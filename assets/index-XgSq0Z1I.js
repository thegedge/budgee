(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const Vw="modulepreload",qw=function(e){return"/"+e},Kd={},cs=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");r=c(n.map(l=>{if(l=qw(l),l in Kd)return;Kd[l]=!0;const h=l.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":Vw,h||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),h)return new Promise((p,g)=>{d.addEventListener("load",p),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};const Yd=new WeakMap,Xd=e=>{if((n=>n.pattern!==void 0)(e))return e.pattern;let t=Yd.get(e);return t===void 0&&Yd.set(e,t=new URLPattern({pathname:e.path})),t};let Kw=class{constructor(t,n,i){this.routes=[],this.o=[],this.t={},this.i=r=>{if(r.routes===this)return;const s=r.routes;this.o.push(s),s.h=this,r.stopImmediatePropagation(),r.onDisconnect=()=>{this.o?.splice(this.o.indexOf(s)>>>0,1)};const a=Gd(this.t);a!==void 0&&s.goto(a)},(this.l=t).addController(this),this.routes=[...n],this.fallback=i?.fallback}link(t){if(t?.startsWith("/"))return t;if(t?.startsWith("."))throw Error("Not implemented");return t??=this.u,(this.h?.link()??"")+t}async goto(t){let n;if(this.routes.length===0&&this.fallback===void 0)n=t,this.u="",this.t={0:n};else{const i=this.p(t);if(i===void 0)throw Error("No route found for "+t);const r=Xd(i).exec({pathname:t}),s=r?.pathname.groups??{};if(n=Gd(s),typeof i.enter=="function"&&await i.enter(s)===!1)return;this.v=i,this.t=s,this.u=n===void 0?t:t.substring(0,t.length-n.length)}if(n!==void 0)for(const i of this.o)i.goto(n);this.l.requestUpdate()}outlet(){return this.v?.render?.(this.t)}get params(){return this.t}p(t){const n=this.routes.find((i=>Xd(i).test({pathname:t})));return n||this.fallback===void 0?n:this.fallback?{...this.fallback,path:"/*"}:void 0}hostConnected(){this.l.addEventListener(Pu.eventName,this.i);const t=new Pu(this);this.l.dispatchEvent(t),this._=t.onDisconnect}hostDisconnected(){this._?.(),this.h=void 0}};const Gd=e=>{let t;for(const n of Object.keys(e))/\d+/.test(n)&&(t===void 0||n>t)&&(t=n);return t&&e[t]};let Pu=class qg extends Event{constructor(t){super(qg.eventName,{bubbles:!0,composed:!0,cancelable:!1}),this.routes=t}};Pu.eventName="lit-routes-connected";const Yw=location.origin||location.protocol+"//"+location.host;let Xw=class extends Kw{constructor(){super(...arguments),this.m=t=>{const n=t.button!==0||t.metaKey||t.ctrlKey||t.shiftKey;if(t.defaultPrevented||n)return;const i=t.composedPath().find((a=>a.tagName==="A"));if(i===void 0||i.target!==""||i.hasAttribute("download")||i.getAttribute("rel")==="external")return;const r=i.href;if(r===""||r.startsWith("mailto:"))return;const s=window.location;i.origin===Yw&&(t.preventDefault(),r!==s.href&&(window.history.pushState({},"",r),this.goto(i.pathname)))},this.R=t=>{this.goto(window.location.pathname)}}hostConnected(){super.hostConnected(),window.addEventListener("click",this.m),window.addEventListener("popstate",this.R),this.goto(window.location.pathname)}hostDisconnected(){super.hostDisconnected(),window.removeEventListener("click",this.m),window.removeEventListener("popstate",this.R)}};const Uo=globalThis,$h=Uo.ShadowRoot&&(Uo.ShadyCSS===void 0||Uo.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Lh=Symbol(),Qd=new WeakMap;let Kg=class{constructor(t,n,i){if(this._$cssResult$=!0,i!==Lh)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if($h&&t===void 0){const i=n!==void 0&&n.length===1;i&&(t=Qd.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&Qd.set(n,t))}return t}toString(){return this.cssText}};const Gw=e=>new Kg(typeof e=="string"?e:e+"",void 0,Lh),Bt=(e,...t)=>{const n=e.length===1?e[0]:t.reduce((i,r,s)=>i+(a=>{if(a._$cssResult$===!0)return a.cssText;if(typeof a=="number")return a;throw Error("Value passed to 'css' function must be a 'css' function result: "+a+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[s+1],e[0]);return new Kg(n,e,Lh)},Qw=(e,t)=>{if($h)e.adoptedStyleSheets=t.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of t){const i=document.createElement("style"),r=Uo.litNonce;r!==void 0&&i.setAttribute("nonce",r),i.textContent=n.cssText,e.appendChild(i)}},Jd=$h?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const i of t.cssRules)n+=i.cssText;return Gw(n)})(e):e;const{is:Jw,defineProperty:Zw,getOwnPropertyDescriptor:t1,getOwnPropertyNames:e1,getOwnPropertySymbols:n1,getPrototypeOf:i1}=Object,nl=globalThis,Zd=nl.trustedTypes,r1=Zd?Zd.emptyScript:"",s1=nl.reactiveElementPolyfillSupport,ua=(e,t)=>e,vc={toAttribute(e,t){switch(t){case Boolean:e=e?r1:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},Nh=(e,t)=>!Jw(e,t),tf={attribute:!0,type:String,converter:vc,reflect:!1,useDefault:!1,hasChanged:Nh};Symbol.metadata??=Symbol("metadata"),nl.litPropertyMetadata??=new WeakMap;let Jr=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,n=tf){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(t,n),!n.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(t,i,n);r!==void 0&&Zw(this.prototype,t,r)}}static getPropertyDescriptor(t,n,i){const{get:r,set:s}=t1(this.prototype,t)??{get(){return this[n]},set(a){this[n]=a}};return{get:r,set(a){const o=r?.call(this);s?.call(this,a),this.requestUpdate(t,o,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??tf}static _$Ei(){if(this.hasOwnProperty(ua("elementProperties")))return;const t=i1(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(ua("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ua("properties"))){const n=this.properties,i=[...e1(n),...n1(n)];for(const r of i)this.createProperty(r,n[r])}const t=this[Symbol.metadata];if(t!==null){const n=litPropertyMetadata.get(t);if(n!==void 0)for(const[i,r]of n)this.elementProperties.set(i,r)}this._$Eh=new Map;for(const[n,i]of this.elementProperties){const r=this._$Eu(n,i);r!==void 0&&this._$Eh.set(r,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const r of i)n.unshift(Jd(r))}else t!==void 0&&n.push(Jd(t));return n}static _$Eu(t,n){const i=n.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,n=this.constructor.elementProperties;for(const i of n.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Qw(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,n,i){this._$AK(t,i)}_$ET(t,n){const i=this.constructor.elementProperties.get(t),r=this.constructor._$Eu(t,i);if(r!==void 0&&i.reflect===!0){const s=(i.converter?.toAttribute!==void 0?i.converter:vc).toAttribute(n,i.type);this._$Em=t,s==null?this.removeAttribute(r):this.setAttribute(r,s),this._$Em=null}}_$AK(t,n){const i=this.constructor,r=i._$Eh.get(t);if(r!==void 0&&this._$Em!==r){const s=i.getPropertyOptions(r),a=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:vc;this._$Em=r;const o=a.fromAttribute(n,s.type);this[r]=o??this._$Ej?.get(r)??o,this._$Em=null}}requestUpdate(t,n,i,r=!1,s){if(t!==void 0){const a=this.constructor;if(r===!1&&(s=this[t]),i??=a.getPropertyOptions(t),!((i.hasChanged??Nh)(s,n)||i.useDefault&&i.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(a._$Eu(t,i))))return;this.C(t,n,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,n,{useDefault:i,reflect:r,wrapped:s},a){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,a??n??this[t]),s!==!0||a!==void 0)||(this._$AL.has(t)||(this.hasUpdated||i||(n=void 0),this._$AL.set(t,n)),r===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,s]of this._$Ep)this[r]=s;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[r,s]of i){const{wrapped:a}=s,o=this[r];a!==!0||this._$AL.has(r)||o===void 0||this.C(r,void 0,s,o)}}let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),this._$EO?.forEach(i=>i.hostUpdate?.()),this.update(n)):this._$EM()}catch(i){throw t=!1,this._$EM(),i}t&&this._$AE(n)}willUpdate(t){}_$AE(t){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(t){}firstUpdated(t){}};Jr.elementStyles=[],Jr.shadowRootOptions={mode:"open"},Jr[ua("elementProperties")]=new Map,Jr[ua("finalized")]=new Map,s1?.({ReactiveElement:Jr}),(nl.reactiveElementVersions??=[]).push("2.1.2");const Fh=globalThis,ef=e=>e,bc=Fh.trustedTypes,nf=bc?bc.createPolicy("lit-html",{createHTML:e=>e}):void 0,Yg="$lit$",Si=`lit$${Math.random().toFixed(9).slice(2)}$`,Xg="?"+Si,a1=`<${Xg}>`,xr=document,Ea=()=>xr.createComment(""),Ma=e=>e===null||typeof e!="object"&&typeof e!="function",Bh=Array.isArray,o1=e=>Bh(e)||typeof e?.[Symbol.iterator]=="function",Nl=`[ 	
\f\r]`,Bs=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,rf=/-->/g,sf=/>/g,Ji=RegExp(`>|${Nl}(?:([^\\s"'>=/]+)(${Nl}*=${Nl}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),af=/'/g,of=/"/g,Gg=/^(?:script|style|textarea|title)$/i,c1=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),F=c1(1),Bi=Symbol.for("lit-noChange"),gt=Symbol.for("lit-nothing"),cf=new WeakMap,fr=xr.createTreeWalker(xr,129);function Qg(e,t){if(!Bh(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return nf!==void 0?nf.createHTML(t):t}const l1=(e,t)=>{const n=e.length-1,i=[];let r,s=t===2?"<svg>":t===3?"<math>":"",a=Bs;for(let o=0;o<n;o++){const c=e[o];let l,h,u=-1,d=0;for(;d<c.length&&(a.lastIndex=d,h=a.exec(c),h!==null);)d=a.lastIndex,a===Bs?h[1]==="!--"?a=rf:h[1]!==void 0?a=sf:h[2]!==void 0?(Gg.test(h[2])&&(r=RegExp("</"+h[2],"g")),a=Ji):h[3]!==void 0&&(a=Ji):a===Ji?h[0]===">"?(a=r??Bs,u=-1):h[1]===void 0?u=-2:(u=a.lastIndex-h[2].length,l=h[1],a=h[3]===void 0?Ji:h[3]==='"'?of:af):a===of||a===af?a=Ji:a===rf||a===sf?a=Bs:(a=Ji,r=void 0);const p=a===Ji&&e[o+1].startsWith("/>")?" ":"";s+=a===Bs?c+a1:u>=0?(i.push(l),c.slice(0,u)+Yg+c.slice(u)+Si+p):c+Si+(u===-2?o:p)}return[Qg(e,s+(e[n]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),i]};class Da{constructor({strings:t,_$litType$:n},i){let r;this.parts=[];let s=0,a=0;const o=t.length-1,c=this.parts,[l,h]=l1(t,n);if(this.el=Da.createElement(l,i),fr.currentNode=this.el.content,n===2||n===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(r=fr.nextNode())!==null&&c.length<o;){if(r.nodeType===1){if(r.hasAttributes())for(const u of r.getAttributeNames())if(u.endsWith(Yg)){const d=h[a++],p=r.getAttribute(u).split(Si),g=/([.?@])?(.*)/.exec(d);c.push({type:1,index:s,name:g[2],strings:p,ctor:g[1]==="."?h1:g[1]==="?"?d1:g[1]==="@"?f1:il}),r.removeAttribute(u)}else u.startsWith(Si)&&(c.push({type:6,index:s}),r.removeAttribute(u));if(Gg.test(r.tagName)){const u=r.textContent.split(Si),d=u.length-1;if(d>0){r.textContent=bc?bc.emptyScript:"";for(let p=0;p<d;p++)r.append(u[p],Ea()),fr.nextNode(),c.push({type:2,index:++s});r.append(u[d],Ea())}}}else if(r.nodeType===8)if(r.data===Xg)c.push({type:2,index:s});else{let u=-1;for(;(u=r.data.indexOf(Si,u+1))!==-1;)c.push({type:7,index:s}),u+=Si.length-1}s++}}static createElement(t,n){const i=xr.createElement("template");return i.innerHTML=t,i}}function gs(e,t,n=e,i){if(t===Bi)return t;let r=i!==void 0?n._$Co?.[i]:n._$Cl;const s=Ma(t)?void 0:t._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),s===void 0?r=void 0:(r=new s(e),r._$AT(e,n,i)),i!==void 0?(n._$Co??=[])[i]=r:n._$Cl=r),r!==void 0&&(t=gs(e,r._$AS(e,t.values),r,i)),t}class u1{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:n},parts:i}=this._$AD,r=(t?.creationScope??xr).importNode(n,!0);fr.currentNode=r;let s=fr.nextNode(),a=0,o=0,c=i[0];for(;c!==void 0;){if(a===c.index){let l;c.type===2?l=new Ja(s,s.nextSibling,this,t):c.type===1?l=new c.ctor(s,c.name,c.strings,this,t):c.type===6&&(l=new p1(s,this,t)),this._$AV.push(l),c=i[++o]}a!==c?.index&&(s=fr.nextNode(),a++)}return fr.currentNode=xr,r}p(t){let n=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,n),n+=i.strings.length-2):i._$AI(t[n])),n++}}class Ja{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,n,i,r){this.type=2,this._$AH=gt,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=i,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&t?.nodeType===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=gs(this,t,n),Ma(t)?t===gt||t==null||t===""?(this._$AH!==gt&&this._$AR(),this._$AH=gt):t!==this._$AH&&t!==Bi&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):o1(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==gt&&Ma(this._$AH)?this._$AA.nextSibling.data=t:this.T(xr.createTextNode(t)),this._$AH=t}$(t){const{values:n,_$litType$:i}=t,r=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=Da.createElement(Qg(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===r)this._$AH.p(n);else{const s=new u1(r,this),a=s.u(this.options);s.p(n),this.T(a),this._$AH=s}}_$AC(t){let n=cf.get(t.strings);return n===void 0&&cf.set(t.strings,n=new Da(t)),n}k(t){Bh(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let i,r=0;for(const s of t)r===n.length?n.push(i=new Ja(this.O(Ea()),this.O(Ea()),this,this.options)):i=n[r],i._$AI(s),r++;r<n.length&&(this._$AR(i&&i._$AB.nextSibling,r),n.length=r)}_$AR(t=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);t!==this._$AB;){const i=ef(t).nextSibling;ef(t).remove(),t=i}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}}class il{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,n,i,r,s){this.type=1,this._$AH=gt,this._$AN=void 0,this.element=t,this.name=n,this._$AM=r,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=gt}_$AI(t,n=this,i,r){const s=this.strings;let a=!1;if(s===void 0)t=gs(this,t,n,0),a=!Ma(t)||t!==this._$AH&&t!==Bi,a&&(this._$AH=t);else{const o=t;let c,l;for(t=s[0],c=0;c<s.length-1;c++)l=gs(this,o[i+c],n,c),l===Bi&&(l=this._$AH[c]),a||=!Ma(l)||l!==this._$AH[c],l===gt?t=gt:t!==gt&&(t+=(l??"")+s[c+1]),this._$AH[c]=l}a&&!r&&this.j(t)}j(t){t===gt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class h1 extends il{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===gt?void 0:t}}class d1 extends il{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==gt)}}class f1 extends il{constructor(t,n,i,r,s){super(t,n,i,r,s),this.type=5}_$AI(t,n=this){if((t=gs(this,t,n,0)??gt)===Bi)return;const i=this._$AH,r=t===gt&&i!==gt||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==gt&&(i===gt||r);r&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class p1{constructor(t,n,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){gs(this,t)}}const g1=Fh.litHtmlPolyfillSupport;g1?.(Da,Ja),(Fh.litHtmlVersions??=[]).push("3.3.2");const m1=(e,t,n)=>{const i=n?.renderBefore??t;let r=i._$litPart$;if(r===void 0){const s=n?.renderBefore??null;i._$litPart$=r=new Ja(t.insertBefore(Ea(),s),s,void 0,n??{})}return r._$AI(e),r};const jh=globalThis;let $t=class extends Jr{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=m1(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Bi}};$t._$litElement$=!0,$t.finalized=!0,jh.litElementHydrateSupport?.({LitElement:$t});const v1=jh.litElementPolyfillSupport;v1?.({LitElement:$t});(jh.litElementVersions??=[]).push("4.2.2");const Ut=e=>(t,n)=>{n!==void 0?n.addInitializer(()=>{customElements.define(e,t)}):customElements.define(e,t)};const b1={attribute:!0,type:String,converter:vc,reflect:!1,hasChanged:Nh},_1=(e=b1,t,n)=>{const{kind:i,metadata:r}=n;let s=globalThis.litPropertyMetadata.get(r);if(s===void 0&&globalThis.litPropertyMetadata.set(r,s=new Map),i==="setter"&&((e=Object.create(e)).wrapped=!0),s.set(n.name,e),i==="accessor"){const{name:a}=n;return{set(o){const c=t.get.call(this);t.set.call(this,o),this.requestUpdate(a,c,e,!0,o)},init(o){return o!==void 0&&this.C(a,void 0,e,o),o}}}if(i==="setter"){const{name:a}=n;return function(o){const c=this[a];t.call(this,o),this.requestUpdate(a,c,e,!0,o)}}throw Error("Unsupported decorator location: "+i)};function pt(e){return(t,n)=>typeof n=="object"?_1(e,t,n):((i,r,s)=>{const a=r.hasOwnProperty(s);return r.constructor.createProperty(s,i),a?Object.getOwnPropertyDescriptor(r,s):void 0})(e,t,n)}function W(e){return pt({...e,state:!0,attribute:!1})}const Jg={ATTRIBUTE:1,CHILD:2},Zg=e=>(...t)=>({_$litDirective$:e,values:t});class tm{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,i){this._$Ct=t,this._$AM=n,this._$Ci=i}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}const y1=Zg(class extends tm{constructor(e){if(super(e),e.type!==Jg.ATTRIBUTE||e.name!=="class"||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){if(this.st===void 0){this.st=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(i=>i!=="")));for(const i in t)t[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(t)}const n=e.element.classList;for(const i of this.st)i in t||(n.remove(i),this.st.delete(i));for(const i in t){const r=!!t[i];r===this.st.has(i)||this.nt?.has(i)||(r?(n.add(i),this.st.add(i)):(n.remove(i),this.st.delete(i)))}return Bi}});class Ou extends tm{constructor(t){if(super(t),this.it=gt,t.type!==Jg.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===gt||t==null)return this._t=void 0,this.it=t;if(t===Bi)return t;if(typeof t!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this._t;this.it=t;const n=[t];return n.raw=n,this._t={_$litType$:this.constructor.resultType,strings:n,values:[]}}}Ou.directiveName="unsafeHTML",Ou.resultType=1;class Au extends Ou{}Au.directiveName="unsafeSVG",Au.resultType=2;const ye=Zg(Au);function Ia(e){"@babel/helpers - typeof";return Ia=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ia(e)}function w1(e,t){if(Ia(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ia(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function x1(e){var t=w1(e,"string");return Ia(t)=="symbol"?t:t+""}function S1(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,x1(i.key),i)}}function Vi(e,t,n){return t&&S1(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C1(e){return e[e.length-1]}function $u(e){return Array.isArray(e)?e.slice(0):[e]}function k1(e,t){e=e.slice(0);for(var n=[];e.length;){var i=e.splice(0,t);n.push(i)}return n}function _c(e){return Array.isArray(e)}function E1(e){return e!=null}function Fl(e,t){var n=0,i=-1;for(var r of e){i=i+1;var s=t(r,i);if(s)n=n+1;else break}return n}function Sr(e,t){var n=t.length;if(n!==0){var i=e.length;e.length=i+t.length;for(var r=0;r<n;++r)e[i+r]=t[r]}}function CL(e){return e.filter(function(t,n,i){return i.indexOf(t)===n})}function ji(e){for(var t="",n=0;n<e.length;n++){var i=e[n];if(i==="-")return parseInt(t,10);t+=i}throw new Error("malformatted revision: "+e)}function ei(e,t){var n=t?ji(t._rev)+1:1;return n+"-"+e}function M1(e){var t=e.split("."),n=t.length;return n===1?i=>i[e]:i=>{for(var r=i,s=0;s<n;++s){var a=t[s];if(r=r[a],typeof r>"u")return r}return r}}function qt(e){return Object.assign({},e)}function D1(e){return Object.keys(e)[0]}function yc(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort((i,r)=>typeof i=="string"&&typeof r=="string"?i.localeCompare(r):typeof i=="object"?1:-1).map(i=>yc(i,t));if(typeof e=="object"&&!Array.isArray(e)){var n={};return Object.keys(e).sort((i,r)=>i.localeCompare(r)).forEach(i=>{n[i]=yc(e[i],t)}),n}return e}function Lu(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var t=new Array(e.length),n=t.length;n--;)t[n]=Lu(e[n]);return t}var i={};for(var r in e)i[r]=Lu(e[r]);return i}var je=Lu;function Qn(e,t,n){return Object.defineProperty(e,t,{get:function(){return n}}),n}var zh=1;function Ps(){return{lwt:zh}}function _n(){return""}function I1(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function R1(e,t,n){if(t.length!==n.length)return!1;for(var i=0,r=t.length;i<r;){var s=t[i],a=n[i];if(i++,s[e]!==a[e]||s._rev!==a._rev||s._meta.lwt!==a._meta.lwt)return!1}return!0}function Ra(e,t){return Ra=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ra(e,t)}function Wh(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ra(e,t)}function Nu(e){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nu(e)}function T1(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function em(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(em=function(){return!!e})()}function P1(e,t,n){if(em())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(e.bind.apply(e,i));return n&&Ra(r,n.prototype),r}function wc(e){var t=typeof Map=="function"?new Map:void 0;return wc=function(i){if(i===null||!T1(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(i))return t.get(i);t.set(i,r)}function r(){return P1(i,arguments,Nu(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ra(r,i)},wc(e)}var zt={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return`
        RxDB Error-Code: `+e+`.
        Hint: Error messages are not included in RxDB core to reduce build size.
        To show the full error messages and to ensure that you do not make any mistakes when using RxDB,
        use the dev-mode plugin when you are in development mode: https://rxdb.info/dev-mode.html?console=error
        `}};function O1(e){var t="";return Object.keys(e).length===0||(t+="-".repeat(20)+`
`,t+=`Parameters:
`,t+=Object.keys(e).map(n=>{var i="[object Object]";try{n==="errors"?i=e[n].map(r=>JSON.stringify(r,Object.getOwnPropertyNames(r))):i=JSON.stringify(e[n],function(r,s){return s===void 0?null:s},2)}catch{}return n+": "+i}).join(`
`),t+=`
`),t}function nm(e,t,n){return`
`+e+`
`+O1(n)}var A1=(function(e){function t(i,r,s={}){var a,o=nm(r,i,s);return a=e.call(this,o)||this,a.code=i,a.message=o,a.url=Hh(i),a.parameters=s,a.rxdb=!0,a}Wh(t,e);var n=t.prototype;return n.toString=function(){return this.message},Vi(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])})(wc(Error)),$1=(function(e){function t(i,r,s={}){var a,o=nm(r,i,s);return a=e.call(this,o)||this,a.code=i,a.message=o,a.url=Hh(i),a.parameters=s,a.rxdb=!0,a}Wh(t,e);var n=t.prototype;return n.toString=function(){return this.message},Vi(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])})(wc(TypeError));function Hh(e){return"https://rxdb.info/errors.html?console=errors#"+e}function im(e){return`
Find out more about this error here: `+Hh(e)+` 
`}function et(e,t){return new A1(e,zt.tunnelErrorMessage(e)+im(e),t)}function xc(e,t){return new $1(e,zt.tunnelErrorMessage(e)+im(e),t)}function ms(e){return e&&e.status===409?e:!1}var L1={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function rm(e){return et("COL20",{name:L1[e.status],document:e.documentId,writeError:e})}var yo;function N1(){if(yo)return yo;if(typeof crypto>"u"||typeof crypto.subtle>"u"||typeof crypto.subtle.digest!="function")throw et("UT8",{args:{typeof_crypto:typeof crypto,typeof_crypto_subtle:typeof crypto?.subtle,typeof_crypto_subtle_digest:typeof crypto?.subtle?.digest}});return yo=crypto.subtle.digest.bind(crypto.subtle),yo}async function F1(e){var t=new TextEncoder().encode(e),n=await N1()("SHA-256",t),i=Array.prototype.map.call(new Uint8Array(n),r=>("00"+r.toString(16)).slice(-2)).join("");return i}var sm=F1;function B1(){return new Promise(e=>setTimeout(e,0))}function am(e=0){return new Promise(t=>setTimeout(t,e))}function om(e){return e&&typeof e.then=="function"?e:Promise.resolve(e)}var Uh=Promise.resolve(!0),Pn=Promise.resolve(!1),Vh=Promise.resolve(null),Ge=Promise.resolve();function rl(e=1e4){return typeof requestIdleCallback=="function"?new Promise(t=>{requestIdleCallback(()=>t(),{timeout:e})}):am(0)}var Bl=Ge;function j1(e=void 0){return Bl=Bl.then(()=>rl(e)),Bl}function z1(e,t){return e.reduce((n,i)=>n.then(i),Promise.resolve(t))}var W1=/\./g,lf="abcdefghijklmnopqrstuvwxyz";function Nr(e=10){for(var t="",n=0;n<e;n++)t+=lf.charAt(Math.floor(Math.random()*lf.length));return t}function cm(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)}function Gs(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function Ta(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,i;if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!Ta(e[i],t[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){var s=r[i];if(!Ta(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}var Fu=e=>{var t=typeof e;return e!==null&&(t==="object"||t==="function")},jl=new Set(["__proto__","prototype","constructor"]),H1=new Set("0123456789");function lm(e){var t=[],n="",i="start",r=!1;for(var s of e)switch(s){case"\\":{if(i==="index")throw new Error("Invalid character in an index");if(i==="indexEnd")throw new Error("Invalid character after an index");r&&(n+=s),i="property",r=!r;break}case".":{if(i==="index")throw new Error("Invalid character in an index");if(i==="indexEnd"){i="property";break}if(r){r=!1,n+=s;break}if(jl.has(n))return[];t.push(n),n="",i="property";break}case"[":{if(i==="index")throw new Error("Invalid character in an index");if(i==="indexEnd"){i="index";break}if(r){r=!1,n+=s;break}if(i==="property"){if(jl.has(n))return[];t.push(n),n=""}i="index";break}case"]":{if(i==="index"){t.push(Number.parseInt(n,10)),n="",i="indexEnd";break}if(i==="indexEnd")throw new Error("Invalid character after an index")}default:{if(i==="index"&&!H1.has(s))throw new Error("Invalid character in an index");if(i==="indexEnd")throw new Error("Invalid character after an index");i==="start"&&(i="property"),r&&(r=!1,n+="\\"),n+=s}}switch(r&&(n+="\\"),i){case"property":{if(jl.has(n))return[];t.push(n);break}case"index":throw new Error("Index was not closed");case"start":{t.push("");break}}return t}function um(e,t){if(typeof t!="number"&&Array.isArray(e)){var n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}function U1(e,t){if(um(e,t))throw new Error("Cannot use string index")}function vs(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!Fu(e)||typeof t!="string")return n===void 0?e:n;var i=lm(t);if(i.length===0)return n;for(var r=0;r<i.length;r++){var s=i[r];if(um(e,s)?e=r===i.length-1?void 0:null:e=e[s],e==null){if(r!==i.length-1)return n;break}}return e===void 0?n:e}function kL(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!Fu(e)||typeof t!="string")return e;for(var i=e,r=lm(t),s=0;s<r.length;s++){var a=r[s];U1(e,a),s===r.length-1?e[a]=n:Fu(e[a])||(e[a]=typeof r[s+1]=="number"?[]:{}),e=e[a]}return i}function zi(e,t){var n=e.get(t);if(typeof n>"u")throw new Error("missing value from map "+t);return n}function ln(e,t,n,i){var r=e.get(t);return typeof r>"u"&&(r=n(),e.set(t,r)),r}function jt(e){var t=e.split("-"),n="RxDB";return t.forEach(i=>{n+=cm(i)}),n+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+n+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+n+`);
        `)}function Bu(e){var t={name:e.name,message:e.message,rxdb:e.rxdb,parameters:e.parameters,extensions:e.extensions,code:e.code,url:e.url,stack:e.stack?e.stack.replace(/\n/g,` 
 `):void 0};return t}var zl=0;function wn(){var e=Date.now();e=e+.01,e<=zl&&(e=zl+.01);var t=parseFloat(e.toFixed(2));return zl=t,t}function it(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}var Za={bufferSize:1,refCount:!0},V1="16.21.1",Wl={},q1="6da4936d1425ff3a5c44c02342c6daf791d266be3ae8479b8ec59e261df41b93",uf=16,Hl=Pn,hf=!1;async function K1(){return hf||(hf=!0,Hl=(async()=>!!(Wl.premium&&typeof Wl.premium=="string"&&await sm(Wl.premium)===q1))()),Hl}var Pa={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postCloseRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],prePrepareRxQuery:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preCloseRxDatabase:[],postRemoveRxDatabase:[],postCleanup:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function ze(e,t){Pa[e].length>0&&Pa[e].forEach(n=>n(t))}async function Cr(e,t){for(var n of Pa[e])await n(t)}function Oa(e,t){var n=t;n=n.replace(W1,".properties."),n="properties."+n,n=Gs(n);var i=vs(e,n);return i}function Y1(e,t,n){if(typeof t.primaryKey=="string")return n;var i=qi(t,n),r=n[e];if(r&&r!==i)throw et("DOC19",{args:{documentData:n,existingPrimary:r,newPrimary:i},schema:t});return n[e]=i,n}function xn(e){return typeof e=="string"?e:e.key}function X1(e){var t=xn(e.primaryKey),n=Oa(e,t);return it(n.maxLength)}function qi(e,t){if(typeof e.primaryKey=="string")return t[e.primaryKey];var n=e.primaryKey;return n.fields.map(i=>{var r=vs(t,i);if(typeof r>"u")throw et("DOC18",{args:{field:i,documentData:t}});return r}).join(n.separator)}function G1(e){var t=yc(e,!0);return t}function Q1(e){return["_deleted",e]}function sl(e){e=qt(e);var t=xn(e.primaryKey);e.properties=qt(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=Z1,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var n=hm(e);Sr(e.required,n),e.required=e.required.filter(s=>!s.includes(".")).filter((s,a,o)=>o.indexOf(s)===a),e.version=e.version||0;var i=e.indexes.map(s=>{var a=_c(s)?s.slice(0):[s];return a.includes(t)||a.push(t),a[0]!=="_deleted"&&a.unshift("_deleted"),a});i.length===0&&i.push(Q1(t)),i.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map(s=>{i.push(s)});var r=new Set;return i.filter(s=>{var a=s.join(",");return r.has(a)?!1:(r.add(a),!0)}),e.indexes=i,e}var J1=1e15,Z1={type:"object",properties:{lwt:{type:"number",minimum:zh,maximum:J1,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function hm(e){var t=Object.keys(e.properties).filter(i=>e.properties[i].final),n=xn(e.primaryKey);return t.push(n),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(i=>t.push(i)),t}function tx(e,t){for(var n=Object.keys(e.defaultValues),i=0;i<n.length;++i){var r=n[i];(!Object.prototype.hasOwnProperty.call(t,r)||typeof t[r]>"u")&&(t[r]=e.defaultValues[r])}return t}var dm=(function(){function e(n,i){if(this.jsonSchema=n,this.hashFunction=i,this.indexes=ex(this.jsonSchema),this.primaryPath=xn(this.jsonSchema.primaryKey),!n.properties[this.primaryPath].maxLength)throw et("SC39",{schema:n});this.finalFields=hm(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(i,r){this.finalFields.forEach(s=>{if(!Ta(i[s],r[s]))throw et("DOC9",{dataBefore:i,dataAfter:r,fieldName:s,schema:this.jsonSchema})})},t.getDocumentPrototype=function(){var i={},r=Oa(this.jsonSchema,"");return Object.keys(r).forEach(s=>{var a=s;i.__defineGetter__(s,function(){if(!(!this.get||typeof this.get!="function")){var o=this.get(a);return o}}),Object.defineProperty(i,s+"$",{get:function(){return this.get$(a)},enumerable:!1,configurable:!1}),Object.defineProperty(i,s+"$$",{get:function(){return this.get$$(a)},enumerable:!1,configurable:!1}),Object.defineProperty(i,s+"_",{get:function(){return this.populate(a)},enumerable:!1,configurable:!1})}),Qn(this,"getDocumentPrototype",()=>i),i},t.getPrimaryOfDocumentData=function(i){return qi(this.jsonSchema,i)},Vi(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var n={};return Object.entries(this.jsonSchema.properties).filter(([,i])=>Object.prototype.hasOwnProperty.call(i,"default")).forEach(([i,r])=>n[i]=r.default),Qn(this,"defaultValues",n)}},{key:"hash",get:function(){return Qn(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])})();function ex(e){return(e.indexes||[]).map(t=>_c(t)?t:[t])}function nx(e){var t=e.version?e.version:0,n=0;return new Array(t).fill(0).map(()=>n++)}function ix(e,t,n=!0){n&&ze("preCreateRxSchema",e);var i=sl(e);i=G1(i),zt.deepFreezeWhenDevMode(i);var r=new dm(i,t);return ze("createRxSchema",r),r}function ce(e){return typeof e=="function"}function rx(e){return ce(e?.lift)}function Bn(e){return function(t){if(rx(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}var ju=function(e,t){return ju=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},ju(e,t)};function Fr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ju(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function sx(e,t,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(h){try{l(i.next(h))}catch(u){a(u)}}function c(h){try{l(i.throw(h))}catch(u){a(u)}}function l(h){h.done?s(h.value):r(h.value).then(o,c)}l((i=i.apply(e,t||[])).next())})}function fm(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(h){return c([l,h])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(i=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(h){l=[6,h],r=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function bs(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function kr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),r,s=[],a;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function Er(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,s;i<r;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}function ls(e){return this instanceof ls?(this.v=e,this):new ls(e)}function ax(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(p){return function(g){return Promise.resolve(g).then(p,u)}}function o(p,g){i[p]&&(r[p]=function(m){return new Promise(function(b,w){s.push([p,m,b,w])>1||c(p,m)})},g&&(r[p]=g(r[p])))}function c(p,g){try{l(i[p](g))}catch(m){d(s[0][3],m)}}function l(p){p.value instanceof ls?Promise.resolve(p.value.v).then(h,u):d(s[0][2],p)}function h(p){c("next",p)}function u(p){c("throw",p)}function d(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ox(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof bs=="function"?bs(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(a){return new Promise(function(o,c){a=e[s](a),r(o,c,a.done,a.value)})}}function r(s,a,o,c){Promise.resolve(c).then(function(l){s({value:l,done:o})},a)}}var pm=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function gm(e){return ce(e?.then)}function qh(e){var t=function(i){Error.call(i),i.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ul=qh(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function zu(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var al=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,i,r,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=bs(a),c=o.next();!c.done;c=o.next()){var l=c.value;l.remove(this)}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}else a.remove(this);var h=this.initialTeardown;if(ce(h))try{h()}catch(m){s=m instanceof Ul?m.errors:[m]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var d=bs(u),p=d.next();!p.done;p=d.next()){var g=p.value;try{df(g)}catch(m){s=s??[],m instanceof Ul?s=Er(Er([],kr(s)),kr(m.errors)):s.push(m)}}}catch(m){i={error:m}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}if(s)throw new Ul(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)df(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&zu(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&zu(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),mm=al.EMPTY;function vm(e){return e instanceof al||e&&"closed"in e&&ce(e.remove)&&ce(e.add)&&ce(e.unsubscribe)}function df(e){ce(e)?e():e.unsubscribe()}var cx={Promise:void 0},lx={setTimeout:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,Er([e,t],kr(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function bm(e){lx.setTimeout(function(){throw e})}function ff(){}function Vo(e){e()}var Kh=(function(e){Fr(t,e);function t(n){var i=e.call(this)||this;return i.isStopped=!1,n?(i.destination=n,vm(n)&&n.add(i)):i.destination=dx,i}return t.create=function(n,i,r){return new _s(n,i,r)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(al),ux=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(i){wo(i)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(i){wo(i)}else wo(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){wo(n)}},e})(),_s=(function(e){Fr(t,e);function t(n,i,r){var s=e.call(this)||this,a;return ce(n)||!n?a={next:n??void 0,error:i??void 0,complete:r??void 0}:a=n,s.destination=new ux(a),s}return t})(Kh);function wo(e){bm(e)}function hx(e){throw e}var dx={closed:!0,next:ff,error:hx,complete:ff},Yh=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function to(e){return e}function fx(e){return e.length===0?to:e.length===1?e[0]:function(n){return e.reduce(function(i,r){return r(i)},n)}}var Qe=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,i){var r=this,s=gx(t)?t:new _s(t,n,i);return Vo(function(){var a=r,o=a.operator,c=a.source;s.add(o?o.call(s,c):c?r._subscribe(s):r._trySubscribe(s))}),s},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var i=this;return n=pf(n),new n(function(r,s){var a=new _s({next:function(o){try{t(o)}catch(c){s(c),a.unsubscribe()}},error:s,complete:r});i.subscribe(a)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Yh]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return fx(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=pf(t),new t(function(i,r){var s;n.subscribe(function(a){return s=a},function(a){return r(a)},function(){return i(s)})})},e.create=function(t){return new e(t)},e})();function pf(e){var t;return(t=e??cx.Promise)!==null&&t!==void 0?t:Promise}function px(e){return e&&ce(e.next)&&ce(e.error)&&ce(e.complete)}function gx(e){return e&&e instanceof Kh||px(e)&&vm(e)}function _m(e){return ce(e[Yh])}function ym(e){return Symbol.asyncIterator&&ce(e?.[Symbol.asyncIterator])}function wm(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function mx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var xm=mx();function Sm(e){return ce(e?.[xm])}function Cm(e){return ax(this,arguments,function(){var n,i,r,s;return fm(this,function(a){switch(a.label){case 0:n=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,ls(n.read())];case 3:return i=a.sent(),r=i.value,s=i.done,s?[4,ls(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,ls(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function km(e){return ce(e?.getReader)}function hi(e){if(e instanceof Qe)return e;if(e!=null){if(_m(e))return vx(e);if(pm(e))return bx(e);if(gm(e))return _x(e);if(ym(e))return Em(e);if(Sm(e))return yx(e);if(km(e))return wx(e)}throw wm(e)}function vx(e){return new Qe(function(t){var n=e[Yh]();if(ce(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bx(e){return new Qe(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function _x(e){return new Qe(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,bm)})}function yx(e){return new Qe(function(t){var n,i;try{for(var r=bs(e),s=r.next();!s.done;s=r.next()){var a=s.value;if(t.next(a),t.closed)return}}catch(o){n={error:o}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}t.complete()})}function Em(e){return new Qe(function(t){xx(e,t).catch(function(n){return t.error(n)})})}function wx(e){return Em(Cm(e))}function xx(e,t){var n,i,r,s;return sx(this,void 0,void 0,function(){var a,o;return fm(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=ox(e),c.label=1;case 1:return[4,n.next()];case 2:if(i=c.sent(),!!i.done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=c.sent(),r={error:o},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function ni(e,t,n,i,r){return new Sx(e,t,n,i,r)}var Sx=(function(e){Fr(t,e);function t(n,i,r,s,a,o){var c=e.call(this,n)||this;return c.onFinalize=a,c.shouldUnsubscribe=o,c._next=i?function(l){try{i(l)}catch(h){n.error(h)}}:e.prototype._next,c._error=s?function(l){try{s(l)}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=r?function(){try{r()}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;e.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(Kh),Mm={now:function(){return(Mm.delegate||Date).now()},delegate:void 0};function Cx(e){return e&&ce(e.schedule)}function Xh(e){return e[e.length-1]}function kx(e){return ce(Xh(e))?e.pop():void 0}function eo(e){return Cx(Xh(e))?e.pop():void 0}function Dm(e,t){return typeof Xh(e)=="number"?e.pop():t}function Ai(e,t,n,i,r){i===void 0&&(i=0),r===void 0&&(r=!1);var s=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(s),!r)return s}var Ex=Array.isArray,Mx=Object.getPrototypeOf,Dx=Object.prototype,Ix=Object.keys;function Rx(e){if(e.length===1){var t=e[0];if(Ex(t))return{args:t,keys:null};if(Tx(t)){var n=Ix(t);return{args:n.map(function(i){return t[i]}),keys:n}}}return{args:e,keys:null}}function Tx(e){return e&&typeof e=="object"&&Mx(e)===Dx}function Im(e,t){return t===void 0&&(t=0),Bn(function(n,i){n.subscribe(ni(i,function(r){return Ai(i,e,function(){return i.next(r)},t)},function(){return Ai(i,e,function(){return i.complete()},t)},function(r){return Ai(i,e,function(){return i.error(r)},t)}))})}function Rm(e,t){return t===void 0&&(t=0),Bn(function(n,i){i.add(e.schedule(function(){return n.subscribe(i)},t))})}function Px(e,t){return hi(e).pipe(Rm(t),Im(t))}function Ox(e,t){return hi(e).pipe(Rm(t),Im(t))}function Ax(e,t){return new Qe(function(n){var i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}function $x(e,t){return new Qe(function(n){var i;return Ai(n,t,function(){i=e[xm](),Ai(n,t,function(){var r,s,a;try{r=i.next(),s=r.value,a=r.done}catch(o){n.error(o);return}a?n.complete():n.next(s)},0,!0)}),function(){return ce(i?.return)&&i.return()}})}function Tm(e,t){if(!e)throw new Error("Iterable cannot be null");return new Qe(function(n){Ai(n,t,function(){var i=e[Symbol.asyncIterator]();Ai(n,t,function(){i.next().then(function(r){r.done?n.complete():n.next(r.value)})},0,!0)})})}function Lx(e,t){return Tm(Cm(e),t)}function Nx(e,t){if(e!=null){if(_m(e))return Px(e,t);if(pm(e))return Ax(e,t);if(gm(e))return Ox(e,t);if(ym(e))return Tm(e,t);if(Sm(e))return $x(e,t);if(km(e))return Lx(e,t)}throw wm(e)}function no(e,t){return t?Nx(e,t):hi(e)}function Jt(e,t){return Bn(function(n,i){var r=0;n.subscribe(ni(i,function(s){i.next(e.call(t,s,r++))}))})}var Fx=Array.isArray;function Bx(e,t){return Fx(t)?e.apply(void 0,Er([],kr(t))):e(t)}function jx(e){return Jt(function(t){return Bx(e,t)})}function zx(e,t){return e.reduce(function(n,i,r){return n[i]=t[r],n},{})}function Pm(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eo(e),i=kx(e),r=Rx(e),s=r.args,a=r.keys;if(s.length===0)return no([],n);var o=new Qe(Wx(s,n,a?function(c){return zx(a,c)}:to));return i?o.pipe(jx(i)):o}function Wx(e,t,n){return n===void 0&&(n=to),function(i){gf(t,function(){for(var r=e.length,s=new Array(r),a=r,o=r,c=function(h){gf(t,function(){var u=no(e[h],t),d=!1;u.subscribe(ni(i,function(p){s[h]=p,d||(d=!0,o--),o||i.next(n(s.slice()))},function(){--a||i.complete()}))},i)},l=0;l<r;l++)c(l)},i)}}function gf(e,t,n){e?Ai(n,e,t):t()}function Hx(e,t,n,i,r,s,a,o){var c=[],l=0,h=0,u=!1,d=function(){u&&!c.length&&!l&&t.complete()},p=function(m){return l<i?g(m):c.push(m)},g=function(m){l++;var b=!1;hi(n(m,h++)).subscribe(ni(t,function(w){t.next(w)},function(){b=!0},void 0,function(){if(b)try{l--;for(var w=function(){var C=c.shift();a||g(C)};c.length&&l<i;)w();d()}catch(C){t.error(C)}}))};return e.subscribe(ni(t,p,function(){u=!0,d()})),function(){}}function On(e,t,n){return n===void 0&&(n=1/0),ce(t)?On(function(i,r){return Jt(function(s,a){return t(i,s,r,a)})(hi(e(i,r)))},n):(typeof t=="number"&&(n=t),Bn(function(i,r){return Hx(i,r,e,n)}))}function Gh(e){return e===void 0&&(e=1/0),On(to,e)}function Ux(){return Gh(1)}var Vx=qh(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ie=(function(e){Fr(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var i=new mf(this,this);return i.operator=n,i},t.prototype._throwIfClosed=function(){if(this.closed)throw new Vx},t.prototype.next=function(n){var i=this;Vo(function(){var r,s;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var a=bs(i.currentObservers),o=a.next();!o.done;o=a.next()){var c=o.value;c.next(n)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}})},t.prototype.error=function(n){var i=this;Vo(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=n;for(var r=i.observers;r.length;)r.shift().error(n)}})},t.prototype.complete=function(){var n=this;Vo(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var i=n.observers;i.length;)i.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var i=this,r=this,s=r.hasError,a=r.isStopped,o=r.observers;return s||a?mm:(this.currentObservers=null,o.push(n),new al(function(){i.currentObservers=null,zu(o,n)}))},t.prototype._checkFinalizedStatuses=function(n){var i=this,r=i.hasError,s=i.thrownError,a=i.isStopped;r?n.error(s):a&&n.complete()},t.prototype.asObservable=function(){var n=new Qe;return n.source=this,n},t.create=function(n,i){return new mf(n,i)},t})(Qe),mf=(function(e){Fr(t,e);function t(n,i){var r=e.call(this)||this;return r.destination=n,r.source=i,r}return t.prototype.next=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,n)},t.prototype.error=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,n)},t.prototype.complete=function(){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||i===void 0||i.call(n)},t.prototype._subscribe=function(n){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(n))!==null&&r!==void 0?r:mm},t})(ie);function vf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ux()(no(e,eo(e)))}var qx=new Qe(function(e){return e.complete()});function Aa(e,t){return t===void 0&&(t=to),e=e??Kx,Bn(function(n,i){var r,s=!0;n.subscribe(ni(i,function(a){var o=t(a);(s||!e(r,o))&&(s=!1,r=o,i.next(a))}))})}function Kx(e,t){return e===t}function wt(e,t){return Bn(function(n,i){var r=0;n.subscribe(ni(i,function(s){return e.call(t,s,r++)&&i.next(s)}))})}var Yx=qh(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Xx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eo(e),i=Dm(e,1/0);return Bn(function(r,s){Gh(i)(no(Er([r],kr(e)),n)).subscribe(s)})}function Gx(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xx.apply(void 0,Er([],kr(e)))}var mn=(function(e){Fr(t,e);function t(n){var i=e.call(this)||this;return i._value=n,i}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var i=e.prototype._subscribe.call(this,n);return!i.closed&&n.next(this._value),i},t.prototype.getValue=function(){var n=this,i=n.hasError,r=n.thrownError,s=n._value;if(i)throw r;return this._throwIfClosed(),s},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t})(ie),Qx=(function(e){Fr(t,e);function t(n,i,r){n===void 0&&(n=1/0),i===void 0&&(i=1/0),r===void 0&&(r=Mm);var s=e.call(this)||this;return s._bufferSize=n,s._windowTime=i,s._timestampProvider=r,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=i===1/0,s._bufferSize=Math.max(1,n),s._windowTime=Math.max(1,i),s}return t.prototype.next=function(n){var i=this,r=i.isStopped,s=i._buffer,a=i._infiniteTimeWindow,o=i._timestampProvider,c=i._windowTime;r||(s.push(n),!a&&s.push(o.now()+c)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var i=this._innerSubscribe(n),r=this,s=r._infiniteTimeWindow,a=r._buffer,o=a.slice(),c=0;c<o.length&&!n.closed;c+=s?1:2)n.next(o[c]);return this._checkFinalizedStatuses(n),i},t.prototype._trimBuffer=function(){var n=this,i=n._bufferSize,r=n._timestampProvider,s=n._buffer,a=n._infiniteTimeWindow,o=(a?1:2)*i;if(i<1/0&&o<s.length&&s.splice(0,s.length-o),!a){for(var c=r.now(),l=0,h=1;h<s.length&&s[h]<=c;h+=2)l=h;l&&s.splice(0,l+1)}},t})(ie);function Jx(e){e===void 0&&(e={});var t=e.connector,n=t===void 0?function(){return new ie}:t,i=e.resetOnError,r=i===void 0?!0:i,s=e.resetOnComplete,a=s===void 0?!0:s,o=e.resetOnRefCountZero,c=o===void 0?!0:o;return function(l){var h,u,d,p=0,g=!1,m=!1,b=function(){u?.unsubscribe(),u=void 0},w=function(){b(),h=d=void 0,g=m=!1},C=function(){var _=h;w(),_?.unsubscribe()};return Bn(function(_,k){p++,!m&&!g&&b();var x=d=d??n();k.add(function(){p--,p===0&&!m&&!g&&(u=Vl(C,c))}),x.subscribe(k),!h&&p>0&&(h=new _s({next:function(I){return x.next(I)},error:function(I){m=!0,b(),u=Vl(w,r,I),x.error(I)},complete:function(){g=!0,b(),u=Vl(w,a),x.complete()}}),hi(_).subscribe(h))})(l)}}function Vl(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(t===!0){e();return}if(t!==!1){var r=new _s({next:function(){r.unsubscribe(),e()}});return hi(t.apply(void 0,Er([],kr(n)))).subscribe(r)}}function io(e,t,n){var i,r,s,a,o=!1;return e&&typeof e=="object"?(i=e.bufferSize,a=i===void 0?1/0:i,r=e.windowTime,t=r===void 0?1/0:r,s=e.refCount,o=s===void 0?!1:s,n=e.scheduler):a=e??1/0,Jx({connector:function(){return new Qx(a,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}function ro(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eo(e);return Bn(function(i,r){(n?vf(e,i,n):vf(e,i)).subscribe(r)})}function Zx(e,t){return Bn(function(n,i){var r=null,s=0,a=!1,o=function(){return a&&!r&&i.complete()};n.subscribe(ni(i,function(c){r?.unsubscribe();var l=0,h=s++;hi(e(c,h)).subscribe(r=ni(i,function(u){return i.next(t?t(c,u,h,l++):u)},function(){r=null,o()}))},function(){a=!0,o()}))})}function Om(e){return e.documentData?e.documentData:e.previousDocumentData}function t2(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:zt.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}var e2=new Map;function Am(e){return ln(e2,e,()=>{for(var t=new Array(e.events.length),n=e.events,i=e.collectionName,r=e.isLocal,s=zt.deepFreezeWhenDevMode,a=0;a<n.length;a++){var o=n[a];t[a]={documentId:o.documentId,collectionName:i,isLocal:r,operation:o.operation,documentData:s(o.documentData),previousDocumentData:s(o.previousDocumentData)}}return t})}function Jn(e,t){return new Promise(function(n,i){var r=new _s({next:function(s){n(s),r.unsubscribe()},error:i,complete:function(){i(new Yx)}});e.subscribe(r)})}function n2(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eo(e),i=Dm(e,1/0),r=e;return r.length?r.length===1?hi(r[0]):Gh(i)(no(r,n)):qx}var ha="",da=Number.MIN_SAFE_INTEGER;function i2(e,t){var n=t.selector,i=e.indexes?e.indexes.slice(0):[];t.index&&(i=[t.index]);var r=!!t.sort.find(h=>Object.values(h)[0]==="desc"),s=new Set;Object.keys(n).forEach(h=>{var u=Oa(e,h);u&&u.type==="boolean"&&Object.prototype.hasOwnProperty.call(n[h],"$eq")&&s.add(h)});var a=t.sort.map(h=>Object.keys(h)[0]),o=a.filter(h=>!s.has(h)).join(","),c=-1,l;if(i.forEach(h=>{var u=!0,d=!0,p=h.map(C=>{var _=n[C],k=_?Object.keys(_):[],x={};if(!_||!k.length){var I=d?da:ha;x={startKey:I,endKey:u?ha:da,inclusiveStart:!0,inclusiveEnd:!0}}else k.forEach(E=>{if(Qh.has(E)){var y=_[E],M=o2(E,y);x=Object.assign(x,M)}});return typeof x.startKey>"u"&&(x.startKey=da),typeof x.endKey>"u"&&(x.endKey=ha),typeof x.inclusiveStart>"u"&&(x.inclusiveStart=!0),typeof x.inclusiveEnd>"u"&&(x.inclusiveEnd=!0),d&&!x.inclusiveStart&&(d=!1),u&&!x.inclusiveEnd&&(u=!1),x}),g=p.map(C=>C.startKey),m=p.map(C=>C.endKey),b={index:h,startKeys:g,endKeys:m,inclusiveEnd:u,inclusiveStart:d,sortSatisfiedByIndex:!r&&o===h.filter(C=>!s.has(C)).join(","),selectorSatisfiedByIndex:a2(h,t.selector,g,m)},w=c2(e,t,b);(w>=c||t.index)&&(c=w,l=b)}),!l)throw et("SNH",{query:t});return l}var Qh=new Set(["$eq","$gt","$gte","$lt","$lte"]),r2=new Set(["$eq","$gt","$gte"]),s2=new Set(["$eq","$lt","$lte"]);function a2(e,t,n,i){var r=Object.entries(t),s=r.find(([E,y])=>{if(!e.includes(E))return!0;var M=Object.entries(y).find(([D,R])=>!Qh.has(D));return M});if(s||t.$and||t.$or)return!1;var a=[],o=new Set;for(var[c,l]of Object.entries(t)){if(!e.includes(c))return!1;var h=Object.keys(l).filter(E=>r2.has(E));if(h.length>1)return!1;var u=h[0];if(u&&o.add(c),u!=="$eq"){if(a.length>0)return!1;a.push(u)}}var d=[],p=new Set;for(var[g,m]of Object.entries(t)){if(!e.includes(g))return!1;var b=Object.keys(m).filter(E=>s2.has(E));if(b.length>1)return!1;var w=b[0];if(w&&p.add(g),w!=="$eq"){if(d.length>0)return!1;d.push(w)}}var C=0;for(var _ of e){for(var k of[o,p]){if(!k.has(_)&&k.size>0)return!1;k.delete(_)}var x=n[C],I=i[C];if(x!==I&&o.size>0&&p.size>0)return!1;C++}return!0}function o2(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}function c2(e,t,n){var i=0,r=h=>{h>0&&(i=i+h)},s=10,a=Fl(n.startKeys,h=>h!==da&&h!==ha);r(a*s);var o=Fl(n.startKeys,h=>h!==ha&&h!==da);r(o*s);var c=Fl(n.startKeys,(h,u)=>h===n.endKeys[u]);r(c*s*1.5);var l=n.sortSatisfiedByIndex?5:0;return r(l),i}class ol extends Error{}const $a=Symbol("missing"),$m=Object.freeze(new Error("mingo: cycle detected while processing object/array")),cl=e=>{const t=qo(e);let n=0,i=t.length;for(;i;)n=(n<<5)-n^t.charCodeAt(--i);return n>>>0},Mi=e=>typeof e!="object"&&typeof e!="function"||e===null,Lm=e=>Mi(e)||Na(e)||mr(e),Nm={undefined:1,null:2,number:3,string:4,symbol:5,object:6,array:7,arraybuffer:8,boolean:9,date:10,regexp:11,function:12},Wi=(e,t)=>{e===$a&&(e=void 0),t===$a&&(t=void 0);const[n,i]=[e,t].map(r=>Nm[La(r)]||0);return n!==i?n-i:$i(e,t)?0:e<t?-1:e>t?1:0};class Sc extends Map{#t=cl;#n=new Map;#e=t=>{const n=this.#t(t);return[(this.#n.get(n)||[]).find(i=>$i(i,t)),n]};constructor(){super()}static init(t){const n=new Sc;return t&&(n.#t=t),n}clear(){super.clear(),this.#n.clear()}delete(t){if(Mi(t))return super.delete(t);const[n,i]=this.#e(t);return super.delete(n)?(this.#n.set(i,this.#n.get(i).filter(r=>!$i(r,n))),!0):!1}get(t){if(Mi(t))return super.get(t);const[n,i]=this.#e(t);return super.get(n)}has(t){if(Mi(t))return super.has(t);const[n,i]=this.#e(t);return super.has(n)}set(t,n){if(Mi(t))return super.set(t,n);const[i,r]=this.#e(t);if(super.has(i))super.set(i,n);else{super.set(t,n);const s=this.#n.get(r)||[];s.push(t),this.#n.set(r,s)}return this}get size(){return super.size}}function pe(e,t){if(!e)throw new ol(t)}const l2=Object.keys(Nm).reduce((e,t)=>(e["[object "+t[0].toUpperCase()+t.substring(1)+"]"]=t,e),{});function La(e){const t=Object.prototype.toString.call(e);return t==="[object Object]"?e?.constructor?.name?.toLowerCase()||"object":l2[t]||t.substring(8,t.length-1).toLowerCase()}const us=e=>typeof e=="boolean",yn=e=>typeof e=="string",u2=e=>typeof e=="symbol",Ke=e=>!isNaN(e)&&typeof e=="number",Ft=Array.isArray;function Oe(e){if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===Object.prototype||t===null)&&La(e)==="object"}const Fm=e=>!Mi(e),Na=e=>e instanceof Date,mr=e=>e instanceof RegExp,Jh=e=>typeof e=="function",Je=e=>e==null,h2=(e,t=!0)=>!!e||t&&e==="",Zh=e=>Je(e)||yn(e)&&!e||Ft(e)&&e.length===0||Oe(e)&&Object.keys(e).length===0,so=e=>Ft(e)?e:[e],ys=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),d2=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),Fa=(e,t)=>{if(Je(e)||us(e)||Ke(e)||yn(e))return e;if(Na(e))return new Date(e);if(mr(e))return new RegExp(e);if(d2(e)){const n=e.constructor;return new n(e)}if(t instanceof Set||(t=new Set),t.has(e))throw $m;t.add(e);try{if(Ft(e)){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=Fa(e[i],t);return n}if(Oe(e)){const n={};for(const i of Object.keys(e))n[i]=Fa(e[i],t);return n}}finally{t.delete(e)}return e},bf=e=>e===$a;function Wu(e,t){if(bf(e)||Je(e))return t;if(bf(t)||Je(t))return e;if(Mi(e)||Mi(t))return t;Ft(e)&&Ft(t)&&pe(e.length===t.length,"arrays must be of equal length to merge.");for(const n of Object.keys(t))e[n]=Wu(e[n],t[n]);return e}function f2(e,t=cl){const n=[Sc.init(t),Sc.init(t)];if(e.length===0)return[];if(e.some(i=>i.length===0))return[];if(e.length===1)return[...e];e[e.length-1].forEach(i=>n[0].set(i,!0));for(let i=e.length-2;i>-1;i--){if(e[i].forEach(r=>{n[0].has(r)&&n[1].set(r,!0)}),n[1].size===0)return[];n.reverse(),n[1].clear()}return Array.from(n[0].keys())}function Bm(e,t=1){const n=new Array;function i(r,s){for(let a=0,o=r.length;a<o;a++)Ft(r[a])&&(s>0||s<0)?i(r[a],Math.max(-1,s-1)):n.push(r[a])}return i(e,t),n}function p2(e){const t={};for(;e;){for(const n of Object.getOwnPropertyNames(e))n in t||(t[n]=e[n]);e=Object.getPrototypeOf(e)}return t}function jm(e){for(;e;){if(Object.getOwnPropertyNames(e).includes("toString"))return e.toString!==Object.prototype.toString;e=Object.getPrototypeOf(e)}return!1}function $i(e,t){if(e===t||Object.is(e,t))return!0;if(e===null||t===null||typeof e!=typeof t||typeof e!="object"||e.constructor!==t.constructor)return!1;if(e instanceof Date)return+e==+t;if(e instanceof RegExp)return e.toString()===t.toString();const n=e.constructor;if(n===Array||n===Object){const i=Object.keys(e).sort(),r=Object.keys(t).sort();if(i.length!==r.length)return!1;for(let s=0,a=i[s];s<i.length;a=i[++s])if(a!==r[s]||!$i(e[a],t[a]))return!1;return!0}return jm(e)&&e.toString()===t.toString()}const qo=(e,t)=>{if(e===null)return"null";if(e===void 0)return"undefined";if(yn(e)||Ke(e)||us(e))return JSON.stringify(e);if(Na(e))return e.toISOString();if(mr(e)||u2(e)||Jh(e))return e.toString();if(t instanceof Set||(t=new Set),t.has(e))throw $m;try{if(t.add(e),Ft(e))return"["+e.map(i=>qo(i,t)).join(",")+"]";if(Oe(e))return"{"+Object.keys(e).sort().map(r=>`${r}:${qo(e[r],t)}`).join()+"}";const n=jm(e)?e.toString():qo(p2(e),t);return La(e)+"("+n+")"}finally{t.delete(e)}};function g2(e,t){return Je(e)?null:(t=t||cl,t(e))}function m2(e,t,n=cl){if(e.length<1)return new Map;const i=new Map,r=new Map;for(let s=0;s<e.length;s++){const a=e[s],o=t(a,s),c=g2(o,n);if(c===null)r.has(null)?r.get(null).push(a):r.set(null,[a]);else{const l=i.has(c)?i.get(c).find(h=>$i(h,o)):null;Je(l)?(r.set(o,[a]),i.has(c)?i.get(c).push(o):i.set(c,[o])):r.get(l).push(a)}}return r}function Hu(e,t){return Fm(e)?e[t]:void 0}function v2(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function Mr(e,t,n){let i=0;function r(a,o){let c=a;for(let l=0;l<o.length;l++){const h=o[l];if(/^\d+$/.exec(h)===null&&Ft(c)){if(l===0&&i>0)break;i+=1;const d=o.slice(l);c=c.reduce((p,g)=>{const m=r(g,d);return m!==void 0&&p.push(m),p},[]);break}else c=Hu(c,h);if(c===void 0)break}return c}const s=Lm(e)?e:r(e,t.split("."));return Ft(s)&&n?.unwrapArray?v2(s,i):s}function fa(e,t,n){const i=t.indexOf("."),r=i==-1?t:t.substring(0,i),s=t.substring(i+1),a=i!=-1;if(Ft(e)){const l=/^\d+$/.test(r),h=l&&n?.preserveIndex?[...e]:[];if(l){const u=parseInt(r);let d=Hu(e,u);a&&(d=fa(d,s,n)),n?.preserveIndex?h[u]=d:h.push(d)}else for(const u of e){const d=fa(u,t,n);n?.preserveMissing?h.push(d??$a):(d!=null||n?.preserveIndex)&&h.push(d)}return h}const o=n?.preserveKeys?{...e}:{};let c=Hu(e,r);if(a&&(c=fa(c,s,n)),c!==void 0)return o[r]=c,o}function Uu(e){if(Ft(e))for(let t=e.length-1;t>=0;t--)e[t]===$a?e.splice(t,1):Uu(e[t]);else if(Oe(e))for(const t in e)ys(e,t)&&Uu(e[t])}const _f=/^\d+$/;function Cc(e,t,n,i){const r=t.split("."),s=r[0],a=r.slice(1).join(".");if(r.length===1)(Oe(e)||Ft(e)&&_f.test(s))&&n(e,s);else{i?.buildGraph&&Je(e[s])&&(e[s]={});const o=e[s];if(!o)return;const c=!!(r.length>1&&_f.test(r[1]));Ft(o)&&i?.descendArray&&!c?o.forEach(l=>Cc(l,a,n,i)):Cc(o,a,n,i)}}function b2(e,t,n){Cc(e,t,(i,r)=>{i[r]=Jh(n)?n(i[r]):n},{buildGraph:!0})}function yf(e,t,n){Cc(e,t,(i,r)=>{if(Ft(i)){if(/^\d+$/.test(r))i.splice(parseInt(r),1);else if(n&&n.descendArray)for(const s of i)Oe(s)&&delete s[r]}else Oe(i)&&delete i[r]},n)}const _2=/^\$[a-zA-Z0-9_]+$/;function Br(e){return _2.test(e)}function zm(e){if(Lm(e))return mr(e)?{$regex:e}:{$eq:e};if(Fm(e)){if(!Object.keys(e).some(Br))return{$eq:e};if(ys(e,"$regex")){const t={...e};return t.$regex=new RegExp(e.$regex,e.$options),delete t.$options,t}}return e}var Vu=(e=>(e[e.CLONE_OFF=0]="CLONE_OFF",e[e.CLONE_INPUT=1]="CLONE_INPUT",e[e.CLONE_OUTPUT=2]="CLONE_OUTPUT",e[e.CLONE_ALL=3]="CLONE_ALL",e))(Vu||{});class vr{#t;#n;#e;constructor(t,n,i){this.#t=t,this.update(n,i)}static init(t,n,i){return t instanceof vr?new vr(t.#t,t.root??n,{...t.#e,...i,variables:Object.assign({},t.#e?.variables,i?.variables)}):new vr(t,n,i)}update(t,n){this.#n=t;const i=Object.assign({},this.#e?.variables,n?.variables);return Object.keys(i).length?this.#e={...n,variables:i}:this.#e=n??{},this}getOptions(){return Object.freeze({...this.#t,context:Dr.from(this.#t.context)})}get root(){return this.#n}get local(){return this.#e}get idKey(){return this.#t.idKey}get collation(){return this.#t?.collation}get processingMode(){return this.#t?.processingMode||0}get useStrictMode(){return this.#t?.useStrictMode}get scriptEnabled(){return this.#t?.scriptEnabled}get useGlobalContext(){return this.#t?.useGlobalContext}get hashFunction(){return this.#t?.hashFunction}get collectionResolver(){return this.#t?.collectionResolver}get jsonSchemaValidator(){return this.#t?.jsonSchemaValidator}get variables(){return this.#t?.variables}get context(){return this.#t?.context}}function y2(e){return e instanceof vr?e.getOptions():Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:0,...e,context:e?.context?Dr.from(e?.context):Dr.init()})}class Dr{#t=new Map;constructor(){}static init(){return new Dr}static from(t){const n=Dr.init();return Je(t)||t.#t.forEach((i,r)=>n.addOperators(r,i)),n}addOperators(t,n){this.#t.has(t)||this.#t.set(t,{});for(const[i,r]of Object.entries(n))this.getOperator(t,i)||(this.#t.get(t)[i]=r);return this}getOperator(t,n){return(this.#t.get(t)??{})[n]??null}addAccumulatorOps(t){return this.addOperators("accumulator",t)}addExpressionOps(t){return this.addOperators("expression",t)}addQueryOps(t){return this.addOperators("query",t)}addPipelineOps(t){return this.addOperators("pipeline",t)}addProjectionOps(t){return this.addOperators("projection",t)}addWindowOps(t){return this.addOperators("window",t)}}const or=Dr.init();function wf(e,t){for(const[n,i]of Object.entries(t)){pe(Jh(i)&&Br(n),`'${n}' is not a valid operator`);const r=Ba(e,n,null);pe(!r||i===r,`${n} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":or.addAccumulatorOps(t);break;case"expression":or.addExpressionOps(t);break;case"pipeline":or.addPipelineOps(t);break;case"projection":or.addProjectionOps(t);break;case"query":or.addQueryOps(t);break;case"window":or.addWindowOps(t);break}}function Ba(e,t,n){const{context:i,useGlobalContext:r}=n||{},s=i?i.getOperator(e,t):null;return!s&&r?or.getOperator(e,t):s}function Zr(e,t,n,i){const r=vr.init(i,e);return n&&Br(n)?Wm(e,t,n,r):kc(e,t,r)}const w2=["$$ROOT","$$CURRENT","$$REMOVE","$$NOW"];function kc(e,t,n){if(yn(t)&&t.length>0&&t[0]==="$"){if(x2.includes(t))return t;let i=n.root;const r=t.split(".");if(w2.includes(r[0])){switch(r[0]){case"$$ROOT":break;case"$$CURRENT":i=e;break;case"$$REMOVE":i=void 0;break;case"$$NOW":i=new Date;break}t=t.slice(r[0].length+1)}else if(r[0].slice(0,2)==="$$"){i=Object.assign({},n.variables,{this:e},n?.local?.variables);const s=r[0].slice(2);pe(ys(i,s),`Use of undefined variable: ${s}`),t=t.slice(2)}else t=t.slice(1);return t===""?i:Mr(i,t)}if(Ft(t))return t.map(i=>kc(e,i,n));if(Oe(t)){const i={},r=Object.entries(t);for(const[s,a]of r){if(Br(s))return pe(r.length==1,"expression must have single operator."),Wm(e,a,s,n);i[s]=kc(e,a,n)}return i}return t}function Wm(e,t,n,i){const r=Ba("expression",n,i);if(r)return r(e,t,i);const s=Ba("accumulator",n,i);return pe(!!s,`accumulator '${n}' is not registered.`),Ft(e)||(e=kc(e,t,i),t=null),pe(Ft(e),`arguments must resolve to array for ${n}.`),s(e,t,i)}const x2=["$$KEEP","$$PRUNE","$$DESCEND"];function ja(e){return e instanceof xf?e:new xf(e)}function S2(...e){let t=0;return ja(()=>{for(;t<e.length;){const n=e[t].next();if(!n.done)return n;t++}return{done:!0}})}function C2(e){return!!e&&typeof e=="object"&&e?.next instanceof Function}function k2(e,t){const n=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,n)}const qu=new Error;function E2(e,t,n){let i=!1,r=-1,s=0;return function(a){try{t:for(;!i;){let o=e();r++;let c=-1;const l=t.length;let h=!1;for(;++c<l;){const u=t[c];switch(u.action){case 0:o=u.func(o,r);break;case 1:if(!u.func(o,r))continue t;break;case 2:--u.count,u.count||(h=!0);break;case 3:--u.count,u.count||k2(t,c);continue t;default:break t}}if(i=h,a)n[s++]=o;else return{value:o,done:!1}}}catch(o){if(o!==qu)throw o}return i=!0,{done:i}}}let xf=class{constructor(t){this.#t=[],this.#n=[],this.isDone=!1;let n;if(t instanceof Function&&(t={next:t}),C2(t)){const i=t;n=()=>{const r=i.next();if(r.done)throw qu;return r.value}}else if(Ft(t)){const i=t,r=i.length;let s=0;n=()=>{if(s<r)return i[s++];throw qu}}else if(!(t instanceof Function))throw new ol("Lazy must be initialized with an array, generator, or function.");this.#e=E2(n,this.#t,this.#n)}#t;#n;#e;push(t,n){return typeof n=="function"?this.#t.push({action:t,func:n}):typeof n=="number"&&this.#t.push({action:t,count:n}),this}next(){return this.#e()}map(t){return this.push(0,t)}filter(t){return this.push(1,t)}take(t){return t>0?this.push(2,t):this}drop(t){return t>0?this.push(3,t):this}transform(t){const n=this;let i;return ja(()=>(i||(i=ja(t(n.value()))),i.next()))}value(){return this.isDone||(this.isDone=this.#e(!0).done),this.#n}each(t){for(;;){const n=this.next();if(n.done)break;if(t(n.value)===!1)return!1}return!0}reduce(t,n){let i=this.next();for(n===void 0&&!i.done&&(n=i.value,i=this.next());!i.done;)n=t(n,i.value),i=this.next();return n}size(){return this.reduce((t,n)=>++t,0)}[Symbol.iterator](){return this}};const M2=(e,t,n)=>e.take(t),Hm=(e,t,n)=>Zh(t)?e:(Vm(t,n),e.map(Um(t,vr.init(n))));function Um(e,t,n=!0){const i=t.idKey,r=Object.keys(e),s=new Array,a=new Array,o={};for(const p of r){const g=e[p];if(Ke(g)||us(g))g?a.push(p):s.push(p);else if(Ft(g))o[p]=m=>g.map(b=>Zr(m,b,null,t.update(m))??null);else if(Oe(g)){const m=Object.keys(g),b=m.length==1?m[0]:"",w=Ba("projection",b,t);w?b==="$slice"&&!so(g[b]).every(Ke)?o[p]=_=>Zr(_,g,p,t.update(_)):o[p]=_=>w(_,g[b],p,t.update(_)):Br(b)?o[p]=C=>Zr(C,g[b],b,t):(Vm(g,t),o[p]=C=>{if(!ys(C,p))return Zr(C,g,null,t);n&&t.update(C);const _=Mr(C,p),k=Um(g,t,!1);return Ft(_)?_.map(k):Oe(_)?k(_):k(C)})}else o[p]=yn(g)&&g[0]==="$"?m=>Zr(m,g,p,t):m=>g}const c=Object.keys(o),l=s.includes(i);if(n&&l&&s.length===1&&!a.length&&!c.length)return p=>{const g={...p};return delete g[i],g};const u=n&&!l&&!a.includes(i),d={preserveMissing:!0};return p=>{const g={};if(s.length&&!a.length){Wu(g,p);for(const m of s)yf(g,m,{descendArray:!0})}for(const m of a){const b=fa(p,m,d)??{};Wu(g,b)}a.length&&Uu(g);for(const m of c){const b=o[m](p);b===void 0?yf(g,m,{descendArray:!0}):b2(g,m,b)}return u&&ys(p,i)&&(g[i]=Mr(p,i)),g}}function Vm(e,t){let n=!1,i=!1;for(const[r,s]of Object.entries(e))pe(!r.startsWith("$"),"Field names may not start with '$'."),pe(!r.endsWith(".$"),"Positional projection operator '$' is not supported."),r!==t?.idKey&&(s===0||s===!1?n=!0:(s===1||s===!0)&&(i=!0),pe(!(n&&i),"Projection cannot have a mix of inclusion and exclusion."))}const D2=(e,t,n)=>e.drop(t),qm=(e,t,n)=>{if(Zh(t)||!Oe(t))return e;let i=Wi;const r=n.collation;return Oe(r)&&yn(r.locale)&&(i=R2(r)),e.transform(s=>{const a=Object.keys(t);for(const o of a.reverse()){const c=m2(s,u=>Mr(u,o),n.hashFunction),l=Array.from(c.keys()).sort(i);t[o]===-1&&l.reverse();let h=0;for(const u of l)for(const d of c.get(u))s[h++]=d;pe(h==s.length,"bug: counter must match collection size.")}return s})},I2={1:"base",2:"accent",3:"variant"};function R2(e){const t={sensitivity:I2[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));const n=new Intl.Collator(e.locale,t);return(i,r)=>{if(!yn(i)||!yn(r))return Wi(i,r);const s=n.compare(i,r);return s<0?-1:s>0?1:0}}const T2={$sort:qm,$skip:D2,$limit:M2};class P2{#t;#n;#e;#r;#a={};#i=null;#s=[];constructor(t,n,i,r){this.#t=t,this.#n=n,this.#e=i,this.#r=r}fetch(){if(this.#i)return this.#i;this.#i=ja(this.#t).filter(this.#n);const t=this.#r.processingMode;t&Vu.CLONE_INPUT&&this.#i.map(Fa);for(const n of["$sort","$skip","$limit"])ys(this.#a,n)&&(this.#i=T2[n](this.#i,this.#a[n],this.#r));return Object.keys(this.#e).length&&(this.#i=Hm(this.#i,this.#e,this.#r)),t&Vu.CLONE_OUTPUT&&this.#i.map(Fa),this.#i}fetchAll(){const t=ja([...this.#s]);return this.#s=[],S2(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.#a.$skip=t,this}limit(t){return this.#a.$limit=t,this}sort(t){return this.#a.$sort=t,this}collation(t){return this.#r={...this.#r,collation:t},this}next(){if(this.#s.length>0)return this.#s.pop();const t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.#s.length>0)return!0;const t=this.fetch().next();return t.done?!1:(this.#s.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}}const O2=new Set(Array.from(["$and","$or","$nor","$expr","$jsonSchema"]));class ao{#t;#n;#e;constructor(t,n){this.#e=Fa(t),this.#n=y2(n),this.#t=[],this.compile()}compile(){pe(Oe(this.#e),`query criteria must be an object: ${JSON.stringify(this.#e)}`);const t={};for(const[n,i]of Object.entries(this.#e)){if(n==="$where")pe(this.#n.scriptEnabled,"$where operator requires 'scriptEnabled' option to be true."),Object.assign(t,{field:n,expr:i});else if(O2.has(n))this.processOperator(n,n,i);else{pe(!Br(n),`unknown top level operator: ${n}`);for(const[r,s]of Object.entries(zm(i)))this.processOperator(n,r,s)}t.field&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,n,i){const r=Ba("query",n,this.#n);pe(!!r,`unknown query operator ${n}`),this.#t.push(r(t,i,this.#n))}test(t){return this.#t.every(n=>n(t))}find(t,n){return new P2(t,i=>this.test(i),n||{},this.#n)}remove(t){return t.reduce((n,i)=>(this.test(i)||n.push(i),n),[])}}const A2=["monday","mon","tuesday","tue","wednesday","wed","thursday","thu","friday","fri","saturday","sat","sunday","sun"];new Set(A2);function tn(e){return(n,i,r)=>{const s={unwrapArray:!0},a=Math.max(1,n.split(".").length-1);return o=>{const c=Mr(o,n,s);return e(c,i,{...r,depth:a})}}}function Km(e,t,n){return $i(e,t)||Je(e)&&Je(t)?!0:Ft(e)?e.some(i=>$i(i,t))||Bm(e,n?.depth).some(i=>$i(i,t)):!1}function $2(e,t,n){return!Km(e,t,n)}function Ym(e,t,n){return Je(e)?t.some(i=>i===null):f2([so(e),t],n?.hashFunction).length>0}function L2(e,t,n){return!Ym(e,t,n)}function N2(e,t,n){return ll(e,t,(i,r)=>Wi(i,r)<0)}function F2(e,t,n){return ll(e,t,(i,r)=>Wi(i,r)<=0)}function B2(e,t,n){return ll(e,t,(i,r)=>Wi(i,r)>0)}function j2(e,t,n){return ll(e,t,(i,r)=>Wi(i,r)>=0)}function z2(e,t,n){return so(e).some(i=>t.length===2&&i%t[0]===t[1])}function W2(e,t,n){const i=so(e),r=s=>yn(s)&&h2(t.exec(s),n?.useStrictMode);return i.some(r)||Bm(i,1).some(r)}function H2(e,t,n){return Array.isArray(e)&&e.length===t}function U2(e){return Br(e)&&["$and","$or","$nor"].indexOf(e)===-1}function V2(e,t,n){if(Ft(e)&&!Zh(e)){let i=a=>a,r=t;Object.keys(t).every(U2)&&(r={temp:t},i=a=>({temp:a}));const s=new ao(r,n);for(let a=0,o=e.length;a<o;a++)if(s.test(i(e[a])))return!0}return!1}const Sf=e=>e===null,q2={array:Ft,boolean:us,bool:us,date:Na,number:Ke,int:Ke,long:Ke,double:Ke,decimal:Ke,null:Sf,object:Oe,regexp:mr,regex:mr,string:yn,undefined:Je,function:e=>{throw new ol("unsupported type key `function`.")},1:Ke,2:yn,3:Oe,4:Ft,6:Je,8:us,9:Na,10:Sf,11:mr,16:Ke,18:Ke,19:Ke};function Cf(e,t,n){const i=q2[t];return i?i(e):!1}function K2(e,t,n){return Ft(t)?t.findIndex(i=>Cf(e,i))>=0:Cf(e,t)}function ll(e,t,n){return so(e).some(i=>La(i)===La(t)&&n(i,t))}const kf=(e,t)=>{const n={};return e.split("").forEach((i,r)=>n[i]=t*(r+1)),n};({...kf("ABCDEFGHIKLM",1),...kf("NOPQRSTUVWXY",-1)});const Ef={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function en(e,t=Ef){const n=Object.assign({},Ef,t),i=new Set(Object.keys(n));return(r,s,a)=>{const o=Zr(r,s,null,a);if(i.has(`${o}`)){const c=n[`${o}`];if(c instanceof Error)throw new ol(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return c}return e(o)}}en(Math.acos,{Infinity:1/0,0:new Error});en(Math.acosh,{Infinity:1/0,0:new Error});en(Math.asin);en(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});en(Math.atan);en(Math.atanh,{1:1/0,"-1":-1/0});en(Math.cos);en(Math.cosh,{"-Infinity":1/0,Infinity:1/0});const Y2=Math.PI/180;en(e=>e*Y2,{Infinity:1/0,"-Infinity":1/0});const X2=180/Math.PI;en(e=>e*X2,{Infinity:1/0,"-Infinity":-1/0});en(Math.sin);en(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});en(Math.tan);const G2=(e,t,n)=>{pe(Ft(t),"Invalid expression: $and expects value to be an Array.");const i=t.map(r=>new ao(r,n));return r=>i.every(s=>s.test(r))},Xm=(e,t,n)=>{pe(Ft(t),"Invalid expression. $or expects value to be an Array");const i=t.map(r=>new ao(r,n));return r=>i.some(s=>s.test(r))},Q2=(e,t,n)=>{pe(Ft(t),"Invalid expression. $nor expects value to be an array.");const i=Xm("$or",t,n);return r=>!i(r)},J2=(e,t,n)=>{const i={};i[e]=zm(t);const r=new ao(i,n);return s=>!r.test(s)},Z2=tn(Km),tS=tn(B2),eS=tn(j2),nS=tn(Ym),iS=tn(N2),rS=tn(F2),sS=tn($2),aS=tn(L2),oS=tn(z2),cS=tn(W2),lS=tn(V2),uS=tn(H2),hS=(e,t,n)=>{const i=e.includes("."),r=!!t;return!i||e.match(/\.\d+$/)?s=>Mr(s,e)!==void 0===r:s=>{const a=fa(s,e,{preserveIndex:!0}),o=Mr(a,e.substring(0,e.lastIndexOf(".")));return Ft(o)?o.some(c=>c!==void 0)===r:o!==void 0===r}},dS=tn(K2);var Mf=!1;function fS(e){return Mf||(wf("pipeline",{$sort:qm,$project:Hm}),wf("query",{$and:G2,$eq:Z2,$elemMatch:lS,$exists:hS,$gt:tS,$gte:eS,$in:nS,$lt:iS,$lte:rS,$ne:sS,$nin:aS,$mod:oS,$nor:Q2,$not:J2,$or:Xm,$regex:cS,$size:uS,$type:dS}),Mf=!0),new ao(e)}function hs(e,t){var n=xn(e.primaryKey);t=qt(t);var i=je(t);if(typeof i.skip!="number"&&(i.skip=0),i.selector?(i.selector=i.selector,Object.entries(i.selector).forEach(([u,d])=>{(typeof d!="object"||d===null)&&(i.selector[u]={$eq:d})})):i.selector={},i.index){var r=$u(i.index);r.includes(n)||r.push(n),i.index=r}if(i.sort){var h=i.sort.find(u=>D1(u)===n);h||(i.sort=i.sort.slice(0),i.sort.push({[n]:"asc"}))}else if(i.index)i.sort=i.index.map(u=>({[u]:"asc"}));else{if(e.indexes){var s=new Set;Object.entries(i.selector).forEach(([u,d])=>{var p=!1;typeof d=="object"&&d!==null?p=!!Object.keys(d).find(g=>Qh.has(g)):p=!0,p&&s.add(u)});var a=-1,o;e.indexes.forEach(u=>{var d=_c(u)?u:[u],p=d.findIndex(g=>!s.has(g));p>0&&p>a&&(a=p,o=d)}),o&&(i.sort=o.map(u=>({[u]:"asc"})))}if(!i.sort)if(e.indexes&&e.indexes.length>0){var c=e.indexes[0],l=_c(c)?c:[c];i.sort=l.map(u=>({[u]:"asc"}))}else i.sort=[{[n]:"asc"}]}return i}function pS(e,t){if(!t.sort)throw et("SNH",{query:t});var n=[];t.sort.forEach(r=>{var s=Object.keys(r)[0],a=Object.values(r)[0];n.push({key:s,direction:a,getValueFn:M1(s)})});var i=(r,s)=>{for(var a=0;a<n.length;++a){var o=n[a],c=o.getValueFn(r),l=o.getValueFn(s);if(c!==l){var h=o.direction==="asc"?Wi(c,l):Wi(l,c);return h}}};return i}function Gm(e,t){if(!t.sort)throw et("SNH",{query:t});var n=fS(t.selector),i=r=>n.test(r);return i}async function js(e,t){var n=await e.exec();if(!n)return null;if(Array.isArray(n))return Promise.all(n.map(r=>t(r)));if(n instanceof Map)return Promise.all([...n.values()].map(r=>t(r)));var i=await t(n);return i}function ul(e,t){if(!t.sort)throw et("SNH",{query:t});var n=i2(e,t);return{query:t,queryPlan:n}}var gS="_rxdb_internal";async function Os(e,t){var n=await e.findDocumentsById([t],!1),i=n[0];if(i)return i}async function ws(e,t,n){var i=await e.bulkWrite([t],n);if(i.error.length>0){var r=i.error[0];throw r}else{var s=xn(e.schema.primaryKey),a=un(s,[t],i),o=a[0];return o}}function mS(e,t){var n=Os(e,t),i=e.changeStream().pipe(Jt(r=>r.events.find(s=>s.documentId===t)),wt(r=>!!r),Jt(r=>Promise.resolve(it(r).documentData)),ro(n),Zx(r=>r),wt(r=>!!r));return i}function za(e){return Object.assign({},...e.filter(t=>!!t))}function Ec(e,t,n,i){if(i)throw i.status===409?et("CONFLICT",{collection:e.name,id:t,writeError:i,data:n}):i.status===422?et("VD2",{collection:e.name,id:t,writeError:i,data:n}):i}function ML(e,t,n,i,r,s,a){for(var o=!!e.schema.attachments,c=[],l=[],h=[],u=Nr(10),d={id:u,events:[],checkpoint:null,context:r},p=d.events,g=[],m=[],b=[],w=n.size>0,C,_=i.length,k=function(){var I=i[x],E=I.document,y=I.previous,M=E[t],D=E._deleted,R=y&&y._deleted,P=void 0;w&&(P=n.get(M));var N;if(P){var Y=P._rev;if(!y||y&&Y!==y._rev){var K={isError:!0,status:409,documentId:M,writeRow:I,documentInDb:P};return h.push(K),1}var Z=o?ql(I):I;o&&(D?y&&Object.keys(y._attachments).forEach(z=>{m.push({documentId:M,attachmentId:z,digest:it(y)._attachments[z].digest})}):(Object.entries(E._attachments).find(([z,J])=>{var lt=y?y._attachments[z]:void 0;return!lt&&!J.data&&(N={documentId:M,documentInDb:P,isError:!0,status:510,writeRow:I,attachmentId:z}),!0}),N||Object.entries(E._attachments).forEach(([z,J])=>{var lt=y?y._attachments[z]:void 0;if(!lt)g.push({documentId:M,attachmentId:z,attachmentData:J,digest:J.digest});else{var St=Z.document._attachments[z].digest;J.data&&lt.digest!==St&&b.push({documentId:M,attachmentId:z,attachmentData:J,digest:J.digest})}}))),N?h.push(N):(o?l.push(ql(Z)):l.push(Z),C=Z);var j=null,nt=null,G=null;if(R&&!D)G="INSERT",j=o?Dn(E):E;else if(y&&!R&&!D)G="UPDATE",j=o?Dn(E):E,nt=y;else if(D)G="DELETE",j=it(E),nt=y;else throw et("SNH",{args:{writeRow:I}});var tt={documentId:M,documentData:j,previousDocumentData:nt,operation:G};p.push(tt)}else{var U=!!D;if(o&&Object.entries(E._attachments).forEach(([z,J])=>{J.data?g.push({documentId:M,attachmentId:z,attachmentData:J,digest:J.digest}):(N={documentId:M,isError:!0,status:510,writeRow:I,attachmentId:z},h.push(N))}),N||(o?c.push(ql(I)):c.push(I),C=I),!U){var H={documentId:M,operation:"INSERT",documentData:o?Dn(E):E,previousDocumentData:o&&y?Dn(y):y};p.push(H)}}},x=0;x<_;x++)k();return{bulkInsertDocs:c,bulkUpdateDocs:l,newestRow:C,errors:h,eventBulk:d,attachmentsAdd:g,attachmentsRemove:m,attachmentsUpdate:b}}function ql(e){return{previous:e.previous,document:Dn(e.document)}}function vS(e){return atob(e).length}function bS(e){var t=e.data;if(!t)return e;var n={length:vS(t),digest:e.digest,type:e.type};return n}function Dn(e){if(!e._attachments||Object.keys(e._attachments).length===0)return e;var t=qt(e);return t._attachments={},Object.entries(e._attachments).forEach(([n,i])=>{t._attachments[n]=bS(i)}),t}function hl(e){return Object.assign({},e,{_meta:qt(e._meta)})}function td(e,t,n){zt.deepFreezeWhenDevMode(n);var i=xn(t.schema.primaryKey),r={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,async bulkWrite(s,a){for(var o=e.token,c=new Array(s.length),l=wn(),h=0;h<s.length;h++){var u=s[h],d=hl(u.document);d._meta.lwt=l;var p=u.previous;d._rev=ei(o,p),c[h]={document:d,previous:p}}ze("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:c});var g=await e.lockedRun(()=>t.bulkWrite(c,a)),m={error:[]};Jm.set(m,c);var b=g.error.length===0?[]:g.error.filter(I=>I.status===409&&!I.writeRow.previous&&!I.writeRow.document._deleted&&it(I.documentInDb)._deleted?!0:(m.error.push(I),!1));if(b.length>0){var w=new Set,C=b.map(I=>(w.add(I.documentId),{previous:I.documentInDb,document:Object.assign({},I.writeRow.document,{_rev:ei(e.token,I.documentInDb)})})),_=await e.lockedRun(()=>t.bulkWrite(C,a));Sr(m.error,_.error);var k=un(i,c,m,w),x=un(i,C,_);return Sr(k,x),m}return m},query(s){return e.lockedRun(()=>t.query(s))},count(s){return e.lockedRun(()=>t.count(s))},findDocumentsById(s,a){return e.lockedRun(()=>t.findDocumentsById(s,a))},getAttachmentData(s,a,o){return e.lockedRun(()=>t.getAttachmentData(s,a,o))},getChangedDocumentsSince:t.getChangedDocumentsSince?(s,a)=>e.lockedRun(()=>t.getChangedDocumentsSince(it(s),a)):void 0,cleanup(s){return e.lockedRun(()=>t.cleanup(s))},remove(){return e.storageInstances.delete(r),e.lockedRun(()=>t.remove())},close(){return e.storageInstances.delete(r),e.lockedRun(()=>t.close())},changeStream(){return t.changeStream()}};return e.storageInstances.add(r),r}function DL(e){if(e.schema.keyCompression)throw et("UT5",{args:{params:e}});if(Mc(e.schema))throw et("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw et("UT7",{args:{params:e}})}function Mc(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}function _S(e,t,n){var i=xn(e.schema.primaryKey),r=n?n.lwt:zh,s=n?n.id:"";return hs(e.schema,{selector:{$or:[{"_meta.lwt":{$gt:r}},{"_meta.lwt":{$eq:r},[i]:{$gt:n?s:""}}],"_meta.lwt":{$gte:r}},sort:[{"_meta.lwt":"asc"},{[i]:"asc"}],skip:0,limit:t})}async function Qm(e,t,n){if(e.getChangedDocumentsSince)return e.getChangedDocumentsSince(t,n);var i=xn(e.schema.primaryKey),r=ul(e.schema,_S(e,t,n)),s=await e.query(r),a=s.documents,o=C1(a);return{documents:a,checkpoint:o?{id:o[i],lwt:o._meta.lwt}:n||{id:"",lwt:0}}}var Jm=new WeakMap,yS=new WeakMap;function un(e,t,n,i){return ln(yS,n,()=>{var r=[],s=Jm.get(n);if(s||(s=t),n.error.length>0||i){for(var a=i||new Set,o=0;o<n.error.length;o++){var c=n.error[o];a.add(c.documentId)}for(var l=0;l<s.length;l++){var h=s[l].document;a.has(h[e])||r.push(Dn(h))}}else{r.length=t.length-n.error.length;for(var u=0;u<s.length;u++){var d=s[u].document;r[u]=Dn(d)}}return r})}var Zm=(function(){function e(n,i,r,s){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=n,this.primaryPath=i,this.preWrite=r,this.postWrite=s}var t=e.prototype;return t.addWrite=function(i,r){var s=i[this.primaryPath],a=ln(this.queueByDocId,s,()=>[]),o=new Promise((c,l)=>{var h={lastKnownDocumentState:i,modifier:r,resolve:c,reject:l};it(a).push(h),this.triggerRun()});return o},t.triggerRun=async function(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var i=[],r=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(r.entries()).map(async([a,o])=>{var c=wS(o.map(u=>u.lastKnownDocumentState)),l=c;for(var h of o)try{l=await h.modifier(je(l))}catch(u){h.reject(u),h.reject=()=>{},h.resolve=()=>{}}try{await this.preWrite(l,c)}catch(u){o.forEach(d=>d.reject(u));return}i.push({previous:c,document:l})}));var s=i.length>0?await this.storageInstance.bulkWrite(i,"incremental-write"):{error:[]};return await Promise.all(un(this.primaryPath,i,s).map(a=>{var o=a[this.primaryPath];this.postWrite(a);var c=zi(r,o);c.forEach(l=>l.resolve(a))})),s.error.forEach(a=>{var o=a.documentId,c=zi(r,o),l=ms(a);if(l){var h=ln(this.queueByDocId,o,()=>[]);c.reverse().forEach(d=>{d.lastKnownDocumentState=it(l.documentInDb),it(h).unshift(d)})}else{var u=rm(a);c.forEach(d=>d.reject(u))}}),this.isRunning=!1,this.triggerRun()}},e})();function Df(e){var t=async n=>{var i=I1(n);i._deleted=n._deleted;var r=await e(i),s=Object.assign({},r,{_meta:n._meta,_attachments:n._attachments,_rev:n._rev,_deleted:typeof r._deleted<"u"?r._deleted:n._deleted});return typeof s._deleted>"u"&&(s._deleted=!1),s};return t}function wS(e){var t=e[0],n=ji(t._rev);return e.forEach(i=>{var r=ji(i._rev);r>n&&(t=i,n=r)}),t}var dl={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(Jt(t=>t._data._deleted))},get deleted$$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this,t=this.primary;return e.collection.eventBulks$.pipe(wt(n=>!n.isLocal),Jt(n=>n.events.find(i=>i.documentId===t)),wt(n=>!!n),Jt(n=>Om(it(n))),ro(e.collection._docCache.getLatestDocumentData(t)),Aa((n,i)=>n._rev===i._rev),Jt(n=>this.collection._docCache.getCachedRxDocument(n)),io(Za))},get $$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(zt.isDevMode()){if(e.includes(".item."))throw et("DOC1",{path:e});if(e===this.primaryPath)throw et("DOC2");if(this.collection.schema.finalFields.includes(e))throw et("DOC3",{path:e});var t=Oa(this.collection.schema.jsonSchema,e);if(!t)throw et("DOC4",{path:e})}return this.$.pipe(Jt(n=>vs(n,e)),Aa())},get$$(e){var t=this.get$(e),n=this.collection.database.getReactivityFactory();return n.fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=Oa(this.collection.schema.jsonSchema,e),n=this.get(e);if(!n)return Vh;if(!t)throw et("DOC5",{path:e});if(!t.ref)throw et("DOC6",{path:e,schemaObj:t});var i=this.collection.database.collections[t.ref];if(!i)throw et("DOC7",{ref:t.ref,path:e,schemaObj:t});return t.type==="array"?i.findByIds(n).exec().then(r=>{var s=r.values();return Array.from(s)}):i.findOne(n).exec()},get(e){return nv(this,e)},toJSON(e=!1){if(e)return zt.deepFreezeWhenDevMode(this._data);var t=qt(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,zt.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return je(this.toJSON(e))},update(e){throw jt("update")},incrementalUpdate(e){throw jt("update")},updateCRDT(e){throw jt("crdt")},putAttachment(){throw jt("attachments")},putAttachmentBase64(){throw jt("attachments")},getAttachment(){throw jt("attachments")},allAttachments(){throw jt("attachments")},get allAttachments$(){throw jt("attachments")},async modify(e,t){var n=this._data,i=await Df(e)(n);return this._saveData(i,n)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,Df(e)).then(n=>this.collection._docCache.getCachedRxDocument(n))},patch(e){var t=this._data,n=je(t);return Object.entries(e).forEach(([i,r])=>{n[i]=r}),this._saveData(n,t)},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([n,i])=>{t[n]=i}),t))},async _saveData(e,t){if(e=qt(e),this._data._deleted)throw et("DOC11",{id:this.primary,document:this});await ev(this.collection,e,t);var n=[{previous:t,document:e}],i=await this.collection.storageInstance.bulkWrite(n,"rx-document-save-data"),r=i.error[0];return Ec(this.collection,this.primary,e,r),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(un(this.collection.schema.primaryPath,n,i)[0])},async remove(){if(this.deleted)return Promise.reject(et("DOC13",{document:this,id:this.primary}));var e=await this.collection.bulkRemove([this]);if(e.error.length>0){var t=e.error[0];Ec(this.collection,this.primary,this._data,t)}return e.success[0]},incrementalRemove(){return this.incrementalModify(async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e)).then(async e=>(await this.collection._runHooks("post","remove",e._data,e),e))},close(){throw et("DOC14")}};function tv(e=dl){var t=function(i,r){this.collection=i,this._data=r,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function xS(e,t,n){var i=new e(t,n);return ze("createRxDocument",i),i}function ev(e,t,n){return t._meta=Object.assign({},n._meta,t._meta),zt.isDevMode()&&e.schema.validateChange(n,t),e._runHooks("pre","save",t,n)}function nv(e,t){return ln(e._propertyCache,t,()=>{var n=vs(e._data,t);if(typeof n!="object"||n===null||Array.isArray(n))return zt.deepFreezeWhenDevMode(n);var i=new Proxy(qt(n),{get(r,s){if(typeof s!="string")return r[s];var a=s.charAt(s.length-1);if(a==="$")if(s.endsWith("$$")){var o=s.slice(0,-2);return e.get$$(Gs(t+"."+o))}else{var c=s.slice(0,-1);return e.get$(Gs(t+"."+c))}else if(a==="_"){var l=s.slice(0,-1);return e.populate(Gs(t+"."+l))}else{var h=r[s];return typeof h=="number"||typeof h=="string"||typeof h=="boolean"?h:nv(e,Gs(t+"."+s))}}});return i})}function ed(e){return e[e.length-1]}function SS(e){const t=typeof e;return e!==null&&(t==="object"||t==="function")}function If(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!SS(e)||typeof t!="string")return e;const i=t.split(".");if(i.length===0)return n;for(let r=0;r<i.length;r++){const s=i[r];if(CS(e,s)?e=r===i.length-1?void 0:null:e=e[s],e==null){if(r!==i.length-1)return n;break}}return e===void 0?n:e}function CS(e,t){if(typeof t!="number"&&Array.isArray(e)){const n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}const iv=e=>!!e.queryParams.limit,kS=e=>e.queryParams.limit===1,ES=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),MS=e=>e.changeEvent.operation==="DELETE",DS=e=>e.changeEvent.operation==="INSERT",IS=e=>e.changeEvent.operation==="UPDATE",RS=e=>iv(e)&&e.previousResults.length>=e.queryParams.limit,TS=e=>{const t=e.queryParams.sortFields,n=e.changeEvent.previous,i=e.changeEvent.doc;if(!i)return!1;if(!n)return!0;for(let r=0;r<t.length;r++){const s=t[r],a=If(n,s),o=If(i,s);if(a!==o)return!0}return!1},PS=e=>{const t=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(t);{const n=e.queryParams.primaryKey,i=e.previousResults;for(let r=0;r<i.length;r++)if(i[r][n]===t)return!0;return!1}},OS=e=>{const t=e.previousResults[0];return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},AS=e=>{const t=ed(e.previousResults);return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},$S=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=e.previousResults[0];return n?n[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,n)<0:!1},LS=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=ed(e.previousResults);return n?n[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,n)>0:!1},NS=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=e.previousResults[0];return n?n[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,n)<0:!1},FS=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=ed(e.previousResults);return n?n[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,n)>0:!1},BS=e=>{const t=e.changeEvent.previous;return t?e.queryParams.queryMatcher(t):!1},jS=e=>{const t=e.changeEvent.doc;return t?e.queryParams.queryMatcher(t):!1},zS=e=>e.previousResults.length===0,WS={0:DS,1:IS,2:MS,3:iv,4:kS,5:ES,6:zS,7:RS,8:OS,9:AS,10:TS,11:PS,12:$S,13:LS,14:NS,15:FS,16:BS,17:jS};function HS(e,t,n,i){var r=e.length,s=r-1,a=0;if(r===0)return e.push(t),0;for(var o;i<=s;)a=i+(s-i>>1),o=e[a],n(o,t)<=0?i=a+1:s=a-1;return n(o,t)<=0&&a++,e.splice(a,0,t),a}const US=e=>{},nd=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},id=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},rd=e=>{const t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},sd=e=>{const t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},VS=e=>{rd(e),id(e)},qS=e=>{sd(e),nd(e)},KS=e=>{rd(e),nd(e)},YS=e=>{sd(e),id(e)},rv=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);const t=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][t]===e.changeEvent.id){n.splice(i,1);break}},XS=e=>{const t=e.changeEvent.doc,n=e.queryParams.primaryKey,i=e.previousResults;for(let r=0;r<i.length;r++)if(i[r][n]===e.changeEvent.id){i[r]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}},GS=e=>{const t={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},sv=e=>{const t=e.changeEvent.id,n=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,n)}else if(e.previousResults.find(r=>r[e.queryParams.primaryKey]===t))return;HS(e.previousResults,n,e.queryParams.sortComparator,0)},QS=e=>{rv(e),sv(e)},JS=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},ZS=e=>{throw new Error("Action unknownAction should never be called")},tC=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],eC={doNothing:US,insertFirst:nd,insertLast:id,removeFirstItem:rd,removeLastItem:sd,removeFirstInsertLast:VS,removeLastInsertFirst:qS,removeFirstInsertFirst:KS,removeLastInsertLast:YS,removeExisting:rv,replaceExisting:XS,alwaysWrong:GS,insertAtSortPosition:sv,removeExistingAndInsertAtSortPosition:QS,runFullQueryAgain:JS,unknownAction:ZS},nC=40;function Kl(e){return e.charCodeAt(0)-nC}function iC(e){return e?"1":"0"}function Rf(e,t){const n=[];for(let i=0,r=e.length;i<r;i+=t)n.push(e.substring(i,i+t));return n}function rC(e){const t=new Map,i=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,r=e.substring(2,i),s=Rf(r,2);for(let m=0;m<s.length;m++){const b=s[m],w=b.charAt(0),C=Kl(b.charAt(1));t.set(w,C)}const a=e.substring(i,e.length-3),o=Rf(a,4);for(let m=0;m<o.length;m++){const b=o[m],w=b.charAt(0),C=b.charAt(1),_=b.charAt(2),k=Kl(b.charAt(3));if(!t.has(C))throw new Error("missing node with id "+C);if(!t.has(_))throw new Error("missing node with id "+_);const x=t.get(C),I=t.get(_),E={l:k,0:x,1:I};t.set(w,E)}const c=e.slice(-3),l=c.charAt(0),h=c.charAt(1),u=Kl(c.charAt(2)),d=t.get(l),p=t.get(h);return{l:u,0:d,1:p}}function sC(e,t,n){let i=e,r=e.l;for(;;){const s=t[r](n),a=iC(s);if(i=i[a],typeof i=="number"||typeof i=="string")return i;r=i.l}}const aC="14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9ae9bf9bq9cg9ck9cn9nd9np9nq9nf9ng9nm9nk9mr9ms9mt9mj9mk9ml9mn9mc8{8}888mn88m8m4z4w4z44444m4v7yn77~777n777m77m7m7m5m5m55m555m55m5m552|2u2222x222|222222n2n222n2/an/bn/cn///////////,cn,,,,,,,ac0bc00000000000m-m-----------3333(((++++11*m*.";let Yl;function oC(){return Yl||(Yl=rC(aC)),Yl}const cC=e=>sC(oC(),WS,e);function lC(e){const t=cC(e);return tC[t]}function uC(e,t,n,i,r){const s=eC[e];return s({queryParams:t,changeEvent:n,previousResults:i,keyDocumentMap:r}),i}function hC(e,t){return!t.sort||t.sort.length===0?[e]:t.sort.map(n=>Object.keys(n)[0])}var dC=new WeakMap;function fC(e){return ln(dC,e,()=>{var t=e.collection,n=hs(t.storageInstance.schema,je(e.mangoQuery)),i=t.schema.primaryPath,r=pS(t.schema.jsonSchema,n),s=(l,h)=>{var u={docA:l,docB:h};return r(u.docA,u.docB)},a=Gm(t.schema.jsonSchema,n),o=l=>{var h={doc:l};return a(h.doc)},c={primaryKey:e.collection.schema.primaryPath,skip:n.skip,limit:n.limit,sortFields:hC(i,n),sortComparator:s,queryMatcher:o};return c})}function pC(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};for(var n=fC(e),i=it(e._result).docsData.slice(0),r=it(e._result).docsDataMap,s=!1,a=[],o=0;o<t.length;o++){var c=t[o],l=t2(c);l&&a.push(l)}var h=a.find(u=>{var d={queryParams:n,changeEvent:u,previousResults:i,keyDocumentMap:r},p=lC(d);if(p==="runFullQueryAgain")return!0;if(p!=="doNothing")return s=!0,uC(p,n,u,i,r),!1});return h?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:s,newResults:i}}var gC=(function(){function e(){this._map=new Map}var t=e.prototype;return t.getByQuery=function(i){var r=i.toString(),s=ln(this._map,r,()=>i);return s},e})();function mC(){return new gC}function Tf(e,t){t.uncached=!0;var n=t.toString();e._map.delete(n)}function vC(e){return e.refCount$.observers.length}var bC=100,_C=30*1e3,yC=(e,t)=>(n,i)=>{if(!(i._map.size<e)){var r=wn()-t,s=[],a=Array.from(i._map.values());for(var o of a)if(!(vC(o)>0)){if(o._lastEnsureEqual===0&&o._creationTime<r){Tf(i,o);continue}s.push(o)}var c=s.length-e;if(!(c<=0)){var l=s.sort((u,d)=>u._lastEnsureEqual-d._lastEnsureEqual),h=l.slice(0,c);h.forEach(u=>Tf(i,u))}}},av=yC(bC,_C),Xl=new WeakSet;function wC(e){Xl.has(e)||(Xl.add(e),B1().then(()=>j1(200)).then(()=>{e.closed||e.cacheReplacementPolicy(e,e._queryCache),Xl.delete(e)}))}var ov=(function(){function e(n,i,r){this.cacheItemByDocId=new Map,this.tasks=new Set,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(s=>{var a=s.docId,o=this.cacheItemByDocId.get(a);o&&(o[0].delete(s.revisionHeight+s.lwt+""),o[0].size===0&&this.cacheItemByDocId.delete(a))}):void 0,this.primaryPath=n,this.changes$=i,this.documentCreator=r,i.subscribe(s=>{this.tasks.add(()=>{for(var a=this.cacheItemByDocId,o=0;o<s.length;o++){var c=s[o],l=a.get(c.documentId);if(l){var h=c.documentData;h||(h=c.previousDocumentData),l[1]=h}}}),this.tasks.size<=1&&rl().then(()=>{this.processTasks()})})}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var i=Array.from(this.tasks);i.forEach(r=>r()),this.tasks.clear()}},t.getLatestDocumentData=function(i){this.processTasks();var r=zi(this.cacheItemByDocId,i);return r[1]},t.getLatestDocumentDataIfExists=function(i){this.processTasks();var r=this.cacheItemByDocId.get(i);if(r)return r[1]},Vi(e,[{key:"getCachedRxDocuments",get:function(){var n=Pf(this);return Qn(this,"getCachedRxDocuments",n)}},{key:"getCachedRxDocument",get:function(){var n=Pf(this);return Qn(this,"getCachedRxDocument",i=>n([i])[0])}}])})();function Pf(e){var t=e.primaryPath,n=e.cacheItemByDocId,i=e.registry,r=zt.deepFreezeWhenDevMode,s=e.documentCreator,a=o=>{for(var c=new Array(o.length),l=[],h=0;h<o.length;h++){var u=o[h],d=u[t],p=ji(u._rev),g=void 0,m=void 0,b=n.get(d);b?(g=b[0],m=g.get(p+u._meta.lwt+"")):(g=new Map,b=[g,u],n.set(d,b));var w=m?m.deref():void 0;w||(u=r(u),w=s(u),g.set(p+u._meta.lwt+"",SC(w)),i&&l.push(w)),c[h]=w}return l.length>0&&i&&(e.tasks.add(()=>{for(var C=0;C<l.length;C++){var _=l[C];i.register(_,{docId:_.primary,revisionHeight:ji(_.revision),lwt:_._data._meta.lwt})}}),e.tasks.size<=1&&rl().then(()=>{e.processTasks()})),c};return a}function Ku(e,t){var n=e.getCachedRxDocuments;return n(t)}var xC=typeof WeakRef=="function",SC=xC?CC:kC;function CC(e){return new WeakRef(e)}function kC(e){return{deref(){return e}}}var Of=(function(){function e(n,i,r){this.time=wn(),this.query=n,this.count=r,this.documents=Ku(this.query.collection._docCache,i)}var t=e.prototype;return t.getValue=function(i){var r=this.query.op;if(r==="count")return this.count;if(r==="findOne"){var s=this.documents.length===0?null:this.documents[0];if(!s&&i)throw et("QU10",{collection:this.query.collection.name,query:this.query.mangoQuery,op:r});return s}else return r==="findByIds"?this.docsMap:this.documents.slice(0)},Vi(e,[{key:"docsData",get:function(){return Qn(this,"docsData",this.documents.map(n=>n._data))}},{key:"docsDataMap",get:function(){var n=new Map;return this.documents.forEach(i=>{n.set(i.primary,i._data)}),Qn(this,"docsDataMap",n)}},{key:"docsMap",get:function(){for(var n=new Map,i=this.documents,r=0;r<i.length;r++){var s=i[r];n.set(s.primary,s)}return Qn(this,"docsMap",n)}}])})(),EC=0,MC=function(){return++EC},cv=(function(){function e(n,i,r,s={}){this.id=MC(),this._execOverDatabaseCount=0,this._creationTime=wn(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new mn(null),this._result=null,this._latestChangeEvent=-1,this._ensureEqualQueue=Pn,this.op=n,this.mangoQuery=i,this.collection=r,this.other=s,i||(this.mangoQuery=Ko()),this.isFindOneByIdQuery=PC(this.collection.schema.primaryPath,i)}var t=e.prototype;return t._setResultData=function(i){if(typeof i>"u")throw et("QU18",{database:this.collection.database.name,collection:this.collection.name});if(typeof i=="number"){this._result=new Of(this,[],i);return}else i instanceof Map&&(i=Array.from(i.values()));var r=new Of(this,i,i.length);this._result=r},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this.op==="count"){var i=this.getPreparedQuery(),r=await this.collection.storageInstance.count(i);if(r.mode==="slow"&&!this.collection.database.allowSlowCount)throw et("QU14",{collection:this.collection,queryObj:this.mangoQuery});return{result:r.count,counter:this.collection._changeEventBuffer.getCounter()}}if(this.op==="findByIds"){var s=it(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,a=new Map,o=[];if(s.forEach(h=>{var u=this.collection._docCache.getLatestDocumentDataIfExists(h);if(u){if(!u._deleted){var d=this.collection._docCache.getCachedRxDocument(u);a.set(h,d)}}else o.push(h)}),o.length>0){var c=await this.collection.storageInstance.findDocumentsById(o,!1);c.forEach(h=>{var u=this.collection._docCache.getCachedRxDocument(h);a.set(u.primary,u)})}return{result:a,counter:this.collection._changeEventBuffer.getCounter()}}var l=await TC(this);return{result:l.docs,counter:l.counter}},t.exec=async function(i){if(i&&this.op!=="findOne")throw et("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});await Af(this);var r=it(this._result);return r.getValue(i)},t.toString=function(){var i=yc({op:this.op,query:hs(this.collection.schema.jsonSchema,this.mangoQuery),other:this.other},!0),r=JSON.stringify(i);return this.toString=()=>r,r},t.getPreparedQuery=function(){var i={rxQuery:this,mangoQuery:hs(this.collection.schema.jsonSchema,this.mangoQuery)};i.mangoQuery.selector._deleted={$eq:!1},i.mangoQuery.index&&i.mangoQuery.index.unshift("_deleted"),ze("prePrepareQuery",i);var r=ul(this.collection.schema.jsonSchema,i.mangoQuery);return this.getPreparedQuery=()=>r,r},t.doesDocumentDataMatch=function(i){return i._deleted?!1:this.queryMatcher(i)},t.remove=async function(){var i=await this.exec();if(Array.isArray(i)){var r=await this.collection.bulkRemove(i);if(r.error.length>0)throw rm(r.error[0]);return r.success}else return i.remove()},t.incrementalRemove=function(){return js(this.asRxQuery,i=>i.incrementalRemove())},t.update=function(i){throw jt("update")},t.patch=function(i){return js(this.asRxQuery,r=>r.patch(i))},t.incrementalPatch=function(i){return js(this.asRxQuery,r=>r.incrementalPatch(i))},t.modify=function(i){return js(this.asRxQuery,r=>r.modify(i))},t.incrementalModify=function(i){return js(this.asRxQuery,r=>r.incrementalModify(i))},t.where=function(i){throw jt("query-builder")},t.sort=function(i){throw jt("query-builder")},t.skip=function(i){throw jt("query-builder")},t.limit=function(i){throw jt("query-builder")},Vi(e,[{key:"$",get:function(){if(!this._$){var n=this.collection.eventBulks$.pipe(wt(i=>!i.isLocal),ro(null),On(()=>Af(this)),Jt(()=>this._result),io(Za),Aa((i,r)=>!!(i&&i.time===it(r).time)),wt(i=>!!i),Jt(i=>it(i).getValue()));this._$=n2(n,this.refCount$.pipe(wt(()=>!1)))}return this._$}},{key:"$$",get:function(){var n=this.collection.database.getReactivityFactory();return n.fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var n=this.collection.schema.jsonSchema,i=hs(this.collection.schema.jsonSchema,this.mangoQuery);return Qn(this,"queryMatcher",Gm(n,i))}},{key:"asRxQuery",get:function(){return this}}])})();function Ko(){return{selector:{}}}function DC(e){return e.collection._queryCache.getByQuery(e)}function zs(e,t,n,i){ze("preCreateRxQuery",{op:e,queryObj:t,collection:n,other:i});var r=new cv(e,t,n,i);return r=DC(r),wC(n),r}function IC(e){var t=e.asRxQuery.collection._changeEventBuffer.getCounter();return e._latestChangeEvent>=t}async function Af(e){return e.collection.awaitBeforeReads.size>0&&await Promise.all(Array.from(e.collection.awaitBeforeReads).map(t=>t())),e._ensureEqualQueue=e._ensureEqualQueue.then(()=>RC(e)),e._ensureEqualQueue}function RC(e){if(e._lastEnsureEqual=wn(),e.collection.database.closed||IC(e))return Pn;var t=!1,n=!1;if(e._latestChangeEvent===-1&&(n=!0),!n){var i=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(i===null)n=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.getCounter();var r=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(i);if(e.op==="count"){var s=it(e._result).count,a=s;r.forEach(c=>{var l=c.previousDocumentData&&e.doesDocumentDataMatch(c.previousDocumentData),h=e.doesDocumentDataMatch(c.documentData);!l&&h&&a++,l&&!h&&a--}),a!==s&&(t=!0,e._setResultData(a))}else{var o=pC(e,r);o.runFullQueryAgain?n=!0:o.changed&&(t=!0,e._setResultData(o.newResults))}}}return n?e._execOverDatabase().then(c=>{var l=c.result;return e._latestChangeEvent=c.counter,typeof l=="number"?((!e._result||l!==e._result.count)&&(t=!0,e._setResultData(l)),t):((!e._result||!R1(e.collection.schema.primaryPath,l,e._result.docsData))&&(t=!0,e._setResultData(l)),t)}):Promise.resolve(t)}async function TC(e){var t=[],n=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var i=e.isFindOneByIdQuery;if(i=i.filter(h=>{var u=e.collection._docCache.getLatestDocumentDataIfExists(h);return u?(u._deleted||t.push(u),!1):!0}),i.length>0){var r=await n.storageInstance.findDocumentsById(i,!1);Sr(t,r)}}else{var s=e.isFindOneByIdQuery,a=e.collection._docCache.getLatestDocumentDataIfExists(s);if(!a){var o=await n.storageInstance.findDocumentsById([s],!1);o[0]&&(a=o[0])}a&&!a._deleted&&t.push(a)}else{var c=e.getPreparedQuery(),l=await n.storageInstance.query(c);t=l.documents}return{docs:t,counter:n._changeEventBuffer.getCounter()}}function PC(e,t){if(!t.skip&&t.selector&&Object.keys(t.selector).length===1&&t.selector[e]){var n=t.selector[e];if(typeof n=="string")return n;if(Object.keys(n).length===1&&typeof n.$eq=="string"||Object.keys(n).length===1&&Array.isArray(n.$eq)&&!n.$eq.find(i=>typeof i!="string"))return n.$eq}return!1}var Li="collection",ad="storage-token",Yo="rx-migration-status",OC="rx-pipeline-checkpoint",AC="RxInternalDocument",od=sl({version:0,title:AC,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Li,ad,Yo,OC,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function Ir(e,t){return qi(od,{key:e,context:t})}async function lv(e){var t=ul(e.schema,{selector:{context:Li,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0}),n=await e.query(t),i=n.documents;return i}var uv="storageToken",$C=Ir(uv,ad);async function LC(e){var t=Nr(10),n=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,i={id:$C,context:ad,key:uv,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:n},_deleted:!1,_meta:Ps(),_rev:_n(),_attachments:{}},r=[{document:i}],s=await e.internalStore.bulkWrite(r,"internal-add-storage-token");if(!s.error[0])return un("id",r,s)[0];var a=it(s.error[0]);if(a.isError&&ms(a)){var o=a;if(!NC(o.documentInDb.data.rxdbVersion,e.rxdbVersion))throw et("DM5",{args:{database:e.name,databaseStateVersion:o.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(n&&n!==o.documentInDb.data.passwordHash)throw et("DB1",{passwordHash:n,existingPasswordHash:o.documentInDb.data.passwordHash});var c=o.documentInDb;return it(c)}throw a}function NC(e,t){if(!e)return!1;var n=e.split(".")[0],i=t.split(".")[0];return n==="15"&&i==="16"?!0:n===i}async function hv(e,t,n){if(e.schema.version!==n.version)throw et("SNH",{schema:n,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var i=Dc(e.name,e.schema.jsonSchema),r=Ir(i,Li);;){var s=await Os(e.database.internalStore,r),a=je(it(s)),o=a.data.connectedStorages.find(c=>c.collectionName===t&&c.schema.version===n.version);if(o)return;a.data.connectedStorages.push({collectionName:t,schema:n});try{await ws(e.database.internalStore,{previous:it(s),document:a},"add-connected-storage-to-collection")}catch(c){if(!ms(c))throw c}}}async function FC(e,t,n){if(e.schema.version!==n.version)throw et("SNH",{schema:n,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var i=Dc(e.name,e.schema.jsonSchema),r=Ir(i,Li);;){var s=await Os(e.database.internalStore,r),a=je(it(s)),o=a.data.connectedStorages.find(c=>c.collectionName===t&&c.schema.version===n.version);if(!o)return;a.data.connectedStorages=a.data.connectedStorages.filter(c=>c.collectionName!==t);try{await ws(e.database.internalStore,{previous:it(s),document:a},"remove-connected-storage-from-collection")}catch(c){if(!ms(c))throw c}}}function Dc(e,t){return e+"-"+t.version}function xo(e,t){return t=qt(t),t=tx(e,t),typeof e.jsonSchema.primaryKey!="string"&&(t=Y1(e.primaryPath,e.jsonSchema,t)),t._meta=Ps(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=_n()),t}async function BC(e,t){t.multiInstance=e.multiInstance;var n=await e.storage.createStorageInstance(t);return n}async function dv(e,t,n,i,r,s,a,o){var c=await lv(t),l=c.filter(p=>p.data.name===r),h=[];l.forEach(p=>{h.push({collectionName:p.data.name,schema:p.data.schema,isCollection:!0}),p.data.connectedStorages.forEach(g=>h.push({collectionName:g.collectionName,isCollection:!1,schema:g.schema}))});var u=new Set;if(h=h.filter(p=>{var g=p.collectionName+"||"+p.schema.version;return u.has(g)?!1:(u.add(g),!0)}),await Promise.all(h.map(async p=>{var g=await e.createStorageInstance({collectionName:p.collectionName,databaseInstanceToken:n,databaseName:i,multiInstance:s,options:{},schema:p.schema,password:a,devMode:zt.isDevMode()});await g.remove(),p.isCollection&&await Cr("postRemoveRxCollection",{storage:e,databaseName:i,collectionName:r})})),o){var d=l.map(p=>{var g=hl(p);return g._deleted=!0,g._meta.lwt=wn(),g._rev=ei(n,p),{previous:p,document:g}});await t.bulkWrite(d,"rx-database-remove-collection-all")}}function rn(e){if(e.closed)throw et("COL21",{collection:e.name,version:e.schema.version})}var jC=(function(){function e(n){this.subs=[],this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.limit=100,this.tasks=new Set,this.collection=n,this.subs.push(this.collection.eventBulks$.pipe(wt(i=>!i.isLocal)).subscribe(i=>{this.tasks.add(()=>this._handleChangeEvents(i.events)),this.tasks.size<=1&&rl().then(()=>{this.processTasks()})}))}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var i=Array.from(this.tasks);i.forEach(r=>r()),this.tasks.clear()}},t._handleChangeEvents=function(i){var r=this.counter;this.counter=this.counter+i.length,i.length>this.limit?this.buffer=i.slice(i.length*-1):(Sr(this.buffer,i),this.buffer=this.buffer.slice(this.limit*-1));for(var s=r+1,a=this.eventCounterMap,o=0;o<i.length;o++){var c=i[o];a.set(c,s+o)}},t.getCounter=function(){return this.processTasks(),this.counter},t.getBuffer=function(){return this.processTasks(),this.buffer},t.getArrayIndexByPointer=function(i){this.processTasks();var r=this.buffer[0],s=this.eventCounterMap.get(r);if(i<s)return null;var a=i-s;return a},t.getFrom=function(i){this.processTasks();var r=[],s=this.getArrayIndexByPointer(i);if(s===null)return null;for(;;){var a=this.buffer[s];if(s++,a)r.push(a);else return r}},t.runFrom=function(i,r){this.processTasks();var s=this.getFrom(i);if(s===null)throw new Error("out of bounds");s.forEach(a=>r(a))},t.reduceByLastOfDoc=function(i){return this.processTasks(),i.slice(0)},t.close=function(){this.tasks.clear(),this.subs.forEach(i=>i.unsubscribe())},e})();function zC(e){return new jC(e)}var WC=new WeakMap;function HC(e){var t=e.schema.getDocumentPrototype(),n=qC(e),i=dl,r={};return[t,n,i].forEach(s=>{var a=Object.getOwnPropertyNames(s);a.forEach(o=>{var c=Object.getOwnPropertyDescriptor(s,o),l=!0;(o.startsWith("_")||o.endsWith("_")||o.startsWith("$")||o.endsWith("$"))&&(l=!1),typeof c.value=="function"?Object.defineProperty(r,o,{get(){return c.value.bind(this)},enumerable:l,configurable:!1}):(c.enumerable=l,c.configurable=!1,c.writable&&(c.writable=!1),Object.defineProperty(r,o,c))})}),r}function UC(e){return ln(WC,e,()=>tv(HC(e)))}function VC(e,t,n){var i=xS(t,e,zt.deepFreezeWhenDevMode(n));return e._runHooksSync("post","create",n,i),ze("postCreateRxDocument",i),i}function qC(e){var t={};return Object.entries(e.methods).forEach(([n,i])=>{t[n]=i}),t}var Ic={isEqual(e,t,n){e=$f(e),t=$f(t);var i=Ta(Dn(e),Dn(t));return i},resolve(e){return e.realMasterState}};function $f(e){return e._attachments||(e=qt(e),e._attachments={}),e}var fv=["pre","post"],pv=["insert","save","remove","create"],Lf=!1,ts=new Set,gv=(function(){function e(n,i,r,s,a={},o={},c={},l={},h={},u=av,d={},p=Ic){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this.awaitBeforeReads=new Set,this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=mC(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.eventBulks$={},this.onClose=[],this.closed=!1,this.onRemove=[],this.database=n,this.name=i,this.schema=r,this.internalStorageInstance=s,this.instanceCreationOptions=a,this.migrationStrategies=o,this.methods=c,this.attachments=l,this.options=h,this.cacheReplacementPolicy=u,this.statics=d,this.conflictHandler=p,KC(this.asRxCollection),n&&(this.eventBulks$=n.eventBulks$.pipe(wt(g=>g.collectionName===this.name))),this.database&&ts.add(this)}var t=e.prototype;return t.prepare=async function(){if(!await K1()){for(var i=0;i<10&&ts.size>uf;)i++,await this.promiseWait(30);if(ts.size>uf)throw et("COL23",{database:this.database.name,collection:this.name,args:{existing:Array.from(ts.values()).map(c=>({db:c.database?c.database.name:"",c:c.name}))}})}this.storageInstance=td(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new Zm(this.storageInstance,this.schema.primaryPath,(c,l)=>ev(this,c,l),c=>this._runHooks("post","save",c)),this.$=this.eventBulks$.pipe(On(c=>Am(c))),this.checkpoint$=this.eventBulks$.pipe(Jt(c=>c.checkpoint)),this._changeEventBuffer=zC(this.asRxCollection);var r;this._docCache=new ov(this.schema.primaryPath,this.eventBulks$.pipe(wt(c=>!c.isLocal),Jt(c=>c.events)),c=>(r||(r=UC(this.asRxCollection)),VC(this.asRxCollection,r,c)));var s=this.database.internalStore.changeStream().pipe(wt(c=>{var l=this.name+"-"+this.schema.version,h=c.events.find(u=>u.documentData.context==="collection"&&u.documentData.key===l&&u.operation==="DELETE");return!!h})).subscribe(async()=>{await this.close(),await Promise.all(this.onRemove.map(c=>c()))});this._subs.push(s);var a=await this.database.storageToken,o=this.storageInstance.changeStream().subscribe(c=>{var l={id:c.id,isLocal:!1,internal:!1,collectionName:this.name,storageToken:a,events:c.events,databaseToken:this.database.token,checkpoint:c.checkpoint,context:c.context};this.database.$emit(l)});return this._subs.push(o),Ge},t.cleanup=function(i){throw rn(this),jt("cleanup")},t.migrationNeeded=function(){throw jt("migration-schema")},t.getMigrationState=function(){throw jt("migration-schema")},t.startMigration=function(i=10){return rn(this),this.getMigrationState().startMigration(i)},t.migratePromise=function(i=10){return this.getMigrationState().migratePromise(i)},t.insert=async function(i){rn(this);var r=await this.bulkInsert([i]),s=r.error[0];Ec(this,i[this.schema.primaryPath],i,s);var a=it(r.success[0]);return a},t.insertIfNotExists=async function(i){var r=await this.bulkInsert([i]);if(r.error.length>0){var s=r.error[0];if(s.status===409){var a=s.documentInDb;return Ku(this._docCache,[a])[0]}else throw s}return r.success[0]},t.bulkInsert=async function(i){if(rn(this),i.length===0)return{success:[],error:[]};var r=this.schema.primaryPath,s=new Set,a;if(this.hasHooks("pre","insert"))a=await Promise.all(i.map(b=>{var w=xo(this.schema,b);return this._runHooks("pre","insert",w).then(()=>(s.add(w[r]),{document:w}))}));else{a=new Array(i.length);for(var o=this.schema,c=0;c<i.length;c++){var l=i[c],h=xo(o,l);s.add(h[r]),a[c]={document:h}}}if(s.size!==i.length)throw et("COL22",{collection:this.name,args:{documents:i}});var u=await this.storageInstance.bulkWrite(a,"rx-collection-bulk-insert"),d,p=this,g={get success(){if(!d){var b=un(p.schema.primaryPath,a,u);d=Ku(p._docCache,b)}return d},error:u.error};if(this.hasHooks("post","insert")){var m=new Map;a.forEach(b=>{var w=b.document;m.set(w[r],w)}),await Promise.all(g.success.map(b=>this._runHooks("post","insert",m.get(b.primary),b)))}return g},t.bulkRemove=async function(i){rn(this);var r=this.schema.primaryPath;if(i.length===0)return{success:[],error:[]};var s;typeof i[0]=="string"?s=await this.findByIds(i).exec():(s=new Map,i.forEach(p=>s.set(p.primary,p)));var a=[],o=new Map;Array.from(s.values()).forEach(p=>{var g=p.toMutableJSON(!0);a.push(g),o.set(p.primary,g)}),await Promise.all(a.map(p=>{var g=p[this.schema.primaryPath];return this._runHooks("pre","remove",p,s.get(g))}));var c=a.map(p=>{var g=qt(p);return g._deleted=!0,{previous:p,document:g}}),l=await this.storageInstance.bulkWrite(c,"rx-collection-bulk-remove"),h=un(this.schema.primaryPath,c,l),u=[],d=h.map(p=>{var g=p[r],m=this._docCache.getCachedRxDocument(p);return u.push(m),g});return await Promise.all(d.map(p=>this._runHooks("post","remove",o.get(p),s.get(p)))),{success:u,error:l.error}},t.bulkUpsert=async function(i){rn(this);var r=[],s=new Map;i.forEach(l=>{var h=xo(this.schema,l),u=h[this.schema.primaryPath];if(!u)throw et("COL3",{primaryPath:this.schema.primaryPath,data:h,schema:this.schema.jsonSchema});s.set(u,h),r.push(h)});var a=await this.bulkInsert(r),o=a.success.slice(0),c=[];return await Promise.all(a.error.map(async l=>{if(l.status!==409)c.push(l);else{var h=l.documentId,u=zi(s,h),d=it(l.documentInDb),p=this._docCache.getCachedRxDocuments([d])[0],g=await p.incrementalModify(()=>u);o.push(g)}})),{error:c,success:o}},t.upsert=async function(i){rn(this);var r=await this.bulkUpsert([i]);return Ec(this.asRxCollection,i[this.schema.primaryPath],i,r.error[0]),r.success[0]},t.incrementalUpsert=function(i){rn(this);var r=xo(this.schema,i),s=r[this.schema.primaryPath];if(!s)throw et("COL4",{data:i});var a=this._incrementalUpsertQueues.get(s);return a||(a=Ge),a=a.then(()=>XC(this,s,r)).then(o=>o.inserted?o.doc:YC(o.doc,r)),this._incrementalUpsertQueues.set(s,a),a},t.find=function(i){rn(this),ze("prePrepareRxQuery",{op:"find",queryObj:i,collection:this}),i||(i=Ko());var r=zs("find",i,this);return r},t.findOne=function(i){rn(this),ze("prePrepareRxQuery",{op:"findOne",queryObj:i,collection:this});var r;if(typeof i=="string")r=zs("findOne",{selector:{[this.schema.primaryPath]:i},limit:1},this);else{if(i||(i=Ko()),i.limit)throw et("QU6");i=qt(i),i.limit=1,r=zs("findOne",i,this)}return r},t.count=function(i){rn(this),i||(i=Ko());var r=zs("count",i,this);return r},t.findByIds=function(i){rn(this);var r={selector:{[this.schema.primaryPath]:{$in:i.slice(0)}}},s=zs("findByIds",r,this);return s},t.exportJSON=function(){throw jt("json-dump")},t.importJSON=function(i){throw jt("json-dump")},t.insertCRDT=function(i){throw jt("crdt")},t.addPipeline=function(i){throw jt("pipeline")},t.addHook=function(i,r,s,a=!1){if(typeof s!="function")throw xc("COL7",{key:r,when:i});if(!fv.includes(i))throw xc("COL8",{key:r,when:i});if(!pv.includes(r))throw et("COL9",{key:r});if(i==="post"&&r==="create"&&a===!0)throw et("COL10",{when:i,key:r,parallel:a});var o=s.bind(this),c=a?"parallel":"series";this.hooks[r]=this.hooks[r]||{},this.hooks[r][i]=this.hooks[r][i]||{series:[],parallel:[]},this.hooks[r][i][c].push(o)},t.getHooks=function(i,r){return!this.hooks[r]||!this.hooks[r][i]?{series:[],parallel:[]}:this.hooks[r][i]},t.hasHooks=function(i,r){if(!this.hooks[r]||!this.hooks[r][i])return!1;var s=this.getHooks(i,r);return s?s.series.length>0||s.parallel.length>0:!1},t._runHooks=function(i,r,s,a){var o=this.getHooks(i,r);if(!o)return Ge;var c=o.series.map(l=>()=>l(s,a));return z1(c).then(()=>Promise.all(o.parallel.map(l=>l(s,a))))},t._runHooksSync=function(i,r,s,a){if(this.hasHooks(i,r)){var o=this.getHooks(i,r);o&&o.series.forEach(c=>c(s,a))}},t.promiseWait=function(i){var r=new Promise(s=>{var a=setTimeout(()=>{this.timeouts.delete(a),s()},i);this.timeouts.add(a)});return r},t.close=async function(){return this.closed?Pn:(ts.delete(this),await Promise.all(this.onClose.map(i=>i())),this.closed=!0,Array.from(this.timeouts).forEach(i=>clearTimeout(i)),this._changeEventBuffer&&this._changeEventBuffer.close(),this.database.requestIdlePromise().then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(i=>i.unsubscribe()),delete this.database.collections[this.name],Cr("postCloseRxCollection",this).then(()=>!0))))},t.remove=async function(){await this.close(),await Promise.all(this.onRemove.map(i=>i())),await dv(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.multiInstance,this.database.password,this.database.hashFunction)},Vi(e,[{key:"insert$",get:function(){return this.$.pipe(wt(n=>n.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(wt(n=>n.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(wt(n=>n.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}])})();function KC(e){if(!Lf){Lf=!0;var t=Object.getPrototypeOf(e);pv.forEach(n=>{fv.map(i=>{var r=i+cm(n);t[r]=function(s,a){return this.addHook(i,n,s,a)}})})}}function YC(e,t){return e.incrementalModify(n=>t)}function XC(e,t,n){var i=e._docCache.getLatestDocumentDataIfExists(t);return i?Promise.resolve({doc:e._docCache.getCachedRxDocuments([i])[0],inserted:!1}):e.findOne(t).exec().then(r=>r?{doc:r,inserted:!1}:e.insert(n).then(s=>({doc:s,inserted:!0})))}async function GC({database:e,name:t,schema:n,instanceCreationOptions:i={},migrationStrategies:r={},autoMigrate:s=!0,statics:a={},methods:o={},attachments:c={},options:l={},localDocuments:h=!1,cacheReplacementPolicy:u=av,conflictHandler:d=Ic}){var p={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:n.jsonSchema,options:i,multiInstance:e.multiInstance,password:e.password,devMode:zt.isDevMode()};ze("preCreateRxStorageInstance",p);var g=await BC(e,p),m=new gv(e,t,n,g,i,r,o,c,l,u,a,d);try{await m.prepare(),Object.entries(a).forEach(([b,w])=>{Object.defineProperty(m,b,{get:()=>w.bind(m)})}),ze("createRxCollection",{collection:m,creator:{name:t,schema:n,storageInstance:g,instanceCreationOptions:i,migrationStrategies:r,methods:o,attachments:c,options:l,cacheReplacementPolicy:u,localDocuments:h,statics:a}}),s&&m.schema.version!==0&&await m.migratePromise()}catch(b){throw ts.delete(m),await g.close(),b}return m}var mv=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};mv.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,Yu(this)},wrapCall:function(t){var n=this;this._qC++;var i;try{i=t()}catch(r){throw this.unlock(),r}return!i.then||typeof i.then!="function"?(this.unlock(),i):i.then(function(r){return n.unlock(),r}).catch(function(r){throw n.unlock(),r})},requestIdlePromise:function(t){var n=this;t=t||{};var i,r=new Promise(function(o){return i=o}),s=function(){Gl(n,r),i()};if(r._manRes=s,t.timeout){var a=setTimeout(function(){r._manRes()},t.timeout);r._timeoutObj=a}return this._iC.add(r),Yu(this),r},cancelIdlePromise:function(t){Gl(this,t)},requestIdleCallback:function(t,n){var i=this._lHN++,r=this.requestIdlePromise(n);return this._hPM.set(i,r),this._pHM.set(r,i),r.then(function(){return t()}),i},cancelIdleCallback:function(t){var n=this._hPM.get(t);this.cancelIdlePromise(n)},clear:function(){var t=this;this._iC.forEach(function(n){return Gl(t,n)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function QC(e){if(e._iC.size!==0){var t=e._iC.values(),n=t.next().value;n._manRes(),setTimeout(function(){return Yu(e)},0)}}function Gl(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var n=e._pHM.get(t);e._hPM.delete(n),e._pHM.delete(t)}e._iC.delete(t)}}function Yu(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}QC(e),e._tryIR=!1},0)},0))}let JC=class{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){return this.map.has(t)}add(t){this.map.set(t,vv()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,ZC(this)},0))}clear(){this.map.clear()}};function ZC(e){const t=vv()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const i=n.next().value;if(!i)return;const r=i[0];if(i[1]<t)e.map.delete(r);else return}}function vv(){return Date.now()}var Xu=new Set,Nf=new Map,cd=(function(){function e(n,i,r,s,a,o,c=!1,l={},h,u,d,p,g,m){this.idleQueue=new mv,this.rxdbVersion=V1,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onClose=[],this.closed=!1,this.collections={},this.states={},this.eventBulks$=new ie,this.closePromise=null,this.observable$=this.eventBulks$.pipe(On(b=>Am(b))),this.storageToken=Pn,this.storageTokenDocument=Pn,this.emittedEventBulkIds=new JC(60*1e3),this.name=n,this.token=i,this.storage=r,this.instanceCreationOptions=s,this.password=a,this.multiInstance=o,this.eventReduce=c,this.options=l,this.internalStore=h,this.hashFunction=u,this.cleanupPolicy=d,this.allowSlowCount=p,this.reactivity=g,this.onClosed=m,this.name!=="pseudoInstance"&&(this.internalStore=td(this.asRxDatabase,h,od),this.storageTokenDocument=LC(this.asRxDatabase).catch(b=>this.startupErrors.push(b)),this.storageToken=this.storageTokenDocument.then(b=>b.data.token).catch(b=>this.startupErrors.push(b)))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw et("DB14",{database:this.name});return this.reactivity},t.$emit=function(i){this.emittedEventBulkIds.has(i.id)||(this.emittedEventBulkIds.add(i.id),this.eventBulks$.next(i))},t.removeCollectionDoc=async function(i,r){var s=await Os(this.internalStore,Ir(Dc(i,r),Li));if(!s)throw et("SNH",{name:i,schema:r});var a=hl(s);a._deleted=!0,await this.internalStore.bulkWrite([{document:a,previous:s}],"rx-database-remove-collection")},t.addCollections=async function(i){var r={},s={},a=[],o={};await Promise.all(Object.entries(i).map(async([h,u])=>{var d=h,p=u.schema;r[d]=p;var g=ix(p,this.hashFunction);if(s[d]=g,this.collections[h])throw et("DB3",{name:h});var m=Dc(h,p),b={id:Ir(m,Li),key:m,context:Li,data:{name:d,schemaHash:await g.hash,schema:g.jsonSchema,version:g.version,connectedStorages:[]},_deleted:!1,_meta:Ps(),_rev:_n(),_attachments:{}};a.push({document:b});var w=Object.assign({},u,{name:d,schema:g,database:this}),C=qt(u);C.database=this,C.name=h,ze("preCreateRxCollection",C),w.conflictHandler=C.conflictHandler,o[d]=w}));var c=await this.internalStore.bulkWrite(a,"rx-database-add-collection");await rk(this),await Promise.all(c.error.map(async h=>{if(h.status!==409)throw et("DB12",{database:this.name,writeError:h});var u=it(h.documentInDb),d=u.data.name,p=s[d];if(u.data.schemaHash!==await p.hash)throw et("DB6",{database:this.name,collection:d,previousSchemaHash:u.data.schemaHash,schemaHash:await p.hash,previousSchema:u.data.schema,schema:it(r[d])})}));var l={};return await Promise.all(Object.keys(i).map(async h=>{var u=o[h],d=await GC(u);l[h]=d,this.collections[h]=d,this[h]||Object.defineProperty(this,h,{get:()=>this.collections[h]})})),l},t.lockedRun=function(i){return this.idleQueue.wrapCall(i)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(i){throw jt("json-dump")},t.addState=function(i){throw jt("state")},t.importJSON=function(i){throw jt("json-dump")},t.backup=function(i){throw jt("backup")},t.leaderElector=function(){throw jt("leader-election")},t.isLeader=function(){throw jt("leader-election")},t.waitForLeadership=function(){throw jt("leader-election")},t.migrationStates=function(){throw jt("migration-schema")},t.close=function(){if(this.closePromise)return this.closePromise;var{promise:i,resolve:r}=bv(),s=a=>{this.onClosed&&this.onClosed(),this.closed=!0,r(a)};return this.closePromise=i,(async()=>{if(await Cr("preCloseRxDatabase",this),this.eventBulks$.complete(),this._subs.map(a=>a.unsubscribe()),this.name==="pseudoInstance"){s(!1);return}return this.requestIdlePromise().then(()=>Promise.all(this.onClose.map(a=>a()))).then(()=>Promise.all(Object.keys(this.collections).map(a=>this.collections[a]).map(a=>a.close()))).then(()=>this.internalStore.close()).then(()=>s(!0))})(),i},t.remove=function(){return this.close().then(()=>nk(this.name,this.storage,this.multiInstance,this.password))},Vi(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])})();function tk(e,t){if(Xu.has(_v(e,t)))throw et("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}function bv(){var e,t,n=new Promise((i,r)=>{e=i,t=r});return{promise:n,resolve:e,reject:t}}function _v(e,t){return t.name+"|"+e}async function yv(e,t,n,i,r,s){var a=await t.createStorageInstance({databaseInstanceToken:e,databaseName:n,collectionName:gS,schema:od,options:i,multiInstance:r,password:s,devMode:zt.isDevMode()});return a}function ek({storage:e,instanceCreationOptions:t,name:n,password:i,multiInstance:r=!0,eventReduce:s=!0,ignoreDuplicate:a=!1,options:o={},cleanupPolicy:c,closeDuplicates:l=!1,allowSlowCount:h=!1,localDocuments:u=!1,hashFunction:d=sm,reactivity:p}){ze("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:n,password:i,multiInstance:r,eventReduce:s,ignoreDuplicate:a,options:o,localDocuments:u});var g=_v(n,e),m=Nf.get(g)||new Set,b=bv(),w=Array.from(m),C=()=>{m.delete(b.promise),Xu.delete(g)};return m.add(b.promise),Nf.set(g,m),(async()=>{if(l&&await Promise.all(w.map(I=>I.catch(()=>null).then(E=>E&&E.close()))),a){if(!zt.isDevMode())throw et("DB9",{database:n})}else tk(n,e);Xu.add(g);var _=Nr(10),k=await yv(_,e,n,t,r,i),x=new cd(n,_,e,t,i,r,s,o,k,d,c,h,p,C);return await Cr("createRxDatabase",{database:x,creator:{storage:e,instanceCreationOptions:t,name:n,password:i,multiInstance:r,eventReduce:s,ignoreDuplicate:a,options:o,localDocuments:u}}),x})().then(_=>{b.resolve(_)}).catch(_=>{b.reject(_),C()}),b.promise}async function nk(e,t,n=!0,i){var r=Nr(10),s=await yv(r,t,e,{},n,i),a=await lv(s),o=new Set;a.forEach(l=>o.add(l.data.name));var c=Array.from(o);return await Promise.all(c.map(l=>dv(t,s,r,e,l,n,i))),await Cr("postRemoveRxDatabase",{databaseName:e,storage:t}),await s.remove(),c}function ik(e){return e instanceof cd}async function rk(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}var sk={RxSchema:dm.prototype,RxDocument:dl,RxQuery:cv.prototype,RxCollection:gv.prototype,RxDatabase:cd.prototype},Ql=new Set,Ff=new Set;function fl(e){if(ze("preAddRxPlugin",{plugin:e,plugins:Ql}),!Ql.has(e)){{if(Ff.has(e.name))throw et("PL3",{name:e.name,plugin:e});Ql.add(e),Ff.add(e.name)}if(!e.rxdb)throw xc("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach(([t,n])=>n(sk[t])),e.overwritable&&Object.assign(zt,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach(([t,n])=>{n.after&&Pa[t].push(n.after),n.before&&Pa[t].unshift(n.before)})}}async function Rc(e,t){var n=qi(e.input.metaInstance.schema,{isCheckpoint:"1",itemId:t}),i=await e.input.metaInstance.findDocumentsById([n],!1),r=i[0];if(e.lastCheckpointDoc[t]=r,r)return r.checkpointData}async function Tc(e,t,n){e.checkpointQueue=e.checkpointQueue.then(async()=>{var i=e.lastCheckpointDoc[t];if(n&&!e.events.canceled.getValue()&&(!i||JSON.stringify(i.checkpointData)!==JSON.stringify(n))){var r={id:"",isCheckpoint:"1",itemId:t,_deleted:!1,_attachments:{},checkpointData:n,_meta:Ps(),_rev:_n()};for(r.id=qi(e.input.metaInstance.schema,r);!e.events.canceled.getValue();){if(i&&(r.checkpointData=za([i.checkpointData,r.checkpointData])),r._meta.lwt=wn(),r._rev=ei(await e.checkpointKey,i),e.events.canceled.getValue())return;var s=[{previous:i,document:r}],a=await e.input.metaInstance.bulkWrite(s,"replication-set-checkpoint"),o=un(e.primaryPath,s,a)[0];if(o){e.lastCheckpointDoc[t]=o;return}else{var c=a.error[0];if(c.status!==409)throw c;i=it(c.documentInDb),r._rev=ei(await e.checkpointKey,i)}}}}),await e.checkpointQueue}async function ak(e){var t=await e.hashFunction([e.identifier,e.forkInstance.databaseName,e.forkInstance.collectionName].join("||"));return"rx_storage_replication_"+t}function Bf(e,t,n,i,r){var s=Object.assign({},i,{_attachments:t&&i._attachments?i._attachments:{},_meta:n?i._meta:Object.assign({},r?r._meta:{},{lwt:wn()}),_rev:n?i._rev:_n()});return s._rev||(s._rev=ei(e,r)),s}function yi(e,t,n){var i=qt(e);return t||delete i._attachments,n||(delete i._meta,delete i._rev),i}function Gu(e,t){return e.hasAttachments?t.map(n=>{var i=je(n.document);return i.docData=Dn(i.docData),{document:i,previous:n.previous}}):t}function Qu(e){for(;;)if(e.underlyingPersistentStorage)e=e.underlyingPersistentStorage;else return e}var Xo="RxReplicationProtocolMetaData";function Ju(e,t){var n=X1(e),i={title:Xo,primaryKey:{key:"id",fields:["itemId","isCheckpoint"],separator:"|"},type:"object",version:e.version,additionalProperties:!1,properties:{id:{type:"string",minLength:1,maxLength:n+2},isCheckpoint:{type:"string",enum:["0","1"],minLength:1,maxLength:1},itemId:{type:"string",maxLength:n>4?n:4},checkpointData:{type:"object",additionalProperties:!0},docData:{type:"object",properties:e.properties},isResolvedConflict:{type:"string"}},keyCompression:e.keyCompression,required:["id","isCheckpoint","itemId"]};t&&(i.encrypted=["docData"]);var r=sl(i);return r}function wv(e,t){return e.input.metaInstance.findDocumentsById(t.map(n=>{var i=qi(e.input.metaInstance.schema,{itemId:n,isCheckpoint:"0"});return i}),!0).then(n=>{var i={};return Object.values(n).forEach(r=>{i[r.itemId]={docData:r.docData,metaDocument:r}}),i})}async function Pc(e,t,n,i){var r=t[e.primaryPath],s=n?hl(n):{id:"",isCheckpoint:"0",itemId:r,docData:t,_attachments:{},_deleted:!1,_rev:_n(),_meta:{lwt:0}};s.docData=t,i&&(s.isResolvedConflict=i),s._meta.lwt=wn(),s.id=qi(e.input.metaInstance.schema,s),s._rev=ei(await e.checkpointKey,n);var a={previous:n,document:s};return a}async function ok(e){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.downstream){var t=await Rc(e,"down");t||await Tc(e,"down",e.input.initialCheckpoint.downstream)}var n=await e.input.hashFunction(e.input.identifier),i=e.input.replicationHandler,r=0,s=[];function a(g){e.stats.down.addNewTask=e.stats.down.addNewTask+1;var m={time:r++,task:g};s.push(m),e.streamQueue.down=e.streamQueue.down.then(()=>{for(var b=[];s.length>0;){e.events.active.down.next(!0);var w=it(s.shift());if(!(w.time<c)){if(w.task==="RESYNC")if(b.length===0){b.push(w.task);break}else break;b.push(w.task)}}if(b.length!==0)return b[0]==="RESYNC"?l():h(b)}).then(()=>{e.events.active.down.next(!1),!e.firstSyncDone.down.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.down.next(!0)})}if(a("RESYNC"),!e.events.canceled.getValue()){var o=i.masterChangeStream$.pipe(On(async g=>(await Jn(e.events.active.up.pipe(wt(m=>!m))),g))).subscribe(g=>{e.stats.down.masterChangeStreamEmit=e.stats.down.masterChangeStreamEmit+1,a(g)});Jn(e.events.canceled.pipe(wt(g=>!!g))).then(()=>o.unsubscribe())}var c=-1;async function l(){if(e.stats.down.downstreamResyncOnce=e.stats.down.downstreamResyncOnce+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>Rc(e,"down"));for(var g=await e.checkpointQueue,m=[];!e.events.canceled.getValue();){c=r++;var b=await i.masterChangesSince(g,e.input.pullBatchSize);if(b.documents.length===0||(g=za([g,b.checkpoint]),m.push(p(b.documents,g)),b.documents.length<e.input.pullBatchSize))break}await Promise.all(m)}}function h(g){e.stats.down.downstreamProcessChanges=e.stats.down.downstreamProcessChanges+1;var m=[],b=null;return g.forEach(w=>{if(w==="RESYNC")throw new Error("SNH");Sr(m,w.documents),b=za([b,w.checkpoint])}),p(m,it(b))}var u=Ge,d={docs:{}};function p(g,m){var b=e.primaryPath;return e.stats.down.persistFromMaster=e.stats.down.persistFromMaster+1,g.forEach(w=>{var C=w[b];d.docs[C]=w}),d.checkpoint=m,u=u.then(()=>{var w=d.docs;d.docs={};var C=d.checkpoint,_=Object.keys(w);if(e.events.canceled.getValue()||_.length===0)return Ge;var k=[],x={},I={},E=[];return Promise.all([e.input.forkInstance.findDocumentsById(_,!0),wv(e,_)]).then(([y,M])=>{var D=new Map;return y.forEach(R=>D.set(R[b],R)),Promise.all(_.map(async R=>{var P=D.get(R),N=P?yi(P,e.hasAttachments,!1):void 0,U=w[R],H=M[R];H&&P&&H.metaDocument.isResolvedConflict===P._rev&&await e.streamQueue.up;var Y=!H||!N?!1:e.input.conflictHandler.isEqual(H.docData,N,"downstream-check-if-equal-0");if(!Y&&H&&H.docData._rev&&P&&P._meta[e.input.identifier]&&ji(P._rev)===P._meta[e.input.identifier]&&(Y=!0),P&&H&&Y===!1||P&&!H)return Ge;var K=N?e.input.conflictHandler.isEqual(U,N,"downstream-check-if-equal-1"):!1;if(N&&K)return(!H||Y===!1)&&E.push(await Pc(e,N,H?H.metaDocument:void 0)),Ge;var Z=Object.assign({},U,P?{_meta:qt(P._meta),_attachments:e.hasAttachments&&U._attachments?U._attachments:{},_rev:_n()}:{_meta:{lwt:wn()},_rev:_n(),_attachments:e.hasAttachments&&U._attachments?U._attachments:{}});if(U._rev){var j=P?ji(P._rev)+1:1;Z._meta[e.input.identifier]=j,e.input.keepMeta&&(Z._rev=U._rev)}e.input.keepMeta&&U._meta&&(Z._meta=U._meta);var nt={previous:P,document:Z};nt.document._rev=nt.document._rev?nt.document._rev:ei(n,nt.previous),k.push(nt),x[R]=nt,I[R]=await Pc(e,U,H?H.metaDocument:void 0)}))}).then(async()=>{if(k.length>0)return e.input.forkInstance.bulkWrite(k,await e.downstreamBulkWriteFlag).then(y=>{var M=un(e.primaryPath,k,y);M.forEach(R=>{var P=R[b];e.events.processed.down.next(x[P]),E.push(I[P])});var D;if(y.error.forEach(R=>{if(R.status!==409){var P=et("RC_PULL",{writeError:R});e.events.error.next(P),D=P}}),D)throw D})}).then(()=>{if(E.length>0)return e.input.metaInstance.bulkWrite(Gu(e,E),"replication-down-write-meta").then(y=>{y.error.forEach(M=>{e.events.error.next(et("RC_PULL",{id:M.documentId,writeError:M}))})})}).then(()=>{Tc(e,"down",C)})}).catch(w=>e.events.error.next(w)),u}}async function ck(e,t,n){var i=e.input.conflictHandler,r=i.isEqual(t.realMasterState,t.newDocumentState,"replication-resolve-conflict");if(!r){var s=await i.resolve(t,"replication-resolve-conflict"),a=Object.assign({},s,{_meta:qt(n._meta),_rev:_n(),_attachments:qt(n._attachments)});return a._meta.lwt=wn(),a._rev=ei(await e.checkpointKey,n),a}}async function Zu(e,t,n,i){if(!n._attachments||i&&!i._attachments)throw new Error("_attachments missing");var r=n[e],s=new Set(i&&i._attachments?Object.keys(i._attachments):[]);return await Promise.all(Object.entries(n._attachments).map(async([a,o])=>{if((!s.has(a)||i&&it(i._attachments)[a].digest!==o.digest)&&!o.data){var c=await t.getAttachmentData(r,a,o.digest);o.data=c}})),n}async function lk(e){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.upstream){var t=await Rc(e,"up");t||await Tc(e,"up",e.input.initialCheckpoint.upstream)}var n=e.input.replicationHandler;e.streamQueue.up=e.streamQueue.up.then(()=>h().then(()=>u()));var i=0,r=-1,s=[],a=Pn,o={docs:{}},c=e.input.forkInstance.changeStream().subscribe(p=>{if(!e.events.paused.getValue())return e.stats.up.forkChangeStreamEmit=e.stats.up.forkChangeStreamEmit+1,s.push({task:p,time:i++}),e.events.active.up.getValue()||e.events.active.up.next(!0),e.input.waitBeforePersist?e.input.waitBeforePersist().then(()=>u()):u()}),l=n.masterChangeStream$.pipe(wt(p=>p==="RESYNC")).subscribe(()=>{s.push({task:"RESYNC",time:i++}),u()});Jn(e.events.canceled.pipe(wt(p=>!!p))).then(()=>{c.unsubscribe(),l.unsubscribe()});async function h(){if(e.stats.up.upstreamInitialSync=e.stats.up.upstreamInitialSync+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>Rc(e,"up"));for(var p=await e.checkpointQueue,g=new Set,m=async function(){r=i++,g.size>3&&await Promise.race(Array.from(g));var C=await Qm(e.input.forkInstance,e.input.pushBatchSize,p);if(C.documents.length===0)return 1;p=za([p,C.checkpoint]);var _=d(C.documents,it(p));g.add(_),_.catch().then(()=>g.delete(_))};!e.events.canceled.getValue()&&!await m(););var b=await Promise.all(g),w=b.find(C=>!!C);w?await h():!e.firstSyncDone.up.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.up.next(!0)}}function u(){if(e.events.canceled.getValue()||s.length===0){e.events.active.up.next(!1);return}e.stats.up.processTasks=e.stats.up.processTasks+1,e.events.active.up.next(!0),e.streamQueue.up=e.streamQueue.up.then(async()=>{for(var p=[],g;s.length>0;){var m=it(s.shift());if(!(m.time<r)){if(m.task==="RESYNC"){e.events.active.up.next(!1),await h();return}m.task.context!==await e.downstreamBulkWriteFlag&&Sr(p,m.task.events.map(b=>b.documentData)),g=za([g,m.task.checkpoint])}}if(await d(p,g),s.length===0)e.events.active.up.next(!1);else return u()})}function d(p,g){return e.stats.up.persistToMaster=e.stats.up.persistToMaster+1,p.forEach(m=>{var b=m[e.primaryPath];o.docs[b]=m}),o.checkpoint=g,a=a.then(async()=>{if(e.events.canceled.getValue())return!1;var m=o.docs;o.docs={};var b=o.checkpoint,w=Object.keys(m);function C(){return Tc(e,"up",b)}if(w.length===0)return C(),!1;var _=await wv(e,w),k={},x=[],I={},E={};if(await Promise.all(w.map(async nt=>{var G=m[nt];E[nt]=G;var tt=yi(G,e.hasAttachments,!!e.input.keepMeta),z=_[nt];z&&z.metaDocument.isResolvedConflict!==G._rev&&e.input.conflictHandler.isEqual(z.docData,tt,"upstream-check-if-equal")||z&&z.docData._rev&&ji(G._rev)===G._meta[e.input.identifier]||(x.push(nt),k[nt]={assumedMasterState:z?z.docData:void 0,newDocumentState:tt},I[nt]=await Pc(e,tt,z?z.metaDocument:void 0))})),x.length===0)return C(),!1;var y=Object.values(k),M=new Set,D={},R=k1(y,e.input.pushBatchSize);await Promise.all(R.map(async nt=>{e.hasAttachments&&await Promise.all(nt.map(async tt=>{tt.newDocumentState=await Zu(e.primaryPath,e.input.forkInstance,je(tt.newDocumentState),tt.assumedMasterState)}));var G=await n.masterWrite(nt);G.forEach(tt=>{var z=tt[e.primaryPath];M.add(z),D[z]=tt})}));var P=[];if(x.forEach(nt=>{M.has(nt)||(e.events.processed.up.next(k[nt]),P.push(I[nt]))}),e.events.canceled.getValue())return!1;P.length>0&&await e.input.metaInstance.bulkWrite(Gu(e,P),"replication-up-write-meta");var N=!1;if(M.size>0){e.stats.up.persistToMasterHadConflicts=e.stats.up.persistToMasterHadConflicts+1;var U=[],H={};if(await Promise.all(Object.entries(D).map(([nt,G])=>{var tt=k[nt],z={newDocumentState:tt.newDocumentState,assumedMasterState:tt.assumedMasterState,realMasterState:G};return ck(e,z,E[nt]).then(async J=>{if(J){e.events.resolvedConflicts.next({input:z,output:J}),U.push({previous:E[nt],document:J});var lt=_[nt];H[nt]=await Pc(e,it(G),lt?lt.metaDocument:void 0,J._rev)}})})),U.length>0){N=!0,e.stats.up.persistToMasterConflictWrites=e.stats.up.persistToMasterConflictWrites+1;var Y=await e.input.forkInstance.bulkWrite(U,"replication-up-write-conflict"),K;if(Y.error.forEach(nt=>{if(nt.status!==409){var G=et("RC_PUSH",{writeError:nt});e.events.error.next(G),K=G}}),K)throw K;var Z=[],j=un(e.primaryPath,U,Y);j.forEach(nt=>{var G=nt[e.primaryPath];Z.push(H[G])}),Z.length>0&&await e.input.metaInstance.bulkWrite(Gu(e,Z),"replication-up-write-conflict-meta")}}return C(),N}).catch(m=>(e.events.error.next(m),!1)),a}}function xv(e){e=qt(e),e.forkInstance=Qu(e.forkInstance),e.metaInstance=Qu(e.metaInstance);var t=ak(e),n={primaryPath:xn(e.forkInstance.schema.primaryKey),hasAttachments:!!e.forkInstance.schema.attachments,input:e,checkpointKey:t,downstreamBulkWriteFlag:t.then(i=>"replication-downstream-"+i),events:{canceled:new mn(!1),paused:new mn(!1),active:{down:new mn(!0),up:new mn(!0)},processed:{down:new ie,up:new ie},resolvedConflicts:new ie,error:new ie},stats:{down:{addNewTask:0,downstreamProcessChanges:0,downstreamResyncOnce:0,masterChangeStreamEmit:0,persistFromMaster:0},up:{forkChangeStreamEmit:0,persistToMaster:0,persistToMasterConflictWrites:0,persistToMasterHadConflicts:0,processTasks:0,upstreamInitialSync:0}},firstSyncDone:{down:new mn(!1),up:new mn(!1)},streamQueue:{down:Ge,up:Ge},checkpointQueue:Ge,lastCheckpointDoc:{}};return ok(n),lk(n),n}function Go(e){return Jn(Pm([e.firstSyncDone.down.pipe(wt(t=>!!t)),e.firstSyncDone.up.pipe(wt(t=>!!t))])).then(()=>{})}function th(e){return Promise.all([e.streamQueue.up,e.streamQueue.down,e.checkpointQueue])}function Sv(e,t,n,i=!1){e=Qu(e);var r=!!e.schema.attachments,s=xn(e.schema.primaryKey),a={masterChangeStream$:e.changeStream().pipe(On(async o=>{var c={checkpoint:o.checkpoint,documents:await Promise.all(o.events.map(async l=>{var h=yi(l.documentData,r,i);return r&&(h=await Zu(s,e,je(h),void 0)),h}))};return c})),masterChangesSince(o,c){return Qm(e,c,o).then(async l=>({checkpoint:l.documents.length>0?l.checkpoint:o,documents:await Promise.all(l.documents.map(async h=>{var u=yi(h,r,i);return r&&(u=await Zu(s,e,je(u),void 0)),u}))}))},async masterWrite(o){var c={};o.forEach(m=>{var b=m.newDocumentState[s];c[b]=m});var l=Object.keys(c),h=await e.findDocumentsById(l,!0),u=new Map;h.forEach(m=>u.set(m[s],m));var d=[],p=[];if(await Promise.all(Object.entries(c).map(([m,b])=>{var w=u.get(m);w?w&&!b.assumedMasterState?d.push(yi(w,r,i)):t.isEqual(yi(w,r,i),it(b.assumedMasterState),"rxStorageInstanceToReplicationHandler-masterWrite")===!0?p.push({previous:w,document:Bf(n,r,i,b.newDocumentState,w)}):d.push(yi(w,r,i)):p.push({document:Bf(n,r,i,b.newDocumentState)})})),p.length>0){var g=await e.bulkWrite(p,"replication-master-write");g.error.forEach(m=>{if(m.status!==409)throw et("SNH",{name:"non conflict error",error:m});d.push(yi(it(m.documentInDb),r,i))})}return d}};return a}async function Cv(e){e.events.canceled.next(!0),e.events.active.up.complete(),e.events.active.down.complete(),e.events.processed.up.complete(),e.events.processed.down.complete(),e.events.resolvedConflicts.complete(),e.events.canceled.complete(),await e.checkpointQueue}function uk(e){return e&&typeof e.then=="function"}Promise.resolve(!1);var hk=Promise.resolve(!0),Zn=Promise.resolve();function pr(e,t){return e||(e=0),new Promise(function(n){return setTimeout(function(){return n(t)},e)})}function dk(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function oo(){return Math.random().toString(36).substring(2)}var Jl=0;function co(){var e=Date.now()*1e3;return e<=Jl&&(e=Jl+1),Jl=e,e}function fk(){return typeof navigator<"u"&&typeof navigator.locks<"u"&&typeof navigator.locks.request=="function"}var pk=co,gk="native";function mk(e){var t={time:co(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(n){t.messagesCallback&&t.messagesCallback(n.data)},t}function vk(e){e.bc.close(),e.subFns=[]}function bk(e,t){try{return e.bc.postMessage(t,!1),Zn}catch(n){return Promise.reject(n)}}function _k(e,t){e.messagesCallback=t}function yk(){if(typeof globalThis<"u"&&globalThis.Deno&&globalThis.Deno.args)return!0;if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function wk(){return 150}var xk={create:mk,close:vk,onMessage:_k,postMessage:bk,canBeUsed:yk,type:gk,averageResponseTime:wk,microSeconds:pk};class kv{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){const n=this.map.get(t);return typeof n>"u"?!1:n<eh()-this.ttl?(this.map.delete(t),!1):!0}add(t){this.map.delete(t),this.map.set(t,eh()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,Sk(this)},0))}clear(){this.map.clear()}}function Sk(e){const t=eh()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const i=n.next().value;if(!i)break;const r=i[0];if(i[1]<t)e.map.delete(r);else break}}function eh(){return Date.now()}function ld(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var Ck=co,kk="pubkey.broadcast-channel-0-",ii="messages",pl={durability:"relaxed"},Ek="idb";function Ev(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function ud(e){e.commit&&e.commit()}function Mk(e){var t=Ev(),n=kk+e,i=t.open(n);return i.onupgradeneeded=function(r){var s=r.target.result;s.createObjectStore(ii,{keyPath:"id",autoIncrement:!0})},new Promise(function(r,s){i.onerror=function(a){return s(a)},i.onsuccess=function(){r(i.result)}})}function Dk(e,t,n){var i=Date.now(),r={uuid:t,time:i,data:n},s=e.transaction([ii],"readwrite",pl);return new Promise(function(a,o){s.oncomplete=function(){return a()},s.onerror=function(l){return o(l)};var c=s.objectStore(ii);c.add(r),ud(s)})}function Ik(e,t){var n=e.transaction(ii,"readonly",pl),i=n.objectStore(ii),r=[],s=IDBKeyRange.bound(t+1,1/0);if(i.getAll){var a=i.getAll(s);return new Promise(function(c,l){a.onerror=function(h){return l(h)},a.onsuccess=function(h){c(h.target.result)}})}function o(){try{return s=IDBKeyRange.bound(t+1,1/0),i.openCursor(s)}catch{return i.openCursor()}}return new Promise(function(c,l){var h=o();h.onerror=function(u){return l(u)},h.onsuccess=function(u){var d=u.target.result;d?d.value.id<t+1?d.continue(t+1):(r.push(d.value),d.continue()):(ud(n),c(r))}})}function Rk(e,t){if(e.closed)return Promise.resolve([]);var n=e.db.transaction(ii,"readwrite",pl),i=n.objectStore(ii);return Promise.all(t.map(function(r){var s=i.delete(r);return new Promise(function(a){s.onsuccess=function(){return a()}})}))}function Tk(e,t){var n=Date.now()-t,i=e.transaction(ii,"readonly",pl),r=i.objectStore(ii),s=[];return new Promise(function(a){r.openCursor().onsuccess=function(o){var c=o.target.result;if(c){var l=c.value;l.time<n?(s.push(l),c.continue()):(ud(i),a(s))}else a(s)}})}function Pk(e){return Tk(e.db,e.options.idb.ttl).then(function(t){return Rk(e,t.map(function(n){return n.id}))})}function Ok(e,t){return t=ld(t),Mk(e).then(function(n){var i={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:oo(),eMIs:new kv(t.idb.ttl*2),writeBlockPromise:Zn,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){i.closed=!0,t.idb.onclose&&t.idb.onclose()},Mv(i),i})}function Mv(e){e.closed||Dv(e).then(function(){return pr(e.options.idb.fallbackInterval)}).then(function(){return Mv(e)})}function Ak(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function Dv(e){return e.closed||!e.messagesCallback?Zn:Ik(e.db,e.lastCursorId).then(function(t){var n=t.filter(function(i){return!!i}).map(function(i){return i.id>e.lastCursorId&&(e.lastCursorId=i.id),i}).filter(function(i){return Ak(i,e)}).sort(function(i,r){return i.time-r.time});return n.forEach(function(i){e.messagesCallback&&(e.eMIs.add(i.id),e.messagesCallback(i.data))}),Zn})}function $k(e){e.closed=!0,e.db.close()}function Lk(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return Dk(e.db,e.uuid,t)}).then(function(){dk(0,10)===0&&Pk(e)}),e.writeBlockPromise}function Nk(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,Dv(e)}function Fk(){return!!Ev()}function Bk(e){return e.idb.fallbackInterval*2}var jk={create:Ok,close:$k,onMessage:Nk,postMessage:Lk,canBeUsed:Fk,type:Ek,averageResponseTime:Bk,microSeconds:Ck},zk=co,Wk="pubkey.broadcastChannel-",Hk="localstorage";function Iv(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Rv(e){return Wk+e}function Uk(e,t){return new Promise(function(n){pr().then(function(){var i=Rv(e.channelName),r={token:oo(),time:Date.now(),data:t,uuid:e.uuid},s=JSON.stringify(r);Iv().setItem(i,s);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=i,a.newValue=s,window.dispatchEvent(a),n()})})}function Vk(e,t){var n=Rv(e),i=function(s){s.key===n&&t(JSON.parse(s.newValue))};return window.addEventListener("storage",i),i}function qk(e){window.removeEventListener("storage",e)}function Kk(e,t){if(t=ld(t),!Tv())throw new Error("BroadcastChannel: localstorage cannot be used");var n=oo(),i=new kv(t.localstorage.removeTimeout),r={channelName:e,uuid:n,eMIs:i};return r.listener=Vk(e,function(s){r.messagesCallback&&s.uuid!==n&&(!s.token||i.has(s.token)||s.data.time&&s.data.time<r.messagesCallbackTime||(i.add(s.token),r.messagesCallback(s.data)))}),r}function Yk(e){qk(e.listener)}function Xk(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t}function Tv(){var e=Iv();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function Gk(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var Qk={create:Kk,close:Yk,onMessage:Xk,postMessage:Uk,canBeUsed:Tv,type:Hk,averageResponseTime:Gk,microSeconds:zk},Pv=co,Jk="simulate",hd=new Set;function Zk(e){var t={time:Pv(),name:e,messagesCallback:null};return hd.add(t),t}function tE(e){hd.delete(e)}var Ov=5;function eE(e,t){return new Promise(function(n){return setTimeout(function(){var i=Array.from(hd);i.forEach(function(r){r.name===e.name&&r!==e&&r.messagesCallback&&r.time<t.time&&r.messagesCallback(t)}),n()},Ov)})}function nE(e,t){e.messagesCallback=t}function iE(){return!0}function rE(){return Ov}var sE={create:Zk,close:tE,onMessage:nE,postMessage:eE,canBeUsed:iE,type:Jk,averageResponseTime:rE,microSeconds:Pv},jf=[xk,jk,Qk];function aE(e){var t=[].concat(e.methods,jf).filter(Boolean);if(e.type){if(e.type==="simulate")return sE;var n=t.find(function(r){return r.type===e.type});if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter(function(r){return r.type!=="idb"}));var i=t.find(function(r){return r.canBeUsed()});if(i)return i;throw new Error("No usable method found in "+JSON.stringify(jf.map(function(r){return r.type})))}var Av=new Set,oE=0,gl=function(t,n){this.id=oE++,Av.add(this),this.name=t,this.options=ld(n),this.method=aE(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,cE(this)};gl._pubkey=!0;gl.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return zf(this,"message",t)},postInternal:function(t){return zf(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),n={time:t,fn:e};Hf(this,"message",this._onML),e&&typeof e=="function"?(this._onML=n,Wf(this,"message",n)):this._onML=null},addEventListener:function(t,n){var i=this.method.microSeconds(),r={time:i,fn:n};Wf(this,t,r)},removeEventListener:function(t,n){var i=this._addEL[t].find(function(r){return r.fn===n});Hf(this,t,i)},close:function(){var t=this;if(!this.closed){Av.delete(this),this.closed=!0;var n=this._prepP?this._prepP:Zn;return this._onML=null,this._addEL.message=[],n.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(i){return i()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function zf(e,t,n){var i=e.method.microSeconds(),r={time:i,type:t,data:n},s=e._prepP?e._prepP:Zn;return s.then(function(){var a=e.method.postMessage(e._state,r);return e._uMP.add(a),a.catch().then(function(){return e._uMP.delete(a)}),a})}function cE(e){var t=e.method.create(e.name,e.options);uk(t)?(e._prepP=t,t.then(function(n){e._state=n})):e._state=t}function $v(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Wf(e,t,n){e._addEL[t].push(n),lE(e)}function Hf(e,t,n){e._addEL[t]=e._addEL[t].filter(function(i){return i!==n}),uE(e)}function lE(e){if(!e._iL&&$v(e)){var t=function(r){e._addEL[r.type].forEach(function(s){r.time>=s.time&&s.fn(r.data)})},n=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,n)}):(e._iL=!0,e.method.onMessage(e._state,t,n))}}function uE(e){if(e._iL&&!$v(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}function hE(e){if(typeof WorkerGlobalScope=="function"&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if(typeof window.addEventListener!="function")return;window.addEventListener("beforeunload",function(){e()},!0),window.addEventListener("unload",function(){e()},!0)}}function dE(e){process.on("exit",function(){return e()}),process.on("beforeExit",function(){return e().then(function(){return process.exit()})}),process.on("SIGINT",function(){return e().then(function(){return process.exit()})}),process.on("uncaughtException",function(t){return e().then(function(){console.trace(t),process.exit(101)})})}var fE=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",pE=fE?dE:hE,pa=new Set,Uf=!1;function gE(){Uf||(Uf=!0,pE(vE))}function mE(e){if(gE(),typeof e!="function")throw new Error("Listener is no function");pa.add(e);var t={remove:function(){return pa.delete(e)},run:function(){return pa.delete(e),e()}};return t}function vE(){var e=[];return pa.forEach(function(t){e.push(t()),pa.delete(t)}),Promise.all(e)}function br(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}function Lv(e){e.isLeader=!0,e._hasLeader=!0;var t=mE(function(){return e.die()});e._unl.push(t);var n=function(r){r.context==="leader"&&r.action==="apply"&&br(e,"tell"),r.context==="leader"&&r.action==="tell"&&!e._dpLC&&(e._dpLC=!0,e._dpL(),br(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),br(e,"tell")}var Nv=function(t,n){var i=this;this.broadcastChannel=t,t._befC.push(function(){return i.die()}),this._options=n,this.isLeader=!1,this.isDead=!1,this.token=oo(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+t.method.type+"||"+t.name};Nv.prototype={hasLeader:function(){var t=this;return navigator.locks.query().then(function(n){var i=n.held?n.held.filter(function(r){return r.name===t.lN}):[];return!!(i&&i.length>0)})},awaitLeadership:function(){var t=this;if(!this._wLMP){this._wKMC.c=new AbortController;var n=new Promise(function(i,r){t._wKMC.res=i,t._wKMC.rej=r});this._wLMP=new Promise(function(i,r){navigator.locks.request(t.lN,{signal:t._wKMC.c.signal},function(){return t._wKMC.c=void 0,Lv(t),i(),n}).catch(function(s){t._wKMC.rej&&t._wKMC.rej(s),r(s)})})}return this._wLMP},set onduplicate(e){},die:function(){var t=this;return this._lstns.forEach(function(n){return t.broadcastChannel.removeEventListener("internal",n)}),this._lstns=[],this._unl.forEach(function(n){return n.remove()}),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),br(this,"death")}};var Fv=function(t,n){var i=this;this.broadcastChannel=t,this._options=n,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=oo(),this._aplQ=Zn,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var r=function(a){a.context==="leader"&&(a.action==="death"&&(i._hasLeader=!1),a.action==="tell"&&(i._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",r),this._lstns.push(r)};Fv.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(t){var n=this;if(this.isLeader)return pr(0,!0);if(this.isDead)return pr(0,!1);if(this._aplQC>1)return this._aplQ;var i=function(){if(n.isLeader)return hk;var s=!1,a,o=new Promise(function(h){a=function(){s=!0,h()}}),c=function(u){u.context==="leader"&&u.token!=n.token&&(u.action==="apply"&&u.token>n.token&&a(),u.action==="tell"&&(a(),n._hasLeader=!0))};n.broadcastChannel.addEventListener("internal",c);var l=t?n._options.responseTime*4:n._options.responseTime;return br(n,"apply").then(function(){return Promise.race([pr(l),o.then(function(){return Promise.reject(new Error)})])}).then(function(){return br(n,"apply")}).then(function(){return Promise.race([pr(l),o.then(function(){return Promise.reject(new Error)})])}).catch(function(){}).then(function(){return n.broadcastChannel.removeEventListener("internal",c),s?!1:Lv(n).then(function(){return!0})})};return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then(function(){return i()}).then(function(){n._aplQC=n._aplQC-1}),this._aplQ.then(function(){return n.isLeader})},awaitLeadership:function(){return this._aLP||(this._aLP=bE(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var t=this;return this._lstns.forEach(function(n){return t.broadcastChannel.removeEventListener("internal",n)}),this._lstns=[],this._unl.forEach(function(n){return n.remove()}),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,br(this,"death")}};function bE(e){return e.isLeader?Zn:new Promise(function(t){var n=!1;function i(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",s),t(!0))}e.applyOnce().then(function(){e.isLeader&&i()});var r=function(){return pr(e._options.fallbackInterval).then(function(){if(!(e.isDead||n))if(e.isLeader)i();else return e.applyOnce(!0).then(function(){e.isLeader?i():r()})})};r();var s=function(o){o.context==="leader"&&o.action==="death"&&(e._hasLeader=!1,e.applyOnce().then(function(){e.isLeader&&i()}))};e.broadcastChannel.addEventListener("internal",s),e._lstns.push(s)})}function _E(e,t){return e||(e={}),e=JSON.parse(JSON.stringify(e)),e.fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}function Bv(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=_E(t,e);var n=fk()?new Nv(e,t):new Fv(e,t);return e._befC.push(function(){return n.die()}),e._leaderElector=n,n}var Oc=new Map;function jv(e,t,n,i){var r=Oc.get(t);return r||(r={bc:new gl(["RxDB:",e,n].join("|")),refs:new Set},Oc.set(t,r)),r.refs.add(i),r.bc}function nh(e,t){var n=Oc.get(e);if(n&&(n.refs.delete(t),n.refs.size===0))return Oc.delete(e),n.bc.close()}function RL(e,t,n,i){if(t.multiInstance){var r=jv(e,t.databaseInstanceToken,n.databaseName,n),s=new ie,a=d=>{d.storageName===e&&d.databaseName===t.databaseName&&d.collectionName===t.collectionName&&d.version===t.schema.version&&s.next(d.eventBulk)};r.addEventListener("message",a);var o=n.changeStream(),c=!1,l=o.subscribe(d=>{c||r.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:d})});n.changeStream=function(){return s.asObservable().pipe(Gx(o))};var h=n.close.bind(n);n.close=async function(){return c=!0,l.unsubscribe(),r.removeEventListener("message",a),await nh(t.databaseInstanceToken,n),h()};var u=n.remove.bind(n);n.remove=async function(){return c=!0,l.unsubscribe(),r.removeEventListener("message",a),await nh(t.databaseInstanceToken,n),u()}}}async function zv(e){var t=nx(e.collection.schema.jsonSchema).map(s=>e.collection.name+"-"+s),n=await e.database.internalStore.findDocumentsById(t.map(s=>Ir(s,Li)),!1),i={};n.forEach(s=>i[s.key]=s);var r=t.find(s=>i[s]);return r?i[r]:void 0}function yE(e,t,n){var i=qt(n._attachments),r=je(n),s=r._meta;delete r._meta,r._attachments=i;for(var a=t+1,o=Promise.resolve(r),c=function(){var l=a;o=o.then(h=>wE(e,l,h)),a++};a<=e.schema.version;)c();return o.then(l=>l===null?Vh:(s&&(l._meta=s),l))}function wE(e,t,n){if(n===null)return Vh;var i=e.migrationStrategies[t](n,e),r=om(i);return r}async function Wv(e){if(e.collection.schema.version===0)return Pn;var t=await zv(e);return!!t}var xE=200,Hv=new WeakMap;function SE(e){var t=Uv(e.database),n=t.getValue().slice(0);n.push(e),t.next(n)}function Uv(e){return ln(Hv,e,()=>new mn([]))}function CE(e){var t=Hv.get(e);t&&t.complete()}var kE=(function(){function e(n,i,r=[n.name,"v",n.schema.version].join("-")){this.started=!1,this.canceled=!1,this.updateStatusHandlers=[],this.updateStatusQueue=Uh,this.collection=n,this.migrationStrategies=i,this.statusDocKey=r,this.database=n.database,this.oldCollectionMeta=zv(this),this.mustMigrate=Wv(this),this.statusDocId=Ir(this.statusDocKey,Yo),SE(this),this.$=mS(this.database.internalStore,this.statusDocId).pipe(wt(s=>!!s),Jt(s=>it(s).data),io(Za))}var t=e.prototype;return t.getStatus=function(){return Jn(this.$)},t.startMigration=async function(i=xE){var r=await this.mustMigrate;if(r){if(this.started)throw et("DM1");if(this.started=!0,this.database.multiInstance){this.broadcastChannel=new gl(["rx-migration-state",this.database.name,this.collection.name,this.collection.schema.version].join("|"));var s=Bv(this.broadcastChannel);await s.awaitLeadership()}var a=await this.oldCollectionMeta,o=await this.database.storage.createStorageInstance({databaseName:this.database.name,collectionName:this.collection.name,databaseInstanceToken:this.database.token,multiInstance:this.database.multiInstance,options:{},schema:it(a).data.schema,password:this.database.password,devMode:zt.isDevMode()}),c=await this.getConnectedStorageInstances(),l=await this.countAllDocuments([o].concat(c.map(u=>u.oldStorage)));await this.updateStatus(u=>(u.count.total=l,u));try{await Promise.all(c.map(async u=>{await hv(this.collection,u.newStorage.collectionName,u.newStorage.schema),await this.migrateStorage(u.oldStorage,u.newStorage,i),await u.newStorage.close()})),await this.migrateStorage(o,this.collection.storageInstance.originalStorageInstance,i)}catch(u){await o.close(),await this.updateStatus(d=>(d.status="ERROR",d.error=Bu(u),d));return}try{await ws(this.database.internalStore,{previous:a,document:Object.assign({},a,{_deleted:!0})},"rx-migration-remove-collection-meta")}catch(u){var h=ms(u);if(!(h&&h.documentInDb._deleted))throw u}await this.updateStatus(u=>(u.status="DONE",u)),this.broadcastChannel&&await this.broadcastChannel.close()}},t.updateStatus=function(i){return this.updateStatusHandlers.push(i),this.updateStatusQueue=this.updateStatusQueue.then(async()=>{if(this.updateStatusHandlers.length!==0){var r=this.updateStatusHandlers;for(this.updateStatusHandlers=[];;){var s=await Os(this.database.internalStore,this.statusDocId),a=je(s);s||(a={id:this.statusDocId,key:this.statusDocKey,context:Yo,data:{collectionName:this.collection.name,status:"RUNNING",count:{total:0,handled:0,percent:0}},_deleted:!1,_meta:Ps(),_rev:_n(),_attachments:{}});var o=it(a).data;for(var c of r)o=c(o);if(o.count.percent=Math.round(o.count.handled/o.count.total*100),a&&s&&Ta(a.data,s.data))break;try{await ws(this.database.internalStore,{previous:s,document:it(a)},Yo);break}catch(l){if(!ms(l))throw l}}}}),this.updateStatusQueue},t.migrateStorage=async function(i,r,s){this.collection.onClose.push(()=>this.cancel()),this.database.onClose.push(()=>this.cancel());var a=await this.database.storage.createStorageInstance({databaseName:this.database.name,collectionName:"rx-migration-state-meta-"+i.collectionName+"-"+i.schema.version,databaseInstanceToken:this.database.token,multiInstance:this.database.multiInstance,options:{},schema:Ju(i.schema,Mc(i.schema)),password:this.database.password,devMode:zt.isDevMode()}),o=Sv(r,Ic,this.database.token,!0),c=xv({keepMeta:!0,identifier:["rx-migration-state",i.collectionName,i.schema.version,this.collection.schema.version].join("-"),replicationHandler:{masterChangesSince(){return Promise.resolve({checkpoint:null,documents:[]})},masterWrite:async h=>{var u=await Promise.all(h.map(async p=>{var g=p.newDocumentState;if(r.schema.title===Xo&&(g=p.newDocumentState.docData,p.newDocumentState.isCheckpoint==="1"))return{assumedMasterState:void 0,newDocumentState:p.newDocumentState};var m=await yE(this.collection,i.schema.version,g);if(m===null)return null;var b={assumedMasterState:void 0,newDocumentState:r.schema.title===Xo?Object.assign({},p.newDocumentState,{docData:m}):m};return b}));u=u.filter(p=>!!p&&!!p.newDocumentState);var d=await o.masterWrite(u);return d},masterChangeStream$:new ie().asObservable()},forkInstance:i,metaInstance:a,pushBatchSize:s,pullBatchSize:0,conflictHandler:Ic,hashFunction:this.database.hashFunction}),l=!1;if(c.events.error.subscribe(h=>l=h),c.events.processed.up.subscribe(()=>{this.updateStatus(h=>(h.count.handled=h.count.handled+1,h))}),await Go(c),await th(c),await this.updateStatusQueue,l)throw await a.close(),l;await Promise.all([i.remove(),a.remove()]),await this.cancel()},t.cancel=async function(){this.canceled=!0,this.replicationState&&await Cv(this.replicationState),this.broadcastChannel&&await this.broadcastChannel.close()},t.countAllDocuments=async function(i){var r=0;return await Promise.all(i.map(async s=>{var a=ul(s.schema,hs(s.schema,{selector:{}})),o=await s.count(a);r+=o.count})),r},t.getConnectedStorageInstances=async function(){var i=it(await this.oldCollectionMeta),r=[];return await Promise.all(await Promise.all(i.data.connectedStorages.map(async s=>{if(s.schema.title!==Xo)throw new Error("unknown migration handling for schema");var a=Ju(je(this.collection.schema.jsonSchema),Mc(s.schema));a.version=this.collection.schema.version;var[o,c]=await Promise.all([this.database.storage.createStorageInstance({databaseInstanceToken:this.database.token,databaseName:this.database.name,devMode:zt.isDevMode(),multiInstance:this.database.multiInstance,options:{},schema:s.schema,password:this.database.password,collectionName:s.collectionName}),this.database.storage.createStorageInstance({databaseInstanceToken:this.database.token,databaseName:this.database.name,devMode:zt.isDevMode(),multiInstance:this.database.multiInstance,options:{},schema:a,password:this.database.password,collectionName:s.collectionName})]);r.push({oldStorage:o,newStorage:c})}))),r},t.migratePromise=async function(i){this.startMigration(i);var r=await this.mustMigrate;if(!r)return{status:"DONE",collectionName:this.collection.name,count:{handled:0,percent:0,total:0}};var s=await Promise.race([Jn(this.$.pipe(wt(a=>a.status==="DONE"))),Jn(this.$.pipe(wt(a=>a.status==="ERROR")))]);if(s.status==="ERROR")throw et("DM4",{collection:this.collection.name,error:s.error});return s},e})(),Ac=new WeakMap,ih=new WeakMap;function ga(e){var t=Ac.get(e);if(!t){var n=e.database?e.database:e,i=e.database?e.name:"";throw et("LD8",{database:n.name,collection:i})}return t}function Vv(e,t,n,i,r,s){return t.createStorageInstance({databaseInstanceToken:e,databaseName:n,collectionName:EE(i),schema:qv,options:r,multiInstance:s,devMode:zt.isDevMode()})}function Vf(e){var t=Ac.get(e);if(t)return Ac.delete(e),t.then(n=>n.storageInstance.close())}async function qf(e,t,n){var i=Nr(10),r=await Vv(i,e,t,n,{},!1);await r.remove()}function EE(e){return"plugin-local-documents-"+e}var qv=sl({title:"RxLocalDocument",version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:128},data:{type:"object",additionalProperties:!0}},required:["id","data"]});async function Kf(e,t){var n=await ga(this),i={id:e,data:t,_deleted:!1,_meta:Ps(),_rev:_n(),_attachments:{}};return ws(n.storageInstance,{document:i},"local-document-insert").then(r=>n.docCache.getCachedRxDocument(r))}function Yf(e,t){return this.getLocal(e).then(n=>{if(n)return n.incrementalModify(()=>t);var i=this.insertLocal(e,t);return i})}async function Xf(e){var t=await ga(this),n=t.docCache,i=n.getLatestDocumentDataIfExists(e);return i?Promise.resolve(n.getCachedRxDocument(i)):Os(t.storageInstance,e).then(r=>r?t.docCache.getCachedRxDocument(r):null)}function Gf(e){return this.$.pipe(ro(null),On(async t=>{if(t)return{changeEvent:t};var n=await this.getLocal(e);return{doc:n}}),On(async t=>{if(t.changeEvent){var n=t.changeEvent;if(!n.isLocal||n.documentId!==e)return{use:!1};var i=await this.getLocal(e);return{use:!0,doc:i}}else return{use:!0,doc:t.doc}}),wt(t=>t.use),Jt(t=>t.doc))}var ME=tv(),DE=(function(e){function t(n,i,r){var s;return s=e.call(this,null,i)||this,s.id=n,s.parent=r,s}return Wh(t,e),t})(ME),ma={get isLocal(){return!0},get allAttachments$(){throw et("LD1",{document:this})},get primaryPath(){return"id"},get primary(){return this.id},get $(){var e=this,t=zi(ih,this.parent),n=this.primary;return e.parent.eventBulks$.pipe(wt(i=>!!i.isLocal),Jt(i=>i.events.find(r=>r.documentId===n)),wt(i=>!!i),Jt(i=>Om(it(i))),ro(t.docCache.getLatestDocumentData(this.primary)),Aa((i,r)=>i._rev===r._rev),Jt(i=>t.docCache.getCachedRxDocument(i)),io(Za))},get $$(){var e=this,t=Zl(e),n=t.getReactivityFactory();return n.fromObservable(e.$,e.getLatest()._data,t)},get deleted$$(){var e=this,t=Zl(e),n=t.getReactivityFactory();return n.fromObservable(e.deleted$,e.getLatest().deleted,t)},getLatest(){var e=zi(ih,this.parent),t=e.docCache.getLatestDocumentData(this.primary);return e.docCache.getCachedRxDocument(t)},get(e){if(e="data."+e,!!this._data){if(typeof e!="string")throw xc("LD2",{objPath:e});var t=vs(this._data,e);return t=zt.deepFreezeWhenDevMode(t),t}},get$(e){if(e="data."+e,zt.isDevMode()){if(e.includes(".item."))throw et("LD3",{objPath:e});if(e===this.primaryPath)throw et("LD4")}return this.$.pipe(Jt(t=>t._data),Jt(t=>vs(t,e)),Aa())},get$$(e){var t=Zl(this),n=t.getReactivityFactory();return n.fromObservable(this.get$(e),this.getLatest().get(e),t)},async incrementalModify(e){var t=await ga(this.parent);return t.incrementalWriteQueue.addWrite(this._data,async n=>(n.data=await e(n.data,this),n)).then(n=>t.docCache.getCachedRxDocument(n))},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([n,i])=>{t[n]=i}),t))},async _saveData(e){var t=await ga(this.parent),n=this._data;e.id=this.id;var i=[{previous:n,document:e}];return t.storageInstance.bulkWrite(i,"local-document-save-data").then(r=>{if(r.error[0])throw r.error[0];var s=un(this.collection.schema.primaryPath,i,r)[0];e=qt(e),e._rev=s._rev})},async remove(){var e=await ga(this.parent),t=qt(this._data);return t._deleted=!0,ws(e.storageInstance,{previous:this._data,document:t},"local-document-remove").then(n=>e.docCache.getCachedRxDocument(n))}},Qf=!1,IE=()=>{if(!Qf){Qf=!0;var e=dl,t=Object.getOwnPropertyNames(e);t.forEach(i=>{var r=Object.getOwnPropertyDescriptor(ma,i);if(!r){var s=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(ma,i,s)}});var n=i=>()=>{throw et("LD6",{functionName:i})};["populate","update","putAttachment","putAttachmentBase64","getAttachment","allAttachments"].forEach(i=>ma[i]=n(i))}};function RE(e,t){IE();var n=new DE(e.id,e,t);return Object.setPrototypeOf(n,ma),n.prototype=ma,n}function Zl(e){var t=e.parent;return ik(t)?t:t.database}function Jf(e){var t=e.database?e.database:e,n=e.database?e.name:"",i=(async()=>{var r=await Vv(t.token,t.storage,t.name,n,t.instanceCreationOptions,t.multiInstance);r=td(t,r,qv);var s=new ov("id",t.eventBulks$.pipe(wt(h=>{var u=!1;return(n===""&&!h.collectionName||n!==""&&h.collectionName===n)&&(u=!0),u&&h.isLocal}),Jt(h=>h.events)),h=>RE(h,e)),a=new Zm(r,"id",()=>{},()=>{}),o=await t.storageToken,c=r.changeStream().subscribe(h=>{for(var u=new Array(h.events.length),d=h.events,p=e.database?e.name:void 0,g=0;g<d.length;g++){var m=d[g];u[g]={documentId:m.documentId,collectionName:p,isLocal:!0,operation:m.operation,documentData:zt.deepFreezeWhenDevMode(m.documentData),previousDocumentData:zt.deepFreezeWhenDevMode(m.previousDocumentData)}}var b={id:h.id,isLocal:!0,internal:!1,collectionName:e.database?e.name:void 0,storageToken:o,events:u,databaseToken:t.token,checkpoint:h.checkpoint,context:h.context};t.$emit(b)});e._subs.push(c);var l={database:t,parent:e,storageInstance:r,docCache:s,incrementalWriteQueue:a};return ih.set(e,l),l})();Ac.set(e,i)}var TE={name:"local-documents",rxdb:!0,prototypes:{RxCollection:e=>{e.insertLocal=Kf,e.upsertLocal=Yf,e.getLocal=Xf,e.getLocal$=Gf},RxDatabase:e=>{e.insertLocal=Kf,e.upsertLocal=Yf,e.getLocal=Xf,e.getLocal$=Gf}},hooks:{createRxDatabase:{before:e=>{e.creator.localDocuments&&Jf(e.database)}},createRxCollection:{before:e=>{e.creator.localDocuments&&Jf(e.collection)}},preCloseRxDatabase:{after:e=>Vf(e)},postCloseRxCollection:{after:e=>Vf(e)},postRemoveRxDatabase:{after:e=>qf(e.storage,e.databaseName,"")},postRemoveRxCollection:{after:e=>qf(e.storage,e.databaseName,e.collectionName)}},overwritable:{}},PE=new WeakMap,OE={name:"migration-schema",rxdb:!0,init(){fl(TE)},hooks:{preCloseRxDatabase:{after:CE}},prototypes:{RxDatabase:e=>{e.migrationStates=function(){return Uv(this).pipe(io(Za))}},RxCollection:e=>{e.getMigrationState=function(){return ln(PE,this,()=>new kE(this.asRxCollection,this.migrationStrategies))},e.migrationNeeded=function(){return this.schema.version===0?Pn:Wv(this.getMigrationState())}}}},AE=OE;fl(AE);const di={type:"string",maxLength:100},$E={version:0,primaryKey:"id",type:"object",properties:{id:di,date:{type:"string",maxLength:10},amount:{type:"number"},originalDescription:{type:"string"},memo:{type:"string"},merchantId:{type:"string",maxLength:100},accountId:{type:"string",maxLength:100},tagIds:{type:"array",items:{type:"string"}}},required:["id","date","amount","originalDescription","tagIds"],indexes:["date"]},LE={version:0,primaryKey:"id",type:"object",properties:{id:di,name:{type:"string",maxLength:200},icon:{type:"string"},color:{type:"string"}},required:["id","name"],indexes:["name"]},NE={version:0,primaryKey:"id",type:"object",properties:{id:di,name:{type:"string",maxLength:200}},required:["id","name"],indexes:["name"]},FE={version:0,primaryKey:"id",type:"object",properties:{id:di,name:{type:"string"},type:{type:"string"}},required:["id","name"]},BE={version:0,primaryKey:"id",type:"object",properties:{id:di,logic:{type:"string"},conditions:{type:"array",items:{type:"object",properties:{field:{type:"string"},operator:{type:"string"},value:{type:"string"}}}},merchantId:{type:"string"},tagIds:{type:"array",items:{type:"string"}}},required:["id","logic","conditions","tagIds"]},jE={version:0,primaryKey:"id",type:"object",properties:{id:di,title:{type:"string"},chartType:{type:"string"},granularity:{type:"string"},startDate:{type:"string"},endDate:{type:"string"},tagId:{type:"string"},merchantId:{type:"string"},position:{type:"number"},colSpan:{type:"number"},rowSpan:{type:"number"},excludedTagIds:{type:"array",items:{type:"string"}},excludedMerchantIds:{type:"array",items:{type:"string"}},direction:{type:"string"},descriptionFilter:{type:"string"},descriptionFilterMode:{type:"string"},legendPosition:{type:"string"},filters:{type:"array",items:{type:"object",properties:{field:{type:"string"},operator:{type:"string"},value:{type:"string"}}}}},required:["id","title","chartType","granularity","position"]},zE={version:0,primaryKey:"id",type:"object",properties:{id:di,title:{type:"string"},model:{type:"string"},columns:{type:"array",items:{type:"string"}},position:{type:"number"},colSpan:{type:"number"},rowSpan:{type:"number"}},required:["id","title","model","columns","position"]},WE={version:0,primaryKey:"id",type:"object",properties:{id:di,value:{type:"number"}},required:["id","value"]},HE={version:0,primaryKey:"id",type:"object",properties:{id:di,data:{type:"string"}},required:["id"]};class jn{#t;constructor(t){this.#t=t}get rxCollection(){return this.#t}async get(t){const n=await this.#t.findOne(t).exec();if(!n)throw new Error(`Document not found: ${t}`);return n.toJSON(!0)}async put(t){return await this.#t.upsert(t),{id:t.id}}async bulkDocs(t){await this.#t.bulkUpsert(t)}async remove(t){const n=await this.#t.findOne(t).exec();n&&await n.remove()}async find(t){return(await this.#t.find(t).exec()).map(i=>i.toJSON(!0))}async all(){return(await this.#t.find().exec()).map(n=>n.toJSON(!0))}async clear(){const t=await this.#t.find().exec();await Promise.all(t.map(n=>n.remove()))}async count(){return this.#t.count().exec()}}async function UE(e){const n=new TextEncoder().encode(e);if(typeof crypto<"u"&&crypto.subtle?.digest){const r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s,a=>a.toString(16).padStart(2,"0")).join("")}let i=2166136261;for(let r=0;r<n.length;r++)i^=n[r],i=Math.imul(i,16777619);return(i>>>0).toString(16).padStart(8,"0")}async function VE(e,t="budgee"){const n=await ek({name:t,storage:e,hashFunction:UE});return await n.addCollections({transactions:{schema:$E},tags:{schema:LE},merchants:{schema:NE},accounts:{schema:FE},merchant_rules:{schema:BE},dashboard_charts:{schema:jE},dashboard_tables:{schema:zE},meta:{schema:WE},backups:{schema:HE}}),{rxdb:n,transactions:new jn(n.transactions),tags:new jn(n.tags),merchants:new jn(n.merchants),accounts:new jn(n.accounts),merchantRules:new jn(n.merchant_rules),dashboardCharts:new jn(n.dashboard_charts),dashboardTables:new jn(n.dashboard_tables),meta:new jn(n.meta),backups:new jn(n.backups)}}async function qE(){const{getRxStorageDexie:e}=await cs(async()=>{const{getRxStorageDexie:t}=await import("./index-BrM2K1B5.js");return{getRxStorageDexie:t}},[]);return VE(e())}const KE=qE().then(e=>e);function ht(){return KE}function Pe(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=[...e].map(n=>n.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}function Zi(e){if(!e)return{docs:[],idMap:new Map};const t=new Map;return{docs:e.map(i=>{if(i.id)return i;const s=String(i._id??""),a=Pe();return s&&t.set(s,a),{...i,id:a}}),idMap:t}}function Ws(e,t){return t&&(e.get(t)??t)}function So(e,t){return t&&t.map(n=>e.get(n)??n)}async function Kv(e){const t=await e.text(),n=JSON.parse(t),{migrateExport:i,LATEST_VERSION:r}=await cs(async()=>{const{migrateExport:C,LATEST_VERSION:_}=await Promise.resolve().then(()=>cM);return{migrateExport:C,LATEST_VERSION:_}},void 0),s=i(n),a=await ht();await a.transactions.clear(),await a.tags.clear(),await a.merchants.clear(),await a.accounts.clear(),await a.merchantRules.clear(),await a.dashboardCharts.clear(),await a.dashboardTables.clear();const{docs:o,idMap:c}=Zi(s.tags),{docs:l,idMap:h}=Zi(s.merchants),{docs:u,idMap:d}=Zi(s.accounts),p=c.size>0||h.size>0||d.size>0,{docs:g}=Zi(s.transactions),{docs:m}=Zi(s.merchantRules),{docs:b}=Zi(s.dashboardCharts),{docs:w}=Zi(s.dashboardTables);if(p){for(const C of g)C.merchantId=Ws(h,C.merchantId),C.accountId=Ws(d,C.accountId),C.tagIds=So(c,C.tagIds)??C.tagIds;for(const C of m)C.merchantId=Ws(h,C.merchantId),C.tagIds=So(c,C.tagIds)??C.tagIds;for(const C of b)C.tagId=Ws(c,C.tagId),C.merchantId=Ws(h,C.merchantId),C.excludedTagIds=So(c,C.excludedTagIds),C.excludedMerchantIds=So(h,C.excludedMerchantIds)}g.length&&await a.transactions.bulkDocs(g),o.length&&await a.tags.bulkDocs(o),l.length&&await a.merchants.bulkDocs(l),u.length&&await a.accounts.bulkDocs(u),m.length&&await a.merchantRules.bulkDocs(m),b.length&&await a.dashboardCharts.bulkDocs(b),w.length&&await a.dashboardTables.bulkDocs(w);try{const C=await a.meta.get("schema_version");await a.meta.put({...C,value:r})}catch{await a.meta.put({id:"schema_version",value:r})}}const Yv=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-bird"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M16 7h.01" />
  <path d="M3.4 18H12a8 8 0 0 0 8-8V7a4 4 0 0 0-7.28-2.3L2 20" />
  <path d="m20 7 2 .5-2 .5" />
  <path d="M10 18v3" />
  <path d="M14 17.75V21" />
  <path d="M7 18a6 6 0 0 0 3.84-10.61" />
</svg>
`;var YE=Object.defineProperty,XE=Object.getOwnPropertyDescriptor,Xv=(e,t,n,i)=>{for(var r=i>1?void 0:i?XE(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&YE(t,n,r),r};let $c=class extends $t{constructor(){super(...arguments),this.message=""}render(){return F`
      <div class="icon">${ye(Yv)}</div>
      <div class="message">${this.message}</div>
    `}};$c.styles=Bt`
    :host {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      gap: 1rem;
    }

    .icon {
      animation: pulse 1.2s ease-in-out infinite;
    }

    .icon svg {
      width: 3rem;
      height: 3rem;
      color: white;
    }

    .message {
      color: white;
      font-size: 1.25rem;
      font-weight: 600;
      font-family: sans-serif;
    }

    @keyframes pulse {
      0%,
      100% {
        transform: scale(1);
        opacity: 0.7;
      }
      50% {
        transform: scale(1.15);
        opacity: 1;
      }
    }
  `;Xv([pt()],$c.prototype,"message",2);$c=Xv([Ut("budgee-loading-overlay")],$c);let Ci=null;function dd(e){if(Ci){Ci.message=e;return}Ci=document.createElement("budgee-loading-overlay"),Ci.message=e,document.body.appendChild(Ci)}function fd(){Ci&&(Ci.remove(),Ci=null)}const rh="BudgeeDatabase",Gv=["tags","merchants","accounts"],GE=[...Gv,"transactions","merchantRules","dashboardCharts","dashboardTables"];function QE(e){return new Promise((t,n)=>{const i=indexedDB.open(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)})}function JE(e,t){return new Promise((n,i)=>{if(!e.objectStoreNames.contains(t)){n([]);return}const a=e.transaction(t,"readonly").objectStore(t).getAll();a.onsuccess=()=>n(a.result??[]),a.onerror=()=>i(a.error)})}function Qv(e){return new Promise(t=>{const n=indexedDB.open(e);let i=!0;n.onupgradeneeded=()=>{i=!1},n.onsuccess=()=>{n.result.close(),i||indexedDB.deleteDatabase(e),t(i)},n.onerror=()=>t(!1)})}async function ZE(){if(!await Qv(rh))return null;const t=await QE(rh),n={};for(const i of GE)n[i]=await JE(t,i);return t.close(),{version:0,...n}}function tM(){indexedDB.deleteDatabase(rh)}function Hs(e,t){if(typeof t=="number")return e.get(t)}function Co(e,t){return Array.isArray(t)?t.map(n=>e.get(n)).filter(n=>n!=null):[]}function Jv(e){const t=e,n={};for(const u of Gv){const d=new Map;for(const p of t[u]??[])d.set(p.id,Pe());n[u]=d}const i=(u,d)=>u.map(p=>{const{id:g,...m}=p;return{...m,id:d.get(g)}}),r=i(t.tags??[],n.tags),s=i(t.merchants??[],n.merchants),a=i(t.accounts??[],n.accounts),o=(t.transactions??[]).map(u=>{const{id:d,merchantId:p,accountId:g,tagIds:m,...b}=u;return{...b,id:Pe(),merchantId:Hs(n.merchants,p),accountId:Hs(n.accounts,g),tagIds:Co(n.tags,m)}}),c=(t.merchantRules??[]).map(u=>{const{id:d,merchantId:p,tagIds:g,...m}=u;return{...m,id:Pe(),merchantId:Hs(n.merchants,p),tagIds:Co(n.tags,g)}}),l=(t.dashboardCharts??[]).map(u=>{const{id:d,tagId:p,merchantId:g,excludedTagIds:m,excludedMerchantIds:b,...w}=u;return{...w,id:Pe(),tagId:Hs(n.tags,p),merchantId:Hs(n.merchants,g),excludedTagIds:Co(n.tags,m),excludedMerchantIds:Co(n.merchants,b)}}),h=(t.dashboardTables??[]).map(u=>{const{id:d,...p}=u;return{...p,id:Pe()}});return{version:1,transactions:o,tags:r,merchants:s,accounts:a,merchantRules:c,dashboardCharts:l,dashboardTables:h}}const eM=Object.freeze(Object.defineProperty({__proto__:null,databaseExists:Qv,deleteDexieDatabase:tM,migrateV0toV1:Jv,readDexieData:ZE},Symbol.toStringTag,{value:"Module"})),Zv=[Jv],_r=Zv.length;function t0(e){let t=e.version??1,n=e;for(;t<_r;)n=Zv[t](n),t=n.version??t+1;return n}async function nM(e){return{version:_r,transactions:await e.transactions.all(),tags:await e.tags.all(),merchants:await e.merchants.all(),accounts:await e.accounts.all(),merchantRules:await e.merchantRules.all(),dashboardCharts:await e.dashboardCharts.all(),dashboardTables:await e.dashboardTables.all()}}async function iM(e,t){const n=`backup_${new Date().toISOString()}`;await e.backups.put({id:n,data:JSON.stringify(t)}),await rM(e,10)}async function rM(e,t){const n=await e.backups.all();if(n.length<=t)return;const r=n.sort((s,a)=>a.id.localeCompare(s.id)).slice(t);for(const s of r)await e.backups.remove(s.id)}async function sM(e){try{return(await e.meta.get("schema_version")).value}catch{return null}}async function aM(e,t){await e.meta.put({id:"schema_version",value:t})}async function oM(e,t){await e.transactions.clear(),await e.tags.clear(),await e.merchants.clear(),await e.accounts.clear(),await e.merchantRules.clear(),await e.dashboardCharts.clear(),await e.dashboardTables.clear(),t.transactions?.length&&await e.transactions.bulkDocs(t.transactions),t.tags?.length&&await e.tags.bulkDocs(t.tags),t.merchants?.length&&await e.merchants.bulkDocs(t.merchants),t.accounts?.length&&await e.accounts.bulkDocs(t.accounts),t.merchantRules?.length&&await e.merchantRules.bulkDocs(t.merchantRules),t.dashboardCharts?.length&&await e.dashboardCharts.bulkDocs(t.dashboardCharts),t.dashboardTables?.length&&await e.dashboardTables.bulkDocs(t.dashboardTables)}async function e0(e){const{readDexieData:t,deleteDexieDatabase:n}=await cs(async()=>{const{readDexieData:a,deleteDexieDatabase:o}=await Promise.resolve().then(()=>eM);return{readDexieData:a,deleteDexieDatabase:o}},void 0),i=await t(),r=await sM(e);if(!i&&r!=null&&r>=_r)return;let s;i?(s=i,console.log("[migrate] Found Dexie data at version 0")):(s=await nM(e),s.version=r??1,console.log(`[migrate] Current data at version ${s.version}`)),(s.version??1)<_r&&(await iM(e,s),console.log("[migrate] Backup saved"),s=t0(s),console.log(`[migrate] Migrated to version ${s.version}`),await oM(e,s)),await aM(e,_r),i&&(n(),console.log("[migrate] Dexie database deleted")),console.log("[migrate] Migration complete")}const cM=Object.freeze(Object.defineProperty({__proto__:null,LATEST_VERSION:_r,migrateDatabase:e0,migrateExport:t0},Symbol.toStringTag,{value:"Module"}));var n0=new WeakMap,lM=new WeakMap;function Zf(e){return ln(lM,e,()=>Bv(e))}function uM(){var e=jv(this.storage.name,this.token,this.name,this),t=this.close.bind(this);this.close=function(){return nh(this.token,this),t()};var n=Zf(e);return n||(n=Zf(e),n0.set(this,n)),this.leaderElector=()=>n,n}function hM(){return this.multiInstance?this.leaderElector().isLeader:!0}function dM(){return this.multiInstance?this.leaderElector().awaitLeadership().then(()=>!0):Uh}function fM(e){var t=n0.get(e);t&&t.die()}var pM=!0,gM={RxDatabase:e=>{e.leaderElector=uM,e.isLeader=hM,e.waitForLeadership=dM}},i0={name:"leader-election",rxdb:pM,prototypes:gM,hooks:{preCloseRxDatabase:{after:fM}}},tp=e=>Promise.resolve(e);function ep(e,t){if(e==="_deleted")return t;t=qt(t);var n=!!t._deleted;return t[e]=n,delete t._deleted,t}function tu(e,t,n){return n.map(i=>{var r=qt(i);if(t!=="_deleted"){var s=!!r[t];r._deleted=s,delete r[t]}else r._deleted=!!r._deleted;var a=e.schema.primaryPath;return r[a]=qi(e.schema.jsonSchema,r),r})}function np(e,t){if(typeof window>"u"||typeof window!="object"||typeof window.addEventListener>"u"||navigator.onLine)return e.promiseWait(t);var n,i=new Promise(r=>{n=()=>{window.removeEventListener("online",n),r()},window.addEventListener("online",n)});return Promise.race([i,e.promiseWait(t)]).then(()=>{window.removeEventListener("online",n)})}function mM(e){function t(){if(!(typeof document>"u"||typeof document.dispatchEvent!="function")){var i=new Event("mousemove");document.dispatchEvent(i)}}var n=setInterval(t,20*1e3);e.onCancel.push(()=>clearInterval(n))}var vM=new WeakMap,bM=(function(){function e(n,i,r,s,a,o,c,l,h){this.subs=[],this.subjects={received:new ie,sent:new ie,error:new ie,canceled:new mn(!1),active:new mn(!1)},this.received$=this.subjects.received.asObservable(),this.sent$=this.subjects.sent.asObservable(),this.error$=this.subjects.error.asObservable(),this.canceled$=this.subjects.canceled.asObservable(),this.active$=this.subjects.active.asObservable(),this.wasStarted=!1,this.startQueue=Ge,this.onCancel=[],this.callOnStart=void 0,this.remoteEvents$=new ie,this.replicationIdentifier=n,this.collection=i,this.deletedField=r,this.pull=s,this.push=a,this.live=o,this.retryTime=c,this.autoStart=l,this.toggleOnDocumentVisible=h,this.metaInfoPromise=(async()=>{var p="rx-replication-meta-"+await i.database.hashFunction([this.collection.name,this.replicationIdentifier].join("-")),g=Ju(this.collection.schema.jsonSchema,Mc(this.collection.schema.jsonSchema));return{collectionName:p,schema:g}})();var u=ln(vM,i,()=>[]);u.push(this),this.collection.onClose.push(()=>this.cancel()),Object.keys(this.subjects).forEach(p=>{Object.defineProperty(this,p+"$",{get:function(){return this.subjects[p].asObservable()}})});var d=new Promise(p=>{this.callOnStart=p});this.startPromise=d}var t=e.prototype;return t.start=function(){return this.startQueue=this.startQueue.then(()=>this._start()),this.startQueue},t._start=async function(){if(!this.isStopped()){if(this.internalReplicationState&&this.internalReplicationState.events.paused.next(!1),this.wasStarted){this.reSync();return}this.wasStarted=!0,this.toggleOnDocumentVisible||mM(this);var i=this.pull&&this.pull.modifier?this.pull.modifier:tp,r=this.push&&this.push.modifier?this.push.modifier:tp,s=this.collection.database,a=await this.metaInfoPromise,[o]=await Promise.all([this.collection.database.storage.createStorageInstance({databaseName:s.name,collectionName:a.collectionName,databaseInstanceToken:s.token,multiInstance:s.multiInstance,options:{},schema:a.schema,password:s.password,devMode:zt.isDevMode()}),hv(this.collection,a.collectionName,a.schema)]);this.metaInstance=o,this.internalReplicationState=xv({pushBatchSize:this.push&&this.push.batchSize?this.push.batchSize:100,pullBatchSize:this.pull&&this.pull.batchSize?this.pull.batchSize:100,initialCheckpoint:{upstream:this.push?this.push.initialCheckpoint:void 0,downstream:this.pull?this.pull.initialCheckpoint:void 0},forkInstance:this.collection.storageInstance,metaInstance:this.metaInstance,hashFunction:s.hashFunction,identifier:"rxdbreplication"+this.replicationIdentifier,conflictHandler:this.collection.conflictHandler,replicationHandler:{masterChangeStream$:this.remoteEvents$.asObservable().pipe(wt(c=>!!this.pull),On(async c=>{if(c==="RESYNC")return c;var l=qt(c);return l.documents=tu(this.collection,this.deletedField,l.documents),l.documents=await Promise.all(l.documents.map(h=>i(h))),l})),masterChangesSince:async(c,l)=>{if(!this.pull)return{checkpoint:null,documents:[]};for(var h=!1,u={};!h&&!this.isStoppedOrPaused();)try{u=await this.pull.handler(c,l),h=!0}catch(g){var d=et("RC_PULL",{checkpoint:c,errors:$u(g).map(m=>Bu(m)),direction:"pull"});this.subjects.error.next(d),await np(this.collection,it(this.retryTime))}if(this.isStoppedOrPaused())return{checkpoint:null,documents:[]};var p=qt(u);return p.documents=tu(this.collection,this.deletedField,p.documents),p.documents=await Promise.all(p.documents.map(g=>i(g))),p},masterWrite:async c=>{if(!this.push)return[];var l=!1;await Cr("preReplicationMasterWrite",{rows:c,collection:this.collection});var h=await Promise.all(c.map(async m=>(m.newDocumentState=await r(m.newDocumentState),m.newDocumentState===null?null:(m.assumedMasterState&&(m.assumedMasterState=await r(m.assumedMasterState)),this.deletedField!=="_deleted"&&(m.newDocumentState=ep(this.deletedField,m.newDocumentState),m.assumedMasterState&&(m.assumedMasterState=ep(this.deletedField,m.assumedMasterState))),m)))),u=h.filter(E1),d=null;for(u.length===0&&(l=!0,d=[]);!l&&!this.isStoppedOrPaused();)try{if(d=await this.push.handler(u),!Array.isArray(d))throw et("RC_PUSH_NO_AR",{pushRows:c,direction:"push",args:{result:d}});l=!0}catch(m){var p=m.rxdb?m:et("RC_PUSH",{pushRows:c,errors:$u(m).map(b=>Bu(b)),direction:"push"});this.subjects.error.next(p),await np(this.collection,it(this.retryTime))}if(this.isStoppedOrPaused())return[];await Cr("preReplicationMasterWriteDocumentsHandle",{result:d,collection:this.collection});var g=tu(this.collection,this.deletedField,it(d));return g}}}),this.subs.push(this.internalReplicationState.events.error.subscribe(c=>{this.subjects.error.next(c)}),this.internalReplicationState.events.processed.down.subscribe(c=>this.subjects.received.next(c.document)),this.internalReplicationState.events.processed.up.subscribe(c=>{this.subjects.sent.next(c.newDocumentState)}),Pm([this.internalReplicationState.events.active.down,this.internalReplicationState.events.active.up]).subscribe(([c,l])=>{var h=c||l;this.subjects.active.next(h)})),this.pull&&this.pull.stream$&&this.live&&this.subs.push(this.pull.stream$.subscribe({next:c=>{this.isStoppedOrPaused()||this.remoteEvents$.next(c)},error:c=>{this.subjects.error.next(c)}})),this.live||(await Go(this.internalReplicationState),await th(this.internalReplicationState),await this._cancel()),this.callOnStart()}},t.pause=function(){return this.startQueue=this.startQueue.then(()=>{this.internalReplicationState&&this.internalReplicationState.events.paused.next(!0)}),this.startQueue},t.isPaused=function(){return!!(this.internalReplicationState&&this.internalReplicationState.events.paused.getValue())},t.isStopped=function(){return!!this.subjects.canceled.getValue()},t.isStoppedOrPaused=function(){return this.isPaused()||this.isStopped()},t.awaitInitialReplication=async function(){return await this.startPromise,Go(it(this.internalReplicationState))},t.awaitInSync=async function(){await this.startPromise,await Go(it(this.internalReplicationState));for(var i=2;i>0;)i--,await this.collection.database.requestIdlePromise(),await th(it(this.internalReplicationState));return!0},t.reSync=function(){this.remoteEvents$.next("RESYNC")},t.emitEvent=function(i){this.remoteEvents$.next(i)},t.cancel=async function(){this.startQueue=this.startQueue.catch(()=>{}).then(async()=>{await this._cancel()}),await this.startQueue},t._cancel=async function(i=!1){if(this.isStopped())return Pn;var r=this.onCancel.map(s=>om(s()));return this.internalReplicationState&&await Cv(this.internalReplicationState),this.metaInstance&&!i&&r.push(it(this.internalReplicationState).checkpointQueue.then(()=>it(this.metaInstance).close())),this.subs.forEach(s=>s.unsubscribe()),this.subjects.canceled.next(!0),this.subjects.active.complete(),this.subjects.canceled.complete(),this.subjects.error.complete(),this.subjects.received.complete(),this.subjects.sent.complete(),Promise.all(r)},t.remove=async function(){return this.startQueue=this.startQueue.then(async()=>{var i=await this.metaInfoPromise;await this._cancel(!0),await it(this.internalReplicationState).checkpointQueue.then(()=>it(this.metaInstance).remove()),await FC(this.collection,i.collectionName,i.schema)}),this.startQueue},e})();function _M({replicationIdentifier:e,collection:t,deletedField:n="_deleted",pull:i,push:r,live:s=!0,retryTime:a=1e3*5,waitForLeadership:o=!0,autoStart:c=!0,toggleOnDocumentVisible:l=!1}){if(fl(i0),!i&&!r)throw et("UT3",{collection:t.name,args:{replicationIdentifier:e}});var h=new bM(e,t,n,i,r,s,a,c,l);if(l&&typeof document<"u"&&typeof document.addEventListener=="function"&&typeof document.visibilityState=="string"){var u=()=>{if(!h.isStopped()){var d=document.visibilityState==="visible";d?h.start():t.database.isLeader()||h.pause()}};document.addEventListener("visibilitychange",u),h.onCancel.push(()=>document.removeEventListener("visibilitychange",u))}return yM(o,h),h}function yM(e,t){var n=e&&t.collection.database.multiInstance,i=n?t.collection.database.waitForLeadership():Uh;return i.then(()=>{t.isStopped()||t.autoStart&&t.start()})}async function wM(e,t,n){var i=await e([t,n].join("|"))>await e([n,t].join("|"));return i}function eu(e,t,n){var i=n.id,r=Jn(e.response$.pipe(wt(s=>s.peer===t),wt(s=>s.response.id===i),Jt(s=>s.response)));return e.send(t,n),r}var Cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function r0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ko(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nu={exports:{}},ip;function xM(){return ip||(ip=1,(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,i=Math.abs,r=Math.pow;return(function(){function s(a,o,c){function l(d,p){if(!o[d]){if(!a[d]){var g=typeof ko=="function"&&ko;if(!p&&g)return g(d,!0);if(h)return h(d,!0);var m=new Error("Cannot find module '"+d+"'");throw m.code="MODULE_NOT_FOUND",m}var b=o[d]={exports:{}};a[d][0].call(b.exports,function(w){var C=a[d][1][w];return l(C||w)},b,b.exports,s,a,o,c)}return o[d].exports}for(var h=typeof ko=="function"&&ko,u=0;u<c.length;u++)l(c[u]);return l}return s})()({1:[function(s,a,o){function c(k){var x=k.length;if(0<x%4)throw new Error("Invalid string. Length must be a multiple of 4");var I=k.indexOf("=");I===-1&&(I=x);var E=I===x?0:4-I%4;return[I,E]}function l(k,x,I){return 3*(x+I)/4-I}function h(k){var x,I,E=c(k),y=E[0],M=E[1],D=new b(l(k,y,M)),R=0,P=0<M?y-4:y;for(I=0;I<P;I+=4)x=m[k.charCodeAt(I)]<<18|m[k.charCodeAt(I+1)]<<12|m[k.charCodeAt(I+2)]<<6|m[k.charCodeAt(I+3)],D[R++]=255&x>>16,D[R++]=255&x>>8,D[R++]=255&x;return M===2&&(x=m[k.charCodeAt(I)]<<2|m[k.charCodeAt(I+1)]>>4,D[R++]=255&x),M===1&&(x=m[k.charCodeAt(I)]<<10|m[k.charCodeAt(I+1)]<<4|m[k.charCodeAt(I+2)]>>2,D[R++]=255&x>>8,D[R++]=255&x),D}function u(k){return g[63&k>>18]+g[63&k>>12]+g[63&k>>6]+g[63&k]}function d(k,x,I){for(var E,y=[],M=x;M<I;M+=3)E=(16711680&k[M]<<16)+(65280&k[M+1]<<8)+(255&k[M+2]),y.push(u(E));return y.join("")}function p(k){for(var x,I=k.length,E=I%3,y=[],M=16383,D=0,R=I-E;D<R;D+=M)y.push(d(k,D,D+M>R?R:D+M));return E===1?(x=k[I-1],y.push(g[x>>2]+g[63&x<<4]+"==")):E===2&&(x=(k[I-2]<<8)+k[I-1],y.push(g[x>>10]+g[63&x>>4]+g[63&x<<2]+"=")),y.join("")}o.byteLength=function(k){var x=c(k),I=x[0],E=x[1];return 3*(I+E)/4-E},o.toByteArray=h,o.fromByteArray=p;for(var g=[],m=[],b=typeof Uint8Array>"u"?Array:Uint8Array,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=0,_=w.length;C<_;++C)g[C]=w[C],m[w.charCodeAt(C)]=C;m[45]=62,m[95]=63},{}],2:[function(){},{}],3:[function(s,a,o){(function(){(function(){var c=String.fromCharCode,l=Math.min;function h(f){if(2147483647<f)throw new RangeError('The value "'+f+'" is invalid for option "size"');var v=new Uint8Array(f);return v.__proto__=u.prototype,v}function u(f,v,S){if(typeof f=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(f)}return d(f,v,S)}function d(f,v,S){if(typeof f=="string")return b(f,v);if(ArrayBuffer.isView(f))return w(f);if(f==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);if($(f,ArrayBuffer)||f&&$(f.buffer,ArrayBuffer))return C(f,v,S);if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var O=f.valueOf&&f.valueOf();if(O!=null&&O!==f)return u.from(O,v,S);var A=_(f);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof f[Symbol.toPrimitive]=="function")return u.from(f[Symbol.toPrimitive]("string"),v,S);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f)}function p(f){if(typeof f!="number")throw new TypeError('"size" argument must be of type number');if(0>f)throw new RangeError('The value "'+f+'" is invalid for option "size"')}function g(f,v,S){return p(f),0>=f||v===void 0?h(f):typeof S=="string"?h(f).fill(v,S):h(f).fill(v)}function m(f){return p(f),h(0>f?0:0|k(f))}function b(f,v){if((typeof v!="string"||v==="")&&(v="utf8"),!u.isEncoding(v))throw new TypeError("Unknown encoding: "+v);var S=0|x(f,v),O=h(S),A=O.write(f,v);return A!==S&&(O=O.slice(0,A)),O}function w(f){for(var v=0>f.length?0:0|k(f.length),S=h(v),O=0;O<v;O+=1)S[O]=255&f[O];return S}function C(f,v,S){if(0>v||f.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<v+(S||0))throw new RangeError('"length" is outside of buffer bounds');var O;return O=v===void 0&&S===void 0?new Uint8Array(f):S===void 0?new Uint8Array(f,v):new Uint8Array(f,v,S),O.__proto__=u.prototype,O}function _(f){if(u.isBuffer(f)){var v=0|k(f.length),S=h(v);return S.length===0||f.copy(S,0,0,v),S}return f.length===void 0?f.type==="Buffer"&&Array.isArray(f.data)?w(f.data):void 0:typeof f.length!="number"||L(f.length)?h(0):w(f)}function k(f){if(f>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|f}function x(f,v){if(u.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||$(f,ArrayBuffer))return f.byteLength;if(typeof f!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);var S=f.length,O=2<arguments.length&&arguments[2]===!0;if(!O&&S===0)return 0;for(var A=!1;;)switch(v){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":return Ot(f).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*S;case"hex":return S>>>1;case"base64":return Tt(f).length;default:if(A)return O?-1:Ot(f).length;v=(""+v).toLowerCase(),A=!0}}function I(f,v,S){var O=!1;if((v===void 0||0>v)&&(v=0),v>this.length||((S===void 0||S>this.length)&&(S=this.length),0>=S)||(S>>>=0,v>>>=0,S<=v))return"";for(f||(f="utf8");;)switch(f){case"hex":return G(this,v,S);case"utf8":case"utf-8":return K(this,v,S);case"ascii":return j(this,v,S);case"latin1":case"binary":return nt(this,v,S);case"base64":return Y(this,v,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tt(this,v,S);default:if(O)throw new TypeError("Unknown encoding: "+f);f=(f+"").toLowerCase(),O=!0}}function E(f,v,S){var O=f[v];f[v]=f[S],f[S]=O}function y(f,v,S,O,A){if(f.length===0)return-1;if(typeof S=="string"?(O=S,S=0):2147483647<S?S=2147483647:-2147483648>S&&(S=-2147483648),S=+S,L(S)&&(S=A?0:f.length-1),0>S&&(S=f.length+S),S>=f.length){if(A)return-1;S=f.length-1}else if(0>S)if(A)S=0;else return-1;if(typeof v=="string"&&(v=u.from(v,O)),u.isBuffer(v))return v.length===0?-1:M(f,v,S,O,A);if(typeof v=="number")return v&=255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(f,v,S):Uint8Array.prototype.lastIndexOf.call(f,v,S):M(f,[v],S,O,A);throw new TypeError("val must be string, number or Buffer")}function M(f,v,S,O,A){function B(nn,vi){return Q===1?nn[vi]:nn.readUInt16BE(vi*Q)}var Q=1,rt=f.length,Mt=v.length;if(O!==void 0&&(O=(O+"").toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(2>f.length||2>v.length)return-1;Q=2,rt/=2,Mt/=2,S/=2}var vt;if(A){var bt=-1;for(vt=S;vt<rt;vt++)if(B(f,vt)!==B(v,bt===-1?0:vt-bt))bt!==-1&&(vt-=vt-bt),bt=-1;else if(bt===-1&&(bt=vt),vt-bt+1===Mt)return bt*Q}else for(S+Mt>rt&&(S=rt-Mt),vt=S;0<=vt;vt--){for(var Kt=!0,fe=0;fe<Mt;fe++)if(B(f,vt+fe)!==B(v,fe)){Kt=!1;break}if(Kt)return vt}return-1}function D(f,v,S,O){S=+S||0;var A=f.length-S;O?(O=+O,O>A&&(O=A)):O=A;var B=v.length;O>B/2&&(O=B/2);for(var Q,rt=0;rt<O;++rt){if(Q=parseInt(v.substr(2*rt,2),16),L(Q))return rt;f[S+rt]=Q}return rt}function R(f,v,S,O){return yt(Ot(v,f.length-S),f,S,O)}function P(f,v,S,O){return yt(st(v),f,S,O)}function N(f,v,S,O){return P(f,v,S,O)}function U(f,v,S,O){return yt(Tt(v),f,S,O)}function H(f,v,S,O){return yt(Rt(v,f.length-S),f,S,O)}function Y(f,v,S){return v===0&&S===f.length?V.fromByteArray(f):V.fromByteArray(f.slice(v,S))}function K(f,v,S){S=l(f.length,S);for(var O=[],A=v;A<S;){var B=f[A],Q=null,rt=239<B?4:223<B?3:191<B?2:1;if(A+rt<=S){var Mt,vt,bt,Kt;rt===1?128>B&&(Q=B):rt===2?(Mt=f[A+1],(192&Mt)==128&&(Kt=(31&B)<<6|63&Mt,127<Kt&&(Q=Kt))):rt===3?(Mt=f[A+1],vt=f[A+2],(192&Mt)==128&&(192&vt)==128&&(Kt=(15&B)<<12|(63&Mt)<<6|63&vt,2047<Kt&&(55296>Kt||57343<Kt)&&(Q=Kt))):rt===4&&(Mt=f[A+1],vt=f[A+2],bt=f[A+3],(192&Mt)==128&&(192&vt)==128&&(192&bt)==128&&(Kt=(15&B)<<18|(63&Mt)<<12|(63&vt)<<6|63&bt,65535<Kt&&1114112>Kt&&(Q=Kt)))}Q===null?(Q=65533,rt=1):65535<Q&&(Q-=65536,O.push(55296|1023&Q>>>10),Q=56320|1023&Q),O.push(Q),A+=rt}return Z(O)}function Z(f){var v=f.length;if(v<=4096)return c.apply(String,f);for(var S="",O=0;O<v;)S+=c.apply(String,f.slice(O,O+=4096));return S}function j(f,v,S){var O="";S=l(f.length,S);for(var A=v;A<S;++A)O+=c(127&f[A]);return O}function nt(f,v,S){var O="";S=l(f.length,S);for(var A=v;A<S;++A)O+=c(f[A]);return O}function G(f,v,S){var O=f.length;(!v||0>v)&&(v=0),(!S||0>S||S>O)&&(S=O);for(var A="",B=v;B<S;++B)A+=_t(f[B]);return A}function tt(f,v,S){for(var O=f.slice(v,S),A="",B=0;B<O.length;B+=2)A+=c(O[B]+256*O[B+1]);return A}function z(f,v,S){if(f%1!=0||0>f)throw new RangeError("offset is not uint");if(f+v>S)throw new RangeError("Trying to access beyond buffer length")}function J(f,v,S,O,A,B){if(!u.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>A||v<B)throw new RangeError('"value" argument is out of bounds');if(S+O>f.length)throw new RangeError("Index out of range")}function lt(f,v,S,O){if(S+O>f.length)throw new RangeError("Index out of range");if(0>S)throw new RangeError("Index out of range")}function St(f,v,S,O,A){return v=+v,S>>>=0,A||lt(f,v,S,4),q.write(f,v,S,O,23,4),S+4}function ee(f,v,S,O,A){return v=+v,S>>>=0,A||lt(f,v,S,8),q.write(f,v,S,O,52,8),S+8}function mt(f){if(f=f.split("=")[0],f=f.trim().replace(T,""),2>f.length)return"";for(;f.length%4!=0;)f+="=";return f}function _t(f){return 16>f?"0"+f.toString(16):f.toString(16)}function Ot(f,v){v=v||1/0;for(var S,O=f.length,A=null,B=[],Q=0;Q<O;++Q){if(S=f.charCodeAt(Q),55295<S&&57344>S){if(!A){if(56319<S){-1<(v-=3)&&B.push(239,191,189);continue}else if(Q+1===O){-1<(v-=3)&&B.push(239,191,189);continue}A=S;continue}if(56320>S){-1<(v-=3)&&B.push(239,191,189),A=S;continue}S=(A-55296<<10|S-56320)+65536}else A&&-1<(v-=3)&&B.push(239,191,189);if(A=null,128>S){if(0>(v-=1))break;B.push(S)}else if(2048>S){if(0>(v-=2))break;B.push(192|S>>6,128|63&S)}else if(65536>S){if(0>(v-=3))break;B.push(224|S>>12,128|63&S>>6,128|63&S)}else if(1114112>S){if(0>(v-=4))break;B.push(240|S>>18,128|63&S>>12,128|63&S>>6,128|63&S)}else throw new Error("Invalid code point")}return B}function st(f){for(var v=[],S=0;S<f.length;++S)v.push(255&f.charCodeAt(S));return v}function Rt(f,v){for(var S,O,A,B=[],Q=0;Q<f.length&&!(0>(v-=2));++Q)S=f.charCodeAt(Q),O=S>>8,A=S%256,B.push(A),B.push(O);return B}function Tt(f){return V.toByteArray(mt(f))}function yt(f,v,S,O){for(var A=0;A<O&&!(A+S>=v.length||A>=f.length);++A)v[A+S]=f[A];return A}function $(f,v){return f instanceof v||f!=null&&f.constructor!=null&&f.constructor.name!=null&&f.constructor.name===v.name}function L(f){return f!==f}var V=s("base64-js"),q=s("ieee754");o.Buffer=u,o.SlowBuffer=function(f){return+f!=f&&(f=0),u.alloc(+f)},o.INSPECT_MAX_BYTES=50,o.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=(function(){try{var f=new Uint8Array(1);return f.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},f.foo()===42}catch{return!1}})(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(f,v,S){return d(f,v,S)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(f,v,S){return g(f,v,S)},u.allocUnsafe=function(f){return m(f)},u.allocUnsafeSlow=function(f){return m(f)},u.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==u.prototype},u.compare=function(f,v){if($(f,Uint8Array)&&(f=u.from(f,f.offset,f.byteLength)),$(v,Uint8Array)&&(v=u.from(v,v.offset,v.byteLength)),!u.isBuffer(f)||!u.isBuffer(v))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===v)return 0;for(var S=f.length,O=v.length,A=0,B=l(S,O);A<B;++A)if(f[A]!==v[A]){S=f[A],O=v[A];break}return S<O?-1:O<S?1:0},u.isEncoding=function(f){switch((f+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(f,v){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return u.alloc(0);var S;if(v===void 0)for(v=0,S=0;S<f.length;++S)v+=f[S].length;var O=u.allocUnsafe(v),A=0;for(S=0;S<f.length;++S){var B=f[S];if($(B,Uint8Array)&&(B=u.from(B)),!u.isBuffer(B))throw new TypeError('"list" argument must be an Array of Buffers');B.copy(O,A),A+=B.length}return O},u.byteLength=x,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var f=this.length;if(f%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var v=0;v<f;v+=2)E(this,v,v+1);return this},u.prototype.swap32=function(){var f=this.length;if(f%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var v=0;v<f;v+=4)E(this,v,v+3),E(this,v+1,v+2);return this},u.prototype.swap64=function(){var f=this.length;if(f%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var v=0;v<f;v+=8)E(this,v,v+7),E(this,v+1,v+6),E(this,v+2,v+5),E(this,v+3,v+4);return this},u.prototype.toString=function(){var f=this.length;return f===0?"":arguments.length===0?K(this,0,f):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(f){if(!u.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f||u.compare(this,f)===0},u.prototype.inspect=function(){var f="",v=o.INSPECT_MAX_BYTES;return f=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(f+=" ... "),"<Buffer "+f+">"},u.prototype.compare=function(f,v,S,O,A){if($(f,Uint8Array)&&(f=u.from(f,f.offset,f.byteLength)),!u.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(v===void 0&&(v=0),S===void 0&&(S=f?f.length:0),O===void 0&&(O=0),A===void 0&&(A=this.length),0>v||S>f.length||0>O||A>this.length)throw new RangeError("out of range index");if(O>=A&&v>=S)return 0;if(O>=A)return-1;if(v>=S)return 1;if(v>>>=0,S>>>=0,O>>>=0,A>>>=0,this===f)return 0;for(var B=A-O,Q=S-v,rt=l(B,Q),Mt=this.slice(O,A),vt=f.slice(v,S),bt=0;bt<rt;++bt)if(Mt[bt]!==vt[bt]){B=Mt[bt],Q=vt[bt];break}return B<Q?-1:Q<B?1:0},u.prototype.includes=function(f,v,S){return this.indexOf(f,v,S)!==-1},u.prototype.indexOf=function(f,v,S){return y(this,f,v,S,!0)},u.prototype.lastIndexOf=function(f,v,S){return y(this,f,v,S,!1)},u.prototype.write=function(f,v,S,O){if(v===void 0)O="utf8",S=this.length,v=0;else if(S===void 0&&typeof v=="string")O=v,S=this.length,v=0;else if(isFinite(v))v>>>=0,isFinite(S)?(S>>>=0,O===void 0&&(O="utf8")):(O=S,S=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var A=this.length-v;if((S===void 0||S>A)&&(S=A),0<f.length&&(0>S||0>v)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(var B=!1;;)switch(O){case"hex":return D(this,f,v,S);case"utf8":case"utf-8":return R(this,f,v,S);case"ascii":return P(this,f,v,S);case"latin1":case"binary":return N(this,f,v,S);case"base64":return U(this,f,v,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,f,v,S);default:if(B)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),B=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(f,v){var S=this.length;f=~~f,v=v===void 0?S:~~v,0>f?(f+=S,0>f&&(f=0)):f>S&&(f=S),0>v?(v+=S,0>v&&(v=0)):v>S&&(v=S),v<f&&(v=f);var O=this.subarray(f,v);return O.__proto__=u.prototype,O},u.prototype.readUIntLE=function(f,v,S){f>>>=0,v>>>=0,S||z(f,v,this.length);for(var O=this[f],A=1,B=0;++B<v&&(A*=256);)O+=this[f+B]*A;return O},u.prototype.readUIntBE=function(f,v,S){f>>>=0,v>>>=0,S||z(f,v,this.length);for(var O=this[f+--v],A=1;0<v&&(A*=256);)O+=this[f+--v]*A;return O},u.prototype.readUInt8=function(f,v){return f>>>=0,v||z(f,1,this.length),this[f]},u.prototype.readUInt16LE=function(f,v){return f>>>=0,v||z(f,2,this.length),this[f]|this[f+1]<<8},u.prototype.readUInt16BE=function(f,v){return f>>>=0,v||z(f,2,this.length),this[f]<<8|this[f+1]},u.prototype.readUInt32LE=function(f,v){return f>>>=0,v||z(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+16777216*this[f+3]},u.prototype.readUInt32BE=function(f,v){return f>>>=0,v||z(f,4,this.length),16777216*this[f]+(this[f+1]<<16|this[f+2]<<8|this[f+3])},u.prototype.readIntLE=function(f,v,S){f>>>=0,v>>>=0,S||z(f,v,this.length);for(var O=this[f],A=1,B=0;++B<v&&(A*=256);)O+=this[f+B]*A;return A*=128,O>=A&&(O-=r(2,8*v)),O},u.prototype.readIntBE=function(f,v,S){f>>>=0,v>>>=0,S||z(f,v,this.length);for(var O=v,A=1,B=this[f+--O];0<O&&(A*=256);)B+=this[f+--O]*A;return A*=128,B>=A&&(B-=r(2,8*v)),B},u.prototype.readInt8=function(f,v){return f>>>=0,v||z(f,1,this.length),128&this[f]?-1*(255-this[f]+1):this[f]},u.prototype.readInt16LE=function(f,v){f>>>=0,v||z(f,2,this.length);var S=this[f]|this[f+1]<<8;return 32768&S?4294901760|S:S},u.prototype.readInt16BE=function(f,v){f>>>=0,v||z(f,2,this.length);var S=this[f+1]|this[f]<<8;return 32768&S?4294901760|S:S},u.prototype.readInt32LE=function(f,v){return f>>>=0,v||z(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},u.prototype.readInt32BE=function(f,v){return f>>>=0,v||z(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},u.prototype.readFloatLE=function(f,v){return f>>>=0,v||z(f,4,this.length),q.read(this,f,!0,23,4)},u.prototype.readFloatBE=function(f,v){return f>>>=0,v||z(f,4,this.length),q.read(this,f,!1,23,4)},u.prototype.readDoubleLE=function(f,v){return f>>>=0,v||z(f,8,this.length),q.read(this,f,!0,52,8)},u.prototype.readDoubleBE=function(f,v){return f>>>=0,v||z(f,8,this.length),q.read(this,f,!1,52,8)},u.prototype.writeUIntLE=function(f,v,S,O){if(f=+f,v>>>=0,S>>>=0,!O){var A=r(2,8*S)-1;J(this,f,v,S,A,0)}var B=1,Q=0;for(this[v]=255&f;++Q<S&&(B*=256);)this[v+Q]=255&f/B;return v+S},u.prototype.writeUIntBE=function(f,v,S,O){if(f=+f,v>>>=0,S>>>=0,!O){var A=r(2,8*S)-1;J(this,f,v,S,A,0)}var B=S-1,Q=1;for(this[v+B]=255&f;0<=--B&&(Q*=256);)this[v+B]=255&f/Q;return v+S},u.prototype.writeUInt8=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,1,255,0),this[v]=255&f,v+1},u.prototype.writeUInt16LE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,2,65535,0),this[v]=255&f,this[v+1]=f>>>8,v+2},u.prototype.writeUInt16BE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,2,65535,0),this[v]=f>>>8,this[v+1]=255&f,v+2},u.prototype.writeUInt32LE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,4,4294967295,0),this[v+3]=f>>>24,this[v+2]=f>>>16,this[v+1]=f>>>8,this[v]=255&f,v+4},u.prototype.writeUInt32BE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,4,4294967295,0),this[v]=f>>>24,this[v+1]=f>>>16,this[v+2]=f>>>8,this[v+3]=255&f,v+4},u.prototype.writeIntLE=function(f,v,S,O){if(f=+f,v>>>=0,!O){var A=r(2,8*S-1);J(this,f,v,S,A-1,-A)}var B=0,Q=1,rt=0;for(this[v]=255&f;++B<S&&(Q*=256);)0>f&&rt===0&&this[v+B-1]!==0&&(rt=1),this[v+B]=255&(f/Q>>0)-rt;return v+S},u.prototype.writeIntBE=function(f,v,S,O){if(f=+f,v>>>=0,!O){var A=r(2,8*S-1);J(this,f,v,S,A-1,-A)}var B=S-1,Q=1,rt=0;for(this[v+B]=255&f;0<=--B&&(Q*=256);)0>f&&rt===0&&this[v+B+1]!==0&&(rt=1),this[v+B]=255&(f/Q>>0)-rt;return v+S},u.prototype.writeInt8=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,1,127,-128),0>f&&(f=255+f+1),this[v]=255&f,v+1},u.prototype.writeInt16LE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,2,32767,-32768),this[v]=255&f,this[v+1]=f>>>8,v+2},u.prototype.writeInt16BE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,2,32767,-32768),this[v]=f>>>8,this[v+1]=255&f,v+2},u.prototype.writeInt32LE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,4,2147483647,-2147483648),this[v]=255&f,this[v+1]=f>>>8,this[v+2]=f>>>16,this[v+3]=f>>>24,v+4},u.prototype.writeInt32BE=function(f,v,S){return f=+f,v>>>=0,S||J(this,f,v,4,2147483647,-2147483648),0>f&&(f=4294967295+f+1),this[v]=f>>>24,this[v+1]=f>>>16,this[v+2]=f>>>8,this[v+3]=255&f,v+4},u.prototype.writeFloatLE=function(f,v,S){return St(this,f,v,!0,S)},u.prototype.writeFloatBE=function(f,v,S){return St(this,f,v,!1,S)},u.prototype.writeDoubleLE=function(f,v,S){return ee(this,f,v,!0,S)},u.prototype.writeDoubleBE=function(f,v,S){return ee(this,f,v,!1,S)},u.prototype.copy=function(f,v,S,O){if(!u.isBuffer(f))throw new TypeError("argument should be a Buffer");if(S||(S=0),O||O===0||(O=this.length),v>=f.length&&(v=f.length),v||(v=0),0<O&&O<S&&(O=S),O===S||f.length===0||this.length===0)return 0;if(0>v)throw new RangeError("targetStart out of bounds");if(0>S||S>=this.length)throw new RangeError("Index out of range");if(0>O)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),f.length-v<O-S&&(O=f.length-v+S);var A=O-S;if(this===f&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(v,S,O);else if(this===f&&S<v&&v<O)for(var B=A-1;0<=B;--B)f[B+v]=this[B+S];else Uint8Array.prototype.set.call(f,this.subarray(S,O),v);return A},u.prototype.fill=function(f,v,S,O){if(typeof f=="string"){if(typeof v=="string"?(O=v,v=0,S=this.length):typeof S=="string"&&(O=S,S=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!u.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(f.length===1){var A=f.charCodeAt(0);(O==="utf8"&&128>A||O==="latin1")&&(f=A)}}else typeof f=="number"&&(f&=255);if(0>v||this.length<v||this.length<S)throw new RangeError("Out of range index");if(S<=v)return this;v>>>=0,S=S===void 0?this.length:S>>>0,f||(f=0);var B;if(typeof f=="number")for(B=v;B<S;++B)this[B]=f;else{var Q=u.isBuffer(f)?f:u.from(f,O),rt=Q.length;if(rt===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(B=0;B<S-v;++B)this[B+v]=Q[B%rt]}return this};var T=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,s("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(s,a,o){(function(c){(function(){function l(){let u;try{u=o.storage.getItem("debug")}catch{}return!u&&typeof c<"u"&&"env"in c&&(u=c.env.DEBUG),u}o.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;u.splice(1,0,d,"color: inherit");let p=0,g=0;u[0].replace(/%[a-zA-Z%]/g,m=>{m==="%%"||(p++,m==="%c"&&(g=p))}),u.splice(g,0,d)},o.save=function(u){try{u?o.storage.setItem("debug",u):o.storage.removeItem("debug")}catch{}},o.load=l,o.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},o.storage=(function(){try{return localStorage}catch{}})(),o.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.log=console.debug||console.log||(()=>{}),a.exports=s("./common")(o);const{formatters:h}=a.exports;h.j=function(u){try{return JSON.stringify(u)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,s("_process"))},{"./common":5,_process:12}],5:[function(s,a){a.exports=function(o){function c(u){function d(...m){if(!d.enabled)return;const b=d,w=+new Date,C=w-(p||w);b.diff=C,b.prev=p,b.curr=w,p=w,m[0]=c.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let _=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(x,I)=>{if(x==="%%")return"%";_++;const E=c.formatters[I];if(typeof E=="function"){const y=m[_];x=E.call(b,y),m.splice(_,1),_--}return x}),c.formatArgs.call(b,m),(b.log||c.log).apply(b,m)}let p,g=null;return d.namespace=u,d.useColors=c.useColors(),d.color=c.selectColor(u),d.extend=l,d.destroy=c.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>g===null?c.enabled(u):g,set:m=>{g=m}}),typeof c.init=="function"&&c.init(d),d}function l(u,d){const p=c(this.namespace+(typeof d>"u"?":":d)+u);return p.log=this.log,p}function h(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return c.debug=c,c.default=c,c.coerce=function(u){return u instanceof Error?u.stack||u.message:u},c.disable=function(){const u=[...c.names.map(h),...c.skips.map(h).map(d=>"-"+d)].join(",");return c.enable(""),u},c.enable=function(u){c.save(u),c.names=[],c.skips=[];let d;const p=(typeof u=="string"?u:"").split(/[\s,]+/),g=p.length;for(d=0;d<g;d++)p[d]&&(u=p[d].replace(/\*/g,".*?"),u[0]==="-"?c.skips.push(new RegExp("^"+u.substr(1)+"$")):c.names.push(new RegExp("^"+u+"$")))},c.enabled=function(u){if(u[u.length-1]==="*")return!0;let d,p;for(d=0,p=c.skips.length;d<p;d++)if(c.skips[d].test(u))return!1;for(d=0,p=c.names.length;d<p;d++)if(c.names[d].test(u))return!0;return!1},c.humanize=s("ms"),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(o).forEach(u=>{c[u]=o[u]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(u){let d=0;for(let p=0;p<u.length;p++)d=(d<<5)-d+u.charCodeAt(p),d|=0;return c.colors[i(d)%c.colors.length]},c.enable(c.load()),c}},{ms:11}],6:[function(s,a){function o(c,l){for(const h in l)Object.defineProperty(c,h,{value:l[h],enumerable:!0,configurable:!0});return c}a.exports=function(c,l,h){if(!c||typeof c=="string")throw new TypeError("Please pass an Error to err-code");h||(h={}),typeof l=="object"&&(h=l,l=""),l&&(h.code=l);try{return o(c,h)}catch{h.message=c.message,h.stack=c.stack;const d=function(){};return d.prototype=Object.create(Object.getPrototypeOf(c)),o(new d,h)}}},{}],7:[function(s,a){function o(D){console&&console.warn&&console.warn(D)}function c(){c.init.call(this)}function l(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}function h(D){return D._maxListeners===void 0?c.defaultMaxListeners:D._maxListeners}function u(D,R,P,N){var U,H,Y;if(l(P),H=D._events,H===void 0?(H=D._events=Object.create(null),D._eventsCount=0):(H.newListener!==void 0&&(D.emit("newListener",R,P.listener?P.listener:P),H=D._events),Y=H[R]),Y===void 0)Y=H[R]=P,++D._eventsCount;else if(typeof Y=="function"?Y=H[R]=N?[P,Y]:[Y,P]:N?Y.unshift(P):Y.push(P),U=h(D),0<U&&Y.length>U&&!Y.warned){Y.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+Y.length+" "+(R+" listeners added. Use emitter.setMaxListeners() to increase limit"));K.name="MaxListenersExceededWarning",K.emitter=D,K.type=R,K.count=Y.length,o(K)}return D}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(D,R,P){var N={fired:!1,wrapFn:void 0,target:D,type:R,listener:P},U=d.bind(N);return U.listener=P,N.wrapFn=U,U}function g(D,R,P){var N=D._events;if(N===void 0)return[];var U=N[R];return U===void 0?[]:typeof U=="function"?P?[U.listener||U]:[U]:P?C(U):b(U,U.length)}function m(D){var R=this._events;if(R!==void 0){var P=R[D];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}function b(D,R){for(var P=Array(R),N=0;N<R;++N)P[N]=D[N];return P}function w(D,R){for(;R+1<D.length;R++)D[R]=D[R+1];D.pop()}function C(D){for(var R=Array(D.length),P=0;P<R.length;++P)R[P]=D[P].listener||D[P];return R}function _(D,R,P){typeof D.on=="function"&&k(D,"error",R,P)}function k(D,R,P,N){if(typeof D.on=="function")N.once?D.once(R,P):D.on(R,P);else if(typeof D.addEventListener=="function")D.addEventListener(R,function U(H){N.once&&D.removeEventListener(R,U),P(H)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof D)}var x,I=typeof Reflect=="object"?Reflect:null,E=I&&typeof I.apply=="function"?I.apply:function(D,R,P){return Function.prototype.apply.call(D,R,P)};x=I&&typeof I.ownKeys=="function"?I.ownKeys:Object.getOwnPropertySymbols?function(D){return Object.getOwnPropertyNames(D).concat(Object.getOwnPropertySymbols(D))}:function(D){return Object.getOwnPropertyNames(D)};var y=Number.isNaN||function(D){return D!==D};a.exports=c,a.exports.once=function(D,R){return new Promise(function(P,N){function U(Y){D.removeListener(R,H),N(Y)}function H(){typeof D.removeListener=="function"&&D.removeListener("error",U),P([].slice.call(arguments))}k(D,R,H,{once:!0}),R!=="error"&&_(D,U,{once:!0})})},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var M=10;Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return M},set:function(D){if(typeof D!="number"||0>D||y(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");M=D}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(D){if(typeof D!="number"||0>D||y(D))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+D+".");return this._maxListeners=D,this},c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(D){for(var R=[],P=1;P<arguments.length;P++)R.push(arguments[P]);var N=D==="error",U=this._events;if(U!==void 0)N=N&&U.error===void 0;else if(!N)return!1;if(N){var H;if(0<R.length&&(H=R[0]),H instanceof Error)throw H;var Y=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw Y.context=H,Y}var K=U[D];if(K===void 0)return!1;if(typeof K=="function")E(K,this,R);else for(var Z=K.length,j=b(K,Z),P=0;P<Z;++P)E(j[P],this,R);return!0},c.prototype.addListener=function(D,R){return u(this,D,R,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(D,R){return u(this,D,R,!0)},c.prototype.once=function(D,R){return l(R),this.on(D,p(this,D,R)),this},c.prototype.prependOnceListener=function(D,R){return l(R),this.prependListener(D,p(this,D,R)),this},c.prototype.removeListener=function(D,R){var P,N,U,H,Y;if(l(R),N=this._events,N===void 0)return this;if(P=N[D],P===void 0)return this;if(P===R||P.listener===R)--this._eventsCount==0?this._events=Object.create(null):(delete N[D],N.removeListener&&this.emit("removeListener",D,P.listener||R));else if(typeof P!="function"){for(U=-1,H=P.length-1;0<=H;H--)if(P[H]===R||P[H].listener===R){Y=P[H].listener,U=H;break}if(0>U)return this;U===0?P.shift():w(P,U),P.length===1&&(N[D]=P[0]),N.removeListener!==void 0&&this.emit("removeListener",D,Y||R)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(D){var R,P,N;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[D]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete P[D]),this;if(arguments.length===0){var U,H=Object.keys(P);for(N=0;N<H.length;++N)U=H[N],U!=="removeListener"&&this.removeAllListeners(U);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=P[D],typeof R=="function")this.removeListener(D,R);else if(R!==void 0)for(N=R.length-1;0<=N;N--)this.removeListener(D,R[N]);return this},c.prototype.listeners=function(D){return g(this,D,!0)},c.prototype.rawListeners=function(D){return g(this,D,!1)},c.listenerCount=function(D,R){return typeof D.listenerCount=="function"?D.listenerCount(R):m.call(D,R)},c.prototype.listenerCount=m,c.prototype.eventNames=function(){return 0<this._eventsCount?x(this._events):[]}},{}],8:[function(s,a){a.exports=function(){if(typeof globalThis>"u")return null;var o={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return o.RTCPeerConnection?o:null}},{}],9:[function(s,a,o){o.read=function(c,l,h,u,d){var p,g,m=8*d-u-1,b=(1<<m)-1,w=b>>1,C=-7,_=h?d-1:0,k=h?-1:1,x=c[l+_];for(_+=k,p=x&(1<<-C)-1,x>>=-C,C+=m;0<C;p=256*p+c[l+_],_+=k,C-=8);for(g=p&(1<<-C)-1,p>>=-C,C+=u;0<C;g=256*g+c[l+_],_+=k,C-=8);if(p===0)p=1-w;else{if(p===b)return g?NaN:(x?-1:1)*(1/0);g+=r(2,u),p-=w}return(x?-1:1)*g*r(2,p-u)},o.write=function(c,l,h,u,d,p){var g,m,b,w=Math.LN2,C=Math.log,_=8*p-d-1,k=(1<<_)-1,x=k>>1,I=d===23?r(2,-24)-r(2,-77):0,E=u?0:p-1,y=u?1:-1,M=0>l||l===0&&0>1/l?1:0;for(l=i(l),isNaN(l)||l===1/0?(m=isNaN(l)?1:0,g=k):(g=n(C(l)/w),1>l*(b=r(2,-g))&&(g--,b*=2),l+=1<=g+x?I/b:I*r(2,1-x),2<=l*b&&(g++,b/=2),g+x>=k?(m=0,g=k):1<=g+x?(m=(l*b-1)*r(2,d),g+=x):(m=l*r(2,x-1)*r(2,d),g=0));8<=d;c[h+E]=255&m,E+=y,m/=256,d-=8);for(g=g<<d|m,_+=d;0<_;c[h+E]=255&g,E+=y,g/=256,_-=8);c[h+E-y]|=128*M}},{}],10:[function(s,a){a.exports=typeof Object.create=="function"?function(o,c){c&&(o.super_=c,o.prototype=Object.create(c.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,c){if(c){o.super_=c;var l=function(){};l.prototype=c.prototype,o.prototype=new l,o.prototype.constructor=o}}},{}],11:[function(s,a){var o=Math.round;function c(d){if(d+="",!(100<d.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(p){var g=parseFloat(p[1]),m=(p[2]||"ms").toLowerCase();return m==="years"||m==="year"||m==="yrs"||m==="yr"||m==="y"?315576e5*g:m==="weeks"||m==="week"||m==="w"?6048e5*g:m==="days"||m==="day"||m==="d"?864e5*g:m==="hours"||m==="hour"||m==="hrs"||m==="hr"||m==="h"?36e5*g:m==="minutes"||m==="minute"||m==="mins"||m==="min"||m==="m"?6e4*g:m==="seconds"||m==="second"||m==="secs"||m==="sec"||m==="s"?1e3*g:m==="milliseconds"||m==="millisecond"||m==="msecs"||m==="msec"||m==="ms"?g:void 0}}}function l(d){var p=i(d);return 864e5<=p?o(d/864e5)+"d":36e5<=p?o(d/36e5)+"h":6e4<=p?o(d/6e4)+"m":1e3<=p?o(d/1e3)+"s":d+"ms"}function h(d){var p=i(d);return 864e5<=p?u(d,p,864e5,"day"):36e5<=p?u(d,p,36e5,"hour"):6e4<=p?u(d,p,6e4,"minute"):1e3<=p?u(d,p,1e3,"second"):d+" ms"}function u(d,p,g,m){return o(d/g)+" "+m+(p>=1.5*g?"s":"")}a.exports=function(d,p){p=p||{};var g=typeof d;if(g=="string"&&0<d.length)return c(d);if(g==="number"&&isFinite(d))return p.long?h(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(s,a){function o(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function l(I){if(m===setTimeout)return setTimeout(I,0);if((m===o||!m)&&setTimeout)return m=setTimeout,setTimeout(I,0);try{return m(I,0)}catch{try{return m.call(null,I,0)}catch{return m.call(this,I,0)}}}function h(I){if(b===clearTimeout)return clearTimeout(I);if((b===c||!b)&&clearTimeout)return b=clearTimeout,clearTimeout(I);try{return b(I)}catch{try{return b.call(null,I)}catch{return b.call(this,I)}}}function u(){k&&C&&(k=!1,C.length?_=C.concat(_):x=-1,_.length&&d())}function d(){if(!k){var I=l(u);k=!0;for(var E=_.length;E;){for(C=_,_=[];++x<E;)C&&C[x].run();x=-1,E=_.length}C=null,k=!1,h(I)}}function p(I,E){this.fun=I,this.array=E}function g(){}var m,b,w=a.exports={};(function(){try{m=typeof setTimeout=="function"?setTimeout:o}catch{m=o}try{b=typeof clearTimeout=="function"?clearTimeout:c}catch{b=c}})();var C,_=[],k=!1,x=-1;w.nextTick=function(I){var E=Array(arguments.length-1);if(1<arguments.length)for(var y=1;y<arguments.length;y++)E[y-1]=arguments[y];_.push(new p(I,E)),_.length!==1||k||l(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=g,w.addListener=g,w.once=g,w.off=g,w.removeListener=g,w.removeAllListeners=g,w.emit=g,w.prependListener=g,w.prependOnceListener=g,w.listeners=function(){return[]},w.binding=function(){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],13:[function(s,a){(function(o){(function(){let c;a.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?o:window):l=>(c||(c=Promise.resolve())).then(l).catch(h=>setTimeout(()=>{throw h},0))}).call(this)}).call(this,typeof Cn>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Cn)},{}],14:[function(s,a){(function(o,c){(function(){var l=s("safe-buffer").Buffer,h=c.crypto||c.msCrypto;a.exports=h&&h.getRandomValues?function(u,d){if(u>4294967295)throw new RangeError("requested too many random bytes");var p=l.allocUnsafe(u);if(0<u)if(65536<u)for(var g=0;g<u;g+=65536)h.getRandomValues(p.slice(g,g+65536));else h.getRandomValues(p);return typeof d=="function"?o.nextTick(function(){d(null,p)}):p}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,s("_process"),typeof Cn>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Cn)},{_process:12,"safe-buffer":30}],15:[function(s,a){function o(g,m){g.prototype=Object.create(m.prototype),g.prototype.constructor=g,g.__proto__=m}function c(g,m,b){function w(_,k,x){return typeof m=="string"?m:m(_,k,x)}b||(b=Error);var C=(function(_){function k(x,I,E){return _.call(this,w(x,I,E))||this}return o(k,_),k})(b);C.prototype.name=b.name,C.prototype.code=g,p[g]=C}function l(g,m){if(Array.isArray(g)){var b=g.length;return g=g.map(function(w){return w+""}),2<b?"one of ".concat(m," ").concat(g.slice(0,b-1).join(", "),", or ")+g[b-1]:b===2?"one of ".concat(m," ").concat(g[0]," or ").concat(g[1]):"of ".concat(m," ").concat(g[0])}return"of ".concat(m," ").concat(g+"")}function h(g,m,b){return g.substr(0,m.length)===m}function u(g,m,b){return(b===void 0||b>g.length)&&(b=g.length),g.substring(b-m.length,b)===m}function d(g,m,b){return typeof b!="number"&&(b=0),!(b+m.length>g.length)&&g.indexOf(m,b)!==-1}var p={};c("ERR_INVALID_OPT_VALUE",function(g,m){return'The value "'+m+'" is invalid for option "'+g+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(g,m,b){var w;typeof m=="string"&&h(m,"not ")?(w="must not be",m=m.replace(/^not /,"")):w="must be";var C;if(u(g," argument"))C="The ".concat(g," ").concat(w," ").concat(l(m,"type"));else{var _=d(g,".")?"property":"argument";C='The "'.concat(g,'" ').concat(_," ").concat(w," ").concat(l(m,"type"))}return C+=". Received type ".concat(typeof b),C},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(g){return"The "+g+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(g){return"Cannot call "+g+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(g){return"Unknown encoding: "+g},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=p},{}],16:[function(s,a){(function(o){(function(){function c(w){return this instanceof c?(d.call(this,w),p.call(this,w),this.allowHalfOpen=!0,void(w&&(w.readable===!1&&(this.readable=!1),w.writable===!1&&(this.writable=!1),w.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",l))))):new c(w)}function l(){this._writableState.ended||o.nextTick(h,this)}function h(w){w.end()}var u=Object.keys||function(w){var C=[];for(var _ in w)C.push(_);return C};a.exports=c;var d=s("./_stream_readable"),p=s("./_stream_writable");s("inherits")(c,d);for(var g,m=u(p.prototype),b=0;b<m.length;b++)g=m[b],c.prototype[g]||(c.prototype[g]=p.prototype[g]);Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(w){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=w,this._writableState.destroyed=w)}})}).call(this)}).call(this,s("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(s,a){function o(l){return this instanceof o?void c.call(this,l):new o(l)}a.exports=o;var c=s("./_stream_transform");s("inherits")(o,c),o.prototype._transform=function(l,h,u){u(null,l)}},{"./_stream_transform":19,inherits:10}],18:[function(s,a){(function(o,c){(function(){function l(T){return tt.from(T)}function h(T){return tt.isBuffer(T)||T instanceof z}function u(T,f,v){return typeof T.prependListener=="function"?T.prependListener(f,v):void(T._events&&T._events[f]?Array.isArray(T._events[f])?T._events[f].unshift(v):T._events[f]=[v,T._events[f]]:T.on(f,v))}function d(T,f,v){Z=Z||s("./_stream_duplex"),T=T||{},typeof v!="boolean"&&(v=f instanceof Z),this.objectMode=!!T.objectMode,v&&(this.objectMode=this.objectMode||!!T.readableObjectMode),this.highWaterMark=st(this,T,"readableHighWaterMark",v),this.buffer=new mt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=T.emitClose!==!1,this.autoDestroy=!!T.autoDestroy,this.destroyed=!1,this.defaultEncoding=T.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,T.encoding&&(!lt&&(lt=s("string_decoder/").StringDecoder),this.decoder=new lt(T.encoding),this.encoding=T.encoding)}function p(T){if(Z=Z||s("./_stream_duplex"),!(this instanceof p))return new p(T);var f=this instanceof Z;this._readableState=new d(T,this,f),this.readable=!0,T&&(typeof T.read=="function"&&(this._read=T.read),typeof T.destroy=="function"&&(this._destroy=T.destroy)),G.call(this)}function g(T,f,v,S,O){j("readableAddChunk",f);var A=T._readableState;if(f===null)A.reading=!1,_(T,A);else{var B;if(O||(B=b(A,f)),B)V(T,B);else if(!(A.objectMode||f&&0<f.length))S||(A.reading=!1,I(T,A));else if(typeof f=="string"||A.objectMode||Object.getPrototypeOf(f)===tt.prototype||(f=l(f)),S)A.endEmitted?V(T,new L):m(T,A,f,!0);else if(A.ended)V(T,new yt);else{if(A.destroyed)return!1;A.reading=!1,A.decoder&&!v?(f=A.decoder.write(f),A.objectMode||f.length!==0?m(T,A,f,!1):I(T,A)):m(T,A,f,!1)}}return!A.ended&&(A.length<A.highWaterMark||A.length===0)}function m(T,f,v,S){f.flowing&&f.length===0&&!f.sync?(f.awaitDrain=0,T.emit("data",v)):(f.length+=f.objectMode?1:v.length,S?f.buffer.unshift(v):f.buffer.push(v),f.needReadable&&k(T)),I(T,f)}function b(T,f){var v;return h(f)||typeof f=="string"||f===void 0||T.objectMode||(v=new Tt("chunk",["string","Buffer","Uint8Array"],f)),v}function w(T){return 1073741824<=T?T=1073741824:(T--,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T++),T}function C(T,f){return 0>=T||f.length===0&&f.ended?0:f.objectMode?1:T===T?(T>f.highWaterMark&&(f.highWaterMark=w(T)),T<=f.length?T:f.ended?f.length:(f.needReadable=!0,0)):f.flowing&&f.length?f.buffer.head.data.length:f.length}function _(T,f){if(j("onEofChunk"),!f.ended){if(f.decoder){var v=f.decoder.end();v&&v.length&&(f.buffer.push(v),f.length+=f.objectMode?1:v.length)}f.ended=!0,f.sync?k(T):(f.needReadable=!1,!f.emittedReadable&&(f.emittedReadable=!0,x(T)))}}function k(T){var f=T._readableState;j("emitReadable",f.needReadable,f.emittedReadable),f.needReadable=!1,f.emittedReadable||(j("emitReadable",f.flowing),f.emittedReadable=!0,o.nextTick(x,T))}function x(T){var f=T._readableState;j("emitReadable_",f.destroyed,f.length,f.ended),!f.destroyed&&(f.length||f.ended)&&(T.emit("readable"),f.emittedReadable=!1),f.needReadable=!f.flowing&&!f.ended&&f.length<=f.highWaterMark,N(T)}function I(T,f){f.readingMore||(f.readingMore=!0,o.nextTick(E,T,f))}function E(T,f){for(;!f.reading&&!f.ended&&(f.length<f.highWaterMark||f.flowing&&f.length===0);){var v=f.length;if(j("maybeReadMore read 0"),T.read(0),v===f.length)break}f.readingMore=!1}function y(T){return function(){var f=T._readableState;j("pipeOnDrain",f.awaitDrain),f.awaitDrain&&f.awaitDrain--,f.awaitDrain===0&&nt(T,"data")&&(f.flowing=!0,N(T))}}function M(T){var f=T._readableState;f.readableListening=0<T.listenerCount("readable"),f.resumeScheduled&&!f.paused?f.flowing=!0:0<T.listenerCount("data")&&T.resume()}function D(T){j("readable nexttick read 0"),T.read(0)}function R(T,f){f.resumeScheduled||(f.resumeScheduled=!0,o.nextTick(P,T,f))}function P(T,f){j("resume",f.reading),f.reading||T.read(0),f.resumeScheduled=!1,T.emit("resume"),N(T),f.flowing&&!f.reading&&T.read(0)}function N(T){var f=T._readableState;for(j("flow",f.flowing);f.flowing&&T.read()!==null;);}function U(T,f){if(f.length===0)return null;var v;return f.objectMode?v=f.buffer.shift():!T||T>=f.length?(v=f.decoder?f.buffer.join(""):f.buffer.length===1?f.buffer.first():f.buffer.concat(f.length),f.buffer.clear()):v=f.buffer.consume(T,f.decoder),v}function H(T){var f=T._readableState;j("endReadable",f.endEmitted),f.endEmitted||(f.ended=!0,o.nextTick(Y,f,T))}function Y(T,f){if(j("endReadableNT",T.endEmitted,T.length),!T.endEmitted&&T.length===0&&(T.endEmitted=!0,f.readable=!1,f.emit("end"),T.autoDestroy)){var v=f._writableState;(!v||v.autoDestroy&&v.finished)&&f.destroy()}}function K(T,f){for(var v=0,S=T.length;v<S;v++)if(T[v]===f)return v;return-1}a.exports=p;var Z;p.ReadableState=d;var j;s("events").EventEmitter;var nt=function(T,f){return T.listeners(f).length},G=s("./internal/streams/stream"),tt=s("buffer").Buffer,z=c.Uint8Array||function(){},J=s("util");j=J&&J.debuglog?J.debuglog("stream"):function(){};var lt,St,ee,mt=s("./internal/streams/buffer_list"),_t=s("./internal/streams/destroy"),Ot=s("./internal/streams/state"),st=Ot.getHighWaterMark,Rt=s("../errors").codes,Tt=Rt.ERR_INVALID_ARG_TYPE,yt=Rt.ERR_STREAM_PUSH_AFTER_EOF,$=Rt.ERR_METHOD_NOT_IMPLEMENTED,L=Rt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s("inherits")(p,G);var V=_t.errorOrDestroy,q=["error","close","destroy","pause","resume"];Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(T){this._readableState&&(this._readableState.destroyed=T)}}),p.prototype.destroy=_t.destroy,p.prototype._undestroy=_t.undestroy,p.prototype._destroy=function(T,f){f(T)},p.prototype.push=function(T,f){var v,S=this._readableState;return S.objectMode?v=!0:typeof T=="string"&&(f=f||S.defaultEncoding,f!==S.encoding&&(T=tt.from(T,f),f=""),v=!0),g(this,T,f,!1,v)},p.prototype.unshift=function(T){return g(this,T,null,!0,!1)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(T){lt||(lt=s("string_decoder/").StringDecoder);var f=new lt(T);this._readableState.decoder=f,this._readableState.encoding=this._readableState.decoder.encoding;for(var v=this._readableState.buffer.head,S="";v!==null;)S+=f.write(v.data),v=v.next;return this._readableState.buffer.clear(),S!==""&&this._readableState.buffer.push(S),this._readableState.length=S.length,this},p.prototype.read=function(T){j("read",T),T=parseInt(T,10);var f=this._readableState,v=T;if(T!==0&&(f.emittedReadable=!1),T===0&&f.needReadable&&((f.highWaterMark===0?0<f.length:f.length>=f.highWaterMark)||f.ended))return j("read: emitReadable",f.length,f.ended),f.length===0&&f.ended?H(this):k(this),null;if(T=C(T,f),T===0&&f.ended)return f.length===0&&H(this),null;var S=f.needReadable;j("need readable",S),(f.length===0||f.length-T<f.highWaterMark)&&(S=!0,j("length less than watermark",S)),f.ended||f.reading?(S=!1,j("reading or ended",S)):S&&(j("do read"),f.reading=!0,f.sync=!0,f.length===0&&(f.needReadable=!0),this._read(f.highWaterMark),f.sync=!1,!f.reading&&(T=C(v,f)));var O;return O=0<T?U(T,f):null,O===null?(f.needReadable=f.length<=f.highWaterMark,T=0):(f.length-=T,f.awaitDrain=0),f.length===0&&(!f.ended&&(f.needReadable=!0),v!==T&&f.ended&&H(this)),O!==null&&this.emit("data",O),O},p.prototype._read=function(){V(this,new $("_read()"))},p.prototype.pipe=function(T,f){function v(qr,Kr){j("onunpipe"),qr===vt&&Kr&&Kr.hasUnpiped===!1&&(Kr.hasUnpiped=!0,O())}function S(){j("onend"),T.end()}function O(){j("cleanup"),T.removeListener("close",Q),T.removeListener("finish",rt),T.removeListener("drain",nn),T.removeListener("error",B),T.removeListener("unpipe",v),vt.removeListener("end",S),vt.removeListener("end",Mt),vt.removeListener("data",A),vi=!0,bt.awaitDrain&&(!T._writableState||T._writableState.needDrain)&&nn()}function A(qr){j("ondata");var Kr=T.write(qr);j("dest.write",Kr),Kr===!1&&((bt.pipesCount===1&&bt.pipes===T||1<bt.pipesCount&&K(bt.pipes,T)!==-1)&&!vi&&(j("false write response, pause",bt.awaitDrain),bt.awaitDrain++),vt.pause())}function B(qr){j("onerror",qr),Mt(),T.removeListener("error",B),nt(T,"error")===0&&V(T,qr)}function Q(){T.removeListener("finish",rt),Mt()}function rt(){j("onfinish"),T.removeListener("close",Q),Mt()}function Mt(){j("unpipe"),vt.unpipe(T)}var vt=this,bt=this._readableState;switch(bt.pipesCount){case 0:bt.pipes=T;break;case 1:bt.pipes=[bt.pipes,T];break;default:bt.pipes.push(T)}bt.pipesCount+=1,j("pipe count=%d opts=%j",bt.pipesCount,f);var Kt=(!f||f.end!==!1)&&T!==o.stdout&&T!==o.stderr,fe=Kt?S:Mt;bt.endEmitted?o.nextTick(fe):vt.once("end",fe),T.on("unpipe",v);var nn=y(vt);T.on("drain",nn);var vi=!1;return vt.on("data",A),u(T,"error",B),T.once("close",Q),T.once("finish",rt),T.emit("pipe",vt),bt.flowing||(j("pipe resume"),vt.resume()),T},p.prototype.unpipe=function(T){var f=this._readableState,v={hasUnpiped:!1};if(f.pipesCount===0)return this;if(f.pipesCount===1)return T&&T!==f.pipes?this:(T||(T=f.pipes),f.pipes=null,f.pipesCount=0,f.flowing=!1,T&&T.emit("unpipe",this,v),this);if(!T){var S=f.pipes,O=f.pipesCount;f.pipes=null,f.pipesCount=0,f.flowing=!1;for(var A=0;A<O;A++)S[A].emit("unpipe",this,{hasUnpiped:!1});return this}var B=K(f.pipes,T);return B===-1?this:(f.pipes.splice(B,1),f.pipesCount-=1,f.pipesCount===1&&(f.pipes=f.pipes[0]),T.emit("unpipe",this,v),this)},p.prototype.on=function(T,f){var v=G.prototype.on.call(this,T,f),S=this._readableState;return T==="data"?(S.readableListening=0<this.listenerCount("readable"),S.flowing!==!1&&this.resume()):T=="readable"&&!S.endEmitted&&!S.readableListening&&(S.readableListening=S.needReadable=!0,S.flowing=!1,S.emittedReadable=!1,j("on readable",S.length,S.reading),S.length?k(this):!S.reading&&o.nextTick(D,this)),v},p.prototype.addListener=p.prototype.on,p.prototype.removeListener=function(T,f){var v=G.prototype.removeListener.call(this,T,f);return T==="readable"&&o.nextTick(M,this),v},p.prototype.removeAllListeners=function(T){var f=G.prototype.removeAllListeners.apply(this,arguments);return(T==="readable"||T===void 0)&&o.nextTick(M,this),f},p.prototype.resume=function(){var T=this._readableState;return T.flowing||(j("resume"),T.flowing=!T.readableListening,R(this,T)),T.paused=!1,this},p.prototype.pause=function(){return j("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},p.prototype.wrap=function(T){var f=this,v=this._readableState,S=!1;for(var O in T.on("end",function(){if(j("wrapped end"),v.decoder&&!v.ended){var B=v.decoder.end();B&&B.length&&f.push(B)}f.push(null)}),T.on("data",function(B){if(j("wrapped data"),v.decoder&&(B=v.decoder.write(B)),!(v.objectMode&&B==null)&&(v.objectMode||B&&B.length)){var Q=f.push(B);Q||(S=!0,T.pause())}}),T)this[O]===void 0&&typeof T[O]=="function"&&(this[O]=(function(B){return function(){return T[B].apply(T,arguments)}})(O));for(var A=0;A<q.length;A++)T.on(q[A],this.emit.bind(this,q[A]));return this._read=function(B){j("wrapped _read",B),S&&(S=!1,T.resume())},this},typeof Symbol=="function"&&(p.prototype[Symbol.asyncIterator]=function(){return St===void 0&&(St=s("./internal/streams/async_iterator")),St(this)}),Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(p.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(p.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(T){this._readableState&&(this._readableState.flowing=T)}}),p._fromList=U,Object.defineProperty(p.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(p.from=function(T,f){return ee===void 0&&(ee=s("./internal/streams/from")),ee(p,T,f)})}).call(this)}).call(this,s("_process"),typeof Cn>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Cn)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(s,a){function o(w,C){var _=this._transformState;_.transforming=!1;var k=_.writecb;if(k===null)return this.emit("error",new p);_.writechunk=null,_.writecb=null,C!=null&&this.push(C),k(w);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function c(w){return this instanceof c?(b.call(this,w),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,w&&(typeof w.transform=="function"&&(this._transform=w.transform),typeof w.flush=="function"&&(this._flush=w.flush)),void this.on("prefinish",l)):new c(w)}function l(){var w=this;typeof this._flush!="function"||this._readableState.destroyed?h(this,null,null):this._flush(function(C,_){h(w,C,_)})}function h(w,C,_){if(C)return w.emit("error",C);if(_!=null&&w.push(_),w._writableState.length)throw new m;if(w._transformState.transforming)throw new g;return w.push(null)}a.exports=c;var u=s("../errors").codes,d=u.ERR_METHOD_NOT_IMPLEMENTED,p=u.ERR_MULTIPLE_CALLBACK,g=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,m=u.ERR_TRANSFORM_WITH_LENGTH_0,b=s("./_stream_duplex");s("inherits")(c,b),c.prototype.push=function(w,C){return this._transformState.needTransform=!1,b.prototype.push.call(this,w,C)},c.prototype._transform=function(w,C,_){_(new d("_transform()"))},c.prototype._write=function(w,C,_){var k=this._transformState;if(k.writecb=_,k.writechunk=w,k.writeencoding=C,!k.transforming){var x=this._readableState;(k.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},c.prototype._read=function(){var w=this._transformState;w.writechunk===null||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},c.prototype._destroy=function(w,C){b.prototype._destroy.call(this,w,function(_){C(_)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(s,a){(function(o,c){(function(){function l($){var L=this;this.next=null,this.entry=null,this.finish=function(){H(L,$)}}function h($){return j.from($)}function u($){return j.isBuffer($)||$ instanceof nt}function d(){}function p($,L,V){Y=Y||s("./_stream_duplex"),$=$||{},typeof V!="boolean"&&(V=L instanceof Y),this.objectMode=!!$.objectMode,V&&(this.objectMode=this.objectMode||!!$.writableObjectMode),this.highWaterMark=z(this,$,"writableHighWaterMark",V),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var q=$.decodeStrings===!1;this.decodeStrings=!q,this.defaultEncoding=$.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(T){I(L,T)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=$.emitClose!==!1,this.autoDestroy=!!$.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function g($){Y=Y||s("./_stream_duplex");var L=this instanceof Y;return L||yt.call(g,this)?(this._writableState=new p($,this,L),this.writable=!0,$&&(typeof $.write=="function"&&(this._write=$.write),typeof $.writev=="function"&&(this._writev=$.writev),typeof $.destroy=="function"&&(this._destroy=$.destroy),typeof $.final=="function"&&(this._final=$.final)),void Z.call(this)):new g($)}function m($,L){var V=new st;Tt($,V),o.nextTick(L,V)}function b($,L,V,q){var T;return V===null?T=new Ot:typeof V!="string"&&!L.objectMode&&(T=new lt("chunk",["string","Buffer"],V)),!T||(Tt($,T),o.nextTick(q,T),!1)}function w($,L,V){return $.objectMode||$.decodeStrings===!1||typeof L!="string"||(L=j.from(L,V)),L}function C($,L,V,q,T,f){if(!V){var v=w(L,q,T);q!==v&&(V=!0,T="buffer",q=v)}var S=L.objectMode?1:q.length;L.length+=S;var O=L.length<L.highWaterMark;if(O||(L.needDrain=!0),L.writing||L.corked){var A=L.lastBufferedRequest;L.lastBufferedRequest={chunk:q,encoding:T,isBuf:V,callback:f,next:null},A?A.next=L.lastBufferedRequest:L.bufferedRequest=L.lastBufferedRequest,L.bufferedRequestCount+=1}else _($,L,!1,S,q,T,f);return O}function _($,L,V,q,T,f,v){L.writelen=q,L.writecb=v,L.writing=!0,L.sync=!0,L.destroyed?L.onwrite(new _t("write")):V?$._writev(T,L.onwrite):$._write(T,f,L.onwrite),L.sync=!1}function k($,L,V,q,T){--L.pendingcb,V?(o.nextTick(T,q),o.nextTick(N,$,L),$._writableState.errorEmitted=!0,Tt($,q)):(T(q),$._writableState.errorEmitted=!0,Tt($,q),N($,L))}function x($){$.writing=!1,$.writecb=null,$.length-=$.writelen,$.writelen=0}function I($,L){var V=$._writableState,q=V.sync,T=V.writecb;if(typeof T!="function")throw new ee;if(x(V),L)k($,V,q,L,T);else{var f=D(V)||$.destroyed;f||V.corked||V.bufferProcessing||!V.bufferedRequest||M($,V),q?o.nextTick(E,$,V,f,T):E($,V,f,T)}}function E($,L,V,q){V||y($,L),L.pendingcb--,q(),N($,L)}function y($,L){L.length===0&&L.needDrain&&(L.needDrain=!1,$.emit("drain"))}function M($,L){L.bufferProcessing=!0;var V=L.bufferedRequest;if($._writev&&V&&V.next){var q=L.bufferedRequestCount,T=Array(q),f=L.corkedRequestsFree;f.entry=V;for(var v=0,S=!0;V;)T[v]=V,V.isBuf||(S=!1),V=V.next,v+=1;T.allBuffers=S,_($,L,!0,L.length,T,"",f.finish),L.pendingcb++,L.lastBufferedRequest=null,f.next?(L.corkedRequestsFree=f.next,f.next=null):L.corkedRequestsFree=new l(L),L.bufferedRequestCount=0}else{for(;V;){var O=V.chunk,A=V.encoding,B=V.callback,Q=L.objectMode?1:O.length;if(_($,L,!1,Q,O,A,B),V=V.next,L.bufferedRequestCount--,L.writing)break}V===null&&(L.lastBufferedRequest=null)}L.bufferedRequest=V,L.bufferProcessing=!1}function D($){return $.ending&&$.length===0&&$.bufferedRequest===null&&!$.finished&&!$.writing}function R($,L){$._final(function(V){L.pendingcb--,V&&Tt($,V),L.prefinished=!0,$.emit("prefinish"),N($,L)})}function P($,L){L.prefinished||L.finalCalled||(typeof $._final!="function"||L.destroyed?(L.prefinished=!0,$.emit("prefinish")):(L.pendingcb++,L.finalCalled=!0,o.nextTick(R,$,L)))}function N($,L){var V=D(L);if(V&&(P($,L),L.pendingcb===0&&(L.finished=!0,$.emit("finish"),L.autoDestroy))){var q=$._readableState;(!q||q.autoDestroy&&q.endEmitted)&&$.destroy()}return V}function U($,L,V){L.ending=!0,N($,L),V&&(L.finished?o.nextTick(V):$.once("finish",V)),L.ended=!0,$.writable=!1}function H($,L,V){var q=$.entry;for($.entry=null;q;){var T=q.callback;L.pendingcb--,T(V),q=q.next}L.corkedRequestsFree.next=$}a.exports=g;var Y;g.WritableState=p;var K={deprecate:s("util-deprecate")},Z=s("./internal/streams/stream"),j=s("buffer").Buffer,nt=c.Uint8Array||function(){},G=s("./internal/streams/destroy"),tt=s("./internal/streams/state"),z=tt.getHighWaterMark,J=s("../errors").codes,lt=J.ERR_INVALID_ARG_TYPE,St=J.ERR_METHOD_NOT_IMPLEMENTED,ee=J.ERR_MULTIPLE_CALLBACK,mt=J.ERR_STREAM_CANNOT_PIPE,_t=J.ERR_STREAM_DESTROYED,Ot=J.ERR_STREAM_NULL_VALUES,st=J.ERR_STREAM_WRITE_AFTER_END,Rt=J.ERR_UNKNOWN_ENCODING,Tt=G.errorOrDestroy;s("inherits")(g,Z),p.prototype.getBuffer=function(){for(var $=this.bufferedRequest,L=[];$;)L.push($),$=$.next;return L},(function(){try{Object.defineProperty(p.prototype,"buffer",{get:K.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var yt;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(yt=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function($){return!!yt.call(this,$)||this===g&&$&&$._writableState instanceof p}})):yt=function($){return $ instanceof this},g.prototype.pipe=function(){Tt(this,new mt)},g.prototype.write=function($,L,V){var q=this._writableState,T=!1,f=!q.objectMode&&u($);return f&&!j.isBuffer($)&&($=h($)),typeof L=="function"&&(V=L,L=null),f?L="buffer":!L&&(L=q.defaultEncoding),typeof V!="function"&&(V=d),q.ending?m(this,V):(f||b(this,q,$,V))&&(q.pendingcb++,T=C(this,q,f,$,L,V)),T},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var $=this._writableState;$.corked&&($.corked--,!$.writing&&!$.corked&&!$.bufferProcessing&&$.bufferedRequest&&M(this,$))},g.prototype.setDefaultEncoding=function($){if(typeof $=="string"&&($=$.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf(($+"").toLowerCase())))throw new Rt($);return this._writableState.defaultEncoding=$,this},Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function($,L,V){V(new St("_write()"))},g.prototype._writev=null,g.prototype.end=function($,L,V){var q=this._writableState;return typeof $=="function"?(V=$,$=null,L=null):typeof L=="function"&&(V=L,L=null),$!=null&&this.write($,L),q.corked&&(q.corked=1,this.uncork()),q.ending||U(this,q,V),this},Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function($){this._writableState&&(this._writableState.destroyed=$)}}),g.prototype.destroy=G.destroy,g.prototype._undestroy=G.undestroy,g.prototype._destroy=function($,L){L($)}}).call(this)}).call(this,s("_process"),typeof Cn>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Cn)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(s,a){(function(o){(function(){function c(y,M,D){return M in y?Object.defineProperty(y,M,{value:D,enumerable:!0,configurable:!0,writable:!0}):y[M]=D,y}function l(y,M){return{value:y,done:M}}function h(y){var M=y[m];if(M!==null){var D=y[x].read();D!==null&&(y[_]=null,y[m]=null,y[b]=null,M(l(D,!1)))}}function u(y){o.nextTick(h,y)}function d(y,M){return function(D,R){y.then(function(){return M[C]?void D(l(void 0,!0)):void M[k](D,R)},R)}}var p,g=s("./end-of-stream"),m=Symbol("lastResolve"),b=Symbol("lastReject"),w=Symbol("error"),C=Symbol("ended"),_=Symbol("lastPromise"),k=Symbol("handlePromise"),x=Symbol("stream"),I=Object.getPrototypeOf(function(){}),E=Object.setPrototypeOf((p={get stream(){return this[x]},next:function(){var y=this,M=this[w];if(M!==null)return Promise.reject(M);if(this[C])return Promise.resolve(l(void 0,!0));if(this[x].destroyed)return new Promise(function(N,U){o.nextTick(function(){y[w]?U(y[w]):N(l(void 0,!0))})});var D,R=this[_];if(R)D=new Promise(d(R,this));else{var P=this[x].read();if(P!==null)return Promise.resolve(l(P,!1));D=new Promise(this[k])}return this[_]=D,D}},c(p,Symbol.asyncIterator,function(){return this}),c(p,"return",function(){var y=this;return new Promise(function(M,D){y[x].destroy(null,function(R){return R?void D(R):void M(l(void 0,!0))})})}),p),I);a.exports=function(y){var M,D=Object.create(E,(M={},c(M,x,{value:y,writable:!0}),c(M,m,{value:null,writable:!0}),c(M,b,{value:null,writable:!0}),c(M,w,{value:null,writable:!0}),c(M,C,{value:y._readableState.endEmitted,writable:!0}),c(M,k,{value:function(R,P){var N=D[x].read();N?(D[_]=null,D[m]=null,D[b]=null,R(l(N,!1))):(D[m]=R,D[b]=P)},writable:!0}),M));return D[_]=null,g(y,function(R){if(R&&R.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=D[b];return P!==null&&(D[_]=null,D[m]=null,D[b]=null,P(R)),void(D[w]=R)}var N=D[m];N!==null&&(D[_]=null,D[m]=null,D[b]=null,N(l(void 0,!0))),D[C]=!0}),y.on("readable",u.bind(null,D)),D}}).call(this)}).call(this,s("_process"))},{"./end-of-stream":24,_process:12}],22:[function(s,a){function o(_,k){var x=Object.keys(_);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(_);k&&(I=I.filter(function(E){return Object.getOwnPropertyDescriptor(_,E).enumerable})),x.push.apply(x,I)}return x}function c(_){for(var k,x=1;x<arguments.length;x++)k=arguments[x]==null?{}:arguments[x],x%2?o(Object(k),!0).forEach(function(I){l(_,I,k[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(k)):o(Object(k)).forEach(function(I){Object.defineProperty(_,I,Object.getOwnPropertyDescriptor(k,I))});return _}function l(_,k,x){return k in _?Object.defineProperty(_,k,{value:x,enumerable:!0,configurable:!0,writable:!0}):_[k]=x,_}function h(_,k){if(!(_ instanceof k))throw new TypeError("Cannot call a class as a function")}function u(_,k){for(var x,I=0;I<k.length;I++)x=k[I],x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(_,x.key,x)}function d(_,k,x){return k&&u(_.prototype,k),_}function p(_,k,x){m.prototype.copy.call(_,k,x)}var g=s("buffer"),m=g.Buffer,b=s("util"),w=b.inspect,C=w&&w.custom||"inspect";a.exports=(function(){function _(){h(this,_),this.head=null,this.tail=null,this.length=0}return d(_,[{key:"push",value:function(k){var x={data:k,next:null};0<this.length?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(k){var x={data:k,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var k=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,k}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(k){if(this.length===0)return"";for(var x=this.head,I=""+x.data;x=x.next;)I+=k+x.data;return I}},{key:"concat",value:function(k){if(this.length===0)return m.alloc(0);for(var x=m.allocUnsafe(k>>>0),I=this.head,E=0;I;)p(I.data,x,E),E+=I.data.length,I=I.next;return x}},{key:"consume",value:function(k,x){var I;return k<this.head.data.length?(I=this.head.data.slice(0,k),this.head.data=this.head.data.slice(k)):k===this.head.data.length?I=this.shift():I=x?this._getString(k):this._getBuffer(k),I}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(k){var x=this.head,I=1,E=x.data;for(k-=E.length;x=x.next;){var y=x.data,M=k>y.length?y.length:k;if(E+=M===y.length?y:y.slice(0,k),k-=M,k===0){M===y.length?(++I,this.head=x.next?x.next:this.tail=null):(this.head=x,x.data=y.slice(M));break}++I}return this.length-=I,E}},{key:"_getBuffer",value:function(k){var x=m.allocUnsafe(k),I=this.head,E=1;for(I.data.copy(x),k-=I.data.length;I=I.next;){var y=I.data,M=k>y.length?y.length:k;if(y.copy(x,x.length-k,0,M),k-=M,k===0){M===y.length?(++E,this.head=I.next?I.next:this.tail=null):(this.head=I,I.data=y.slice(M));break}++E}return this.length-=E,x}},{key:C,value:function(k,x){return w(this,c({},x,{depth:0,customInspect:!1}))}}]),_})()},{buffer:3,util:2}],23:[function(s,a){(function(o){(function(){function c(u,d){h(u,d),l(u)}function l(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function h(u,d){u.emit("error",d)}a.exports={destroy:function(u,d){var p=this,g=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return g||m?(d?d(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,o.nextTick(h,this,u)):o.nextTick(h,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(b){!d&&b?p._writableState?p._writableState.errorEmitted?o.nextTick(l,p):(p._writableState.errorEmitted=!0,o.nextTick(c,p,b)):o.nextTick(c,p,b):d?(o.nextTick(l,p),d(b)):o.nextTick(l,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,d){var p=u._readableState,g=u._writableState;p&&p.autoDestroy||g&&g.autoDestroy?u.destroy(d):u.emit("error",d)}}}).call(this)}).call(this,s("_process"))},{_process:12}],24:[function(s,a){function o(d){var p=!1;return function(){if(!p){p=!0;for(var g=arguments.length,m=Array(g),b=0;b<g;b++)m[b]=arguments[b];d.apply(this,m)}}}function c(){}function l(d){return d.setHeader&&typeof d.abort=="function"}function h(d,p,g){if(typeof p=="function")return h(d,null,p);p||(p={}),g=o(g||c);var m=p.readable||p.readable!==!1&&d.readable,b=p.writable||p.writable!==!1&&d.writable,w=function(){d.writable||_()},C=d._writableState&&d._writableState.finished,_=function(){b=!1,C=!0,m||g.call(d)},k=d._readableState&&d._readableState.endEmitted,x=function(){m=!1,k=!0,b||g.call(d)},I=function(M){g.call(d,M)},E=function(){var M;return m&&!k?(d._readableState&&d._readableState.ended||(M=new u),g.call(d,M)):b&&!C?(d._writableState&&d._writableState.ended||(M=new u),g.call(d,M)):void 0},y=function(){d.req.on("finish",_)};return l(d)?(d.on("complete",_),d.on("abort",E),d.req?y():d.on("request",y)):b&&!d._writableState&&(d.on("end",w),d.on("close",w)),d.on("end",x),d.on("finish",_),p.error!==!1&&d.on("error",I),d.on("close",E),function(){d.removeListener("complete",_),d.removeListener("abort",E),d.removeListener("request",y),d.req&&d.req.removeListener("finish",_),d.removeListener("end",w),d.removeListener("close",w),d.removeListener("finish",_),d.removeListener("end",x),d.removeListener("error",I),d.removeListener("close",E)}}var u=s("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;a.exports=h},{"../../../errors":15}],25:[function(s,a){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(s,a){function o(C){var _=!1;return function(){_||(_=!0,C.apply(void 0,arguments))}}function c(C){if(C)throw C}function l(C){return C.setHeader&&typeof C.abort=="function"}function h(C,_,k,x){x=o(x);var I=!1;C.on("close",function(){I=!0}),g===void 0&&(g=s("./end-of-stream")),g(C,{readable:_,writable:k},function(y){return y?x(y):(I=!0,void x())});var E=!1;return function(y){if(!I)return E?void 0:(E=!0,l(C)?C.abort():typeof C.destroy=="function"?C.destroy():void x(y||new w("pipe")))}}function u(C){C()}function d(C,_){return C.pipe(_)}function p(C){return C.length&&typeof C[C.length-1]=="function"?C.pop():c}var g,m=s("../../../errors").codes,b=m.ERR_MISSING_ARGS,w=m.ERR_STREAM_DESTROYED;a.exports=function(){for(var C=arguments.length,_=Array(C),k=0;k<C;k++)_[k]=arguments[k];var x=p(_);if(Array.isArray(_[0])&&(_=_[0]),2>_.length)throw new b("streams");var I,E=_.map(function(y,M){var D=M<_.length-1;return h(y,D,0<M,function(R){I||(I=R),R&&E.forEach(u),D||(E.forEach(u),x(I))})});return _.reduce(d)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(s,a){function o(l,h,u){return l.highWaterMark==null?h?l[u]:null:l.highWaterMark}var c=s("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(l,h,u,d){var p=o(h,d,u);if(p!=null){if(!(isFinite(p)&&n(p)===p)||0>p){var g=d?u:"highWaterMark";throw new c(g,p)}return n(p)}return l.objectMode?16:16384}}},{"../../../errors":15}],28:[function(s,a){a.exports=s("events").EventEmitter},{events:7}],29:[function(s,a,o){o=a.exports=s("./lib/_stream_readable.js"),o.Stream=o,o.Readable=o,o.Writable=s("./lib/_stream_writable.js"),o.Duplex=s("./lib/_stream_duplex.js"),o.Transform=s("./lib/_stream_transform.js"),o.PassThrough=s("./lib/_stream_passthrough.js"),o.finished=s("./lib/internal/streams/end-of-stream.js"),o.pipeline=s("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(s,a,o){function c(d,p){for(var g in d)p[g]=d[g]}function l(d,p,g){return u(d,p,g)}var h=s("buffer"),u=h.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?a.exports=h:(c(h,o),o.Buffer=l),l.prototype=Object.create(u.prototype),c(u,l),l.from=function(d,p,g){if(typeof d=="number")throw new TypeError("Argument must not be a number");return u(d,p,g)},l.alloc=function(d,p,g){if(typeof d!="number")throw new TypeError("Argument must be a number");var m=u(d);return p===void 0?m.fill(0):typeof g=="string"?m.fill(p,g):m.fill(p),m},l.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return u(d)},l.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(d)}},{buffer:3}],31:[function(s,a,o){function c(E){if(!E)return"utf8";for(var y;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(y)return;E=(""+E).toLowerCase(),y=!0}}function l(E){var y=c(E);if(typeof y!="string"&&(x.isEncoding===I||!I(E)))throw new Error("Unknown encoding: "+E);return y||E}function h(E){this.encoding=l(E);var y;switch(this.encoding){case"utf16le":this.text=m,this.end=b,y=4;break;case"utf8":this.fillLast=g,y=4;break;case"base64":this.text=w,this.end=C,y=3;break;default:return this.write=_,void(this.end=k)}this.lastNeed=0,this.lastTotal=0,this.lastChar=x.allocUnsafe(y)}function u(E){return 127>=E?0:E>>5==6?2:E>>4==14?3:E>>3==30?4:E>>6==2?-1:-2}function d(E,y,M){var D=y.length-1;if(D<M)return 0;var R=u(y[D]);return 0<=R?(0<R&&(E.lastNeed=R-1),R):--D<M||R===-2?0:(R=u(y[D]),0<=R?(0<R&&(E.lastNeed=R-2),R):--D<M||R===-2?0:(R=u(y[D]),0<=R?(0<R&&(R===2?R=0:E.lastNeed=R-3),R):0))}function p(E,y){if((192&y[0])!=128)return E.lastNeed=0,"";if(1<E.lastNeed&&1<y.length){if((192&y[1])!=128)return E.lastNeed=1,"";if(2<E.lastNeed&&2<y.length&&(192&y[2])!=128)return E.lastNeed=2,""}}function g(E){var y=this.lastTotal-this.lastNeed,M=p(this,E);return M===void 0?this.lastNeed<=E.length?(E.copy(this.lastChar,y,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,y,0,E.length),void(this.lastNeed-=E.length)):M}function m(E,y){if((E.length-y)%2==0){var M=E.toString("utf16le",y);if(M){var D=M.charCodeAt(M.length-1);if(55296<=D&&56319>=D)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1],M.slice(0,-1)}return M}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=E[E.length-1],E.toString("utf16le",y,E.length-1)}function b(E){var y=E&&E.length?this.write(E):"";if(this.lastNeed){var M=this.lastTotal-this.lastNeed;return y+this.lastChar.toString("utf16le",0,M)}return y}function w(E,y){var M=(E.length-y)%3;return M==0?E.toString("base64",y):(this.lastNeed=3-M,this.lastTotal=3,M==1?this.lastChar[0]=E[E.length-1]:(this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1]),E.toString("base64",y,E.length-M))}function C(E){var y=E&&E.length?this.write(E):"";return this.lastNeed?y+this.lastChar.toString("base64",0,3-this.lastNeed):y}function _(E){return E.toString(this.encoding)}function k(E){return E&&E.length?this.write(E):""}var x=s("safe-buffer").Buffer,I=x.isEncoding||function(E){switch(E=""+E,E&&E.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};o.StringDecoder=h,h.prototype.write=function(E){if(E.length===0)return"";var y,M;if(this.lastNeed){if(y=this.fillLast(E),y===void 0)return"";M=this.lastNeed,this.lastNeed=0}else M=0;return M<E.length?y?y+this.text(E,M):this.text(E,M):y||""},h.prototype.end=function(E){var y=E&&E.length?this.write(E):"";return this.lastNeed?y+"":y},h.prototype.text=function(E,y){var M=d(this,E,y);if(!this.lastNeed)return E.toString("utf8",y);this.lastTotal=M;var D=E.length-(M-this.lastNeed);return E.copy(this.lastChar,0,D),E.toString("utf8",y,D)},h.prototype.fillLast=function(E){return this.lastNeed<=E.length?(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,E.length),void(this.lastNeed-=E.length))}},{"safe-buffer":30}],32:[function(s,a){(function(o){(function(){function c(l){try{if(!o.localStorage)return!1}catch{return!1}var h=o.localStorage[l];return h!=null&&(h+"").toLowerCase()==="true"}a.exports=function(l,h){function u(){if(!d){if(c("throwDeprecation"))throw new Error(h);c("traceDeprecation")?console.trace(h):console.warn(h),d=!0}return l.apply(this,arguments)}if(c("noDeprecation"))return l;var d=!1;return u}}).call(this)}).call(this,typeof Cn>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Cn)},{}],"/":[function(s,a){function o(C){return C.replace(/a=ice-options:trickle\s\n/g,"")}function c(C){console.warn(C)}const l=s("debug")("simple-peer"),h=s("get-browser-rtc"),u=s("randombytes"),d=s("readable-stream"),p=s("queue-microtask"),g=s("err-code"),{Buffer:m}=s("buffer"),b=65536;class w extends d.Duplex{constructor(_){if(_=Object.assign({allowHalfOpen:!1},_),super(_),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",_),this.channelName=_.initiator?_.channelName||u(20).toString("hex"):null,this.initiator=_.initiator||!1,this.channelConfig=_.channelConfig||w.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},w.config,_.config),this.offerOptions=_.offerOptions||{},this.answerOptions=_.answerOptions||{},this.sdpTransform=_.sdpTransform||(k=>k),this.streams=_.streams||(_.stream?[_.stream]:[]),this.trickle=_.trickle===void 0||_.trickle,this.allowHalfTrickle=_.allowHalfTrickle!==void 0&&_.allowHalfTrickle,this.iceCompleteTimeout=_.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=_.wrtc&&typeof _.wrtc=="object"?_.wrtc:h(),!this._wrtc)throw g(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(k){return void this.destroy(g(k,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=k=>{this._onIceCandidate(k)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(k=>{this.destroy(g(k,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=k=>{this._setupData(k)},this.streams&&this.streams.forEach(k=>{this.addStream(k)}),this._pc.ontrack=k=>{this._onTrack(k)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof _=="string")try{_=JSON.parse(_)}catch{_={}}this._debug("signal()"),_.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),_.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(_.transceiverRequest.kind,_.transceiverRequest.init)),_.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(_.candidate):this._pendingCandidates.push(_.candidate)),_.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(_)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(k=>{this._addIceCandidate(k)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(k=>{this.destroy(g(k,"ERR_SET_REMOTE_DESCRIPTION"))}),_.sdp||_.candidate||_.renegotiate||_.transceiverRequest||this.destroy(g(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(_){const k=new this._wrtc.RTCIceCandidate(_);this._pc.addIceCandidate(k).catch(x=>{!k.address||k.address.endsWith(".local")?c("Ignoring unsupported ICE candidate."):this.destroy(g(x,"ERR_ADD_ICE_CANDIDATE"))})}send(_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(_)}}addTransceiver(_,k){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(_,k),this._needsNegotiation()}catch(x){this.destroy(g(x,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:_,init:k}})}}addStream(_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),_.getTracks().forEach(k=>{this.addTrack(k,_)})}}addTrack(_,k){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const x=this._senderMap.get(_)||new Map;let I=x.get(k);if(!I)I=this._pc.addTrack(_,k),x.set(k,I),this._senderMap.set(_,x),this._needsNegotiation();else throw I.removed?g(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):g(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(_,k,x){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const I=this._senderMap.get(_),E=I?I.get(x):null;if(!E)throw g(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");k&&this._senderMap.set(k,I),E.replaceTrack==null?this.destroy(g(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):E.replaceTrack(k)}removeTrack(_,k){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const x=this._senderMap.get(_),I=x?x.get(k):null;if(!I)throw g(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{I.removed=!0,this._pc.removeTrack(I)}catch(E){E.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(I):this.destroy(g(E,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),_.getTracks().forEach(k=>{this.removeTrack(k,_)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(_){this._destroy(_,()=>{})}_destroy(_,k){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",_&&(_.message||_)),p(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",_&&(_.message||_)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,_&&this.emit("error",_),this.emit("close"),k()}))}_setupData(_){if(!_.channel)return this.destroy(g(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=_.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=b),this.channelName=this._channel.label,this._channel.onmessage=x=>{this._onChannelMessage(x)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=x=>{const I=x.error instanceof Error?x.error:new Error(`Datachannel error: ${x.message} ${x.filename}:${x.lineno}:${x.colno}`);this.destroy(g(I,"ERR_DATA_CHANNEL"))};let k=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(k&&this._onChannelClose(),k=!0):k=!1},5e3)}_read(){}_write(_,k,x){if(this.destroyed)return x(g(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(_)}catch(I){return this.destroy(g(I,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>b?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=x):x(null)}else this._debug("write before connect"),this._chunk=_,this._cb=x}_onFinish(){if(!this.destroyed){const _=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?_():this.once("connect",_)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(_=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(_.sdp=o(_.sdp)),_.sdp=this.sdpTransform(_.sdp);const k=()=>{if(!this.destroyed){const x=this._pc.localDescription||_;this._debug("signal"),this.emit("signal",{type:x.type,sdp:x.sdp})}};this._pc.setLocalDescription(_).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?k():this.once("_iceComplete",k))}).catch(x=>{this.destroy(g(x,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(_=>{this.destroy(g(_,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(_=>{_.mid||!_.sender.track||_.requested||(_.requested=!0,this.addTransceiver(_.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(_=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(_.sdp=o(_.sdp)),_.sdp=this.sdpTransform(_.sdp);const k=()=>{if(!this.destroyed){const x=this._pc.localDescription||_;this._debug("signal"),this.emit("signal",{type:x.type,sdp:x.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(_).then(()=>{this.destroyed||(this.trickle||this._iceComplete?k():this.once("_iceComplete",k))}).catch(x=>{this.destroy(g(x,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(_=>{this.destroy(g(_,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(g(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const _=this._pc.iceConnectionState,k=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",_,k),this.emit("iceStateChange",_,k),(_==="connected"||_==="completed")&&(this._pcReady=!0,this._maybeReady()),_==="failed"&&this.destroy(g(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),_==="closed"&&this.destroy(g(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(_){const k=x=>(Object.prototype.toString.call(x.values)==="[object Array]"&&x.values.forEach(I=>{Object.assign(x,I)}),x);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(x=>{const I=[];x.forEach(E=>{I.push(k(E))}),_(null,I)},x=>_(x)):0<this._pc.getStats.length?this._pc.getStats(x=>{if(this.destroyed)return;const I=[];x.result().forEach(E=>{const y={};E.names().forEach(M=>{y[M]=E.stat(M)}),y.id=E.id,y.type=E.type,y.timestamp=E.timestamp,I.push(k(y))}),_(null,I)},x=>_(x)):_(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const _=()=>{this.destroyed||this.getStats((k,x)=>{if(this.destroyed)return;k&&(x=[]);const I={},E={},y={};let M=!1;x.forEach(R=>{(R.type==="remotecandidate"||R.type==="remote-candidate")&&(I[R.id]=R),(R.type==="localcandidate"||R.type==="local-candidate")&&(E[R.id]=R),(R.type==="candidatepair"||R.type==="candidate-pair")&&(y[R.id]=R)});const D=R=>{M=!0;let P=E[R.localCandidateId];P&&(P.ip||P.address)?(this.localAddress=P.ip||P.address,this.localPort=+P.port):P&&P.ipAddress?(this.localAddress=P.ipAddress,this.localPort=+P.portNumber):typeof R.googLocalAddress=="string"&&(P=R.googLocalAddress.split(":"),this.localAddress=P[0],this.localPort=+P[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let N=I[R.remoteCandidateId];N&&(N.ip||N.address)?(this.remoteAddress=N.ip||N.address,this.remotePort=+N.port):N&&N.ipAddress?(this.remoteAddress=N.ipAddress,this.remotePort=+N.portNumber):typeof R.googRemoteAddress=="string"&&(N=R.googRemoteAddress.split(":"),this.remoteAddress=N[0],this.remotePort=+N[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(x.forEach(R=>{R.type==="transport"&&R.selectedCandidatePairId&&D(y[R.selectedCandidatePairId]),(R.type==="googCandidatePair"&&R.googActiveConnection==="true"||(R.type==="candidatepair"||R.type==="candidate-pair")&&R.selected)&&D(R)}),!M&&(!Object.keys(y).length||Object.keys(E).length))return void setTimeout(_,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(P){return this.destroy(g(P,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const R=this._cb;this._cb=null,R(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};_()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>b)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(_=>{this._pc.removeTrack(_),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(_){this.destroyed||(_.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:_.candidate.candidate,sdpMLineIndex:_.candidate.sdpMLineIndex,sdpMid:_.candidate.sdpMid}}):!_.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),_.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(_){if(this.destroyed)return;let k=_.data;k instanceof ArrayBuffer&&(k=m.from(k)),this.push(k)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const _=this._cb;this._cb=null,_(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(_){this.destroyed||_.streams.forEach(k=>{this._debug("on track"),this.emit("track",_.track,k),this._remoteTracks.push({track:_.track,stream:k}),this._remoteStreams.some(x=>x.id===k.id)||(this._remoteStreams.push(k),p(()=>{this._debug("on stream"),this.emit("stream",k)}))})}_debug(){const _=[].slice.call(arguments);_[0]="["+this._id+"] "+_[0],l.apply(null,_)}}w.WEBRTC_SUPPORT=!!h(),w.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},w.channelConfig={},a.exports=w},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(nu)),nu.exports}var SM=xM();const CM=r0(SM);var kM=CM;function iu(e,t){e.send(JSON.stringify(t))}var s0="signaling.rxdb.info",rp="wss://"+s0+"/",sp=!1,EM=1e3*60*2;function MM({signalingServerUrl:e=rp,wrtc:t,config:n,webSocketConstructor:i=WebSocket}){DM(),e.includes(s0)&&!sp&&(sp=!0,console.warn(["RxDB Warning: You are using the RxDB WebRTC replication plugin","but you did not specify your own signaling server url.","By default it will use a signaling server provided by RxDB at "+rp,"This server is made for demonstration purposes and tryouts. It is not reliable and might be offline at any time.","In production you must always use your own signaling server instead.","Learn how to run your own server at https://rxdb.info/replication-webrtc.html","Also leave a  at the RxDB github repo  https://github.com/pubkey/rxdb "].join(" ")));var r=async s=>{var a=new ie,o=new ie,c=new ie,l=new ie,h=new ie,u=new Map,d=!1,p,g=void 0;m(),(async()=>{for(;await am(EM/2),!d;)g&&iu(g,{type:"ping"})})();function m(){d||(g=new i(e),g.onclose=()=>m(),g.onopen=()=>{it(g).onmessage=w=>{var C=JSON.parse(w.data);switch(C.type){case"init":p=C.yourPeerId,iu(it(g),{type:"join",room:s.topic});break;case"joined":var _=function(x){var I=!1,E=new kM({initiator:x>p,wrtc:t,config:n,trickle:!0});E.id=Nr(10),u.set(x,E),E.on("signal",y=>{iu(it(g),{type:"signal",senderPeerId:p,receiverPeerId:x,room:s.topic,data:y})}),E.on("data",y=>{y=JSON.parse(y.toString()),y.result?l.next({peer:E,response:y}):c.next({peer:E,message:y})}),E.on("error",y=>{h.next(et("RC_WEBRTC_PEER",{error:y})),E.destroy(),I||(I=!0,o.next(E))}),E.on("connect",()=>{a.next(E)}),E.on("close",()=>{I||(I=!0,o.next(E)),_(x)})};C.otherPeerIds.forEach(x=>{x===p||u.has(x)||_(x)});break;case"signal":var k=zi(u,C.senderPeerId);k.signal(C.data);break}}})}var b={error$:h,connect$:a,disconnect$:o,message$:c,response$:l,async send(w,C){await w.send(JSON.stringify(C))},close(){return d=!0,it(g).close(),h.complete(),a.complete(),o.complete(),c.complete(),l.complete(),Ge}};return b};return r}function DM(){if(typeof process>"u"||typeof process.nextTick!="function")throw et("RC7")}async function IM(e){var t=e.collection;fl(i0),e.pull&&(e.pull.batchSize||(e.pull.batchSize=20)),e.push&&(e.push.batchSize||(e.push.batchSize=20)),t.database.multiInstance&&await t.database.waitForLeadership();var n=0,i=Nr(10);function r(){var c=n++;return t.database.token+"|"+i+"|"+c}var s=await t.database.storageToken,a=new RM(t,e,await e.connectionHandlerCreator(e));a.subs.push(a.connectionHandler.error$.subscribe(c=>a.error$.next(c)),a.connectionHandler.disconnect$.subscribe(c=>a.removePeer(c))),a.subs.push(a.connectionHandler.message$.pipe(wt(c=>c.message.method==="token")).subscribe(c=>{a.connectionHandler.send(c.peer,{id:c.message.id,result:s})}));var o=a.connectionHandler.connect$.pipe(wt(()=>!a.canceled)).subscribe(async c=>{if(e.isPeerValid){var l=await e.isPeerValid(c);if(!l)return}var h;try{var u=await eu(a.connectionHandler,c,{id:r(),method:"token",params:[]});h=u.result}catch(w){a.error$.next(et("RC_WEBRTC_PEER",{error:w}));return}var d=await wM(t.database.hashFunction,s,h),p;if(d){var g=a.masterReplicationHandler,m=g.masterChangeStream$.subscribe(w=>{var C={id:"masterChangeStream$",result:w};a.connectionHandler.send(c,C)});a.subs.push(m,a.connectionHandler.disconnect$.pipe(wt(w=>w===c)).subscribe(()=>m.unsubscribe()));var b=a.connectionHandler.message$.pipe(wt(w=>w.peer===c),wt(w=>w.message.method!=="token")).subscribe(async w=>{var{peer:C,message:_}=w,k=g[_.method].bind(g),x=await k(..._.params),I={id:_.id,result:x};a.connectionHandler.send(C,I)});a.subs.push(b)}else p=_M({replicationIdentifier:[t.name,e.topic,h].join("||"),collection:t,autoStart:!0,deletedField:"_deleted",live:!0,retryTime:e.retryTime,waitForLeadership:!1,pull:e.pull?Object.assign({},e.pull,{async handler(w){var C=await eu(a.connectionHandler,c,{method:"masterChangesSince",params:[w,it(e.pull).batchSize],id:r()});return C.result},stream$:a.connectionHandler.response$.pipe(wt(w=>w.response.id==="masterChangeStream$"),Jt(w=>w.response.result))}):void 0,push:e.push?Object.assign({},e.push,{async handler(w){var C=await eu(a.connectionHandler,c,{method:"masterWrite",params:[w],id:r()});return C.result}}):void 0});a.addPeer(c,p)});return a.subs.push(o),a}var RM=(function(){function e(n,i,r){this.peerStates$=new mn(new Map),this.canceled=!1,this.subs=[],this.error$=new ie,this.collection=n,this.options=i,this.connectionHandler=r,this.collection.onClose.push(()=>this.cancel()),this.masterReplicationHandler=Sv(n.storageInstance,n.conflictHandler,n.database.token)}var t=e.prototype;return t.addPeer=function(i,r){var s={peer:i,replicationState:r,subs:[]};this.peerStates$.next(this.peerStates$.getValue().set(i,s)),r&&s.subs.push(r.error$.subscribe(a=>this.error$.next(a)))},t.removePeer=function(i){var r=zi(this.peerStates$.getValue(),i);this.peerStates$.getValue().delete(i),this.peerStates$.next(this.peerStates$.getValue()),r.subs.forEach(s=>s.unsubscribe()),r.replicationState&&r.replicationState.cancel()},t.awaitFirstPeer=function(){return Jn(this.peerStates$.pipe(wt(i=>i.size>0)))},t.cancel=async function(){this.canceled||(this.canceled=!0,this.subs.forEach(i=>i.unsubscribe()),Array.from(this.peerStates$.getValue().keys()).forEach(i=>{this.removePeer(i)}),await this.connectionHandler.close())},e})();async function TM(e){const t=await fetch(`${e}/health`);if(!t.ok)throw new Error(`Server returned ${t.status} ${t.statusText}`)}const PM=["transactions","tags","merchants","accounts","merchant_rules","dashboard_charts","dashboard_tables"];async function OM(e){const n=(await ht()).rxdb,i=e.replace(/^http/,"ws")+"/ws",r=await Promise.all(PM.map(async s=>{const a=n[s],o=`budgee--${s}`;try{await fetch(`${e}/databases`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:o,schema:a.schema.jsonSchema})})}catch(c){console.warn(`Failed to register schema for ${s}:`,c)}return IM({collection:a,topic:o,connectionHandlerCreator:MM({signalingServerUrl:i}),pull:{},push:{}})}));return()=>{for(const s of r)s.cancel().catch(console.error)}}const a0=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-banknote"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="20" height="12" x="2" y="6" rx="2" />
  <circle cx="12" cy="12" r="2" />
  <path d="M6 12h.01M18 12h.01" />
</svg>
`,AM=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-chart-column"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M3 3v16a2 2 0 0 0 2 2h16" />
  <path d="M18 17V9" />
  <path d="M13 17V5" />
  <path d="M8 17v-3" />
</svg>
`,$M=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-download"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 15V3" />
  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
  <path d="m7 10 5 5 5-5" />
</svg>
`,LM=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-landmark"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10 18v-7" />
  <path d="M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z" />
  <path d="M14 18v-7" />
  <path d="M18 18v-7" />
  <path d="M3 22h18" />
  <path d="M6 18v-7" />
</svg>
`,NM=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-settings"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915" />
  <circle cx="12" cy="12" r="3" />
</svg>
`,o0=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-store"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5" />
  <path d="M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244" />
  <path d="M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05" />
</svg>
`,FM=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-refresh-cw"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
  <path d="M21 3v5h-5" />
  <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" />
  <path d="M8 16H3v5" />
</svg>
`,BM=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-tag"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z" />
  <circle cx="7.5" cy="7.5" r=".5" fill="currentColor" />
</svg>
`;class xs{constructor(){}static async all(){return(await ht()).accounts.all()}static async get(t){const n=await ht();try{return await n.accounts.get(t)}catch{return}}static async create(t){const n=await ht(),i=Pe();return await n.accounts.put({...t,id:i}),i}static async update(t,n){const i=await ht(),r=await i.accounts.get(t);await i.accounts.put({...r,...n})}static async remove(t){await(await ht()).accounts.remove(t)}}class An{constructor(){}static async all(){return(await ht()).transactions.all()}static async get(t){const n=await ht();try{return await n.transactions.get(t)}catch{return}}static async update(t,n){const i=await ht(),r=await i.transactions.get(t);await i.transactions.put({...r,...n})}static async bulkPut(t){await(await ht()).transactions.bulkDocs(t.map(i=>({...i,id:i.id??Pe()})))}static async bulkAdd(t){await(await ht()).transactions.bulkDocs(t.map(i=>({...i,id:Pe()})))}static async forMerchant(t){return(await(await ht()).transactions.find({selector:{merchantId:t}})).sort((r,s)=>s.date.localeCompare(r.date))}static async forAccount(t){return(await(await ht()).transactions.find({selector:{accountId:t}})).sort((r,s)=>s.date.localeCompare(r.date))}static async deleteAll(){const t=await ht(),n=await t.transactions.all();return await Promise.all(n.map(i=>t.transactions.remove(i.id))),n.length}static async deleteForAccount(t){const n=await ht(),i=await n.transactions.find({selector:{accountId:t}});return await Promise.all(i.map(r=>n.transactions.remove(r.id))),i.length}}const TL=["chequing","savings","credit_card","investment"],jM={chequing:"Chequing",savings:"Savings",credit_card:"Credit Card",investment:"Investment"};function zM(e){return jM[e]}var WM=Object.defineProperty,HM=Object.getOwnPropertyDescriptor,c0=e=>{throw TypeError(e)},jr=(e,t,n,i)=>{for(var r=i>1?void 0:i?HM(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&WM(t,n,r),r},UM=(e,t,n)=>t.has(e)||c0("Cannot "+n),VM=(e,t,n)=>t.has(e)?c0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Vn=(e,t,n)=>(UM(e,t,"access private method"),n),pn,Ss,l0,u0,h0,d0;let ri=class extends $t{constructor(){super(...arguments),VM(this,pn),this.totalItems=0,this.defaultPageSize=10,this.storageKey="",this.filterable=!1,this._currentPage=1,this._pageSize=0,this._filterDebounce=null}connectedCallback(){if(super.connectedCallback(),this.storageKey)try{const e=localStorage.getItem(`budgee:pageSize:${this.storageKey}`);e&&(this._pageSize=Number(e))}catch{}}get _effectivePageSize(){return this._pageSize||this.defaultPageSize}get _totalPages(){return Math.max(1,Math.ceil(this.totalItems/this._effectivePageSize))}firstUpdated(){Vn(this,pn,Ss).call(this)}willUpdate(e){e.has("totalItems")&&(this._currentPage=1)}reset(){this._currentPage=1,Vn(this,pn,Ss).call(this)}render(){const e=this._effectivePageSize,t=(this._currentPage-1)*e+1,n=Math.min(this._currentPage*e,this.totalItems);return F`
      <div class="pagination-bar">
        <div class="pagination-controls">
          ${this.filterable?F`<input
                class="filter-input"
                type="text"
                placeholder="Filter..."
                @input=${Vn(this,pn,d0)}
              />`:""}
          <label>
            Rows per page:
            <select @change=${Vn(this,pn,l0)}>
              ${[10,25,50,100].map(i=>F`<option value=${i} ?selected=${i===e}>${i}</option>`)}
            </select>
          </label>
        </div>
        <span>Showing ${t}${n} of ${this.totalItems}</span>
        <div class="pagination-controls">
          <button ?disabled=${this._currentPage<=1} @click=${Vn(this,pn,u0)}>Prev</button>
          <button ?disabled=${this._currentPage>=this._totalPages} @click=${Vn(this,pn,h0)}>Next</button>
        </div>
      </div>
      <slot></slot>
    `}};pn=new WeakSet;Ss=function(){this.dispatchEvent(new CustomEvent("page-change",{detail:{page:this._currentPage,pageSize:this._effectivePageSize},bubbles:!0,composed:!0}))};l0=function(e){if(this._pageSize=Number(e.target.value),this._currentPage=1,this.storageKey)try{localStorage.setItem(`budgee:pageSize:${this.storageKey}`,String(this._pageSize))}catch{}Vn(this,pn,Ss).call(this)};u0=function(){this._currentPage>1&&(this._currentPage--,Vn(this,pn,Ss).call(this))};h0=function(){this._currentPage<this._totalPages&&(this._currentPage++,Vn(this,pn,Ss).call(this))};d0=function(e){const t=e.target.value;this._filterDebounce!==null&&clearTimeout(this._filterDebounce),this._filterDebounce=setTimeout(()=>{this._filterDebounce=null,this._currentPage=1,this.dispatchEvent(new CustomEvent("filter-change",{detail:{filter:t},bubbles:!0,composed:!0}))},200)};ri.styles=Bt`
    .pagination-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5rem 0;
      font-size: 0.875rem;
      color: var(--budgee-text-muted);
    }
    .pagination-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    select {
      padding: 2px 6px;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      background: var(--budgee-surface);
    }
    .filter-input {
      padding: 4px 8px;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      background: var(--budgee-surface);
      font-size: 0.875rem;
    }
    button {
      padding: 4px 12px;
      cursor: pointer;
      background-color: var(--budgee-primary);
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover:not(:disabled) {
      background-color: var(--budgee-primary-hover);
    }
    button:disabled {
      opacity: 0.5;
      cursor: default;
    }
  `;jr([pt({type:Number})],ri.prototype,"totalItems",2);jr([pt({type:Number})],ri.prototype,"defaultPageSize",2);jr([pt()],ri.prototype,"storageKey",2);jr([pt({type:Boolean})],ri.prototype,"filterable",2);jr([W()],ri.prototype,"_currentPage",2);jr([W()],ri.prototype,"_pageSize",2);ri=jr([Ut("paginated-table")],ri);const fi=Bt`
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th,
  td {
    border: 1px solid var(--budgee-border);
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: var(--budgee-primary);
    color: white;
  }
  th.sortable {
    cursor: pointer;
    user-select: none;
  }
  th.sortable:hover {
    background-color: var(--budgee-primary-hover);
  }
  tbody tr:nth-child(even) {
    background-color: var(--budgee-row-alt);
  }
  tbody tr:hover {
    background-color: var(--budgee-row-hover);
  }
  .clickable-row {
    cursor: pointer;
  }
  .col-amount {
    text-align: right;
    font-variant-numeric: tabular-nums;
  }
  .amount-negative {
    color: var(--budgee-negative);
  }
  .amount-positive {
    color: var(--budgee-positive);
  }
`;var qM=Object.defineProperty,KM=Object.getOwnPropertyDescriptor,f0=e=>{throw TypeError(e)},zr=(e,t,n,i)=>{for(var r=i>1?void 0:i?KM(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&qM(t,n,r),r},YM=(e,t,n)=>t.has(e)||f0("Cannot "+n),XM=(e,t,n)=>t.has(e)?f0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ie=(e,t,n)=>(YM(e,t,"access private method"),n),me,p0,g0,m0,v0,b0,Qs,Js,_0,y0;let si=class extends $t{constructor(){super(...arguments),XM(this,me),this._rows=null,this._currentPage=1,this._pageSize=25,this._filter="",this._sortCol="name",this._sortDir="asc"}connectedCallback(){super.connectedCallback(),Ie(this,me,p0).call(this)}render(){if(this._rows===null)return F`
        <p>Loading</p>
      `;if(this._rows.length===0)return F`
        <p>No accounts found.</p>
      `;const e=this._rows.filter(r=>Ie(this,me,b0).call(this,r)),t=Ie(this,me,_0).call(this,e),n=(this._currentPage-1)*this._pageSize,i=t.slice(n,n+this._pageSize);return F`
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${25}
        storageKey="accounts"
        ?filterable=${!0}
        @page-change=${Ie(this,me,m0)}
        @filter-change=${Ie(this,me,v0)}
      >
        <table>
          <thead>
            <tr>
              <th class="sortable" @click=${()=>Ie(this,me,Qs).call(this,"name")}>
                Name${Ie(this,me,Js).call(this,"name")}
              </th>
              <th class="sortable" @click=${()=>Ie(this,me,Qs).call(this,"type")}>
                Type${Ie(this,me,Js).call(this,"type")}
              </th>
              <th class="sortable" @click=${()=>Ie(this,me,Qs).call(this,"count")}>
                Transactions${Ie(this,me,Js).call(this,"count")}
              </th>
              <th class="sortable col-amount" @click=${()=>Ie(this,me,Qs).call(this,"balance")}>
                Balance${Ie(this,me,Js).call(this,"balance")}
              </th>
            </tr>
          </thead>
          <tbody>
            ${i.map(r=>F`
              <tr @click=${()=>Ie(this,me,y0).call(this,r.account.id)}>
                <td>${r.account.name}</td>
                <td>${r.account.type?zM(r.account.type):""}</td>
                <td>${r.transactionCount??""}</td>
                <td class="col-amount ${r.balance!=null&&r.balance<0?"amount-negative":r.balance!=null?"amount-positive":""}">
                  ${r.balance!=null?r.balance.toFixed(2):""}
                </td>
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `}};me=new WeakSet;p0=async function(){const e=await xs.all();this._rows=e.map(t=>({account:t,transactionCount:null,balance:null})),Ie(this,me,g0).call(this)};g0=async function(){const e=await An.all(),t=new Map,n=new Map;for(const i of e)i.accountId!=null&&(t.set(i.accountId,(t.get(i.accountId)??0)+1),n.set(i.accountId,(n.get(i.accountId)??0)+i.amount));this._rows=this._rows.map(i=>({...i,transactionCount:t.get(i.account.id)??0,balance:n.get(i.account.id)??0}))};m0=function(e){this._currentPage=e.detail.page,this._pageSize=e.detail.pageSize};v0=function(e){this._filter=e.detail.filter,this._currentPage=1};b0=function(e){if(!this._filter)return!0;const t=this._filter.toLowerCase();return!!(e.account.name.toLowerCase().includes(t)||e.account.type?.toLowerCase().includes(t)||e.transactionCount!=null&&String(e.transactionCount).includes(t)||e.balance!=null&&e.balance.toFixed(2).includes(t))};Qs=function(e){this._sortCol===e?this._sortDir=this._sortDir==="asc"?"desc":"asc":(this._sortCol=e,this._sortDir="asc"),this._currentPage=1};Js=function(e){return this._sortCol!==e?"":this._sortDir==="asc"?" ":" "};_0=function(e){const t=this._sortCol,n=this._sortDir==="asc"?1:-1;return[...e].sort((i,r)=>{let s=0;return t==="name"?s=i.account.name.localeCompare(r.account.name):t==="type"?s=(i.account.type??"").localeCompare(r.account.type??""):t==="count"?s=(i.transactionCount??0)-(r.transactionCount??0):t==="balance"&&(s=(i.balance??0)-(r.balance??0)),s*n})};y0=function(e){window.history.pushState({},"",`/accounts/${e}`),window.dispatchEvent(new PopStateEvent("popstate"))};si.styles=[fi,Bt`
      tbody tr {
        cursor: pointer;
      }
    `];zr([W()],si.prototype,"_rows",2);zr([W()],si.prototype,"_currentPage",2);zr([W()],si.prototype,"_pageSize",2);zr([W()],si.prototype,"_filter",2);zr([W()],si.prototype,"_sortCol",2);zr([W()],si.prototype,"_sortDir",2);si=zr([Ut("account-list")],si);function GM(e,t,n){return(t=tD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ai(){return ai=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ai.apply(null,arguments)}function ap(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ap(Object(n),!0).forEach(function(i){GM(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ap(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function QM(e,t){if(e==null)return{};var n,i,r=JM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JM(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function ZM(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tD(e){var t=ZM(e,"string");return typeof t=="symbol"?t:t+""}function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}var eD="1.15.7";function ti(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var pi=ti(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),lo=ti(/Edge/i),op=ti(/firefox/i),va=ti(/safari/i)&&!ti(/chrome/i)&&!ti(/android/i),pd=ti(/iP(ad|od|hone)/i),w0=ti(/chrome/i)&&ti(/android/i),x0={capture:!1,passive:!1};function Et(e,t,n){e.addEventListener(t,n,!pi&&x0)}function Ct(e,t,n){e.removeEventListener(t,n,!pi&&x0)}function Lc(e,t){if(t){if(t[0]===">"&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch{return!1}return!1}}function S0(e){return e.host&&e!==document&&e.host.nodeType&&e.host!==e?e.host:e.parentNode}function gn(e,t,n,i){if(e){n=n||document;do{if(t!=null&&(t[0]===">"?e.parentNode===n&&Lc(e,t):Lc(e,t))||i&&e===n)return e;if(e===n)break}while(e=S0(e))}return null}var cp=/\s+/g;function He(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(cp," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(cp," ")}}function at(e,t,n){var i=e&&e.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),t===void 0?n:n[t];!(t in i)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),i[t]=n+(typeof n=="string"?"":"px")}}function ds(e,t){var n="";if(typeof e=="string")n=e;else do{var i=at(e,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function C0(e,t,n){if(e){var i=e.getElementsByTagName(t),r=0,s=i.length;if(n)for(;r<s;r++)n(i[r],r);return i}return[]}function Rn(){var e=document.scrollingElement;return e||document.documentElement}function oe(e,t,n,i,r){if(!(!e.getBoundingClientRect&&e!==window)){var s,a,o,c,l,h,u;if(e!==window&&e.parentNode&&e!==Rn()?(s=e.getBoundingClientRect(),a=s.top,o=s.left,c=s.bottom,l=s.right,h=s.height,u=s.width):(a=0,o=0,c=window.innerHeight,l=window.innerWidth,h=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(r=r||e.parentNode,!pi))do if(r&&r.getBoundingClientRect&&(at(r,"transform")!=="none"||n&&at(r,"position")!=="static")){var d=r.getBoundingClientRect();a-=d.top+parseInt(at(r,"border-top-width")),o-=d.left+parseInt(at(r,"border-left-width")),c=a+s.height,l=o+s.width;break}while(r=r.parentNode);if(i&&e!==window){var p=ds(r||e),g=p&&p.a,m=p&&p.d;p&&(a/=m,o/=g,u/=g,h/=m,c=a+h,l=o+u)}return{top:a,left:o,bottom:c,right:l,width:u,height:h}}}function lp(e,t,n){for(var i=Di(e,!0),r=oe(e)[t];i;){var s=oe(i)[n],a=void 0;if(a=r>=s,!a)return i;if(i===Rn())break;i=Di(i,!1)}return!1}function Cs(e,t,n,i){for(var r=0,s=0,a=e.children;s<a.length;){if(a[s].style.display!=="none"&&a[s]!==ot.ghost&&(i||a[s]!==ot.dragged)&&gn(a[s],n.draggable,e,!1)){if(r===t)return a[s];r++}s++}return null}function gd(e,t){for(var n=e.lastElementChild;n&&(n===ot.ghost||at(n,"display")==="none"||t&&!Lc(n,t));)n=n.previousElementSibling;return n||null}function on(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==ot.clone&&(!t||Lc(e,t))&&n++;return n}function up(e){var t=0,n=0,i=Rn();if(e)do{var r=ds(e),s=r.a,a=r.d;t+=e.scrollLeft*s,n+=e.scrollTop*a}while(e!==i&&(e=e.parentNode));return[t,n]}function nD(e,t){for(var n in e)if(e.hasOwnProperty(n)){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n)}return-1}function Di(e,t){if(!e||!e.getBoundingClientRect)return Rn();var n=e,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=at(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Rn();if(i||t)return n;i=!0}}while(n=n.parentNode);return Rn()}function iD(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function ru(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}var ba;function k0(e,t){return function(){if(!ba){var n=arguments,i=this;n.length===1?e.call(i,n[0]):e.apply(i,n),ba=setTimeout(function(){ba=void 0},t)}}}function rD(){clearTimeout(ba),ba=void 0}function E0(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function M0(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function D0(e,t,n){var i={};return Array.from(e.children).forEach(function(r){var s,a,o,c;if(!(!gn(r,t.draggable,e,!1)||r.animated||r===n)){var l=oe(r);i.left=Math.min((s=i.left)!==null&&s!==void 0?s:1/0,l.left),i.top=Math.min((a=i.top)!==null&&a!==void 0?a:1/0,l.top),i.right=Math.max((o=i.right)!==null&&o!==void 0?o:-1/0,l.right),i.bottom=Math.max((c=i.bottom)!==null&&c!==void 0?c:-1/0,l.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var Fe="Sortable"+new Date().getTime();function sD(){var e=[],t;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(r){if(!(at(r,"display")==="none"||r===ot.ghost)){e.push({target:r,rect:oe(r)});var s=$n({},e[e.length-1].rect);if(r.thisAnimationDuration){var a=ds(r,!0);a&&(s.top-=a.f,s.left-=a.e)}r.fromRect=s}})}},addAnimationState:function(i){e.push(i)},removeAnimationState:function(i){e.splice(nD(e,{target:i}),1)},animateAll:function(i){var r=this;if(!this.options.animation){clearTimeout(t),typeof i=="function"&&i();return}var s=!1,a=0;e.forEach(function(o){var c=0,l=o.target,h=l.fromRect,u=oe(l),d=l.prevFromRect,p=l.prevToRect,g=o.rect,m=ds(l,!0);m&&(u.top-=m.f,u.left-=m.e),l.toRect=u,l.thisAnimationDuration&&ru(d,u)&&!ru(h,u)&&(g.top-u.top)/(g.left-u.left)===(h.top-u.top)/(h.left-u.left)&&(c=oD(g,d,p,r.options)),ru(u,h)||(l.prevFromRect=h,l.prevToRect=u,c||(c=r.options.animation),r.animate(l,g,u,c)),c&&(s=!0,a=Math.max(a,c),clearTimeout(l.animationResetTimer),l.animationResetTimer=setTimeout(function(){l.animationTime=0,l.prevFromRect=null,l.fromRect=null,l.prevToRect=null,l.thisAnimationDuration=null},c),l.thisAnimationDuration=c)}),clearTimeout(t),s?t=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),e=[]},animate:function(i,r,s,a){if(a){at(i,"transition",""),at(i,"transform","");var o=ds(this.el),c=o&&o.a,l=o&&o.d,h=(r.left-s.left)/(c||1),u=(r.top-s.top)/(l||1);i.animatingX=!!h,i.animatingY=!!u,at(i,"transform","translate3d("+h+"px,"+u+"px,0)"),this.forRepaintDummy=aD(i),at(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),at(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){at(i,"transition",""),at(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function aD(e){return e.offsetWidth}function oD(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}var Yr=[],su={initializeByDefault:!0},uo={mount:function(t){for(var n in su)su.hasOwnProperty(n)&&!(n in t)&&(t[n]=su[n]);Yr.forEach(function(i){if(i.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Yr.push(t)},pluginEvent:function(t,n,i){var r=this;this.eventCanceled=!1,i.cancel=function(){r.eventCanceled=!0};var s=t+"Global";Yr.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][s]&&n[a.pluginName][s]($n({sortable:n},i)),n.options[a.pluginName]&&n[a.pluginName][t]&&n[a.pluginName][t]($n({sortable:n},i)))})},initializePlugins:function(t,n,i,r){Yr.forEach(function(o){var c=o.pluginName;if(!(!t.options[c]&&!o.initializeByDefault)){var l=new o(t,n,t.options);l.sortable=t,l.options=t.options,t[c]=l,ai(i,l.defaults)}});for(var s in t.options)if(t.options.hasOwnProperty(s)){var a=this.modifyOption(t,s,t.options[s]);typeof a<"u"&&(t.options[s]=a)}},getEventProperties:function(t,n){var i={};return Yr.forEach(function(r){typeof r.eventProperties=="function"&&ai(i,r.eventProperties.call(n[r.pluginName],t))}),i},modifyOption:function(t,n,i){var r;return Yr.forEach(function(s){t[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[n]=="function"&&(r=s.optionListeners[n].call(t[s.pluginName],i))}),r}};function cD(e){var t=e.sortable,n=e.rootEl,i=e.name,r=e.targetEl,s=e.cloneEl,a=e.toEl,o=e.fromEl,c=e.oldIndex,l=e.newIndex,h=e.oldDraggableIndex,u=e.newDraggableIndex,d=e.originalEvent,p=e.putSortable,g=e.extraEventProperties;if(t=t||n&&n[Fe],!!t){var m,b=t.options,w="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!pi&&!lo?m=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent(i,!0,!0)),m.to=a||n,m.from=o||n,m.item=r||n,m.clone=s,m.oldIndex=c,m.newIndex=l,m.oldDraggableIndex=h,m.newDraggableIndex=u,m.originalEvent=d,m.pullMode=p?p.lastPutMode:void 0;var C=$n($n({},g),uo.getEventProperties(i,t));for(var _ in C)m[_]=C[_];n&&n.dispatchEvent(m),b[w]&&b[w].call(t,m)}}var lD=["evt"],Le=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.evt,s=QM(i,lD);uo.pluginEvent.bind(ot)(t,n,$n({dragEl:X,parentEl:Zt,ghostEl:dt,rootEl:Yt,nextEl:cr,lastDownEl:Qo,cloneEl:Qt,cloneHidden:ki,dragStarted:Zs,putSortable:ve,activeSortable:ot.active,originalEvent:r,oldIndex:os,oldDraggableIndex:_a,newIndex:Ve,newDraggableIndex:wi,hideGhostForTarget:P0,unhideGhostForTarget:O0,cloneNowHidden:function(){ki=!0},cloneNowShown:function(){ki=!1},dispatchSortableEvent:function(o){Re({sortable:n,name:o,originalEvent:r})}},s))};function Re(e){cD($n({putSortable:ve,cloneEl:Qt,targetEl:X,rootEl:Yt,oldIndex:os,oldDraggableIndex:_a,newIndex:Ve,newDraggableIndex:wi},e))}var X,Zt,dt,Yt,cr,Qo,Qt,ki,os,Ve,_a,wi,Eo,ve,es=!1,Nc=!1,Fc=[],tr,fn,au,ou,hp,dp,Zs,Xr,ya,wa=!1,Mo=!1,Jo,Se,cu=[],ah=!1,Bc=[],ml=typeof document<"u",Do=pd,fp=lo||pi?"cssFloat":"float",uD=ml&&!w0&&!pd&&"draggable"in document.createElement("div"),I0=(function(){if(ml){if(pi)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}})(),R0=function(t,n){var i=at(t),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),s=Cs(t,0,n),a=Cs(t,1,n),o=s&&at(s),c=a&&at(a),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+oe(s).width,h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+oe(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&o.float&&o.float!=="none"){var u=o.float==="left"?"left":"right";return a&&(c.clear==="both"||c.clear===u)?"vertical":"horizontal"}return s&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||l>=r&&i[fp]==="none"||a&&i[fp]==="none"&&l+h>r)?"vertical":"horizontal"},hD=function(t,n,i){var r=i?t.left:t.top,s=i?t.right:t.bottom,a=i?t.width:t.height,o=i?n.left:n.top,c=i?n.right:n.bottom,l=i?n.width:n.height;return r===o||s===c||r+a/2===o+l/2},dD=function(t,n){var i;return Fc.some(function(r){var s=r[Fe].options.emptyInsertThreshold;if(!(!s||gd(r))){var a=oe(r),o=t>=a.left-s&&t<=a.right+s,c=n>=a.top-s&&n<=a.bottom+s;if(o&&c)return i=r}}),i},T0=function(t){function n(s,a){return function(o,c,l,h){var u=o.options.group.name&&c.options.group.name&&o.options.group.name===c.options.group.name;if(s==null&&(a||u))return!0;if(s==null||s===!1)return!1;if(a&&s==="clone")return s;if(typeof s=="function")return n(s(o,c,l,h),a)(o,c,l,h);var d=(a?o:c).options.group.name;return s===!0||typeof s=="string"&&s===d||s.join&&s.indexOf(d)>-1}}var i={},r=t.group;(!r||sh(r)!="object")&&(r={name:r}),i.name=r.name,i.checkPull=n(r.pull,!0),i.checkPut=n(r.put),i.revertClone=r.revertClone,t.group=i},P0=function(){!I0&&dt&&at(dt,"display","none")},O0=function(){!I0&&dt&&at(dt,"display","")};ml&&!w0&&document.addEventListener("click",function(e){if(Nc)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Nc=!1,!1},!0);var er=function(t){if(X){t=t.touches?t.touches[0]:t;var n=dD(t.clientX,t.clientY);if(n){var i={};for(var r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[Fe]._onDragOver(i)}}},fD=function(t){X&&X.parentNode[Fe]._isOutsideThisEl(t.target)};function ot(e,t){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=ai({},t),e[Fe]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return R0(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:ot.supportPointer!==!1&&"PointerEvent"in window&&(!va||pd),emptyInsertThreshold:5};uo.initializePlugins(this,e,n);for(var i in n)!(i in t)&&(t[i]=n[i]);T0(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:uD,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Et(e,"pointerdown",this._onTapStart):(Et(e,"mousedown",this._onTapStart),Et(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Et(e,"dragover",this),Et(e,"dragenter",this)),Fc.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ai(this,sD())}ot.prototype={constructor:ot,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Xr=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,X):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,i=this.el,r=this.options,s=r.preventOnFilter,a=t.type,o=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,c=(o||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||c,h=r.filter;if(wD(i),!X&&!(/mousedown|pointerdown/.test(a)&&t.button!==0||r.disabled)&&!l.isContentEditable&&!(!this.nativeDraggable&&va&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=gn(c,r.draggable,i,!1),!(c&&c.animated)&&Qo!==c)){if(os=on(c),_a=on(c,r.draggable),typeof h=="function"){if(h.call(this,t,c,this)){Re({sortable:n,rootEl:l,name:"filter",targetEl:c,toEl:i,fromEl:i}),Le("filter",n,{evt:t}),s&&t.preventDefault();return}}else if(h&&(h=h.split(",").some(function(u){if(u=gn(l,u.trim(),i,!1),u)return Re({sortable:n,rootEl:u,name:"filter",targetEl:c,fromEl:i,toEl:i}),Le("filter",n,{evt:t}),!0}),h)){s&&t.preventDefault();return}r.handle&&!gn(l,r.handle,i,!1)||this._prepareDragStart(t,o,c)}}},_prepareDragStart:function(t,n,i){var r=this,s=r.el,a=r.options,o=s.ownerDocument,c;if(i&&!X&&i.parentNode===s){var l=oe(i);if(Yt=s,X=i,Zt=X.parentNode,cr=X.nextSibling,Qo=i,Eo=a.group,ot.dragged=X,tr={target:X,clientX:(n||t).clientX,clientY:(n||t).clientY},hp=tr.clientX-l.left,dp=tr.clientY-l.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,X.style["will-change"]="all",c=function(){if(Le("delayEnded",r,{evt:t}),ot.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!op&&r.nativeDraggable&&(X.draggable=!0),r._triggerDragStart(t,n),Re({sortable:r,name:"choose",originalEvent:t}),He(X,a.chosenClass,!0)},a.ignore.split(",").forEach(function(h){C0(X,h.trim(),lu)}),Et(o,"dragover",er),Et(o,"mousemove",er),Et(o,"touchmove",er),a.supportPointer?(Et(o,"pointerup",r._onDrop),!this.nativeDraggable&&Et(o,"pointercancel",r._onDrop)):(Et(o,"mouseup",r._onDrop),Et(o,"touchend",r._onDrop),Et(o,"touchcancel",r._onDrop)),op&&this.nativeDraggable&&(this.options.touchStartThreshold=4,X.draggable=!0),Le("delayStart",this,{evt:t}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(lo||pi))){if(ot.eventCanceled){this._onDrop();return}a.supportPointer?(Et(o,"pointerup",r._disableDelayedDrag),Et(o,"pointercancel",r._disableDelayedDrag)):(Et(o,"mouseup",r._disableDelayedDrag),Et(o,"touchend",r._disableDelayedDrag),Et(o,"touchcancel",r._disableDelayedDrag)),Et(o,"mousemove",r._delayedDragTouchMoveHandler),Et(o,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&Et(o,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(c,a.delay)}else c()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){X&&lu(X),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;Ct(t,"mouseup",this._disableDelayedDrag),Ct(t,"touchend",this._disableDelayedDrag),Ct(t,"touchcancel",this._disableDelayedDrag),Ct(t,"pointerup",this._disableDelayedDrag),Ct(t,"pointercancel",this._disableDelayedDrag),Ct(t,"mousemove",this._delayedDragTouchMoveHandler),Ct(t,"touchmove",this._delayedDragTouchMoveHandler),Ct(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?Et(document,"pointermove",this._onTouchMove):n?Et(document,"touchmove",this._onTouchMove):Et(document,"mousemove",this._onTouchMove):(Et(X,"dragend",this),Et(Yt,"dragstart",this._onDragStart));try{document.selection?Zo(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(es=!1,Yt&&X){Le("dragStarted",this,{evt:n}),this.nativeDraggable&&Et(document,"dragover",fD);var i=this.options;!t&&He(X,i.dragClass,!1),He(X,i.ghostClass,!0),ot.active=this,t&&this._appendGhost(),Re({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(fn){this._lastX=fn.clientX,this._lastY=fn.clientY,P0();for(var t=document.elementFromPoint(fn.clientX,fn.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(fn.clientX,fn.clientY),t!==n);)n=t;if(X.parentNode[Fe]._isOutsideThisEl(t),n)do{if(n[Fe]){var i=void 0;if(i=n[Fe]._onDragOver({clientX:fn.clientX,clientY:fn.clientY,target:t,rootEl:n}),i&&!this.options.dragoverBubble)break}t=n}while(n=S0(n));O0()}},_onTouchMove:function(t){if(tr){var n=this.options,i=n.fallbackTolerance,r=n.fallbackOffset,s=t.touches?t.touches[0]:t,a=dt&&ds(dt,!0),o=dt&&a&&a.a,c=dt&&a&&a.d,l=Do&&Se&&up(Se),h=(s.clientX-tr.clientX+r.x)/(o||1)+(l?l[0]-cu[0]:0)/(o||1),u=(s.clientY-tr.clientY+r.y)/(c||1)+(l?l[1]-cu[1]:0)/(c||1);if(!ot.active&&!es){if(i&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<i)return;this._onDragStart(t,!0)}if(dt){a?(a.e+=h-(au||0),a.f+=u-(ou||0)):a={a:1,b:0,c:0,d:1,e:h,f:u};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");at(dt,"webkitTransform",d),at(dt,"mozTransform",d),at(dt,"msTransform",d),at(dt,"transform",d),au=h,ou=u,fn=s}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!dt){var t=this.options.fallbackOnBody?document.body:Yt,n=oe(X,!0,Do,!0,t),i=this.options;if(Do){for(Se=t;at(Se,"position")==="static"&&at(Se,"transform")==="none"&&Se!==document;)Se=Se.parentNode;Se!==document.body&&Se!==document.documentElement?(Se===document&&(Se=Rn()),n.top+=Se.scrollTop,n.left+=Se.scrollLeft):Se=Rn(),cu=up(Se)}dt=X.cloneNode(!0),He(dt,i.ghostClass,!1),He(dt,i.fallbackClass,!0),He(dt,i.dragClass,!0),at(dt,"transition",""),at(dt,"transform",""),at(dt,"box-sizing","border-box"),at(dt,"margin",0),at(dt,"top",n.top),at(dt,"left",n.left),at(dt,"width",n.width),at(dt,"height",n.height),at(dt,"opacity","0.8"),at(dt,"position",Do?"absolute":"fixed"),at(dt,"zIndex","100000"),at(dt,"pointerEvents","none"),ot.ghost=dt,t.appendChild(dt),at(dt,"transform-origin",hp/parseInt(dt.style.width)*100+"% "+dp/parseInt(dt.style.height)*100+"%")}},_onDragStart:function(t,n){var i=this,r=t.dataTransfer,s=i.options;if(Le("dragStart",this,{evt:t}),ot.eventCanceled){this._onDrop();return}Le("setupClone",this),ot.eventCanceled||(Qt=M0(X),Qt.removeAttribute("id"),Qt.draggable=!1,Qt.style["will-change"]="",this._hideClone(),He(Qt,this.options.chosenClass,!1),ot.clone=Qt),i.cloneId=Zo(function(){Le("clone",i),!ot.eventCanceled&&(i.options.removeCloneOnHide||Yt.insertBefore(Qt,X),i._hideClone(),Re({sortable:i,name:"clone"}))}),!n&&He(X,s.dragClass,!0),n?(Nc=!0,i._loopId=setInterval(i._emulateDragOver,50)):(Ct(document,"mouseup",i._onDrop),Ct(document,"touchend",i._onDrop),Ct(document,"touchcancel",i._onDrop),r&&(r.effectAllowed="move",s.setData&&s.setData.call(i,r,X)),Et(document,"drop",i),at(X,"transform","translateZ(0)")),es=!0,i._dragStartId=Zo(i._dragStarted.bind(i,n,t)),Et(document,"selectstart",i),Zs=!0,window.getSelection().removeAllRanges(),va&&at(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,i=t.target,r,s,a,o=this.options,c=o.group,l=ot.active,h=Eo===c,u=o.sort,d=ve||l,p,g=this,m=!1;if(ah)return;function b(Z,j){Le(Z,g,$n({evt:t,isOwner:h,axis:p?"vertical":"horizontal",revert:a,dragRect:r,targetRect:s,canSort:u,fromSortable:d,target:i,completed:C,onMove:function(G,tt){return Io(Yt,n,X,r,G,oe(G),t,tt)},changed:_},j))}function w(){b("dragOverAnimationCapture"),g.captureAnimationState(),g!==d&&d.captureAnimationState()}function C(Z){return b("dragOverCompleted",{insertion:Z}),Z&&(h?l._hideClone():l._showClone(g),g!==d&&(He(X,ve?ve.options.ghostClass:l.options.ghostClass,!1),He(X,o.ghostClass,!0)),ve!==g&&g!==ot.active?ve=g:g===ot.active&&ve&&(ve=null),d===g&&(g._ignoreWhileAnimating=i),g.animateAll(function(){b("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(i===X&&!X.animated||i===n&&!i.animated)&&(Xr=null),!o.dragoverBubble&&!t.rootEl&&i!==document&&(X.parentNode[Fe]._isOutsideThisEl(t.target),!Z&&er(t)),!o.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function _(){Ve=on(X),wi=on(X,o.draggable),Re({sortable:g,name:"change",toEl:n,newIndex:Ve,newDraggableIndex:wi,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),i=gn(i,o.draggable,n,!0),b("dragOver"),ot.eventCanceled)return m;if(X.contains(t.target)||i.animated&&i.animatingX&&i.animatingY||g._ignoreWhileAnimating===i)return C(!1);if(Nc=!1,l&&!o.disabled&&(h?u||(a=Zt!==Yt):ve===this||(this.lastPutMode=Eo.checkPull(this,l,X,t))&&c.checkPut(this,l,X,t))){if(p=this._getDirection(t,i)==="vertical",r=oe(X),b("dragOverValid"),ot.eventCanceled)return m;if(a)return Zt=Yt,w(),this._hideClone(),b("revert"),ot.eventCanceled||(cr?Yt.insertBefore(X,cr):Yt.appendChild(X)),C(!0);var k=gd(n,o.draggable);if(!k||vD(t,p,this)&&!k.animated){if(k===X)return C(!1);if(k&&n===t.target&&(i=k),i&&(s=oe(i)),Io(Yt,n,X,r,i,s,t,!!i)!==!1)return w(),k&&k.nextSibling?n.insertBefore(X,k.nextSibling):n.appendChild(X),Zt=n,_(),C(!0)}else if(k&&mD(t,p,this)){var x=Cs(n,0,o,!0);if(x===X)return C(!1);if(i=x,s=oe(i),Io(Yt,n,X,r,i,s,t,!1)!==!1)return w(),n.insertBefore(X,x),Zt=n,_(),C(!0)}else if(i.parentNode===n){s=oe(i);var I=0,E,y=X.parentNode!==n,M=!hD(X.animated&&X.toRect||r,i.animated&&i.toRect||s,p),D=p?"top":"left",R=lp(i,"top","top")||lp(X,"top","top"),P=R?R.scrollTop:void 0;Xr!==i&&(E=s[D],wa=!1,Mo=!M&&o.invertSwap||y),I=bD(t,i,s,p,M?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,Mo,Xr===i);var N;if(I!==0){var U=on(X);do U-=I,N=Zt.children[U];while(N&&(at(N,"display")==="none"||N===dt))}if(I===0||N===i)return C(!1);Xr=i,ya=I;var H=i.nextElementSibling,Y=!1;Y=I===1;var K=Io(Yt,n,X,r,i,s,t,Y);if(K!==!1)return(K===1||K===-1)&&(Y=K===1),ah=!0,setTimeout(gD,30),w(),Y&&!H?n.appendChild(X):i.parentNode.insertBefore(X,Y?H:i),R&&E0(R,0,P-R.scrollTop),Zt=X.parentNode,E!==void 0&&!Mo&&(Jo=Math.abs(E-oe(i)[D])),_(),C(!0)}if(n.contains(X))return C(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Ct(document,"mousemove",this._onTouchMove),Ct(document,"touchmove",this._onTouchMove),Ct(document,"pointermove",this._onTouchMove),Ct(document,"dragover",er),Ct(document,"mousemove",er),Ct(document,"touchmove",er)},_offUpEvents:function(){var t=this.el.ownerDocument;Ct(t,"mouseup",this._onDrop),Ct(t,"touchend",this._onDrop),Ct(t,"pointerup",this._onDrop),Ct(t,"pointercancel",this._onDrop),Ct(t,"touchcancel",this._onDrop),Ct(document,"selectstart",this)},_onDrop:function(t){var n=this.el,i=this.options;if(Ve=on(X),wi=on(X,i.draggable),Le("drop",this,{evt:t}),Zt=X&&X.parentNode,Ve=on(X),wi=on(X,i.draggable),ot.eventCanceled){this._nulling();return}es=!1,Mo=!1,wa=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),oh(this.cloneId),oh(this._dragStartId),this.nativeDraggable&&(Ct(document,"drop",this),Ct(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),va&&at(document.body,"user-select",""),at(X,"transform",""),t&&(Zs&&(t.cancelable&&t.preventDefault(),!i.dropBubble&&t.stopPropagation()),dt&&dt.parentNode&&dt.parentNode.removeChild(dt),(Yt===Zt||ve&&ve.lastPutMode!=="clone")&&Qt&&Qt.parentNode&&Qt.parentNode.removeChild(Qt),X&&(this.nativeDraggable&&Ct(X,"dragend",this),lu(X),X.style["will-change"]="",Zs&&!es&&He(X,ve?ve.options.ghostClass:this.options.ghostClass,!1),He(X,this.options.chosenClass,!1),Re({sortable:this,name:"unchoose",toEl:Zt,newIndex:null,newDraggableIndex:null,originalEvent:t}),Yt!==Zt?(Ve>=0&&(Re({rootEl:Zt,name:"add",toEl:Zt,fromEl:Yt,originalEvent:t}),Re({sortable:this,name:"remove",toEl:Zt,originalEvent:t}),Re({rootEl:Zt,name:"sort",toEl:Zt,fromEl:Yt,originalEvent:t}),Re({sortable:this,name:"sort",toEl:Zt,originalEvent:t})),ve&&ve.save()):Ve!==os&&Ve>=0&&(Re({sortable:this,name:"update",toEl:Zt,originalEvent:t}),Re({sortable:this,name:"sort",toEl:Zt,originalEvent:t})),ot.active&&((Ve==null||Ve===-1)&&(Ve=os,wi=_a),Re({sortable:this,name:"end",toEl:Zt,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){Le("nulling",this),Yt=X=Zt=dt=cr=Qt=Qo=ki=tr=fn=Zs=Ve=wi=os=_a=Xr=ya=ve=Eo=ot.dragged=ot.ghost=ot.clone=ot.active=null;var t=this.el;Bc.forEach(function(n){t.contains(n)&&(n.checked=!0)}),Bc.length=au=ou=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":X&&(this._onDragOver(t),pD(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,i=this.el.children,r=0,s=i.length,a=this.options;r<s;r++)n=i[r],gn(n,a.draggable,this.el,!1)&&t.push(n.getAttribute(a.dataIdAttr)||yD(n));return t},sort:function(t,n){var i={},r=this.el;this.toArray().forEach(function(s,a){var o=r.children[a];gn(o,this.options.draggable,r,!1)&&(i[s]=o)},this),n&&this.captureAnimationState(),t.forEach(function(s){i[s]&&(r.removeChild(i[s]),r.appendChild(i[s]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return gn(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var i=this.options;if(n===void 0)return i[t];var r=uo.modifyOption(this,t,n);typeof r<"u"?i[t]=r:i[t]=n,t==="group"&&T0(i)},destroy:function(){Le("destroy",this);var t=this.el;t[Fe]=null,Ct(t,"mousedown",this._onTapStart),Ct(t,"touchstart",this._onTapStart),Ct(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ct(t,"dragover",this),Ct(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Fc.splice(Fc.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ki){if(Le("hideClone",this),ot.eventCanceled)return;at(Qt,"display","none"),this.options.removeCloneOnHide&&Qt.parentNode&&Qt.parentNode.removeChild(Qt),ki=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ki){if(Le("showClone",this),ot.eventCanceled)return;X.parentNode==Yt&&!this.options.group.revertClone?Yt.insertBefore(Qt,X):cr?Yt.insertBefore(Qt,cr):Yt.appendChild(Qt),this.options.group.revertClone&&this.animate(X,Qt),at(Qt,"display",""),ki=!1}}};function pD(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Io(e,t,n,i,r,s,a,o){var c,l=e[Fe],h=l.options.onMove,u;return window.CustomEvent&&!pi&&!lo?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=t,c.from=e,c.dragged=n,c.draggedRect=i,c.related=r||t,c.relatedRect=s||oe(t),c.willInsertAfter=o,c.originalEvent=a,e.dispatchEvent(c),h&&(u=h.call(l,c,a)),u}function lu(e){e.draggable=!1}function gD(){ah=!1}function mD(e,t,n){var i=oe(Cs(n.el,0,n.options,!0)),r=D0(n.el,n.options,dt),s=10;return t?e.clientX<r.left-s||e.clientY<i.top&&e.clientX<i.right:e.clientY<r.top-s||e.clientY<i.bottom&&e.clientX<i.left}function vD(e,t,n){var i=oe(gd(n.el,n.options.draggable)),r=D0(n.el,n.options,dt),s=10;return t?e.clientX>r.right+s||e.clientY>i.bottom&&e.clientX>i.left:e.clientY>r.bottom+s||e.clientX>i.right&&e.clientY>i.top}function bD(e,t,n,i,r,s,a,o){var c=i?e.clientY:e.clientX,l=i?n.height:n.width,h=i?n.top:n.left,u=i?n.bottom:n.right,d=!1;if(!a){if(o&&Jo<l*r){if(!wa&&(ya===1?c>h+l*s/2:c<u-l*s/2)&&(wa=!0),wa)d=!0;else if(ya===1?c<h+Jo:c>u-Jo)return-ya}else if(c>h+l*(1-r)/2&&c<u-l*(1-r)/2)return _D(t)}return d=d||a,d&&(c<h+l*s/2||c>u-l*s/2)?c>h+l/2?1:-1:0}function _D(e){return on(X)<on(e)?1:-1}function yD(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function wD(e){Bc.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&Bc.push(i)}}function Zo(e){return setTimeout(e,0)}function oh(e){return clearTimeout(e)}ml&&Et(document,"touchmove",function(e){(ot.active||es)&&e.cancelable&&e.preventDefault()});ot.utils={on:Et,off:Ct,css:at,find:C0,is:function(t,n){return!!gn(t,n,t,!1)},extend:iD,throttle:k0,closest:gn,toggleClass:He,clone:M0,index:on,nextTick:Zo,cancelNextTick:oh,detectDirection:R0,getChild:Cs,expando:Fe};ot.get=function(e){return e[Fe]};ot.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(ot.utils=$n($n({},ot.utils),i.utils)),uo.mount(i)})};ot.create=function(e,t){return new ot(e,t)};ot.version=eD;var ae=[],ta,ch,lh=!1,uu,hu,jc,ea;function xD(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return e.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?Et(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Et(document,"pointermove",this._handleFallbackAutoScroll):i.touches?Et(document,"touchmove",this._handleFallbackAutoScroll):Et(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?Ct(document,"dragover",this._handleAutoScroll):(Ct(document,"pointermove",this._handleFallbackAutoScroll),Ct(document,"touchmove",this._handleFallbackAutoScroll),Ct(document,"mousemove",this._handleFallbackAutoScroll)),pp(),tc(),rD()},nulling:function(){jc=ch=ta=lh=ea=uu=hu=null,ae.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var r=this,s=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,o=document.elementFromPoint(s,a);if(jc=n,i||this.options.forceAutoScrollFallback||lo||pi||va){du(n,this.options,o,i);var c=Di(o,!0);lh&&(!ea||s!==uu||a!==hu)&&(ea&&pp(),ea=setInterval(function(){var l=Di(document.elementFromPoint(s,a),!0);l!==c&&(c=l,tc()),du(n,r.options,l,i)},10),uu=s,hu=a)}else{if(!this.options.bubbleScroll||Di(o,!0)===Rn()){tc();return}du(n,this.options,Di(o,!1),!1)}}},ai(e,{pluginName:"scroll",initializeByDefault:!0})}function tc(){ae.forEach(function(e){clearInterval(e.pid)}),ae=[]}function pp(){clearInterval(ea)}var du=k0(function(e,t,n,i){if(t.scroll){var r=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,o=t.scrollSpeed,c=Rn(),l=!1,h;ch!==n&&(ch=n,tc(),ta=t.scroll,h=t.scrollFn,ta===!0&&(ta=Di(n,!0)));var u=0,d=ta;do{var p=d,g=oe(p),m=g.top,b=g.bottom,w=g.left,C=g.right,_=g.width,k=g.height,x=void 0,I=void 0,E=p.scrollWidth,y=p.scrollHeight,M=at(p),D=p.scrollLeft,R=p.scrollTop;p===c?(x=_<E&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),I=k<y&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(x=_<E&&(M.overflowX==="auto"||M.overflowX==="scroll"),I=k<y&&(M.overflowY==="auto"||M.overflowY==="scroll"));var P=x&&(Math.abs(C-r)<=a&&D+_<E)-(Math.abs(w-r)<=a&&!!D),N=I&&(Math.abs(b-s)<=a&&R+k<y)-(Math.abs(m-s)<=a&&!!R);if(!ae[u])for(var U=0;U<=u;U++)ae[U]||(ae[U]={});(ae[u].vx!=P||ae[u].vy!=N||ae[u].el!==p)&&(ae[u].el=p,ae[u].vx=P,ae[u].vy=N,clearInterval(ae[u].pid),(P!=0||N!=0)&&(l=!0,ae[u].pid=setInterval((function(){i&&this.layer===0&&ot.active._onTouchMove(jc);var H=ae[this.layer].vy?ae[this.layer].vy*o:0,Y=ae[this.layer].vx?ae[this.layer].vx*o:0;typeof h=="function"&&h.call(ot.dragged.parentNode[Fe],Y,H,e,jc,ae[this.layer].el)!=="continue"||E0(ae[this.layer].el,Y,H)}).bind({layer:u}),24))),u++}while(t.bubbleScroll&&d!==c&&(d=Di(d,!1)));lh=l}},30),A0=function(t){var n=t.originalEvent,i=t.putSortable,r=t.dragEl,s=t.activeSortable,a=t.dispatchSortableEvent,o=t.hideGhostForTarget,c=t.unhideGhostForTarget;if(n){var l=i||s;o();var h=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,u=document.elementFromPoint(h.clientX,h.clientY);c(),l&&!l.el.contains(u)&&(a("spill"),this.onSpill({dragEl:r,putSortable:i}))}};function md(){}md.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,i=t.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var r=Cs(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:A0};ai(md,{pluginName:"revertOnSpill"});function vd(){}vd.prototype={onSpill:function(t){var n=t.dragEl,i=t.putSortable,r=i||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:A0};ai(vd,{pluginName:"removeOnSpill"});ot.mount(new xD);ot.mount(vd,md);class Ni{constructor(){}static async all(){return(await(await ht()).dashboardCharts.all()).sort((i,r)=>i.position-r.position)}static async create(t){const n=await ht(),i=Pe();return await n.dashboardCharts.put({...t,id:i}),i}static async update(t,n){const i=await ht(),r=await i.dashboardCharts.get(t);await i.dashboardCharts.put({...r,...n})}static async remove(t){await(await ht()).dashboardCharts.remove(t)}static async reorder(t){const n=await ht();await Promise.all(t.map(async(i,r)=>{const s=await n.dashboardCharts.get(i);await n.dashboardCharts.put({...s,position:r})}))}}class ks{constructor(){}static async all(){return(await(await ht()).dashboardTables.all()).sort((i,r)=>i.position-r.position)}static async create(t){const n=await ht(),i=Pe();return await n.dashboardTables.put({...t,id:i}),i}static async update(t,n){const i=await ht(),r=await i.dashboardTables.get(t);await i.dashboardTables.put({...r,...n})}static async remove(t){await(await ht()).dashboardTables.remove(t)}static async reorder(t){const n=await ht();await Promise.all(t.map(async(i,r)=>{const s=await n.dashboardTables.get(i);await n.dashboardTables.put({...s,position:r})}))}}class oi{constructor(){}static async all(){return(await ht()).merchants.all()}static async get(t){const n=await ht();try{return await n.merchants.get(t)}catch{return}}static async create(t){const n=await ht(),i=Pe();return await n.merchants.put({id:i,name:t}),i}static async update(t,n){const i=await ht(),r=await i.merchants.get(t);await i.merchants.put({...r,...n})}static async remove(t){await(await ht()).merchants.remove(t)}static async byName(t){return(await(await ht()).merchants.all()).find(r=>r.name.toLowerCase()===t.toLowerCase())}}function SD(){const e=40+Math.floor(Math.random()*20),t=20+Math.floor(Math.random()*30),n=Math.floor(Math.random()*360);return`lch(${e} ${t} ${n})`}class hn{constructor(){}static async all(){return(await ht()).tags.all()}static async create(t,n){const i=await ht(),r=Pe();return await i.tags.put({id:r,name:t,color:SD(),...n}),r}static async update(t,n){const i=await ht(),r=await i.tags.get(t);await i.tags.put({...r,...n})}static async remove(t){await(await ht()).tags.remove(t)}static async byName(t){return(await(await ht()).tags.all()).find(r=>r.name.toLowerCase()===t.toLowerCase())}}const As=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-trash-2"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10 11v6" />
  <path d="M14 11v6" />
  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
  <path d="M3 6h18" />
  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
</svg>
`,$s=Bt`
  .icon-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    color: var(--budgee-text-muted);
    transition:
      color 0.15s,
      background-color 0.15s;
  }
  .icon-btn:hover {
    color: var(--budgee-text);
    background-color: color-mix(in lch, var(--budgee-text) 10%, transparent);
  }
  .icon-btn svg {
    width: 20px;
    height: 20px;
  }
  .icon-btn--danger:hover {
    color: var(--budgee-danger);
    background-color: color-mix(in lch, var(--budgee-danger) 15%, transparent);
  }
`;var CD=Object.defineProperty,kD=Object.getOwnPropertyDescriptor,$0=e=>{throw TypeError(e)},ho=(e,t,n,i)=>{for(var r=i>1?void 0:i?kD(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&CD(t,n,r),r},ED=(e,t,n)=>t.has(e)||$0("Cannot "+n),MD=(e,t,n)=>t.has(e)?$0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),vn=(e,t,n)=>(ED(e,t,"access private method"),n),Ye,vl,L0,N0,na,F0,B0;const DD=[{value:"tag",label:"Tag"},{value:"merchant",label:"Merchant"},{value:"amount",label:"Amount"},{value:"description",label:"Description"}],j0={tag:[{value:"is",label:"is"},{value:"isNot",label:"is not"}],merchant:[{value:"is",label:"is"},{value:"isNot",label:"is not"}],amount:[{value:"lt",label:"<"},{value:"gt",label:">"},{value:"lte",label:"<="},{value:"gte",label:">="}],description:[{value:"contains",label:"contains"},{value:"excludes",label:"excludes"}]};let Rr=class extends $t{constructor(){super(...arguments),MD(this,Ye),this.condition={field:"tag",operator:"is",value:""},this.index=0,this.tags=[],this.merchants=[]}render(){const e=j0[this.condition.field];return F`
      <select @change=${vn(this,Ye,L0)}>
        ${DD.map(t=>F`<option value=${t.value} ?selected=${this.condition.field===t.value}>${t.label}</option>`)}
      </select>
      <select @change=${vn(this,Ye,N0)}>
        ${e.map(t=>F`<option value=${t.value} ?selected=${this.condition.operator===t.value}>${t.label}</option>`)}
      </select>
      ${vn(this,Ye,B0).call(this)}
      <button class="icon-btn icon-btn--danger" aria-label="Remove filter" @click=${vn(this,Ye,F0)}>${ye(As)}</button>
    `}};Ye=new WeakSet;vl=function(e){this.dispatchEvent(new CustomEvent("filter-changed",{detail:{index:this.index,condition:e}}))};L0=function(e){const t=e.target.value,n=j0[t];vn(this,Ye,vl).call(this,{field:t,operator:n[0].value,value:""})};N0=function(e){const t=e.target.value;vn(this,Ye,vl).call(this,{...this.condition,operator:t})};na=function(e){const t=e.target.value;vn(this,Ye,vl).call(this,{...this.condition,value:t})};F0=function(){this.dispatchEvent(new CustomEvent("filter-removed",{detail:{index:this.index}}))};B0=function(){const{field:e}=this.condition;return e==="tag"?F`
        <select @change=${vn(this,Ye,na)}>
          <option value="">--</option>
          ${this.tags.map(t=>F`<option value=${t.id} ?selected=${this.condition.value===t.id}>${t.name}</option>`)}
        </select>
      `:e==="merchant"?F`
        <select @change=${vn(this,Ye,na)}>
          <option value="">--</option>
          ${this.merchants.map(t=>F`<option value=${t.id} ?selected=${this.condition.value===t.id}>${t.name}</option>`)}
        </select>
      `:e==="amount"?F`
        <input
          type="number"
          placeholder="e.g. 0"
          .value=${this.condition.value}
          @input=${vn(this,Ye,na)}
        />
      `:F`
      <input
        type="text"
        placeholder="value"
        .value=${this.condition.value}
        @input=${vn(this,Ye,na)}
      />
    `};Rr.styles=[$s,Bt`
      :host {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        margin-bottom: 0.25rem;
      }
      select,
      input {
        padding: 4px 8px;
      }
      input {
        flex: 1;
      }
    `];ho([pt({type:Object})],Rr.prototype,"condition",2);ho([pt({type:Number})],Rr.prototype,"index",2);ho([pt({type:Array})],Rr.prototype,"tags",2);ho([pt({type:Array})],Rr.prototype,"merchants",2);Rr=ho([Ut("chart-filter-row")],Rr);var ID=Object.defineProperty,RD=Object.getOwnPropertyDescriptor,z0=e=>{throw TypeError(e)},Ae=(e,t,n,i)=>{for(var r=i>1?void 0:i?RD(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&ID(t,n,r),r},TD=(e,t,n)=>t.has(e)||z0("Cannot "+n),PD=(e,t,n)=>t.has(e)?z0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),lr=(e,t,n)=>(TD(e,t,"access private method"),n),Un,W0,H0,U0,V0,q0,K0,Y0;const fu=new Set(["pie","doughnut"]);let we=class extends $t{constructor(){super(...arguments),PD(this,Un),this.transactions=[],this.tags=[],this.merchants=[],this._title="",this._chartType="bar",this._granularity="month",this._startDate="",this._filters=[],this._excludedTagIds=[],this._excludedMerchantIds=[],this._legendPosition="top",this._showExclusions=!1,this._initialized=!1}updated(e){e.has("editingChart")&&this.editingChart&&!this._initialized&&(this._title=this.editingChart.title,this._chartType=this.editingChart.chartType,this._granularity=this.editingChart.granularity,this._startDate=this.editingChart.startDate??"",this._filters=this.editingChart.filters??lr(this,Un,W0).call(this,this.editingChart),this._excludedTagIds=this.editingChart.excludedTagIds??[],this._excludedMerchantIds=this.editingChart.excludedMerchantIds??[],this._legendPosition=this.editingChart.legendPosition??"top",this._initialized=!0)}render(){return F`
      <h4>${this.editingChart?"Edit Chart":"Add Chart"}</h4>
      <div class="form-grid">
        <label>Title:</label>
        <input
          type="text"
          .value=${this._title}
          @input=${e=>{this._title=e.target.value}}
        />
        <label>Type:</label>
        <select @change=${e=>{this._chartType=e.target.value,fu.has(this._chartType)&&!["byTag","byMerchant","month"].includes(this._granularity)&&(this._granularity="byTag")}}>
          <option value="bar" ?selected=${this._chartType==="bar"}>Bar</option>
          <option value="line" ?selected=${this._chartType==="line"}>Line</option>
          <option value="pie" ?selected=${this._chartType==="pie"}>Pie</option>
          <option value="doughnut" ?selected=${this._chartType==="doughnut"}>Doughnut</option>
        </select>
        <label>${fu.has(this._chartType)?"Split by:":"Group by:"}</label>
        <select @change=${e=>{this._granularity=e.target.value}}>
          ${fu.has(this._chartType)?F`
              <option value="byTag" ?selected=${this._granularity==="byTag"}>Tag</option>
              <option value="byMerchant" ?selected=${this._granularity==="byMerchant"}>Merchant</option>
              <option value="month" ?selected=${this._granularity==="month"}>Month</option>
            `:F`
              <option value="day" ?selected=${this._granularity==="day"}>Day</option>
              <option value="month" ?selected=${this._granularity==="month"}>Month</option>
              <option value="year" ?selected=${this._granularity==="year"}>Year</option>
              <option value="byTag" ?selected=${this._granularity==="byTag"}>Tag</option>
              <option value="byMerchant" ?selected=${this._granularity==="byMerchant"}>Merchant</option>
            `}
        </select>
        <label>Start date:</label>
        <input
          type="text"
          placeholder="e.g. 3 months ago"
          .value=${this._startDate}
          @input=${e=>{this._startDate=e.target.value}}
        />
      </div>
      <div class="filters">
        ${this._filters.map((e,t)=>F`
          <chart-filter-row
            .condition=${e}
            .index=${t}
            .tags=${this.tags}
            .merchants=${this.merchants}
            @filter-changed=${lr(this,Un,H0)}
            @filter-removed=${lr(this,Un,U0)}
          ></chart-filter-row>
        `)}
        <button class="add-filter" @click=${lr(this,Un,V0)}>+ Add filter</button>
      </div>
      <div class="form-grid">
        <label>Legend:</label>
        <select @change=${e=>{this._legendPosition=e.target.value}}>
          <option value="top" ?selected=${this._legendPosition==="top"}>Top</option>
          <option value="bottom" ?selected=${this._legendPosition==="bottom"}>Bottom</option>
          <option value="left" ?selected=${this._legendPosition==="left"}>Left</option>
          <option value="right" ?selected=${this._legendPosition==="right"}>Right</option>
          <option value="hidden" ?selected=${this._legendPosition==="hidden"}>Hidden</option>
        </select>
      </div>
      ${lr(this,Un,K0).call(this)}
      <button @click=${lr(this,Un,q0)}>${this.editingChart?"Update Chart":"Save to Dashboard"}</button>
    `}};Un=new WeakSet;W0=function(e){const t=[];return e.tagId&&t.push({field:"tag",operator:"is",value:e.tagId}),e.merchantId&&t.push({field:"merchant",operator:"is",value:e.merchantId}),e.direction==="debit"?t.push({field:"amount",operator:"lt",value:"0"}):e.direction==="credit"&&t.push({field:"amount",operator:"gt",value:"0"}),e.descriptionFilter&&t.push({field:"description",operator:e.descriptionFilterMode==="include"?"contains":"excludes",value:e.descriptionFilter}),t};H0=function(e){const{index:t,condition:n}=e.detail;this._filters=this._filters.map((i,r)=>r===t?n:i)};U0=function(e){const{index:t}=e.detail;this._filters=this._filters.filter((n,i)=>i!==t)};V0=function(){this._filters=[...this._filters,{field:"tag",operator:"is",value:""}]};q0=function(){const e=this._title.trim();if(!e)return;const t=this._filters.filter(n=>n.value.trim());this.dispatchEvent(new CustomEvent("chart-saved",{detail:{id:this.editingChart?.id,title:e,chartType:this._chartType,granularity:this._granularity,startDate:this._startDate||void 0,excludedTagIds:this._excludedTagIds.length>0?this._excludedTagIds:void 0,excludedMerchantIds:this._excludedMerchantIds.length>0?this._excludedMerchantIds:void 0,legendPosition:this._legendPosition,filters:t.length>0?t:void 0}})),this._title="",this._initialized=!1};K0=function(){if(this._granularity!=="byTag"&&this._granularity!=="byMerchant")return"";const e=this._granularity==="byTag"?this.tags:this.merchants,t=this._granularity==="byTag"?this._excludedTagIds:this._excludedMerchantIds,n=this._granularity==="byTag"?"tags":"merchants";return F`
      <details class="exclusions" ?open=${this._showExclusions} @toggle=${i=>{this._showExclusions=i.target.open}}>
        <summary>Exclude ${n}</summary>
        <div class="checkbox-list">
          ${e.map(i=>F`
            <label>
              <input
                type="checkbox"
                ?checked=${t.includes(i.id)}
                @change=${r=>lr(this,Un,Y0).call(this,i.id,r.target.checked)}
              />
              ${i.name}
            </label>
          `)}
        </div>
      </details>
    `};Y0=function(e,t){this._granularity==="byTag"?this._excludedTagIds=t?[...this._excludedTagIds,e]:this._excludedTagIds.filter(n=>n!==e):this._excludedMerchantIds=t?[...this._excludedMerchantIds,e]:this._excludedMerchantIds.filter(n=>n!==e)};we.styles=Bt`
    :host {
      display: block;
      border: 1px solid var(--budgee-border);
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
      background: var(--budgee-surface);
    }
    h4 {
      margin-top: 0;
    }
    .form-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.5rem;
      align-items: center;
      margin-bottom: 1rem;
    }
    input,
    select {
      padding: 4px 8px;
    }
    button {
      padding: 4px 12px;
      cursor: pointer;
      background-color: var(--budgee-primary);
      color: white;
      border: none;
      border-radius: 4px;
      margin-right: 0.5rem;
    }
    button:hover {
      background-color: var(--budgee-primary-hover);
    }
    .exclusions {
      margin-bottom: 1rem;
    }
    .exclusions summary {
      cursor: pointer;
      font-weight: 500;
      margin-bottom: 0.5rem;
    }
    .checkbox-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem 1rem;
      max-height: 200px;
      overflow-y: auto;
    }
    .checkbox-list label {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.9rem;
    }
    .filters {
      margin-bottom: 1rem;
    }
    .add-filter {
      font-size: 0.85rem;
    }
  `;Ae([pt({type:Array})],we.prototype,"transactions",2);Ae([pt({type:Array})],we.prototype,"tags",2);Ae([pt({type:Array})],we.prototype,"merchants",2);Ae([pt({type:Object})],we.prototype,"editingChart",2);Ae([W()],we.prototype,"_title",2);Ae([W()],we.prototype,"_chartType",2);Ae([W()],we.prototype,"_granularity",2);Ae([W()],we.prototype,"_startDate",2);Ae([W()],we.prototype,"_filters",2);Ae([W()],we.prototype,"_excludedTagIds",2);Ae([W()],we.prototype,"_excludedMerchantIds",2);Ae([W()],we.prototype,"_legendPosition",2);Ae([W()],we.prototype,"_showExclusions",2);Ae([W()],we.prototype,"_initialized",2);we=Ae([Ut("chart-configurator")],we);function fo(e){return e+.5|0}const Ii=(e,t,n)=>Math.max(Math.min(e,n),t);function ia(e){return Ii(fo(e*2.55),0,255)}function Fi(e){return Ii(fo(e*255),0,255)}function qn(e){return Ii(fo(e/2.55)/100,0,1)}function gp(e){return Ii(fo(e*100),0,100)}const sn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},uh=[..."0123456789ABCDEF"],OD=e=>uh[e&15],AD=e=>uh[(e&240)>>4]+uh[e&15],Ro=e=>(e&240)>>4===(e&15),$D=e=>Ro(e.r)&&Ro(e.g)&&Ro(e.b)&&Ro(e.a);function LD(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&sn[e[1]]*17,g:255&sn[e[2]]*17,b:255&sn[e[3]]*17,a:t===5?sn[e[4]]*17:255}:(t===7||t===9)&&(n={r:sn[e[1]]<<4|sn[e[2]],g:sn[e[3]]<<4|sn[e[4]],b:sn[e[5]]<<4|sn[e[6]],a:t===9?sn[e[7]]<<4|sn[e[8]]:255})),n}const ND=(e,t)=>e<255?t(e):"";function FD(e){var t=$D(e)?OD:AD;return e?"#"+t(e.r)+t(e.g)+t(e.b)+ND(e.a,t):void 0}const BD=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function X0(e,t,n){const i=t*Math.min(n,1-n),r=(s,a=(s+e/30)%12)=>n-i*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function jD(e,t,n){const i=(r,s=(r+e/60)%6)=>n-n*t*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function zD(e,t,n){const i=X0(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function WD(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}function bd(e){const n=e.r/255,i=e.g/255,r=e.b/255,s=Math.max(n,i,r),a=Math.min(n,i,r),o=(s+a)/2;let c,l,h;return s!==a&&(h=s-a,l=o>.5?h/(2-s-a):h/(s+a),c=WD(n,i,r,h,s),c=c*60+.5),[c|0,l||0,o]}function _d(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(Fi)}function yd(e,t,n){return _d(X0,e,t,n)}function HD(e,t,n){return _d(zD,e,t,n)}function UD(e,t,n){return _d(jD,e,t,n)}function G0(e){return(e%360+360)%360}function VD(e){const t=BD.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?ia(+t[5]):Fi(+t[5]));const r=G0(+t[2]),s=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?i=HD(r,s,a):t[1]==="hsv"?i=UD(r,s,a):i=yd(r,s,a),{r:i[0],g:i[1],b:i[2],a:n}}function qD(e,t){var n=bd(e);n[0]=G0(n[0]+t),n=yd(n),e.r=n[0],e.g=n[1],e.b=n[2]}function KD(e){if(!e)return;const t=bd(e),n=t[0],i=gp(t[1]),r=gp(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${r}%, ${qn(e.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const mp={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},vp={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function YD(){const e={},t=Object.keys(vp),n=Object.keys(mp);let i,r,s,a,o;for(i=0;i<t.length;i++){for(a=o=t[i],r=0;r<n.length;r++)s=n[r],o=o.replace(s,mp[s]);s=parseInt(vp[a],16),e[o]=[s>>16&255,s>>8&255,s&255]}return e}let To;function XD(e){To||(To=YD(),To.transparent=[0,0,0,0]);const t=To[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const GD=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function QD(e){const t=GD.exec(e);let n=255,i,r,s;if(t){if(t[7]!==i){const a=+t[7];n=t[8]?ia(a):Ii(a*255,0,255)}return i=+t[1],r=+t[3],s=+t[5],i=255&(t[2]?ia(i):Ii(i,0,255)),r=255&(t[4]?ia(r):Ii(r,0,255)),s=255&(t[6]?ia(s):Ii(s,0,255)),{r:i,g:r,b:s,a:n}}}function JD(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${qn(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const pu=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Gr=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function ZD(e,t,n){const i=Gr(qn(e.r)),r=Gr(qn(e.g)),s=Gr(qn(e.b));return{r:Fi(pu(i+n*(Gr(qn(t.r))-i))),g:Fi(pu(r+n*(Gr(qn(t.g))-r))),b:Fi(pu(s+n*(Gr(qn(t.b))-s))),a:e.a+n*(t.a-e.a)}}function Po(e,t,n){if(e){let i=bd(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=yd(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function Q0(e,t){return e&&Object.assign(t||{},e)}function bp(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Fi(e[3]))):(t=Q0(e,{r:0,g:0,b:0,a:1}),t.a=Fi(t.a)),t}function tI(e){return e.charAt(0)==="r"?QD(e):VD(e)}class Wa{constructor(t){if(t instanceof Wa)return t;const n=typeof t;let i;n==="object"?i=bp(t):n==="string"&&(i=LD(t)||XD(t)||tI(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Q0(this._rgb);return t&&(t.a=qn(t.a)),t}set rgb(t){this._rgb=bp(t)}rgbString(){return this._valid?JD(this._rgb):void 0}hexString(){return this._valid?FD(this._rgb):void 0}hslString(){return this._valid?KD(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,r=t.rgb;let s;const a=n===s?.5:n,o=2*a-1,c=i.a-r.a,l=((o*c===-1?o:(o+c)/(1+o*c))+1)/2;s=1-l,i.r=255&l*i.r+s*r.r+.5,i.g=255&l*i.g+s*r.g+.5,i.b=255&l*i.b+s*r.b+.5,i.a=a*i.a+(1-a)*r.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=ZD(this._rgb,t._rgb,n)),this}clone(){return new Wa(this.rgb)}alpha(t){return this._rgb.a=Fi(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=fo(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Po(this._rgb,2,t),this}darken(t){return Po(this._rgb,2,-t),this}saturate(t){return Po(this._rgb,1,t),this}desaturate(t){return Po(this._rgb,1,-t),this}rotate(t){return qD(this._rgb,t),this}}function zn(){}const eI=(()=>{let e=0;return()=>e++})();function xt(e){return e==null}function Xt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function kt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function te(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function qe(e,t){return te(e)?e:t}function ft(e,t){return typeof e>"u"?t:e}const nI=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,J0=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Ht(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Nt(e,t,n,i){let r,s,a;if(Xt(e))for(s=e.length,r=0;r<s;r++)t.call(n,e[r],r);else if(kt(e))for(a=Object.keys(e),s=a.length,r=0;r<s;r++)t.call(n,e[a[r]],a[r])}function zc(e,t){let n,i,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Wc(e){if(Xt(e))return e.map(Wc);if(kt(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=Wc(e[n[r]]);return t}return e}function Z0(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function iI(e,t,n,i){if(!Z0(e))return;const r=t[e],s=n[e];kt(r)&&kt(s)?Ha(r,s,i):t[e]=Wc(s)}function Ha(e,t,n){const i=Xt(t)?t:[t],r=i.length;if(!kt(e))return e;n=n||{};const s=n.merger||iI;let a;for(let o=0;o<r;++o){if(a=i[o],!kt(a))continue;const c=Object.keys(a);for(let l=0,h=c.length;l<h;++l)s(c[l],e,a,n)}return e}function xa(e,t){return Ha(e,t,{merger:rI})}function rI(e,t,n){if(!Z0(e))return;const i=t[e],r=n[e];kt(i)&&kt(r)?xa(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Wc(r))}const _p={"":e=>e,x:e=>e.x,y:e=>e.y};function sI(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function aI(e){const t=sI(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function Hi(e,t){return(_p[t]||(_p[t]=aI(t)))(e)}function wd(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Ua=e=>typeof e<"u",Ui=e=>typeof e=="function",yp=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function oI(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const It=Math.PI,Vt=2*It,cI=Vt+It,Hc=Number.POSITIVE_INFINITY,lI=It/180,re=It/2,nr=It/4,wp=It*2/3,Ri=Math.log10,Tn=Math.sign;function Sa(e,t,n){return Math.abs(e-t)<n}function xp(e){const t=Math.round(e);e=Sa(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Ri(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function uI(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((r,s)=>r-s).pop(),t}function hI(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Es(e){return!hI(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function dI(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function tb(e,t,n){let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function bn(e){return e*(It/180)}function xd(e){return e*(180/It)}function Sp(e){if(!te(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function eb(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*It&&(s+=Vt),{angle:s,distance:r}}function hh(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function fI(e,t){return(e-t+cI)%Vt-It}function Ee(e){return(e%Vt+Vt)%Vt}function Va(e,t,n,i){const r=Ee(e),s=Ee(t),a=Ee(n),o=Ee(s-r),c=Ee(a-r),l=Ee(r-s),h=Ee(r-a);return r===s||r===a||i&&s===a||o>c&&l<h}function ge(e,t,n){return Math.max(t,Math.min(n,e))}function pI(e){return ge(e,-32768,32767)}function Kn(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function Sd(e,t,n){n=n||(a=>e[a]<t);let i=e.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,n(s)?r=s:i=s;return{lo:r,hi:i}}const Yn=(e,t,n,i)=>Sd(e,n,i?r=>{const s=e[r][t];return s<n||s===n&&e[r+1][t]===n}:r=>e[r][t]<n),gI=(e,t,n)=>Sd(e,n,i=>e[i][t]>=n);function mI(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}const nb=["push","pop","shift","splice","unshift"];function vI(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),nb.forEach(n=>{const i="_onData"+wd(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...s){const a=r.apply(this,s);return e._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...s)}),a}})})}function Cp(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(nb.forEach(s=>{delete e[s]}),delete e._chartjs)}function ib(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const rb=(function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame})();function sb(e,t){let n=[],i=!1;return function(...r){n=r,i||(i=!0,rb.call(window,()=>{i=!1,e.apply(t,n)}))}}function bI(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const Cd=e=>e==="start"?"left":e==="end"?"right":"center",Ce=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,_I=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function ab(e,t,n){const i=t.length;let r=0,s=i;if(e._sorted){const{iScale:a,vScale:o,_parsed:c}=e,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,h=a.axis,{min:u,max:d,minDefined:p,maxDefined:g}=a.getUserBounds();if(p){if(r=Math.min(Yn(c,h,u).lo,n?i:Yn(t,h,a.getPixelForValue(u)).lo),l){const m=c.slice(0,r+1).reverse().findIndex(b=>!xt(b[o.axis]));r-=Math.max(0,m)}r=ge(r,0,i-1)}if(g){let m=Math.max(Yn(c,a.axis,d,!0).hi+1,n?0:Yn(t,h,a.getPixelForValue(d),!0).hi+1);if(l){const b=c.slice(m-1).findIndex(w=>!xt(w[o.axis]));m+=Math.max(0,b)}s=ge(m,r,i)-r}else s=i-r}return{start:r,count:s}}function ob(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Oo=e=>e===0||e===1,kp=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Vt/n)),Ep=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Vt/n)+1,Ca={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*re)+1,easeOutSine:e=>Math.sin(e*re),easeInOutSine:e=>-.5*(Math.cos(It*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Oo(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Oo(e)?e:kp(e,.075,.3),easeOutElastic:e=>Oo(e)?e:Ep(e,.075,.3),easeInOutElastic(e){return Oo(e)?e:e<.5?.5*kp(e*2,.1125,.45):.5+.5*Ep(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Ca.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Ca.easeInBounce(e*2)*.5:Ca.easeOutBounce(e*2-1)*.5+.5};function kd(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Mp(e){return kd(e)?e:new Wa(e)}function gu(e){return kd(e)?e:new Wa(e).saturate(.5).darken(.1).hexString()}const yI=["x","y","borderWidth","radius","tension"],wI=["color","borderColor","backgroundColor"];function xI(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:wI},numbers:{type:"number",properties:yI}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function SI(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Dp=new Map;function CI(e,t){t=t||{};const n=e+JSON.stringify(t);let i=Dp.get(n);return i||(i=new Intl.NumberFormat(e,t),Dp.set(n,i)),i}function po(e,t,n){return CI(t,n).format(e)}const cb={values(e){return Xt(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let r,s=e;if(n.length>1){const l=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(l<1e-4||l>1e15)&&(r="scientific"),s=kI(e,n)}const a=Ri(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),c={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(c,this.options.ticks.format),po(e,i,c)},logarithmic(e,t,n){if(e===0)return"0";const i=n[t].significand||e/Math.pow(10,Math.floor(Ri(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?cb.numeric.call(this,e,t,n):""}};function kI(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var bl={formatters:cb};function EI(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:bl.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Tr=Object.create(null),dh=Object.create(null);function ka(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const s=n[i];e=e[s]||(e[s]=Object.create(null))}return e}function mu(e,t,n){return typeof t=="string"?Ha(ka(e,t),n):Ha(ka(e,""),t)}class MI{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>gu(r.backgroundColor),this.hoverBorderColor=(i,r)=>gu(r.borderColor),this.hoverColor=(i,r)=>gu(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return mu(this,t,n)}get(t){return ka(this,t)}describe(t,n){return mu(dh,t,n)}override(t,n){return mu(Tr,t,n)}route(t,n,i,r){const s=ka(this,t),a=ka(this,i),o="_"+n;Object.defineProperties(s,{[o]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const c=this[o],l=a[r];return kt(c)?Object.assign({},l,c):ft(c,l)},set(c){this[o]=c}}})}apply(t){t.forEach(n=>n(this))}}var Gt=new MI({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[xI,SI,EI]);function DI(e){return!e||xt(e.size)||xt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Uc(e,t,n,i,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>i&&(i=s),i}function II(e,t,n,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let a=0;const o=n.length;let c,l,h,u,d;for(c=0;c<o;c++)if(u=n[c],u!=null&&!Xt(u))a=Uc(e,r,s,a,u);else if(Xt(u))for(l=0,h=u.length;l<h;l++)d=u[l],d!=null&&!Xt(d)&&(a=Uc(e,r,s,a,d));e.restore();const p=s.length/2;if(p>n.length){for(c=0;c<p;c++)delete r[s[c]];s.splice(0,p)}return a}function ir(e,t,n){const i=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function Ip(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function fh(e,t,n,i){lb(e,t,n,i,null)}function lb(e,t,n,i,r){let s,a,o,c,l,h,u,d;const p=t.pointStyle,g=t.rotation,m=t.radius;let b=(g||0)*lI;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(b),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),e.restore();return}if(!(isNaN(m)||m<=0)){switch(e.beginPath(),p){default:r?e.ellipse(n,i,r/2,m,0,0,Vt):e.arc(n,i,m,0,Vt),e.closePath();break;case"triangle":h=r?r/2:m,e.moveTo(n+Math.sin(b)*h,i-Math.cos(b)*m),b+=wp,e.lineTo(n+Math.sin(b)*h,i-Math.cos(b)*m),b+=wp,e.lineTo(n+Math.sin(b)*h,i-Math.cos(b)*m),e.closePath();break;case"rectRounded":l=m*.516,c=m-l,a=Math.cos(b+nr)*c,u=Math.cos(b+nr)*(r?r/2-l:c),o=Math.sin(b+nr)*c,d=Math.sin(b+nr)*(r?r/2-l:c),e.arc(n-u,i-o,l,b-It,b-re),e.arc(n+d,i-a,l,b-re,b),e.arc(n+u,i+o,l,b,b+re),e.arc(n-d,i+a,l,b+re,b+It),e.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*m,h=r?r/2:c,e.rect(n-h,i-c,2*h,2*c);break}b+=nr;case"rectRot":u=Math.cos(b)*(r?r/2:m),a=Math.cos(b)*m,o=Math.sin(b)*m,d=Math.sin(b)*(r?r/2:m),e.moveTo(n-u,i-o),e.lineTo(n+d,i-a),e.lineTo(n+u,i+o),e.lineTo(n-d,i+a),e.closePath();break;case"crossRot":b+=nr;case"cross":u=Math.cos(b)*(r?r/2:m),a=Math.cos(b)*m,o=Math.sin(b)*m,d=Math.sin(b)*(r?r/2:m),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a);break;case"star":u=Math.cos(b)*(r?r/2:m),a=Math.cos(b)*m,o=Math.sin(b)*m,d=Math.sin(b)*(r?r/2:m),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a),b+=nr,u=Math.cos(b)*(r?r/2:m),a=Math.cos(b)*m,o=Math.sin(b)*m,d=Math.sin(b)*(r?r/2:m),e.moveTo(n-u,i-o),e.lineTo(n+u,i+o),e.moveTo(n+d,i-a),e.lineTo(n-d,i+a);break;case"line":a=r?r/2:Math.cos(b)*m,o=Math.sin(b)*m,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(b)*(r?r/2:m),i+Math.sin(b)*m);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Xn(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function _l(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function yl(e){e.restore()}function RI(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const s=(t.x+n.x)/2;e.lineTo(s,t.y),e.lineTo(s,n.y)}else r==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function TI(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function PI(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),xt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function OI(e,t,n,i,r){if(r.strikethrough||r.underline){const s=e.measureText(i),a=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,c=n-s.actualBoundingBoxAscent,l=n+s.actualBoundingBoxDescent,h=r.strikethrough?(c+l)/2:l;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(a,h),e.lineTo(o,h),e.stroke()}}function AI(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Pr(e,t,n,i,r,s={}){const a=Xt(t)?t:[t],o=s.strokeWidth>0&&s.strokeColor!=="";let c,l;for(e.save(),e.font=r.string,PI(e,s),c=0;c<a.length;++c)l=a[c],s.backdrop&&AI(e,s.backdrop),o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),xt(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(l,n,i,s.maxWidth)),e.fillText(l,n,i,s.maxWidth),OI(e,n,i,l,s),i+=Number(r.lineHeight);e.restore()}function qa(e,t){const{x:n,y:i,w:r,h:s,radius:a}=t;e.arc(n+a.topLeft,i+a.topLeft,a.topLeft,1.5*It,It,!0),e.lineTo(n,i+s-a.bottomLeft),e.arc(n+a.bottomLeft,i+s-a.bottomLeft,a.bottomLeft,It,re,!0),e.lineTo(n+r-a.bottomRight,i+s),e.arc(n+r-a.bottomRight,i+s-a.bottomRight,a.bottomRight,re,0,!0),e.lineTo(n+r,i+a.topRight),e.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-re,!0),e.lineTo(n+a.topLeft,i)}const $I=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,LI=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function NI(e,t){const n=(""+e).match($I);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const FI=e=>+e||0;function Ed(e,t){const n={},i=kt(t),r=i?Object.keys(t):t,s=kt(e)?i?a=>ft(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of r)n[a]=FI(s(a));return n}function ub(e){return Ed(e,{top:"y",right:"x",bottom:"y",left:"x"})}function yr(e){return Ed(e,["topLeft","topRight","bottomLeft","bottomRight"])}function De(e){const t=ub(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function he(e,t){e=e||{},t=t||Gt.font;let n=ft(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=ft(e.style,t.style);i&&!(""+i).match(LI)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:ft(e.family,t.family),lineHeight:NI(ft(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:ft(e.weight,t.weight),string:""};return r.string=DI(r),r}function ra(e,t,n,i){let r,s,a;for(r=0,s=e.length;r<s;++r)if(a=e[r],a!==void 0&&a!==void 0)return a}function BI(e,t,n){const{min:i,max:r}=e,s=J0(t,(r-i)/2),a=(o,c)=>n&&o===0?0:o+c;return{min:a(i,-Math.abs(s)),max:a(r,s)}}function Ki(e,t){return Object.assign(Object.create(e),t)}function Md(e,t=[""],n,i,r=()=>e[0]){const s=n||e;typeof i>"u"&&(i=pb("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:i,_getTarget:r,override:o=>Md([o,...e],t,s,i)};return new Proxy(a,{deleteProperty(o,c){return delete o[c],delete o._keys,delete e[0][c],!0},get(o,c){return db(o,c,()=>KI(c,t,e,o))},getOwnPropertyDescriptor(o,c){return Reflect.getOwnPropertyDescriptor(o._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(o,c){return Tp(o).includes(c)},ownKeys(o){return Tp(o)},set(o,c,l){const h=o._storage||(o._storage=r());return o[c]=h[c]=l,delete o._keys,!0}})}function Ms(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:hb(e,i),setContext:s=>Ms(e,s,n,i),override:s=>Ms(e.override(s),t,n,i)};return new Proxy(r,{deleteProperty(s,a){return delete s[a],delete e[a],!0},get(s,a,o){return db(s,a,()=>zI(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(s,a,o){return e[a]=o,delete s[a],!0}})}function hb(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:Ui(n)?n:()=>n,isIndexable:Ui(i)?i:()=>i}}const jI=(e,t)=>e?e+wd(t):t,Dd=(e,t)=>kt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function db(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const i=n();return e[t]=i,i}function zI(e,t,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:a}=e;let o=i[t];return Ui(o)&&a.isScriptable(t)&&(o=WI(t,o,e,n)),Xt(o)&&o.length&&(o=HI(t,o,e,a.isIndexable)),Dd(t,o)&&(o=Ms(o,r,s&&s[t],a)),o}function WI(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let c=t(s,a||i);return o.delete(e),Dd(e,c)&&(c=Id(r._scopes,r,e,c)),c}function HI(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;if(typeof s.index<"u"&&i(e))return t[s.index%t.length];if(kt(t[0])){const c=t,l=r._scopes.filter(h=>h!==c);t=[];for(const h of c){const u=Id(l,r,e,h);t.push(Ms(u,s,a&&a[e],o))}}return t}function fb(e,t,n){return Ui(e)?e(t,n):e}const UI=(e,t)=>e===!0?t:typeof e=="string"?Hi(t,e):void 0;function VI(e,t,n,i,r){for(const s of t){const a=UI(n,s);if(a){e.add(a);const o=fb(a._fallback,n,r);if(typeof o<"u"&&o!==n&&o!==i)return o}else if(a===!1&&typeof i<"u"&&n!==i)return null}return!1}function Id(e,t,n,i){const r=t._rootScopes,s=fb(t._fallback,n,i),a=[...e,...r],o=new Set;o.add(i);let c=Rp(o,a,n,s||n,i);return c===null||typeof s<"u"&&s!==n&&(c=Rp(o,a,s,c,i),c===null)?!1:Md(Array.from(o),[""],r,s,()=>qI(t,n,i))}function Rp(e,t,n,i,r){for(;n;)n=VI(e,t,n,i,r);return n}function qI(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];return Xt(r)&&kt(n)?n:r||{}}function KI(e,t,n,i){let r;for(const s of t)if(r=pb(jI(s,e),n),typeof r<"u")return Dd(e,r)?Id(n,i,e,r):r}function pb(e,t){for(const n of t){if(!n)continue;const i=n[e];if(typeof i<"u")return i}}function Tp(e){let t=e._keys;return t||(t=e._keys=YI(e._scopes)),t}function YI(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function gb(e,t,n,i){const{iScale:r}=e,{key:s="r"}=this._parsing,a=new Array(i);let o,c,l,h;for(o=0,c=i;o<c;++o)l=o+n,h=t[l],a[o]={r:r.parse(Hi(h,s),l)};return a}const XI=Number.EPSILON||1e-14,Ds=(e,t)=>t<e.length&&!e[t].skip&&e[t],mb=e=>e==="x"?"y":"x";function GI(e,t,n,i){const r=e.skip?t:e,s=t,a=n.skip?t:n,o=hh(s,r),c=hh(a,s);let l=o/(o+c),h=c/(o+c);l=isNaN(l)?0:l,h=isNaN(h)?0:h;const u=i*l,d=i*h;return{previous:{x:s.x-u*(a.x-r.x),y:s.y-u*(a.y-r.y)},next:{x:s.x+d*(a.x-r.x),y:s.y+d*(a.y-r.y)}}}function QI(e,t,n){const i=e.length;let r,s,a,o,c,l=Ds(e,0);for(let h=0;h<i-1;++h)if(c=l,l=Ds(e,h+1),!(!c||!l)){if(Sa(t[h],0,XI)){n[h]=n[h+1]=0;continue}r=n[h]/t[h],s=n[h+1]/t[h],o=Math.pow(r,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),n[h]=r*a*t[h],n[h+1]=s*a*t[h])}}function JI(e,t,n="x"){const i=mb(n),r=e.length;let s,a,o,c=Ds(e,0);for(let l=0;l<r;++l){if(a=o,o=c,c=Ds(e,l+1),!o)continue;const h=o[n],u=o[i];a&&(s=(h-a[n])/3,o[`cp1${n}`]=h-s,o[`cp1${i}`]=u-s*t[l]),c&&(s=(c[n]-h)/3,o[`cp2${n}`]=h+s,o[`cp2${i}`]=u+s*t[l])}}function ZI(e,t="x"){const n=mb(t),i=e.length,r=Array(i).fill(0),s=Array(i);let a,o,c,l=Ds(e,0);for(a=0;a<i;++a)if(o=c,c=l,l=Ds(e,a+1),!!c){if(l){const h=l[t]-c[t];r[a]=h!==0?(l[n]-c[n])/h:0}s[a]=o?l?Tn(r[a-1])!==Tn(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}QI(e,r,s),JI(e,s,t)}function Ao(e,t,n){return Math.max(Math.min(e,n),t)}function tR(e,t){let n,i,r,s,a,o=Xn(e[0],t);for(n=0,i=e.length;n<i;++n)a=s,s=o,o=n<i-1&&Xn(e[n+1],t),s&&(r=e[n],a&&(r.cp1x=Ao(r.cp1x,t.left,t.right),r.cp1y=Ao(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=Ao(r.cp2x,t.left,t.right),r.cp2y=Ao(r.cp2y,t.top,t.bottom)))}function eR(e,t,n,i,r){let s,a,o,c;if(t.spanGaps&&(e=e.filter(l=>!l.skip)),t.cubicInterpolationMode==="monotone")ZI(e,r);else{let l=i?e[e.length-1]:e[0];for(s=0,a=e.length;s<a;++s)o=e[s],c=GI(l,o,e[Math.min(s+1,a-(i?0:1))%a],t.tension),o.cp1x=c.previous.x,o.cp1y=c.previous.y,o.cp2x=c.next.x,o.cp2y=c.next.y,l=o}t.capBezierPoints&&tR(e,n)}function Rd(){return typeof window<"u"&&typeof document<"u"}function Td(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Vc(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const wl=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function nR(e,t){return wl(e).getPropertyValue(t)}const iR=["top","right","bottom","left"];function wr(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=iR[r];i[s]=parseFloat(e[t+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const rR=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function sR(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=i;let a=!1,o,c;if(rR(r,s,e.target))o=r,c=s;else{const l=t.getBoundingClientRect();o=i.clientX-l.left,c=i.clientY-l.top,a=!0}return{x:o,y:c,box:a}}function ur(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=wl(n),s=r.boxSizing==="border-box",a=wr(r,"padding"),o=wr(r,"border","width"),{x:c,y:l,box:h}=sR(e,n),u=a.left+(h&&o.left),d=a.top+(h&&o.top);let{width:p,height:g}=t;return s&&(p-=a.width+o.width,g-=a.height+o.height),{x:Math.round((c-u)/p*n.width/i),y:Math.round((l-d)/g*n.height/i)}}function aR(e,t,n){let i,r;if(t===void 0||n===void 0){const s=e&&Td(e);if(!s)t=e.clientWidth,n=e.clientHeight;else{const a=s.getBoundingClientRect(),o=wl(s),c=wr(o,"border","width"),l=wr(o,"padding");t=a.width-l.width-c.width,n=a.height-l.height-c.height,i=Vc(o.maxWidth,s,"clientWidth"),r=Vc(o.maxHeight,s,"clientHeight")}}return{width:t,height:n,maxWidth:i||Hc,maxHeight:r||Hc}}const Ti=e=>Math.round(e*10)/10;function oR(e,t,n,i){const r=wl(e),s=wr(r,"margin"),a=Vc(r.maxWidth,e,"clientWidth")||Hc,o=Vc(r.maxHeight,e,"clientHeight")||Hc,c=aR(e,t,n);let{width:l,height:h}=c;if(r.boxSizing==="content-box"){const d=wr(r,"border","width"),p=wr(r,"padding");l-=p.width+d.width,h-=p.height+d.height}return l=Math.max(0,l-s.width),h=Math.max(0,i?l/i:h-s.height),l=Ti(Math.min(l,a,c.maxWidth)),h=Ti(Math.min(h,o,c.maxHeight)),l&&!h&&(h=Ti(l/2)),(t!==void 0||n!==void 0)&&i&&c.height&&h>c.height&&(h=c.height,l=Ti(Math.floor(h*i))),{width:l,height:h}}function Pp(e,t,n){const i=t||1,r=Ti(e.height*i),s=Ti(e.width*i);e.height=Ti(e.height),e.width=Ti(e.width);const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||a.height!==r||a.width!==s?(e.currentDevicePixelRatio=i,a.height=r,a.width=s,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const cR=(function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Rd()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e})();function Op(e,t){const n=nR(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function hr(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function lR(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function uR(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},a=hr(e,r,n),o=hr(r,s,n),c=hr(s,t,n),l=hr(a,o,n),h=hr(o,c,n);return hr(l,h,n)}const hR=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},dR=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function fs(e,t,n){return e?hR(t,n):dR()}function vb(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function bb(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function _b(e){return e==="angle"?{between:Va,compare:fI,normalize:Ee}:{between:Kn,compare:(t,n)=>t-n,normalize:t=>t}}function Ap({start:e,end:t,count:n,loop:i,style:r}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:r}}function fR(e,t,n){const{property:i,start:r,end:s}=n,{between:a,normalize:o}=_b(i),c=t.length;let{start:l,end:h,loop:u}=e,d,p;if(u){for(l+=c,h+=c,d=0,p=c;d<p&&a(o(t[l%c][i]),r,s);++d)l--,h--;l%=c,h%=c}return h<l&&(h+=c),{start:l,end:h,loop:u,style:e.style}}function yb(e,t,n){if(!n)return[e];const{property:i,start:r,end:s}=n,a=t.length,{compare:o,between:c,normalize:l}=_b(i),{start:h,end:u,loop:d,style:p}=fR(e,t,n),g=[];let m=!1,b=null,w,C,_;const k=()=>c(r,_,w)&&o(r,_)!==0,x=()=>o(s,w)===0||c(s,_,w),I=()=>m||k(),E=()=>!m||x();for(let y=h,M=h;y<=u;++y)C=t[y%a],!C.skip&&(w=l(C[i]),w!==_&&(m=c(w,r,s),b===null&&I()&&(b=o(w,r)===0?y:M),b!==null&&E()&&(g.push(Ap({start:b,end:y,loop:d,count:a,style:p})),b=null),M=y,_=w));return b!==null&&g.push(Ap({start:b,end:u,loop:d,count:a,style:p})),g}function wb(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const s=yb(i[r],e.points,t);s.length&&n.push(...s)}return n}function pR(e,t,n,i){let r=0,s=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}function gR(e,t,n,i){const r=e.length,s=[];let a=t,o=e[t],c;for(c=t+1;c<=n;++c){const l=e[c%r];l.skip||l.stop?o.skip||(i=!1,s.push({start:t%r,end:(c-1)%r,loop:i}),t=a=l.stop?c:null):(a=c,o.skip&&(t=c)),o=l}return a!==null&&s.push({start:t%r,end:a%r,loop:i}),s}function mR(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:a,end:o}=pR(n,r,s,i);if(i===!0)return $p(e,[{start:a,end:o,loop:s}],n,t);const c=o<a?o+r:o,l=!!e._fullLoop&&a===0&&o===r-1;return $p(e,gR(n,a,c,l),n,t)}function $p(e,t,n,i){return!i||!i.setContext||!n?t:vR(e,t,n,i)}function vR(e,t,n,i){const r=e._chart.getContext(),s=Lp(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,c=n.length,l=[];let h=s,u=t[0].start,d=u;function p(g,m,b,w){const C=o?-1:1;if(g!==m){for(g+=c;n[g%c].skip;)g-=C;for(;n[m%c].skip;)m+=C;g%c!==m%c&&(l.push({start:g%c,end:m%c,loop:b,style:w}),h=w,u=m%c)}}for(const g of t){u=o?u:g.start;let m=n[u%c],b;for(d=u+1;d<=g.end;d++){const w=n[d%c];b=Lp(i.setContext(Ki(r,{type:"segment",p0:m,p1:w,p0DataIndex:(d-1)%c,p1DataIndex:d%c,datasetIndex:a}))),bR(b,h)&&p(u,d-1,g.loop,h),m=w,h=b}u<d-1&&p(u,d-1,g.loop,h)}return l}function Lp(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function bR(e,t){if(!t)return!1;const n=[],i=function(r,s){return kd(s)?(n.includes(s)||n.push(s),n.indexOf(s)):s};return JSON.stringify(e,i)!==JSON.stringify(t,i)}function $o(e,t,n){return e.options.clip?e[n]:t[n]}function _R(e,t){const{xScale:n,yScale:i}=e;return n&&i?{left:$o(n,t,"left"),right:$o(n,t,"right"),top:$o(i,t,"top"),bottom:$o(i,t,"bottom")}:t}function xb(e,t){const n=t._clip;if(n.disabled)return!1;const i=_R(t,e.chartArea);return{left:n.left===!1?0:i.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:i.right+(n.right===!0?0:n.right),top:n.top===!1?0:i.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:i.bottom+(n.bottom===!0?0:n.bottom)}}class yR{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,r){const s=n.listeners[r],a=n.duration;s.forEach(o=>o({chart:t,initial:n.initial,numSteps:a,currentStep:Math.min(i-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=rb.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let a=s.length-1,o=!1,c;for(;a>=0;--a)c=s[a],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(t),o=!0):(s[a]=s[s.length-1],s.pop());o&&(r.draw(),this._notify(r,i,t,"progress")),s.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),n+=s.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Wn=new yR;const Np="transparent",wR={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=Mp(e||Np),r=i.valid&&Mp(t||Np);return r&&r.valid?r.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class xR{constructor(t,n,i,r){const s=n[i];r=ra([t.to,r,s,t.from]);const a=ra([t.from,s,r]);this._active=!0,this._fn=t.fn||wR[t.type||typeof a],this._easing=Ca[t.easing]||Ca.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,a=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=ra([t.to,n,r,t.from]),this._from=ra([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,r=this._prop,s=this._from,a=this._loop,o=this._to;let c;if(this._active=s!==o&&(a||n<i),!this._active){this._target[r]=o,this._notify(!0);return}if(n<0){this._target[r]=s;return}c=n/i%2,c=a&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(s,o,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}class Sb{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!kt(t))return;const n=Object.keys(Gt.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const s=t[r];if(!kt(s))return;const a={};for(const o of n)a[o]=s[o];(Xt(s.properties)&&s.properties||[r]).forEach(o=>{(o===r||!i.has(o))&&i.set(o,a)})})}_animateOptions(t,n){const i=n.options,r=CR(t,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&SR(t.options.$animations,i).then(()=>{t.options=i},()=>{}),s}_createAnimations(t,n){const i=this._properties,r=[],s=t.$animations||(t.$animations={}),a=Object.keys(n),o=Date.now();let c;for(c=a.length-1;c>=0;--c){const l=a[c];if(l.charAt(0)==="$")continue;if(l==="options"){r.push(...this._animateOptions(t,n));continue}const h=n[l];let u=s[l];const d=i.get(l);if(u)if(d&&u.active()){u.update(d,h,o);continue}else u.cancel();if(!d||!d.duration){t[l]=h;continue}s[l]=u=new xR(d,t,l,h),r.push(u)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return Wn.add(this._chart,i),!0}}function SR(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const s=e[i[r]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function CR(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Fp(e,t){const n=e&&e.options||{},i=n.reverse,r=n.min===void 0?t:0,s=n.max===void 0?t:0;return{start:i?s:r,end:i?r:s}}function kR(e,t,n){if(n===!1)return!1;const i=Fp(e,n),r=Fp(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function ER(e){let t,n,i,r;return kt(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:e===!1}}function Cb(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function Bp(e,t,n,i={}){const r=e.keys,s=i.mode==="single";let a,o,c,l;if(t===null)return;let h=!1;for(a=0,o=r.length;a<o;++a){if(c=+r[a],c===n){if(h=!0,i.all)continue;break}l=e.values[c],te(l)&&(s||t===0||Tn(t)===Tn(l))&&(t+=l)}return!h&&!i.all?0:t}function MR(e,t){const{iScale:n,vScale:i}=t,r=n.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",a=Object.keys(e),o=new Array(a.length);let c,l,h;for(c=0,l=a.length;c<l;++c)h=a[c],o[c]={[r]:h,[s]:e[h]};return o}function vu(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function DR(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function IR(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function RR(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function jp(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const s=e[r.index];if(n&&s>0||!n&&s<0)return r.index}return null}function zp(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:a,index:o}=i,c=s.axis,l=a.axis,h=DR(s,a,i),u=t.length;let d;for(let p=0;p<u;++p){const g=t[p],{[c]:m,[l]:b}=g,w=g._stacks||(g._stacks={});d=w[l]=RR(r,h,m),d[o]=b,d._top=jp(d,a,!0,i.type),d._bottom=jp(d,a,!1,i.type);const C=d._visualValues||(d._visualValues={});C[o]=b}}function bu(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function TR(e,t){return Ki(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function PR(e,t,n){return Ki(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Us(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const r of t){const s=r._stacks;if(!s||s[i]===void 0||s[i][n]===void 0)return;delete s[i][n],s[i]._visualValues!==void 0&&s[i]._visualValues[n]!==void 0&&delete s[i]._visualValues[n]}}}const _u=e=>e==="reset"||e==="none",Wp=(e,t)=>t?e:Object.assign({},e),OR=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:Cb(n,!0),values:null};class Yi{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=vu(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Us(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(u,d,p,g)=>u==="x"?d:u==="r"?g:p,s=n.xAxisID=ft(i.xAxisID,bu(t,"x")),a=n.yAxisID=ft(i.yAxisID,bu(t,"y")),o=n.rAxisID=ft(i.rAxisID,bu(t,"r")),c=n.indexAxis,l=n.iAxisID=r(c,s,a,o),h=n.vAxisID=r(c,a,s,o);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(l),n.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Cp(this._data,this),t._stacked&&Us(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(kt(n)){const r=this._cachedMeta;this._data=MR(n,r)}else if(i!==n){if(i){Cp(i,this);const r=this._cachedMeta;Us(r),r._parsed=[]}n&&Object.isExtensible(n)&&vI(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=n._stacked;n._stacked=vu(n.vScale,n),n.stack!==i.stack&&(r=!0,Us(n),n.stack=i.stack),this._resyncElements(t),(r||s!==n._stacked)&&(zp(this,n._parsed),n._stacked=vu(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:a}=i,o=s.axis;let c=t===0&&n===r.length?!0:i._sorted,l=t>0&&i._parsed[t-1],h,u,d;if(this._parsing===!1)i._parsed=r,i._sorted=!0,d=r;else{Xt(r[t])?d=this.parseArrayData(i,r,t,n):kt(r[t])?d=this.parseObjectData(i,r,t,n):d=this.parsePrimitiveData(i,r,t,n);const p=()=>u[o]===null||l&&u[o]<l[o];for(h=0;h<n;++h)i._parsed[h+t]=u=d[h],c&&(p()&&(c=!1),l=u);i._sorted=c}a&&zp(this,d)}parsePrimitiveData(t,n,i,r){const{iScale:s,vScale:a}=t,o=s.axis,c=a.axis,l=s.getLabels(),h=s===a,u=new Array(r);let d,p,g;for(d=0,p=r;d<p;++d)g=d+i,u[d]={[o]:h||s.parse(l[g],g),[c]:a.parse(n[g],g)};return u}parseArrayData(t,n,i,r){const{xScale:s,yScale:a}=t,o=new Array(r);let c,l,h,u;for(c=0,l=r;c<l;++c)h=c+i,u=n[h],o[c]={x:s.parse(u[0],h),y:a.parse(u[1],h)};return o}parseObjectData(t,n,i,r){const{xScale:s,yScale:a}=t,{xAxisKey:o="x",yAxisKey:c="y"}=this._parsing,l=new Array(r);let h,u,d,p;for(h=0,u=r;h<u;++h)d=h+i,p=n[d],l[h]={x:s.parse(Hi(p,o),d),y:a.parse(Hi(p,c),d)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const r=this.chart,s=this._cachedMeta,a=n[t.axis],o={keys:Cb(r,!0),values:n._stacks[t.axis]._visualValues};return Bp(o,a,s.index,{mode:i})}updateRangeFromParsed(t,n,i,r){const s=i[n.axis];let a=s===null?NaN:s;const o=r&&i._stacks[n.axis];r&&o&&(r.values=o,a=Bp(r,s,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,n){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&t===i.iScale,a=r.length,o=this._getOtherScale(t),c=OR(n,i,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:u}=IR(o);let d,p;function g(){p=r[d];const m=p[o.axis];return!te(p[t.axis])||h>m||u<m}for(d=0;d<a&&!(!g()&&(this.updateRangeFromParsed(l,t,p,c),s));++d);if(s){for(d=a-1;d>=0;--d)if(!g()){this.updateRangeFromParsed(l,t,p,c);break}}return l}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let r,s,a;for(r=0,s=n.length;r<s;++r)a=n[r][t.axis],te(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,r=n.vScale,s=this.getParsed(t);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=ER(ft(this.options.clip,kR(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],s=n.chartArea,a=[],o=this._drawStart||0,c=this._drawCount||r.length-o,l=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,s,o,c),h=o;h<o+c;++h){const u=r[h];u.hidden||(u.active&&l?a.push(u):u.draw(t,s))}for(h=0;h<a.length;++h)a[h].draw(t,s)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const r=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];s=a.$context||(a.$context=PR(this.getContext(),t,a)),s.parsed=this.getParsed(t),s.raw=r.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=TR(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=i,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const r=n==="active",s=this._cachedDataOpts,a=t+"-"+n,o=s[a],c=this.enableOptionSharing&&Ua(i);if(o)return Wp(o,c);const l=this.chart.config,h=l.datasetElementScopeKeys(this._type,t),u=r?[`${t}Hover`,"hover",t,""]:[t,""],d=l.getOptionScopes(this.getDataset(),h),p=Object.keys(Gt.elements[t]),g=()=>this.getContext(i,r,n),m=l.resolveNamedOptions(d,p,g,u);return m.$shared&&(m.$shared=c,s[a]=Object.freeze(Wp(m,c))),m}_resolveAnimations(t,n,i){const r=this.chart,s=this._cachedDataOpts,a=`animation-${n}`,o=s[a];if(o)return o;let c;if(r.options.animation!==!1){const h=this.chart.config,u=h.datasetAnimationScopeKeys(this._type,n),d=h.getOptionScopes(this.getDataset(),u);c=h.createResolver(d,this.getContext(t,i,n))}const l=new Sb(r,c&&c.animations);return c&&c._cacheable&&(s[a]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||_u(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),r=this._sharedOptions,s=this.getSharedOptions(i),a=this.includeOptions(n,s)||s!==r;return this.updateSharedOptions(s,n,i),{sharedOptions:s,includeOptions:a}}updateElement(t,n,i,r){_u(r)?Object.assign(t,i):this._resolveAnimations(n,r).update(t,i)}updateSharedOptions(t,n,i){t&&!_u(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,r){t.active=r;const s=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(t,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[o,c,l]of this._syncList)this[o](c,l);this._syncList=[];const r=i.length,s=n.length,a=Math.min(s,r);a&&this.parse(0,a),s>r?this._insertElements(r,s-r,t):s<r&&this._removeElements(s,r-s)}_insertElements(t,n,i=!0){const r=this._cachedMeta,s=r.data,a=t+n;let o;const c=l=>{for(l.length+=n,o=l.length-1;o>=a;o--)l[o]=l[o-n]};for(c(s),o=t;o<a;++o)s[o]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(t,n),i&&this.updateElements(s,t,n,"reset")}updateElements(t,n,i,r){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(t,n);i._stacked&&Us(i,r)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,r]=t;this[n](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function AR(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let r=0,s=n.length;r<s;r++)i=i.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=ib(i.sort((r,s)=>r-s))}return e._cache.$bar}function $R(e){const t=e.iScale,n=AR(t,e.type);let i=t._length,r,s,a,o;const c=()=>{a===32767||a===-32768||(Ua(o)&&(i=Math.min(i,Math.abs(a-o)||i)),o=a)};for(r=0,s=n.length;r<s;++r)a=t.getPixelForValue(n[r]),c();for(o=void 0,r=0,s=t.ticks.length;r<s;++r)a=t.getPixelForTick(r),c();return i}function LR(e,t,n,i){const r=n.barThickness;let s,a;return xt(r)?(s=t.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:t.pixels[e]-s/2}}function NR(e,t,n,i){const r=t.pixels,s=r[e];let a=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null;const c=n.categoryPercentage;a===null&&(a=s-(o===null?t.end-t.start:o-s)),o===null&&(o=s+s-a);const l=s-(s-Math.min(a,o))/2*c;return{chunk:Math.abs(o-a)/2*c/i,ratio:n.barPercentage,start:l}}function FR(e,t,n,i){const r=n.parse(e[0],i),s=n.parse(e[1],i),a=Math.min(r,s),o=Math.max(r,s);let c=a,l=o;Math.abs(a)>Math.abs(o)&&(c=o,l=a),t[n.axis]=l,t._custom={barStart:c,barEnd:l,start:r,end:s,min:a,max:o}}function kb(e,t,n,i){return Xt(e)?FR(e,t,n,i):t[n.axis]=n.parse(e,i),t}function Hp(e,t,n,i){const r=e.iScale,s=e.vScale,a=r.getLabels(),o=r===s,c=[];let l,h,u,d;for(l=n,h=n+i;l<h;++l)d=t[l],u={},u[r.axis]=o||r.parse(a[l],l),c.push(kb(d,u,s,l));return c}function yu(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function BR(e,t,n){return e!==0?Tn(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function jR(e){let t,n,i,r,s;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:t,top:r,bottom:s}}function zR(e,t,n,i){let r=t.borderSkipped;const s={};if(!r){e.borderSkipped=s;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:c,top:l,bottom:h}=jR(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=l:(n._bottom||0)===i?r=h:(s[Up(h,a,o,c)]=!0,r=l)),s[Up(r,a,o,c)]=!0,e.borderSkipped=s}function Up(e,t,n,i){return i?(e=WR(e,t,n),e=Vp(e,n,t)):e=Vp(e,t,n),e}function WR(e,t,n){return e===t?n:e===n?t:e}function Vp(e,t,n){return e==="start"?t:e==="end"?n:e}function HR(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class UR extends Yi{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,n,i,r){return Hp(t,n,i,r)}parseArrayData(t,n,i,r){return Hp(t,n,i,r)}parseObjectData(t,n,i,r){const{iScale:s,vScale:a}=t,{xAxisKey:o="x",yAxisKey:c="y"}=this._parsing,l=s.axis==="x"?o:c,h=a.axis==="x"?o:c,u=[];let d,p,g,m;for(d=i,p=i+r;d<p;++d)m=n[d],g={},g[s.axis]=s.parse(Hi(m,l),d),u.push(kb(Hi(m,h),g,a,d));return u}updateRangeFromParsed(t,n,i,r){super.updateRangeFromParsed(t,n,i,r);const s=i._custom;s&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:r}=n,s=this.getParsed(t),a=s._custom,o=yu(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,r){const s=r==="reset",{index:a,_cachedMeta:{vScale:o}}=this,c=o.getBasePixel(),l=o.isHorizontal(),h=this._getRuler(),{sharedOptions:u,includeOptions:d}=this._getSharedOptions(n,r);for(let p=n;p<n+i;p++){const g=this.getParsed(p),m=s||xt(g[o.axis])?{base:c,head:c}:this._calculateBarValuePixels(p),b=this._calculateBarIndexPixels(p,h),w=(g._stacks||{})[o.axis],C={horizontal:l,base:m.base,enableBorderRadius:!w||yu(g._custom)||a===w._top||a===w._bottom,x:l?m.head:b.center,y:l?b.center:m.head,height:l?b.size:Math.abs(m.size),width:l?Math.abs(m.size):b.size};d&&(C.options=u||this.resolveDataElementOptions(p,t[p].active?"active":r));const _=C.options||t[p].options;zR(C,_,w,a),HR(C,_,h.ratio),this.updateElement(t[p],p,C,r)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),s=i.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(n),c=o&&o[i.axis],l=h=>{const u=h._parsed.find(p=>p[i.axis]===c),d=u&&u[h.vScale.axis];if(xt(d)||isNaN(d))return!0};for(const h of r)if(!(n!==void 0&&l(h))&&((s===!1||a.indexOf(h.stack)===-1||s===void 0&&h.stack===void 0)&&a.push(h.stack),h.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===n).shift()}_getAxis(){const t={},n=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[ft(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,n)]=!0;return Object.keys(t)}_getStackIndex(t,n,i){const r=this._getStacks(t,i),s=n!==void 0?r.indexOf(n):-1;return s===-1?r.length-1:s}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,r=[];let s,a;for(s=0,a=n.data.length;s<a;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const o=t.barThickness;return{min:o||$R(n),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i,index:r},options:{base:s,minBarLength:a}}=this,o=s||0,c=this.getParsed(t),l=c._custom,h=yu(l);let u=c[n.axis],d=0,p=i?this.applyStack(n,c,i):u,g,m;p!==u&&(d=p-u,p=u),h&&(u=l.barStart,p=l.barEnd-l.barStart,u!==0&&Tn(u)!==Tn(l.barEnd)&&(d=0),d+=u);const b=!xt(s)&&!h?s:d;let w=n.getPixelForValue(b);if(this.chart.getDataVisibility(t)?g=n.getPixelForValue(d+p):g=w,m=g-w,Math.abs(m)<a){m=BR(m,n,o)*a,u===o&&(w-=m/2);const C=n.getPixelForDecimal(0),_=n.getPixelForDecimal(1),k=Math.min(C,_),x=Math.max(C,_);w=Math.max(Math.min(w,x),k),g=w+m,i&&!h&&(c._stacks[n.axis]._visualValues[r]=n.getValueForPixel(g)-n.getValueForPixel(w))}if(w===n.getPixelForValue(o)){const C=Tn(m)*n.getLineWidthForValue(o)/2;w+=C,m-=C}return{size:m,base:w,head:g,center:g+m/2}}_calculateBarIndexPixels(t,n){const i=n.scale,r=this.options,s=r.skipNull,a=ft(r.maxBarThickness,1/0);let o,c;const l=this._getAxisCount();if(n.grouped){const h=s?this._getStackCount(t):n.stackCount,u=r.barThickness==="flex"?NR(t,n,r,h*l):LR(t,n,r,h*l),d=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(ft(d,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0)+p;o=u.start+u.chunk*g+u.chunk/2,c=Math.min(a,u.chunk*u.ratio)}else o=i.getPixelForValue(this.getParsed(t)[i.axis],t),c=Math.min(a,n.min*n.ratio);return{base:o-c/2,head:o+c/2,center:o,size:c}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[n.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}class VR extends Yi{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,r){const s=super.parsePrimitiveData(t,n,i,r);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+i).radius;return s}parseArrayData(t,n,i,r){const s=super.parseArrayData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=ft(o[2],this.resolveDataElementOptions(a+i).radius)}return s}parseObjectData(t,n,i,r){const s=super.parseObjectData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=ft(o&&o.r&&+o.r,this.resolveDataElementOptions(a+i).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=n,a=this.getParsed(t),o=r.getLabelForValue(a.x),c=s.getLabelForValue(a.y),l=a._custom;return{label:i[t]||"",value:"("+o+", "+c+(l?", "+l:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:c,includeOptions:l}=this._getSharedOptions(n,r),h=a.axis,u=o.axis;for(let d=n;d<n+i;d++){const p=t[d],g=!s&&this.getParsed(d),m={},b=m[h]=s?a.getPixelForDecimal(.5):a.getPixelForValue(g[h]),w=m[u]=s?o.getBasePixel():o.getPixelForValue(g[u]);m.skip=isNaN(b)||isNaN(w),l&&(m.options=c||this.resolveDataElementOptions(d,p.active?"active":r),s&&(m.options.radius=0)),this.updateElement(p,d,m,r)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return n!=="active"&&(r.radius=0),r.radius+=ft(i&&i._custom,s),r}}function qR(e,t,n){let i=1,r=1,s=0,a=0;if(t<Vt){const o=e,c=o+t,l=Math.cos(o),h=Math.sin(o),u=Math.cos(c),d=Math.sin(c),p=(_,k,x)=>Va(_,o,c,!0)?1:Math.max(k,k*n,x,x*n),g=(_,k,x)=>Va(_,o,c,!0)?-1:Math.min(k,k*n,x,x*n),m=p(0,l,u),b=p(re,h,d),w=g(It,l,u),C=g(It+re,h,d);i=(m-w)/2,r=(b-C)/2,s=-(m+w)/2,a=-(b+C)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:a}}class Pd extends Yi{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data,{labels:{pointStyle:i,textAlign:r,color:s,useBorderRadius:a,borderRadius:o}}=t.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((c,l)=>{const u=t.getDatasetMeta(0).controller.getStyle(l);return{text:c,fillStyle:u.backgroundColor,fontColor:s,hidden:!t.getDataVisibility(l),lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:u.borderWidth,strokeStyle:u.borderColor,textAlign:r,pointStyle:i,borderRadius:a&&(o||u.borderRadius),index:l}}):[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}}};constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=c=>+i[c];if(kt(i[t])){const{key:c="value"}=this._parsing;s=l=>+Hi(i[l],c)}let a,o;for(a=t,o=t+n;a<o;++a)r._parsed[a]=s(a)}}_getRotation(){return bn(this.options.rotation-90)}_getCircumference(){return bn(this.options.circumference)}_getRotationExtents(){let t=Vt,n=-Vt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),a=r._getCircumference();t=Math.min(t,s),n=Math.max(n,s+a)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,r=this._cachedMeta,s=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-a)/2,0),c=Math.min(nI(this.options.cutout,o),1),l=this._getRingWeight(this.index),{circumference:h,rotation:u}=this._getRotationExtents(),{ratioX:d,ratioY:p,offsetX:g,offsetY:m}=qR(u,h,c),b=(i.width-a)/d,w=(i.height-a)/p,C=Math.max(Math.min(b,w)/2,0),_=J0(this.options.radius,C),k=Math.max(_*c,0),x=(_-k)/this._getVisibleDatasetWeightTotal();this.offsetX=g*_,this.offsetY=m*_,r.total=this.calculateTotal(),this.outerRadius=_-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*l,0),this.updateElements(s,0,s.length,t)}_circumference(t,n){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*s/Vt)}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,o=a.chartArea,l=a.options.animation,h=(o.left+o.right)/2,u=(o.top+o.bottom)/2,d=s&&l.animateScale,p=d?0:this.innerRadius,g=d?0:this.outerRadius,{sharedOptions:m,includeOptions:b}=this._getSharedOptions(n,r);let w=this._getRotation(),C;for(C=0;C<n;++C)w+=this._circumference(C,s);for(C=n;C<n+i;++C){const _=this._circumference(C,s),k=t[C],x={x:h+this.offsetX,y:u+this.offsetY,startAngle:w,endAngle:w+_,circumference:_,outerRadius:g,innerRadius:p};b&&(x.options=m||this.resolveDataElementOptions(C,k.active?"active":r)),w+=_,this.updateElement(k,C,x,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,r;for(r=0;r<n.length;r++){const s=t._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?Vt*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=po(n._parsed[t],i.options.locale);return{label:r[t]||"",value:s}}getMaxBorderWidth(t){let n=0;const i=this.chart;let r,s,a,o,c;if(!t){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){a=i.getDatasetMeta(r),t=a.data,o=a.controller;break}}if(!t)return 0;for(r=0,s=t.length;r<s;++r)c=o.resolveDataElementOptions(r),c.borderAlign!=="inner"&&(n=Math.max(n,c.borderWidth||0,c.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,r=t.length;i<r;++i){const s=this.resolveDataElementOptions(i);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(ft(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class KR extends Yi{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=n,a=this.chart._animationsDisabled;let{start:o,count:c}=ab(n,r,a);this._drawStart=o,this._drawCount=c,ob(n)&&(o=0,c=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!a,options:l},t),this.updateElements(r,o,c,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:c,_dataset:l}=this._cachedMeta,{sharedOptions:h,includeOptions:u}=this._getSharedOptions(n,r),d=a.axis,p=o.axis,{spanGaps:g,segment:m}=this.options,b=Es(g)?g:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||s||r==="none",C=n+i,_=t.length;let k=n>0&&this.getParsed(n-1);for(let x=0;x<_;++x){const I=t[x],E=w?I:{};if(x<n||x>=C){E.skip=!0;continue}const y=this.getParsed(x),M=xt(y[p]),D=E[d]=a.getPixelForValue(y[d],x),R=E[p]=s||M?o.getBasePixel():o.getPixelForValue(c?this.applyStack(o,y,c):y[p],x);E.skip=isNaN(D)||isNaN(R)||M,E.stop=x>0&&Math.abs(y[d]-k[d])>b,m&&(E.parsed=y,E.raw=l.data[x]),u&&(E.options=h||this.resolveDataElementOptions(x,I.active?"active":r)),w||this.updateElement(I,x,E,r),k=y}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class Eb extends Yi{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:i,color:r}}=t.legend.options;return n.labels.map((s,a)=>{const c=t.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:r,lineWidth:c.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=po(n._parsed[t].r,i.options.locale);return{label:r[t]||"",value:s}}parseObjectData(t,n,i,r){return gb.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),s=Math.max(r/2,0),a=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),o=(s-a)/t.getVisibleDatasetCount();this.outerRadius=s-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,c=a.options.animation,l=this._cachedMeta.rScale,h=l.xCenter,u=l.yCenter,d=l.getIndexAngle(0)-.5*It;let p=d,g;const m=360/this.countVisibleElements();for(g=0;g<n;++g)p+=this._computeAngle(g,r,m);for(g=n;g<n+i;g++){const b=t[g];let w=p,C=p+this._computeAngle(g,r,m),_=a.getDataVisibility(g)?l.getDistanceFromCenterForValue(this.getParsed(g).r):0;p=C,s&&(c.animateScale&&(_=0),c.animateRotate&&(w=C=d));const k={x:h,y:u,innerRadius:0,outerRadius:_,startAngle:w,endAngle:C,options:this.resolveDataElementOptions(g,b.active?"active":r)};this.updateElement(b,g,k,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?bn(this.resolveDataElementOptions(t,n).angle||i):0}}class YR extends Pd{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class XR extends Yi{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,r){return gb.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta,i=n.dataset,r=n.data||[],s=n.iScale.getLabels();if(i.points=r,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:s.length===r.length,options:a};this.updateElement(i,void 0,o,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,i,r){const s=this._cachedMeta.rScale,a=r==="reset";for(let o=n;o<n+i;o++){const c=t[o],l=this.resolveDataElementOptions(o,c.active?"active":r),h=s.getPointPositionForValue(o,this.getParsed(o).r),u=a?s.xCenter:h.x,d=a?s.yCenter:h.y,p={x:u,y:d,angle:h.angle,skip:isNaN(u)||isNaN(d),options:l};this.updateElement(c,o,p,r)}}}class GR extends Yi{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=n,a=this.getParsed(t),o=r.getLabelForValue(a.x),c=s.getLabelForValue(a.y);return{label:i[t]||"",value:"("+o+", "+c+")"}}update(t){const n=this._cachedMeta,{data:i=[]}=n,r=this.chart._animationsDisabled;let{start:s,count:a}=ab(n,i,r);if(this._drawStart=s,this._drawCount=a,ob(n)&&(s=0,a=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:c}=n;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!c._decimated,o.points=i;const l=this.resolveDatasetElementOptions(t);l.segment=this.options.segment,this.updateElement(o,void 0,{animated:!r,options:l},t)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(i,s,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:c,_dataset:l}=this._cachedMeta,h=this.resolveDataElementOptions(n,r),u=this.getSharedOptions(h),d=this.includeOptions(r,u),p=a.axis,g=o.axis,{spanGaps:m,segment:b}=this.options,w=Es(m)?m:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||s||r==="none";let _=n>0&&this.getParsed(n-1);for(let k=n;k<n+i;++k){const x=t[k],I=this.getParsed(k),E=C?x:{},y=xt(I[g]),M=E[p]=a.getPixelForValue(I[p],k),D=E[g]=s||y?o.getBasePixel():o.getPixelForValue(c?this.applyStack(o,I,c):I[g],k);E.skip=isNaN(M)||isNaN(D)||y,E.stop=k>0&&Math.abs(I[p]-_[p])>w,b&&(E.parsed=I,E.raw=l.data[k]),d&&(E.options=u||this.resolveDataElementOptions(k,x.active?"active":r)),C||this.updateElement(x,k,E,r),_=I}this.updateSharedOptions(u,r,h)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let o=0;for(let c=n.length-1;c>=0;--c)o=Math.max(o,n[c].size(this.resolveDataElementOptions(c))/2);return o>0&&o}const i=t.dataset,r=i.options&&i.options.borderWidth||0;if(!n.length)return r;const s=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,s,a)/2}}var QR=Object.freeze({__proto__:null,BarController:UR,BubbleController:VR,DoughnutController:Pd,LineController:KR,PieController:YR,PolarAreaController:Eb,RadarController:XR,ScatterController:GR});function rr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Od{static override(t){Object.assign(Od.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return rr()}parse(){return rr()}format(){return rr()}add(){return rr()}diff(){return rr()}startOf(){return rr()}endOf(){return rr()}}var JR={_date:Od};function ZR(e,t,n,i){const{controller:r,data:s,_sorted:a}=e,o=r._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&t!=="r"&&a&&s.length){const l=o._reversePixels?gI:Yn;if(i){if(r._sharedOptions){const h=s[0],u=typeof h.getRange=="function"&&h.getRange(t);if(u){const d=l(s,t,n-u),p=l(s,t,n+u);return{lo:d.lo,hi:p.hi}}}}else{const h=l(s,t,n);if(c){const{vScale:u}=r._cachedMeta,{_parsed:d}=e,p=d.slice(0,h.lo+1).reverse().findIndex(m=>!xt(m[u.axis]));h.lo-=Math.max(0,p);const g=d.slice(h.hi).findIndex(m=>!xt(m[u.axis]));h.hi+=Math.max(0,g)}return h}}return{lo:0,hi:s.length-1}}function xl(e,t,n,i,r){const s=e.getSortedVisibleDatasetMetas(),a=n[t];for(let o=0,c=s.length;o<c;++o){const{index:l,data:h}=s[o],{lo:u,hi:d}=ZR(s[o],t,a,r);for(let p=u;p<=d;++p){const g=h[p];g.skip||i(g,l,p)}}}function tT(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,r){const s=t?Math.abs(i.x-r.x):0,a=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function wu(e,t,n,i,r){const s=[];return!r&&!e.isPointInArea(t)||xl(e,n,t,function(o,c,l){!r&&!Xn(o,e.chartArea,0)||o.inRange(t.x,t.y,i)&&s.push({element:o,datasetIndex:c,index:l})},!0),s}function eT(e,t,n,i){let r=[];function s(a,o,c){const{startAngle:l,endAngle:h}=a.getProps(["startAngle","endAngle"],i),{angle:u}=eb(a,{x:t.x,y:t.y});Va(u,l,h)&&r.push({element:a,datasetIndex:o,index:c})}return xl(e,n,t,s),r}function nT(e,t,n,i,r,s){let a=[];const o=tT(n);let c=Number.POSITIVE_INFINITY;function l(h,u,d){const p=h.inRange(t.x,t.y,r);if(i&&!p)return;const g=h.getCenterPoint(r);if(!(!!s||e.isPointInArea(g))&&!p)return;const b=o(t,g);b<c?(a=[{element:h,datasetIndex:u,index:d}],c=b):b===c&&a.push({element:h,datasetIndex:u,index:d})}return xl(e,n,t,l),a}function xu(e,t,n,i,r,s){return!s&&!e.isPointInArea(t)?[]:n==="r"&&!i?eT(e,t,n,r):nT(e,t,n,i,r,s)}function qp(e,t,n,i,r){const s=[],a=n==="x"?"inXRange":"inYRange";let o=!1;return xl(e,n,t,(c,l,h)=>{c[a]&&c[a](t[n],r)&&(s.push({element:c,datasetIndex:l,index:h}),o=o||c.inRange(t.x,t.y,r))}),i&&!o?[]:s}var iT={modes:{index(e,t,n,i){const r=ur(t,e),s=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?wu(e,r,s,i,a):xu(e,r,s,!1,i,a),c=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(l=>{const h=o[0].index,u=l.data[h];u&&!u.skip&&c.push({element:u,datasetIndex:l.index,index:h})}),c):[]},dataset(e,t,n,i){const r=ur(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?wu(e,r,s,i,a):xu(e,r,s,!1,i,a);if(o.length>0){const c=o[0].datasetIndex,l=e.getDatasetMeta(c).data;o=[];for(let h=0;h<l.length;++h)o.push({element:l[h],datasetIndex:c,index:h})}return o},point(e,t,n,i){const r=ur(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return wu(e,r,s,i,a)},nearest(e,t,n,i){const r=ur(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return xu(e,r,s,n.intersect,i,a)},x(e,t,n,i){const r=ur(t,e);return qp(e,r,"x",n.intersect,i)},y(e,t,n,i){const r=ur(t,e);return qp(e,r,"y",n.intersect,i)}}};const Mb=["left","top","right","bottom"];function Vs(e,t){return e.filter(n=>n.pos===t)}function Kp(e,t){return e.filter(n=>Mb.indexOf(n.pos)===-1&&n.box.axis===t)}function qs(e,t){return e.sort((n,i)=>{const r=t?i:n,s=t?n:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function rT(e){const t=[];let n,i,r,s,a,o;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],{position:s,options:{stack:a,stackWeight:o=1}}=r,t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return t}function sT(e){const t={};for(const n of e){const{stack:i,pos:r,stackWeight:s}=n;if(!i||!Mb.includes(r))continue;const a=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return t}function aT(e,t){const n=sT(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let s,a,o;for(s=0,a=e.length;s<a;++s){o=e[s];const{fullSize:c}=o.box,l=n[o.stack],h=l&&o.stackWeight/l.weight;o.horizontal?(o.width=h?h*i:c&&t.availableWidth,o.height=r):(o.width=i,o.height=h?h*r:c&&t.availableHeight)}return n}function oT(e){const t=rT(e),n=qs(t.filter(l=>l.box.fullSize),!0),i=qs(Vs(t,"left"),!0),r=qs(Vs(t,"right")),s=qs(Vs(t,"top"),!0),a=qs(Vs(t,"bottom")),o=Kp(t,"x"),c=Kp(t,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(c).concat(a).concat(o),chartArea:Vs(t,"chartArea"),vertical:i.concat(r).concat(c),horizontal:s.concat(a).concat(o)}}function Yp(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function Db(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function cT(e,t,n,i){const{pos:r,box:s}=n,a=e.maxPadding;if(!kt(r)){n.size&&(e[r]-=n.size);const u=i[n.stack]||{size:0,count:1};u.size=Math.max(u.size,n.horizontal?s.height:s.width),n.size=u.size/u.count,e[r]+=n.size}s.getPadding&&Db(a,s.getPadding());const o=Math.max(0,t.outerWidth-Yp(a,e,"left","right")),c=Math.max(0,t.outerHeight-Yp(a,e,"top","bottom")),l=o!==e.w,h=c!==e.h;return e.w=o,e.h=c,n.horizontal?{same:l,other:h}:{same:h,other:l}}function lT(e){const t=e.maxPadding;function n(i){const r=Math.max(t[i]-e[i],0);return e[i]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function uT(e,t){const n=t.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{s[a]=Math.max(t[a],n[a])}),s}return i(e?["left","right"]:["top","bottom"])}function sa(e,t,n,i){const r=[];let s,a,o,c,l,h;for(s=0,a=e.length,l=0;s<a;++s){o=e[s],c=o.box,c.update(o.width||t.w,o.height||t.h,uT(o.horizontal,t));const{same:u,other:d}=cT(t,n,o,i);l|=u&&r.length,h=h||d,c.fullSize||r.push(o)}return l&&sa(r,t,n,i)||h}function Lo(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function Xp(e,t,n,i){const r=n.padding;let{x:s,y:a}=t;for(const o of e){const c=o.box,l=i[o.stack]||{placed:0,weight:1},h=o.stackWeight/l.weight||1;if(o.horizontal){const u=t.w*h,d=l.size||c.height;Ua(l.start)&&(a=l.start),c.fullSize?Lo(c,r.left,a,n.outerWidth-r.right-r.left,d):Lo(c,t.left+l.placed,a,u,d),l.start=a,l.placed+=u,a=c.bottom}else{const u=t.h*h,d=l.size||c.width;Ua(l.start)&&(s=l.start),c.fullSize?Lo(c,s,r.top,d,n.outerHeight-r.bottom-r.top):Lo(c,s,t.top+l.placed,d,u),l.start=s,l.placed+=u,s=c.right}}t.x=s,t.y=a}var Me={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=De(e.options.layout.padding),s=Math.max(t-r.width,0),a=Math.max(n-r.height,0),o=oT(e.boxes),c=o.vertical,l=o.horizontal;Nt(e.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const h=c.reduce((m,b)=>b.box.options&&b.box.options.display===!1?m:m+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/h,hBoxMaxHeight:a/2}),d=Object.assign({},r);Db(d,De(i));const p=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),g=aT(c.concat(l),u);sa(o.fullSize,p,u,g),sa(c,p,u,g),sa(l,p,u,g)&&sa(c,p,u,g),lT(p),Xp(o.leftAndTop,p,u,g),p.x+=p.w,p.y+=p.h,Xp(o.rightAndBottom,p,u,g),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Nt(o.chartArea,m=>{const b=m.box;Object.assign(b,e.chartArea),b.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class Ib{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,r){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(t){return!0}updateConfig(t){}}class hT extends Ib{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ec="$chartjs",dT={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Gp=e=>e===null||e==="";function fT(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[ec]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Gp(r)){const s=Op(e,"width");s!==void 0&&(e.width=s)}if(Gp(i))if(e.style.height==="")e.height=e.width/(t||2);else{const s=Op(e,"height");s!==void 0&&(e.height=s)}return e}const Rb=cR?{passive:!0}:!1;function pT(e,t,n){e&&e.addEventListener(t,n,Rb)}function gT(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,Rb)}function mT(e,t){const n=dT[e.type]||e.type,{x:i,y:r}=ur(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:r!==void 0?r:null}}function qc(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function vT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||qc(o.addedNodes,i),a=a&&!qc(o.removedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function bT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||qc(o.removedNodes,i),a=a&&!qc(o.addedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Ka=new Map;let Qp=0;function Tb(){const e=window.devicePixelRatio;e!==Qp&&(Qp=e,Ka.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function _T(e,t){Ka.size||window.addEventListener("resize",Tb),Ka.set(e,t)}function yT(e){Ka.delete(e),Ka.size||window.removeEventListener("resize",Tb)}function wT(e,t,n){const i=e.canvas,r=i&&Td(i);if(!r)return;const s=sb((o,c)=>{const l=r.clientWidth;n(o,c),l<r.clientWidth&&n()},window),a=new ResizeObserver(o=>{const c=o[0],l=c.contentRect.width,h=c.contentRect.height;l===0&&h===0||s(l,h)});return a.observe(r),_T(e,s),a}function Su(e,t,n){n&&n.disconnect(),t==="resize"&&yT(e)}function xT(e,t,n){const i=e.canvas,r=sb(s=>{e.ctx!==null&&n(mT(s,e))},e);return pT(i,t,r),r}class ST extends Ib{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(fT(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[ec])return!1;const i=n[ec].initial;["height","width"].forEach(s=>{const a=i[s];xt(a)?n.removeAttribute(s):n.setAttribute(s,a)});const r=i.style||{};return Object.keys(r).forEach(s=>{n.style[s]=r[s]}),n.width=n.width,delete n[ec],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),a={attach:vT,detach:bT,resize:wT}[n]||xT;r[n]=a(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),r=i[n];if(!r)return;({attach:Su,detach:Su,resize:Su}[n]||gT)(t,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,r){return oR(t,n,i,r)}isAttached(t){const n=t&&Td(t);return!!(n&&n.isConnected)}}function CT(e){return!Rd()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?hT:ST}class gi{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return Es(this.x)&&Es(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const r={};return t.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}function kT(e,t){const n=e.options.ticks,i=ET(e),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?DT(t):[],a=s.length,o=s[0],c=s[a-1],l=[];if(a>r)return IT(t,l,s,a/r),l;const h=MT(s,t,r);if(a>0){let u,d;const p=a>1?Math.round((c-o)/(a-1)):null;for(No(t,l,h,xt(p)?0:o-p,o),u=0,d=a-1;u<d;u++)No(t,l,h,s[u],s[u+1]);return No(t,l,h,c,xt(p)?t.length:c+p),l}return No(t,l,h),l}function ET(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}function MT(e,t,n){const i=RT(e),r=t.length/n;if(!i)return Math.max(r,1);const s=uI(i);for(let a=0,o=s.length-1;a<o;a++){const c=s[a];if(c>r)return c}return Math.max(r,1)}function DT(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function IT(e,t,n,i){let r=0,s=n[0],a;for(i=Math.ceil(i),a=0;a<e.length;a++)a===s&&(t.push(e[a]),r++,s=n[r*i])}function No(e,t,n,i,r){const s=ft(i,0),a=Math.min(ft(r,e.length),e.length);let o=0,c,l,h;for(n=Math.ceil(n),r&&(c=r-i,n=c/Math.floor(c/n)),h=s;h<0;)o++,h=Math.round(s+o*n);for(l=Math.max(s,0);l<a;l++)l===h&&(t.push(e[l]),o++,h=Math.round(s+o*n))}function RT(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const TT=e=>e==="left"?"right":e==="right"?"left":e,Jp=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,Zp=(e,t)=>Math.min(t||e,e);function tg(e,t){const n=[],i=e.length/t,r=e.length;let s=0;for(;s<r;s+=i)n.push(e[Math.floor(s)]);return n}function PT(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),s=e._startPixel,a=e._endPixel,o=1e-6;let c=e.getPixelForTick(r),l;if(!(n&&(i===1?l=Math.max(c-s,a-c):t===0?l=(e.getPixelForTick(1)-c)/2:l=(c-e.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<s-o||c>a+o)))return c}function OT(e,t){Nt(e,n=>{const i=n.gc,r=i.length/2;let s;if(r>t){for(s=0;s<r;++s)delete n.data[i[s]];i.splice(0,r)}})}function Ks(e){return e.drawTicks?e.tickLength:0}function eg(e,t){if(!e.display)return 0;const n=he(e.font,t),i=De(e.padding);return(Xt(e.text)?e.text.length:1)*n.lineHeight+i.height}function AT(e,t){return Ki(e,{scale:t,type:"scale"})}function $T(e,t,n){return Ki(e,{tick:n,index:t,type:"tick"})}function LT(e,t,n){let i=Cd(e);return(n&&t!=="right"||!n&&t==="right")&&(i=TT(i)),i}function NT(e,t,n,i){const{top:r,left:s,bottom:a,right:o,chart:c}=e,{chartArea:l,scales:h}=c;let u=0,d,p,g;const m=a-r,b=o-s;if(e.isHorizontal()){if(p=Ce(i,s,o),kt(n)){const w=Object.keys(n)[0],C=n[w];g=h[w].getPixelForValue(C)+m-t}else n==="center"?g=(l.bottom+l.top)/2+m-t:g=Jp(e,n,t);d=o-s}else{if(kt(n)){const w=Object.keys(n)[0],C=n[w];p=h[w].getPixelForValue(C)-b+t}else n==="center"?p=(l.left+l.right)/2-b+t:p=Jp(e,n,t);g=Ce(i,a,r),u=n==="left"?-re:re}return{titleX:p,titleY:g,maxWidth:d,rotation:u}}class Wr extends gi{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return t=qe(t,Number.POSITIVE_INFINITY),n=qe(n,Number.NEGATIVE_INFINITY),i=qe(i,Number.POSITIVE_INFINITY),r=qe(r,Number.NEGATIVE_INFINITY),{min:qe(t,i),max:qe(n,r),minDefined:te(t),maxDefined:te(n)}}getMinMax(t){let{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),a;if(r&&s)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let c=0,l=o.length;c<l;++c)a=o[c].controller.getMinMax(this,t),r||(n=Math.min(n,a.min)),s||(i=Math.max(i,a.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:qe(n,qe(i,n)),max:qe(i,qe(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ht(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:r,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=BI(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=o<this.ticks.length;this._convertTicksToLabels(c?tg(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=kT(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ht(this.options.afterUpdate,[this])}beforeSetDimensions(){Ht(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ht(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Ht(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ht(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i],s.label=Ht(n.callback,[s.value,i,t],this)}afterTickToLabelConversion(){Ht(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ht(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=Zp(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,s=n.maxRotation;let a=r,o,c,l;if(!this._isVisible()||!n.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const h=this._getLabelSizes(),u=h.widest.width,d=h.highest.height,p=ge(this.chart.width-u,0,this.maxWidth);o=t.offset?this.maxWidth/i:p/(i-1),u+6>o&&(o=p/(i-(t.offset?.5:1)),c=this.maxHeight-Ks(t.grid)-n.padding-eg(t.title,this.chart.options.font),l=Math.sqrt(u*u+d*d),a=xd(Math.min(Math.asin(ge((h.highest.height+6)/o,-1,1)),Math.asin(ge(c/l,-1,1))-Math.asin(ge(d/l,-1,1)))),a=Math.max(r,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){Ht(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ht(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const c=eg(r,n.options.font);if(o?(t.width=this.maxWidth,t.height=Ks(s)+c):(t.height=this.maxHeight,t.width=Ks(s)+c),i.display&&this.ticks.length){const{first:l,last:h,widest:u,highest:d}=this._getLabelSizes(),p=i.padding*2,g=bn(this.labelRotation),m=Math.cos(g),b=Math.sin(g);if(o){const w=i.mirror?0:b*u.width+m*d.height;t.height=Math.min(this.maxHeight,t.height+w+p)}else{const w=i.mirror?0:m*u.width+b*d.height;t.width=Math.min(this.maxWidth,t.width+w+p)}this._calculatePadding(l,h,b,m)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,r){const{ticks:{align:s,padding:a},position:o}=this.options,c=this.labelRotation!==0,l=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,p=0;c?l?(d=r*t.width,p=i*n.height):(d=i*t.height,p=r*n.width):s==="start"?p=n.width:s==="end"?d=t.width:s!=="inner"&&(d=t.width/2,p=n.width/2),this.paddingLeft=Math.max((d-h+a)*this.width/(this.width-h),0),this.paddingRight=Math.max((p-u+a)*this.width/(this.width-u),0)}else{let h=n.height/2,u=t.height/2;s==="start"?(h=0,u=t.height):s==="end"&&(h=n.height,u=0),this.paddingTop=h+a,this.paddingBottom=u+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ht(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)xt(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=tg(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,i){const{ctx:r,_longestTextCache:s}=this,a=[],o=[],c=Math.floor(n/Zp(n,i));let l=0,h=0,u,d,p,g,m,b,w,C,_,k,x;for(u=0;u<n;u+=c){if(g=t[u].label,m=this._resolveTickFontOptions(u),r.font=b=m.string,w=s[b]=s[b]||{data:{},gc:[]},C=m.lineHeight,_=k=0,!xt(g)&&!Xt(g))_=Uc(r,w.data,w.gc,_,g),k=C;else if(Xt(g))for(d=0,p=g.length;d<p;++d)x=g[d],!xt(x)&&!Xt(x)&&(_=Uc(r,w.data,w.gc,_,x),k+=C);a.push(_),o.push(k),l=Math.max(_,l),h=Math.max(k,h)}OT(s,n);const I=a.indexOf(l),E=o.indexOf(h),y=M=>({width:a[M]||0,height:o[M]||0});return{first:y(0),last:y(n-1),widest:y(I),highest:y(E),widths:a,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return pI(this._alignToPixels?ir(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=$T(this.getContext(),t,i))}return this.$context||(this.$context=AT(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=bn(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),s=this._getLabelSizes(),a=t.autoSkipPadding||0,o=s?s.widest.width+a:0,c=s?s.highest.height+a:0;return this.isHorizontal()?c*i>o*r?o/i:c/r:c*r<o*i?c/i:o/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,r=this.options,{grid:s,position:a,border:o}=r,c=s.offset,l=this.isHorizontal(),u=this.ticks.length+(c?1:0),d=Ks(s),p=[],g=o.setContext(this.getContext()),m=g.display?g.width:0,b=m/2,w=function(Y){return ir(i,Y,m)};let C,_,k,x,I,E,y,M,D,R,P,N;if(a==="top")C=w(this.bottom),E=this.bottom-d,M=C-b,R=w(t.top)+b,N=t.bottom;else if(a==="bottom")C=w(this.top),R=t.top,N=w(t.bottom)-b,E=C+b,M=this.top+d;else if(a==="left")C=w(this.right),I=this.right-d,y=C-b,D=w(t.left)+b,P=t.right;else if(a==="right")C=w(this.left),D=t.left,P=w(t.right)-b,I=C+b,y=this.left+d;else if(n==="x"){if(a==="center")C=w((t.top+t.bottom)/2+.5);else if(kt(a)){const Y=Object.keys(a)[0],K=a[Y];C=w(this.chart.scales[Y].getPixelForValue(K))}R=t.top,N=t.bottom,E=C+b,M=E+d}else if(n==="y"){if(a==="center")C=w((t.left+t.right)/2);else if(kt(a)){const Y=Object.keys(a)[0],K=a[Y];C=w(this.chart.scales[Y].getPixelForValue(K))}I=C-b,y=I-d,D=t.left,P=t.right}const U=ft(r.ticks.maxTicksLimit,u),H=Math.max(1,Math.ceil(u/U));for(_=0;_<u;_+=H){const Y=this.getContext(_),K=s.setContext(Y),Z=o.setContext(Y),j=K.lineWidth,nt=K.color,G=Z.dash||[],tt=Z.dashOffset,z=K.tickWidth,J=K.tickColor,lt=K.tickBorderDash||[],St=K.tickBorderDashOffset;k=PT(this,_,c),k!==void 0&&(x=ir(i,k,j),l?I=y=D=P=x:E=M=R=N=x,p.push({tx1:I,ty1:E,tx2:y,ty2:M,x1:D,y1:R,x2:P,y2:N,width:j,color:nt,borderDash:G,borderDashOffset:tt,tickWidth:z,tickColor:J,tickBorderDash:lt,tickBorderDashOffset:St}))}return this._ticksLength=u,this._borderValue=C,p}_computeLabelItems(t){const n=this.axis,i=this.options,{position:r,ticks:s}=i,a=this.isHorizontal(),o=this.ticks,{align:c,crossAlign:l,padding:h,mirror:u}=s,d=Ks(i.grid),p=d+h,g=u?-h:p,m=-bn(this.labelRotation),b=[];let w,C,_,k,x,I,E,y,M,D,R,P,N="middle";if(r==="top")I=this.bottom-g,E=this._getXAxisLabelAlignment();else if(r==="bottom")I=this.top+g,E=this._getXAxisLabelAlignment();else if(r==="left"){const H=this._getYAxisLabelAlignment(d);E=H.textAlign,x=H.x}else if(r==="right"){const H=this._getYAxisLabelAlignment(d);E=H.textAlign,x=H.x}else if(n==="x"){if(r==="center")I=(t.top+t.bottom)/2+p;else if(kt(r)){const H=Object.keys(r)[0],Y=r[H];I=this.chart.scales[H].getPixelForValue(Y)+p}E=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")x=(t.left+t.right)/2-p;else if(kt(r)){const H=Object.keys(r)[0],Y=r[H];x=this.chart.scales[H].getPixelForValue(Y)}E=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(c==="start"?N="top":c==="end"&&(N="bottom"));const U=this._getLabelSizes();for(w=0,C=o.length;w<C;++w){_=o[w],k=_.label;const H=s.setContext(this.getContext(w));y=this.getPixelForTick(w)+s.labelOffset,M=this._resolveTickFontOptions(w),D=M.lineHeight,R=Xt(k)?k.length:1;const Y=R/2,K=H.color,Z=H.textStrokeColor,j=H.textStrokeWidth;let nt=E;a?(x=y,E==="inner"&&(w===C-1?nt=this.options.reverse?"left":"right":w===0?nt=this.options.reverse?"right":"left":nt="center"),r==="top"?l==="near"||m!==0?P=-R*D+D/2:l==="center"?P=-U.highest.height/2-Y*D+D:P=-U.highest.height+D/2:l==="near"||m!==0?P=D/2:l==="center"?P=U.highest.height/2-Y*D:P=U.highest.height-R*D,u&&(P*=-1),m!==0&&!H.showLabelBackdrop&&(x+=D/2*Math.sin(m))):(I=y,P=(1-R)*D/2);let G;if(H.showLabelBackdrop){const tt=De(H.backdropPadding),z=U.heights[w],J=U.widths[w];let lt=P-tt.top,St=0-tt.left;switch(N){case"middle":lt-=z/2;break;case"bottom":lt-=z;break}switch(E){case"center":St-=J/2;break;case"right":St-=J;break;case"inner":w===C-1?St-=J:w>0&&(St-=J/2);break}G={left:St,top:lt,width:J+tt.width,height:z+tt.height,color:H.backdropColor}}b.push({label:k,font:M,textOffset:P,options:{rotation:m,color:K,strokeColor:Z,strokeWidth:j,textAlign:nt,textBaseline:N,translation:[x,I],backdrop:G}})}return b}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-bn(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,a=this._getLabelSizes(),o=t+s,c=a.widest.width;let l,h;return n==="left"?r?(h=this.right+s,i==="near"?l="left":i==="center"?(l="center",h+=c/2):(l="right",h+=c)):(h=this.right-o,i==="near"?l="right":i==="center"?(l="center",h-=c/2):(l="left",h=this.left)):n==="right"?r?(h=this.left+s,i==="near"?l="right":i==="center"?(l="center",h-=c/2):(l="left",h-=c)):(h=this.left+o,i==="near"?l="left":i==="center"?(l="center",h+=c/2):(l="right",h=this.right)):l="right",{textAlign:l,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:r,width:s,height:a}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,r,s,a),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(s=>s.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,a;const o=(c,l,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(l.x,l.y),i.stroke(),i.restore())};if(n.display)for(s=0,a=r.length;s<a;++s){const c=r[s];n.drawOnChartArea&&o({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),n.drawTicks&&o({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),a=i.display?s.width:0;if(!a)return;const o=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let l,h,u,d;this.isHorizontal()?(l=ir(t,this.left,a)-a/2,h=ir(t,this.right,o)+o/2,u=d=c):(u=ir(t,this.top,a)-a/2,d=ir(t,this.bottom,o)+o/2,l=h=c),n.save(),n.lineWidth=s.width,n.strokeStyle=s.color,n.beginPath(),n.moveTo(l,u),n.lineTo(h,d),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&_l(i,r);const s=this.getLabelItems(t);for(const a of s){const o=a.options,c=a.font,l=a.label,h=a.textOffset;Pr(i,l,0,h,c,o)}r&&yl(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const s=he(i.font),a=De(i.padding),o=i.align;let c=s.lineHeight/2;n==="bottom"||n==="center"||kt(n)?(c+=a.bottom,Xt(i.text)&&(c+=s.lineHeight*(i.text.length-1))):c+=a.top;const{titleX:l,titleY:h,maxWidth:u,rotation:d}=NT(this,c,n,o);Pr(t,i.text,0,0,s,{color:i.color,maxWidth:u,rotation:d,textAlign:LT(o,n,r),textBaseline:"middle",translation:[l,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=ft(t.grid&&t.grid.z,-1),r=ft(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Wr.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,a;for(s=0,a=n.length;s<a;++s){const o=n[s];o[i]===this.id&&(!t||o.type===t)&&r.push(o)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return he(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Fo{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;jT(n)&&(i=this.register(n));const r=this.items,s=t.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in r||(r[s]=t,FT(t,a,i),this.override&&Gt.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,r=this.scope;i in n&&delete n[i],r&&i in Gt[r]&&(delete Gt[r][i],this.override&&delete Tr[i])}}function FT(e,t,n){const i=Ha(Object.create(null),[n?Gt.get(n):{},Gt.get(t),e.defaults]);Gt.set(t,i),e.defaultRoutes&&BT(t,e.defaultRoutes),e.descriptors&&Gt.describe(t,e.descriptors)}function BT(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),r=i.pop(),s=[e].concat(i).join("."),a=t[n].split("."),o=a.pop(),c=a.join(".");Gt.route(s,r,c,o)})}function jT(e){return"id"in e&&"defaults"in e}class zT{constructor(){this.controllers=new Fo(Yi,"datasets",!0),this.elements=new Fo(gi,"elements"),this.plugins=new Fo(Object,"plugins"),this.scales=new Fo(Wr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(t,s,r):Nt(r,a=>{const o=i||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,n,i){const r=wd(t);Ht(i["before"+r],[],i),n[t](i),Ht(i["after"+r],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}}var Mn=new zT;class WT{constructor(){this._init=void 0}notify(t,n,i,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const s=r?this._descriptors(t).filter(r):this._descriptors(t),a=this._notify(s,t,n,i);return n==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),a}_notify(t,n,i,r){r=r||{};for(const s of t){const a=s.plugin,o=a[i],c=[n,r,s.options];if(Ht(o,c,a)===!1&&r.cancelable)return!1}return!0}invalidate(){xt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,r=ft(i.options&&i.options.plugins,{}),s=HT(i);return r===!1&&!n?[]:VT(t,s,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,r=(s,a)=>s.filter(o=>!a.some(c=>o.plugin.id===c.plugin.id));this._notify(r(n,i),t,"stop"),this._notify(r(i,n),t,"start")}}function HT(e){const t={},n=[],i=Object.keys(Mn.plugins.items);for(let s=0;s<i.length;s++)n.push(Mn.getPlugin(i[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const a=r[s];n.indexOf(a)===-1&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}function UT(e,t){return!t&&e===!1?null:e===!0?{}:e}function VT(e,{plugins:t,localIds:n},i,r){const s=[],a=e.getContext();for(const o of t){const c=o.id,l=UT(i[c],r);l!==null&&s.push({plugin:o,options:qT(e.config,{plugin:o,local:n[c]},l,a)})}return s}function qT(e,{plugin:t,local:n},i,r){const s=e.pluginScopeKeys(t),a=e.getOptionScopes(i,s);return n&&t.defaults&&a.push(t.defaults),e.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ph(e,t){const n=Gt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function KT(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function YT(e,t){return e===t?"_index_":"_value_"}function ng(e){if(e==="x"||e==="y"||e==="r")return e}function XT(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function gh(e,...t){if(ng(e))return e;for(const n of t){const i=n.axis||XT(n.position)||e.length>1&&ng(e[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function ig(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function GT(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(i=>i.xAxisID===e||i.yAxisID===e);if(n.length)return ig(e,"x",n[0])||ig(e,"y",n[0])}return{}}function QT(e,t){const n=Tr[e.type]||{scales:{}},i=t.scales||{},r=ph(e.type,t),s=Object.create(null);return Object.keys(i).forEach(a=>{const o=i[a];if(!kt(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const c=gh(a,o,GT(a,e),Gt.scales[o.type]),l=YT(c,r),h=n.scales||{};s[a]=xa(Object.create(null),[{axis:c},o,h[c],h[l]])}),e.data.datasets.forEach(a=>{const o=a.type||e.type,c=a.indexAxis||ph(o,t),h=(Tr[o]||{}).scales||{};Object.keys(h).forEach(u=>{const d=KT(u,c),p=a[d+"AxisID"]||d;s[p]=s[p]||Object.create(null),xa(s[p],[{axis:d},i[p],h[u]])})}),Object.keys(s).forEach(a=>{const o=s[a];xa(o,[Gt.scales[o.type],Gt.scale])}),s}function Pb(e){const t=e.options||(e.options={});t.plugins=ft(t.plugins,{}),t.scales=QT(e,t)}function Ob(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function JT(e){return e=e||{},e.data=Ob(e.data),Pb(e),e}const rg=new Map,Ab=new Set;function Bo(e,t){let n=rg.get(e);return n||(n=t(),rg.set(e,n),Ab.add(n)),n}const Ys=(e,t,n)=>{const i=Hi(t,n);i!==void 0&&e.add(i)};class ZT{constructor(t){this._config=JT(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Ob(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Pb(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Bo(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Bo(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Bo(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return Bo(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let r=i.get(t);return(!r||n)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,n,i){const{options:r,type:s}=this,a=this._cachedScopes(t,i),o=a.get(n);if(o)return o;const c=new Set;n.forEach(h=>{t&&(c.add(t),h.forEach(u=>Ys(c,t,u))),h.forEach(u=>Ys(c,r,u)),h.forEach(u=>Ys(c,Tr[s]||{},u)),h.forEach(u=>Ys(c,Gt,u)),h.forEach(u=>Ys(c,dh,u))});const l=Array.from(c);return l.length===0&&l.push(Object.create(null)),Ab.has(n)&&a.set(n,l),l}chartOptionScopes(){const{options:t,type:n}=this;return[t,Tr[n]||{},Gt.datasets[n]||{},{type:n},Gt,dh]}resolveNamedOptions(t,n,i,r=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=sg(this._resolverCache,t,r);let c=a;if(eP(a,n)){s.$shared=!1,i=Ui(i)?i():i;const l=this.createResolver(t,i,o);c=Ms(a,i,l)}for(const l of n)s[l]=c[l];return s}createResolver(t,n,i=[""],r){const{resolver:s}=sg(this._resolverCache,t,i);return kt(n)?Ms(s,n,void 0,r):s}}function sg(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let s=i.get(r);return s||(s={resolver:Md(t,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},i.set(r,s)),s}const tP=e=>kt(e)&&Object.getOwnPropertyNames(e).some(t=>Ui(e[t]));function eP(e,t){const{isScriptable:n,isIndexable:i}=hb(e);for(const r of t){const s=n(r),a=i(r),o=(a||s)&&e[r];if(s&&(Ui(o)||tP(o))||a&&Xt(o))return!0}return!1}var nP="4.5.1";const iP=["top","bottom","left","right","chartArea"];function ag(e,t){return e==="top"||e==="bottom"||iP.indexOf(e)===-1&&t==="x"}function og(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function cg(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Ht(n&&n.onComplete,[e],t)}function rP(e){const t=e.chart,n=t.options.animation;Ht(n&&n.onProgress,[e],t)}function $b(e){return Rd()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const nc={},lg=e=>{const t=$b(e);return Object.values(nc).filter(n=>n.canvas===t).pop()};function sP(e,t,n){const i=Object.keys(e);for(const r of i){const s=+r;if(s>=t){const a=e[r];delete e[r],(n>0||s>t)&&(e[s+n]=a)}}}function aP(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}class Ad{static defaults=Gt;static instances=nc;static overrides=Tr;static registry=Mn;static version=nP;static getChart=lg;static register(...t){Mn.add(...t),ug()}static unregister(...t){Mn.remove(...t),ug()}constructor(t,n){const i=this.config=new ZT(n),r=$b(t),s=lg(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||CT(r)),this.platform.updateConfig(i);const o=this.platform.acquireContext(r,a.aspectRatio),c=o&&o.canvas,l=c&&c.height,h=c&&c.width;if(this.id=eI(),this.ctx=o,this.canvas=c,this.width=h,this.height=l,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new WT,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=bI(u=>this.update(u),a.resizeDelay||0),this._dataChanges=[],nc[this.id]=this,!o||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Wn.listen(this,"complete",cg),Wn.listen(this,"progress",rP),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:r,_aspectRatio:s}=this;return xt(t)?n&&s?s:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Mn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Pp(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ip(this.canvas,this.ctx),this}stop(){return Wn.stop(this),this}resize(t,n){Wn.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,t,n,s),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Pp(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Ht(i.onResize,[this,a],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Nt(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,r=Object.keys(i).reduce((a,o)=>(a[o]=!1,a),{});let s=[];n&&(s=s.concat(Object.keys(n).map(a=>{const o=n[a],c=gh(a,o),l=c==="r",h=c==="x";return{options:o,dposition:l?"chartArea":h?"bottom":"left",dtype:l?"radialLinear":h?"category":"linear"}}))),Nt(s,a=>{const o=a.options,c=o.id,l=gh(c,o),h=ft(o.type,a.dtype);(o.position===void 0||ag(o.position,l)!==ag(a.dposition))&&(o.position=a.dposition),r[c]=!0;let u=null;if(c in i&&i[c].type===h)u=i[c];else{const d=Mn.getScale(h);u=new d({id:c,type:h,ctx:this.ctx,chart:this}),i[u.id]=u}u.init(o,t)}),Nt(r,(a,o)=>{a||delete i[o]}),Nt(i,a=>{Me.configure(this,a,a.options),Me.addBox(this,a)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((r,s)=>r.index-s.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(og("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,r)=>{n.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const s=n[i];let a=this.getDatasetMeta(i);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(i),a=this.getDatasetMeta(i)),a.type=o,a.indexAxis=s.indexAxis||ph(o,this.options),a.order=s.order||0,a.index=i,a.label=""+s.label,a.visible=this.isDatasetVisible(i),a.controller)a.controller.updateIndex(i),a.controller.linkScales();else{const c=Mn.getController(o),{datasetElementType:l,dataElementType:h}=Gt.datasets[o];Object.assign(c,{dataElementType:Mn.getElement(h),datasetElementType:l&&Mn.getElement(l)}),a.controller=new c(this,i),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Nt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let l=0,h=this.data.datasets.length;l<h;l++){const{controller:u}=this.getDatasetMeta(l),d=!r&&s.indexOf(u)===-1;u.buildOrUpdateElements(d),a=Math.max(+u.getMaxOverflow(),a)}a=this._minPadding=i.layout.autoPadding?a:0,this._updateLayout(a),r||Nt(s,l=>{l.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(og("z","_idx"));const{_active:o,_lastEvent:c}=this;c?this._eventHandler(c,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Nt(this.scales,t=>{Me.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!yp(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of n){const a=i==="_removeElements"?-s:s;sP(t,r,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=s=>new Set(t.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),r=i(0);for(let s=1;s<n;s++)if(!yp(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Me.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],Nt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,Ui(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),r={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Wn.has(this)?this.attached&&!Wn.running(this)&&Wn.start(this):(this.draw(),cg({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let r,s;for(r=0,s=n.length;r<s;++r){const a=n[r];(!t||a.visible)&&i.push(a)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i={meta:t,index:t.index,cancelable:!0},r=xb(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&_l(n,r),t.controller.draw(),r&&yl(n),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return Xn(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,r){const s=iT.modes[n];return typeof s=="function"?s(this,t,i,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let r=i.filter(s=>s&&s._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Ki(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const r=i?"show":"hide",s=this.getDatasetMeta(t),a=s.controller._resolveAnimations(void 0,r);Ua(n)?(s.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),a.update(s,{visible:i}),this.update(o=>o.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),Wn.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Ip(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete nc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(s,a)=>{n.addEventListener(this,s,a),t[s]=a},r=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Nt(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(c,l)=>{n.addEventListener(this,c,l),t[c]=l},r=(c,l)=>{t[c]&&(n.removeEventListener(this,c,l),delete t[c])},s=(c,l)=>{this.canvas&&this.resize(c,l)};let a;const o=()=>{r("attach",o),this.attached=!0,this.resize(),i("resize",s),i("detach",a)};a=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",o)},n.isAttached(this.canvas)?o():a()}unbindEvents(){Nt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Nt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const r=i?"set":"remove";let s,a,o,c;for(n==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),o=0,c=t.length;o<c;++o){a=t[o];const l=a&&this.getDatasetMeta(a.datasetIndex).controller;l&&l[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!zc(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,i){const r=this.options.hover,s=(c,l)=>c.filter(h=>!l.some(u=>h.datasetIndex===u.datasetIndex&&h.index===u.index)),a=s(n,t),o=i?t:s(t,n);a.length&&this.updateHoverStyle(a,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:r=[],options:s}=this,a=n,o=this._getActiveElements(t,r,i,a),c=oI(t),l=aP(t,this._lastEvent,i,c);i&&(this._lastEvent=null,Ht(s.onHover,[t,o,this],this),c&&Ht(s.onClick,[t,o,this],this));const h=!zc(o,r);return(h||n)&&(this._active=o,this._updateHoverStyles(o,r,n)),this._lastEvent=l,h}_getActiveElements(t,n,i,r){if(t.type==="mouseout")return[];if(!i)return n;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,r)}}function ug(){return Nt(Ad.instances,e=>e._plugins.invalidate())}function oP(e,t,n){const{startAngle:i,x:r,y:s,outerRadius:a,innerRadius:o,options:c}=t,{borderWidth:l,borderJoinStyle:h}=c,u=Math.min(l/a,Ee(i-n));if(e.beginPath(),e.arc(r,s,a-l/2,i+u/2,n-u/2),o>0){const d=Math.min(l/o,Ee(i-n));e.arc(r,s,o+l/2,n-d/2,i+d/2,!0)}else{const d=Math.min(l/2,a*Ee(i-n));if(h==="round")e.arc(r,s,d,n-It/2,i+It/2,!0);else if(h==="bevel"){const p=2*d*d,g=-p*Math.cos(n+It/2)+r,m=-p*Math.sin(n+It/2)+s,b=p*Math.cos(i+It/2)+r,w=p*Math.sin(i+It/2)+s;e.lineTo(g,m),e.lineTo(b,w)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function cP(e,t,n){const{startAngle:i,pixelMargin:r,x:s,y:a,outerRadius:o,innerRadius:c}=t;let l=r/o;e.beginPath(),e.arc(s,a,o,i-l,n+l),c>r?(l=r/c,e.arc(s,a,c,n+l,i-l,!0)):e.arc(s,a,r,n+re,i-re),e.closePath(),e.clip()}function lP(e){return Ed(e,["outerStart","outerEnd","innerStart","innerEnd"])}function uP(e,t,n,i){const r=lP(e.options.borderRadius),s=(n-t)/2,a=Math.min(s,i*t/2),o=c=>{const l=(n-Math.min(s,c))*i/2;return ge(c,0,Math.min(s,l))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:ge(r.innerStart,0,a),innerEnd:ge(r.innerEnd,0,a)}}function Qr(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Kc(e,t,n,i,r,s){const{x:a,y:o,startAngle:c,pixelMargin:l,innerRadius:h}=t,u=Math.max(t.outerRadius+i+n-l,0),d=h>0?h+i+n+l:0;let p=0;const g=r-c;if(i){const H=h>0?h-i:0,Y=u>0?u-i:0,K=(H+Y)/2,Z=K!==0?g*K/(K+i):g;p=(g-Z)/2}const m=Math.max(.001,g*u-n/It)/u,b=(g-m)/2,w=c+b+p,C=r-b-p,{outerStart:_,outerEnd:k,innerStart:x,innerEnd:I}=uP(t,d,u,C-w),E=u-_,y=u-k,M=w+_/E,D=C-k/y,R=d+x,P=d+I,N=w+x/R,U=C-I/P;if(e.beginPath(),s){const H=(M+D)/2;if(e.arc(a,o,u,M,H),e.arc(a,o,u,H,D),k>0){const j=Qr(y,D,a,o);e.arc(j.x,j.y,k,D,C+re)}const Y=Qr(P,C,a,o);if(e.lineTo(Y.x,Y.y),I>0){const j=Qr(P,U,a,o);e.arc(j.x,j.y,I,C+re,U+Math.PI)}const K=(C-I/d+(w+x/d))/2;if(e.arc(a,o,d,C-I/d,K,!0),e.arc(a,o,d,K,w+x/d,!0),x>0){const j=Qr(R,N,a,o);e.arc(j.x,j.y,x,N+Math.PI,w-re)}const Z=Qr(E,w,a,o);if(e.lineTo(Z.x,Z.y),_>0){const j=Qr(E,M,a,o);e.arc(j.x,j.y,_,w-re,M)}}else{e.moveTo(a,o);const H=Math.cos(M)*u+a,Y=Math.sin(M)*u+o;e.lineTo(H,Y);const K=Math.cos(D)*u+a,Z=Math.sin(D)*u+o;e.lineTo(K,Z)}e.closePath()}function hP(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o}=t;let c=t.endAngle;if(s){Kc(e,t,n,i,c,r);for(let l=0;l<s;++l)e.fill();isNaN(o)||(c=a+(o%Vt||Vt))}return Kc(e,t,n,i,c,r),e.fill(),c}function dP(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o,options:c}=t,{borderWidth:l,borderJoinStyle:h,borderDash:u,borderDashOffset:d,borderRadius:p}=c,g=c.borderAlign==="inner";if(!l)return;e.setLineDash(u||[]),e.lineDashOffset=d,g?(e.lineWidth=l*2,e.lineJoin=h||"round"):(e.lineWidth=l,e.lineJoin=h||"bevel");let m=t.endAngle;if(s){Kc(e,t,n,i,m,r);for(let b=0;b<s;++b)e.stroke();isNaN(o)||(m=a+(o%Vt||Vt))}g&&cP(e,t,m),c.selfJoin&&m-a>=It&&p===0&&h!=="miter"&&oP(e,t,m),s||(Kc(e,t,n,i,m,r),e.stroke())}class fP extends gi{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.getProps(["x","y"],i),{angle:s,distance:a}=eb(r,{x:t,y:n}),{startAngle:o,endAngle:c,innerRadius:l,outerRadius:h,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=(this.options.spacing+this.options.borderWidth)/2,p=ft(u,c-o),g=Va(s,o,c)&&o!==c,m=p>=Vt||g,b=Kn(a,l+d,h+d);return m&&b}getCenterPoint(t){const{x:n,y:i,startAngle:r,endAngle:s,innerRadius:a,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:l}=this.options,h=(r+s)/2,u=(a+o+l+c)/2;return{x:n+Math.cos(h)*u,y:i+Math.sin(h)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,r=(n.offset||0)/4,s=(n.spacing||0)/2,a=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>Vt?Math.floor(i/Vt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const o=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(o)*r,Math.sin(o)*r);const c=1-Math.sin(Math.min(It,i||0)),l=r*c;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,hP(t,this,l,s,a),dP(t,this,l,s,a),t.restore()}}function Lb(e,t,n=t){e.lineCap=ft(n.borderCapStyle,t.borderCapStyle),e.setLineDash(ft(n.borderDash,t.borderDash)),e.lineDashOffset=ft(n.borderDashOffset,t.borderDashOffset),e.lineJoin=ft(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=ft(n.borderWidth,t.borderWidth),e.strokeStyle=ft(n.borderColor,t.borderColor)}function pP(e,t,n){e.lineTo(n.x,n.y)}function gP(e){return e.stepped?RI:e.tension||e.cubicInterpolationMode==="monotone"?TI:pP}function Nb(e,t,n={}){const i=e.length,{start:r=0,end:s=i-1}=n,{start:a,end:o}=t,c=Math.max(r,a),l=Math.min(s,o),h=r<a&&s<a||r>o&&s>o;return{count:i,start:c,loop:t.loop,ilen:l<c&&!h?i+l-c:l-c}}function mP(e,t,n,i){const{points:r,options:s}=t,{count:a,start:o,loop:c,ilen:l}=Nb(r,n,i),h=gP(s);let{move:u=!0,reverse:d}=i||{},p,g,m;for(p=0;p<=l;++p)g=r[(o+(d?l-p:p))%a],!g.skip&&(u?(e.moveTo(g.x,g.y),u=!1):h(e,m,g,d,s.stepped),m=g);return c&&(g=r[(o+(d?l:0))%a],h(e,m,g,d,s.stepped)),!!c}function vP(e,t,n,i){const r=t.points,{count:s,start:a,ilen:o}=Nb(r,n,i),{move:c=!0,reverse:l}=i||{};let h=0,u=0,d,p,g,m,b,w;const C=k=>(a+(l?o-k:k))%s,_=()=>{m!==b&&(e.lineTo(h,b),e.lineTo(h,m),e.lineTo(h,w))};for(c&&(p=r[C(0)],e.moveTo(p.x,p.y)),d=0;d<=o;++d){if(p=r[C(d)],p.skip)continue;const k=p.x,x=p.y,I=k|0;I===g?(x<m?m=x:x>b&&(b=x),h=(u*h+k)/++u):(_(),e.lineTo(k,x),g=I,u=0,m=b=x),w=x}_()}function mh(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?vP:mP}function bP(e){return e.stepped?lR:e.tension||e.cubicInterpolationMode==="monotone"?uR:hr}function _P(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),Lb(e,t.options),e.stroke(r)}function yP(e,t,n,i){const{segments:r,options:s}=t,a=mh(t);for(const o of r)Lb(e,s,o.style),e.beginPath(),a(e,t,o,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const wP=typeof Path2D=="function";function xP(e,t,n,i){wP&&!t.options.segment?_P(e,t,n,i):yP(e,t,n,i)}class Sl extends gi{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;eR(this._points,i,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=mR(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,r=t[n],s=this.points,a=wb(this,{property:n,start:r,end:r});if(!a.length)return;const o=[],c=bP(i);let l,h;for(l=0,h=a.length;l<h;++l){const{start:u,end:d}=a[l],p=s[u],g=s[d];if(p===g){o.push(p);continue}const m=Math.abs((r-p[n])/(g[n]-p[n])),b=c(p,g,m,i.stepped);b[n]=t[n],o.push(b)}return o.length===1?o[0]:o}pathSegment(t,n,i){return mh(this)(t,this,n,i)}path(t,n,i){const r=this.segments,s=mh(this);let a=this._loop;n=n||0,i=i||this.points.length-n;for(const o of r)a&=s(t,this,o,{start:n,end:n+i-1});return!!a}draw(t,n,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),xP(t,this,i,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function hg(e,t,n,i){const r=e.options,{[n]:s}=e.getProps([n],i);return Math.abs(t-s)<r.radius+r.hitRadius}class SP extends gi{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.options,{x:s,y:a}=this.getProps(["x","y"],i);return Math.pow(t-s,2)+Math.pow(n-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return hg(this,t,"x",n)}inYRange(t,n){return hg(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!Xn(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,fh(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function Fb(e,t){const{x:n,y:i,base:r,width:s,height:a}=e.getProps(["x","y","base","width","height"],t);let o,c,l,h,u;return e.horizontal?(u=a/2,o=Math.min(n,r),c=Math.max(n,r),l=i-u,h=i+u):(u=s/2,o=n-u,c=n+u,l=Math.min(i,r),h=Math.max(i,r)),{left:o,top:l,right:c,bottom:h}}function Pi(e,t,n,i){return e?0:ge(t,n,i)}function CP(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,s=ub(i);return{t:Pi(r.top,s.top,0,n),r:Pi(r.right,s.right,0,t),b:Pi(r.bottom,s.bottom,0,n),l:Pi(r.left,s.left,0,t)}}function kP(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=yr(r),a=Math.min(t,n),o=e.borderSkipped,c=i||kt(r);return{topLeft:Pi(!c||o.top||o.left,s.topLeft,0,a),topRight:Pi(!c||o.top||o.right,s.topRight,0,a),bottomLeft:Pi(!c||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:Pi(!c||o.bottom||o.right,s.bottomRight,0,a)}}function EP(e){const t=Fb(e),n=t.right-t.left,i=t.bottom-t.top,r=CP(e,n/2,i/2),s=kP(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function Cu(e,t,n,i){const r=t===null,s=n===null,o=e&&!(r&&s)&&Fb(e,i);return o&&(r||Kn(t,o.left,o.right))&&(s||Kn(n,o.top,o.bottom))}function MP(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function DP(e,t){e.rect(t.x,t.y,t.w,t.h)}function ku(e,t,n={}){const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-i,a=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+s,h:e.h+a,radius:e.radius}}class IP extends gi{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:a}=EP(this),o=MP(a.radius)?qa:DP;t.save(),(a.w!==s.w||a.h!==s.h)&&(t.beginPath(),o(t,ku(a,n,s)),t.clip(),o(t,ku(s,-n,a)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),o(t,ku(s,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,i){return Cu(this,t,n,i)}inXRange(t,n){return Cu(this,t,null,n)}inYRange(t,n){return Cu(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(n+r)/2:n,y:s?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var RP=Object.freeze({__proto__:null,ArcElement:fP,BarElement:IP,LineElement:Sl,PointElement:SP});const vh=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],dg=vh.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function Bb(e){return vh[e%vh.length]}function jb(e){return dg[e%dg.length]}function TP(e,t){return e.borderColor=Bb(t),e.backgroundColor=jb(t),++t}function PP(e,t){return e.backgroundColor=e.data.map(()=>Bb(t++)),t}function OP(e,t){return e.backgroundColor=e.data.map(()=>jb(t++)),t}function AP(e){let t=0;return(n,i)=>{const r=e.getDatasetMeta(i).controller;r instanceof Pd?t=PP(n,t):r instanceof Eb?t=OP(n,t):r&&(t=TP(n,t))}}function fg(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function $P(e){return e&&(e.borderColor||e.backgroundColor)}function LP(){return Gt.borderColor!=="rgba(0,0,0,0.1)"||Gt.backgroundColor!=="rgba(0,0,0,0.1)"}var NP={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;const{data:{datasets:i},options:r}=e.config,{elements:s}=r,a=fg(i)||$P(r)||s&&fg(s)||LP();if(!n.forceOverride&&a)return;const o=AP(e);i.forEach(o)}};function FP(e,t,n,i,r){const s=r.samples||i;if(s>=n)return e.slice(t,t+n);const a=[],o=(n-2)/(s-2);let c=0;const l=t+n-1;let h=t,u,d,p,g,m;for(a[c++]=e[h],u=0;u<s-2;u++){let b=0,w=0,C;const _=Math.floor((u+1)*o)+1+t,k=Math.min(Math.floor((u+2)*o)+1,n)+t,x=k-_;for(C=_;C<k;C++)b+=e[C].x,w+=e[C].y;b/=x,w/=x;const I=Math.floor(u*o)+1+t,E=Math.min(Math.floor((u+1)*o)+1,n)+t,{x:y,y:M}=e[h];for(p=g=-1,C=I;C<E;C++)g=.5*Math.abs((y-b)*(e[C].y-M)-(y-e[C].x)*(w-M)),g>p&&(p=g,d=e[C],m=C);a[c++]=d,h=m}return a[c++]=e[l],a}function BP(e,t,n,i){let r=0,s=0,a,o,c,l,h,u,d,p,g,m;const b=[],w=t+n-1,C=e[t].x,k=e[w].x-C;for(a=t;a<t+n;++a){o=e[a],c=(o.x-C)/k*i,l=o.y;const x=c|0;if(x===h)l<g?(g=l,u=a):l>m&&(m=l,d=a),r=(s*r+o.x)/++s;else{const I=a-1;if(!xt(u)&&!xt(d)){const E=Math.min(u,d),y=Math.max(u,d);E!==p&&E!==I&&b.push({...e[E],x:r}),y!==p&&y!==I&&b.push({...e[y],x:r})}a>0&&I!==p&&b.push(e[I]),b.push(o),h=x,s=0,g=m=l,u=d=p=a}}return b}function zb(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function pg(e){e.data.datasets.forEach(t=>{zb(t)})}function jP(e,t){const n=t.length;let i=0,r;const{iScale:s}=e,{min:a,max:o,minDefined:c,maxDefined:l}=s.getUserBounds();return c&&(i=ge(Yn(t,s.axis,a).lo,0,n-1)),l?r=ge(Yn(t,s.axis,o).hi+1,i,n)-i:r=n-i,{start:i,count:r}}var zP={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){pg(e);return}const i=e.width;e.data.datasets.forEach((r,s)=>{const{_data:a,indexAxis:o}=r,c=e.getDatasetMeta(s),l=a||r.data;if(ra([o,e.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const h=e.scales[c.xAxisID];if(h.type!=="linear"&&h.type!=="time"||e.options.parsing)return;let{start:u,count:d}=jP(c,l);const p=n.threshold||4*i;if(d<=p){zb(r);return}xt(a)&&(r._data=l,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(m){this._data=m}}));let g;switch(n.algorithm){case"lttb":g=FP(l,u,d,i,n);break;case"min-max":g=BP(l,u,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=g})},destroy(e){pg(e)}};function WP(e,t,n){const i=e.segments,r=e.points,s=t.points,a=[];for(const o of i){let{start:c,end:l}=o;l=Cl(c,l,r);const h=bh(n,r[c],r[l],o.loop);if(!t.segments){a.push({source:o,target:h,start:r[c],end:r[l]});continue}const u=wb(t,h);for(const d of u){const p=bh(n,s[d.start],s[d.end],d.loop),g=yb(o,r,p);for(const m of g)a.push({source:m,target:d,start:{[n]:gg(h,p,"start",Math.max)},end:{[n]:gg(h,p,"end",Math.min)}})}}return a}function bh(e,t,n,i){if(i)return;let r=t[e],s=n[e];return e==="angle"&&(r=Ee(r),s=Ee(s)),{property:e,start:r,end:s}}function HP(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,s=[];return t.segments.forEach(({start:a,end:o})=>{o=Cl(a,o,r);const c=r[a],l=r[o];i!==null?(s.push({x:c.x,y:i}),s.push({x:l.x,y:i})):n!==null&&(s.push({x:n,y:c.y}),s.push({x:n,y:l.y}))}),s}function Cl(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function gg(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function Wb(e,t){let n=[],i=!1;return Xt(e)?(i=!0,n=e):n=HP(e,t),n.length?new Sl({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function mg(e){return e&&e.fill!==!1}function UP(e,t,n){let r=e[t].fill;const s=[t];let a;if(!n)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!te(r))return r;if(a=e[r],!a)return!1;if(a.visible)return r;s.push(r),r=a.fill}return!1}function VP(e,t,n){const i=XP(e);if(kt(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return te(r)&&Math.floor(r)===r?qP(i[0],t,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function qP(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function KP(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:kt(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function YP(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:kt(e)?i=e.value:i=t.getBaseValue(),i}function XP(e){const t=e.options,n=t.fill;let i=ft(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function GP(e){const{scale:t,index:n,line:i}=e,r=[],s=i.segments,a=i.points,o=QP(t,n);o.push(Wb({x:null,y:t.bottom},i));for(let c=0;c<s.length;c++){const l=s[c];for(let h=l.start;h<=l.end;h++)JP(r,a[h],o)}return new Sl({points:r,options:{}})}function QP(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===t)break;s.hidden||n.unshift(s.dataset)}return n}function JP(e,t,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:a,last:o,point:c}=ZP(s,t,"x");if(!(!c||a&&o)){if(a)i.unshift(c);else if(e.push(c),!o)break}}e.push(...i)}function ZP(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],s=e.segments,a=e.points;let o=!1,c=!1;for(let l=0;l<s.length;l++){const h=s[l],u=a[h.start][n],d=a[h.end][n];if(Kn(r,u,d)){o=r===u,c=r===d;break}}return{first:o,last:c,point:i}}class Hb{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:r,y:s,radius:a}=this;return n=n||{start:0,end:Vt},t.arc(r,s,a,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:r}=this,s=t.angle;return{x:n+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function tO(e){const{chart:t,fill:n,line:i}=e;if(te(n))return eO(t,n);if(n==="stack")return GP(e);if(n==="shape")return!0;const r=nO(e);return r instanceof Hb?r:Wb(r,i)}function eO(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function nO(e){return(e.scale||{}).getPointPositionForValue?rO(e):iO(e)}function iO(e){const{scale:t={},fill:n}=e,i=KP(n,t);if(te(i)){const r=t.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function rO(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,s=i.reverse?t.max:t.min,a=YP(n,t,s),o=[];if(i.grid.circular){const c=t.getPointPositionForValue(0,s);return new Hb({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(a)})}for(let c=0;c<r;++c)o.push(t.getPointPositionForValue(c,a));return o}function Eu(e,t,n){const i=tO(t),{chart:r,index:s,line:a,scale:o,axis:c}=t,l=a.options,h=l.fill,u=l.backgroundColor,{above:d=u,below:p=u}=h||{},g=r.getDatasetMeta(s),m=xb(r,g);i&&a.points.length&&(_l(e,n),sO(e,{line:a,target:i,above:d,below:p,area:n,scale:o,axis:c,clip:m}),yl(e))}function sO(e,t){const{line:n,target:i,above:r,below:s,area:a,scale:o,clip:c}=t,l=n._loop?"angle":t.axis;e.save();let h=s;s!==r&&(l==="x"?(vg(e,i,a.top),Mu(e,{line:n,target:i,color:r,scale:o,property:l,clip:c}),e.restore(),e.save(),vg(e,i,a.bottom)):l==="y"&&(bg(e,i,a.left),Mu(e,{line:n,target:i,color:s,scale:o,property:l,clip:c}),e.restore(),e.save(),bg(e,i,a.right),h=r)),Mu(e,{line:n,target:i,color:h,scale:o,property:l,clip:c}),e.restore()}function vg(e,t,n){const{segments:i,points:r}=t;let s=!0,a=!1;e.beginPath();for(const o of i){const{start:c,end:l}=o,h=r[c],u=r[Cl(c,l,r)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(h.x,n),e.lineTo(h.x,h.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(u.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function bg(e,t,n){const{segments:i,points:r}=t;let s=!0,a=!1;e.beginPath();for(const o of i){const{start:c,end:l}=o,h=r[c],u=r[Cl(c,l,r)];s?(e.moveTo(h.x,h.y),s=!1):(e.lineTo(n,h.y),e.lineTo(h.x,h.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(n,u.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function Mu(e,t){const{line:n,target:i,property:r,color:s,scale:a,clip:o}=t,c=WP(n,i,r);for(const{source:l,target:h,start:u,end:d}of c){const{style:{backgroundColor:p=s}={}}=l,g=i!==!0;e.save(),e.fillStyle=p,aO(e,a,o,g&&bh(r,u,d)),e.beginPath();const m=!!n.pathSegment(e,l);let b;if(g){m?e.closePath():_g(e,i,d,r);const w=!!i.pathSegment(e,h,{move:m,reverse:!0});b=m&&w,b||_g(e,i,u,r)}e.closePath(),e.fill(b?"evenodd":"nonzero"),e.restore()}}function aO(e,t,n,i){const r=t.chart.chartArea,{property:s,start:a,end:o}=i||{};if(s==="x"||s==="y"){let c,l,h,u;s==="x"?(c=a,l=r.top,h=o,u=r.bottom):(c=r.left,l=a,h=r.right,u=o),e.beginPath(),n&&(c=Math.max(c,n.left),h=Math.min(h,n.right),l=Math.max(l,n.top),u=Math.min(u,n.bottom)),e.rect(c,l,h-c,u-l),e.clip()}}function _g(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}var oO={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let s,a,o,c;for(a=0;a<i;++a)s=e.getDatasetMeta(a),o=s.dataset,c=null,o&&o.options&&o instanceof Sl&&(c={visible:e.isDatasetVisible(a),index:a,fill:VP(o,a,i),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=c,r.push(c);for(a=0;a<i;++a)c=r[a],!(!c||c.fill===!1)&&(c.fill=UP(r,a,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let a=r.length-1;a>=0;--a){const o=r[a].$filler;o&&(o.line.updateControlPoints(s,o.axis),i&&o.fill&&Eu(e.ctx,o,s))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;mg(s)&&Eu(e.ctx,s,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!mg(i)||n.drawTime!=="beforeDatasetDraw"||Eu(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const yg=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},cO=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class wg extends gi{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=Ht(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,r=he(i.font),s=r.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:c}=yg(i,s);let l,h;n.font=r.string,this.isHorizontal()?(l=this.maxWidth,h=this._fitRows(a,s,o,c)+10):(h=this.maxHeight,l=this._fitCols(a,r,o,c)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,r){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,c=this.legendHitBoxes=[],l=this.lineWidths=[0],h=r+o;let u=t;s.textAlign="left",s.textBaseline="middle";let d=-1,p=-h;return this.legendItems.forEach((g,m)=>{const b=i+n/2+s.measureText(g.text).width;(m===0||l[l.length-1]+b+2*o>a)&&(u+=h,l[l.length-(m>0?0:1)]=0,p+=h,d++),c[m]={left:0,top:p,row:d,width:b,height:r},l[l.length-1]+=b+o}),u}_fitCols(t,n,i,r){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,c=this.legendHitBoxes=[],l=this.columnSizes=[],h=a-t;let u=o,d=0,p=0,g=0,m=0;return this.legendItems.forEach((b,w)=>{const{itemWidth:C,itemHeight:_}=lO(i,n,s,b,r);w>0&&p+_+2*o>h&&(u+=d+o,l.push({width:d,height:p}),g+=d+o,m++,d=p=0),c[w]={left:g,top:p,col:m,width:C,height:_},d=Math.max(d,C),p+=_+o}),u+=d,l.push({width:d,height:p}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=this,a=fs(s,this.left,this.width);if(this.isHorizontal()){let o=0,c=Ce(i,this.left+r,this.right-this.lineWidths[o]);for(const l of n)o!==l.row&&(o=l.row,c=Ce(i,this.left+r,this.right-this.lineWidths[o])),l.top+=this.top+t+r,l.left=a.leftForLtr(a.x(c),l.width),c+=l.width+r}else{let o=0,c=Ce(i,this.top+t+r,this.bottom-this.columnSizes[o].height);for(const l of n)l.col!==o&&(o=l.col,c=Ce(i,this.top+t+r,this.bottom-this.columnSizes[o].height)),l.top=c,l.left+=this.left+r,l.left=a.leftForLtr(a.x(l.left),l.width),c+=l.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;_l(t,this),this._draw(),yl(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:r}=this,{align:s,labels:a}=t,o=Gt.color,c=fs(t.rtl,this.left,this.width),l=he(a.font),{padding:h}=a,u=l.size,d=u/2;let p;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:g,boxHeight:m,itemHeight:b}=yg(a,u),w=function(I,E,y){if(isNaN(g)||g<=0||isNaN(m)||m<0)return;r.save();const M=ft(y.lineWidth,1);if(r.fillStyle=ft(y.fillStyle,o),r.lineCap=ft(y.lineCap,"butt"),r.lineDashOffset=ft(y.lineDashOffset,0),r.lineJoin=ft(y.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=ft(y.strokeStyle,o),r.setLineDash(ft(y.lineDash,[])),a.usePointStyle){const D={radius:m*Math.SQRT2/2,pointStyle:y.pointStyle,rotation:y.rotation,borderWidth:M},R=c.xPlus(I,g/2),P=E+d;lb(r,D,R,P,a.pointStyleWidth&&g)}else{const D=E+Math.max((u-m)/2,0),R=c.leftForLtr(I,g),P=yr(y.borderRadius);r.beginPath(),Object.values(P).some(N=>N!==0)?qa(r,{x:R,y:D,w:g,h:m,radius:P}):r.rect(R,D,g,m),r.fill(),M!==0&&r.stroke()}r.restore()},C=function(I,E,y){Pr(r,y.text,I,E+b/2,l,{strikethrough:y.hidden,textAlign:c.textAlign(y.textAlign)})},_=this.isHorizontal(),k=this._computeTitleHeight();_?p={x:Ce(s,this.left+h,this.right-i[0]),y:this.top+h+k,line:0}:p={x:this.left+h,y:Ce(s,this.top+k+h,this.bottom-n[0].height),line:0},vb(this.ctx,t.textDirection);const x=b+h;this.legendItems.forEach((I,E)=>{r.strokeStyle=I.fontColor,r.fillStyle=I.fontColor;const y=r.measureText(I.text).width,M=c.textAlign(I.textAlign||(I.textAlign=a.textAlign)),D=g+d+y;let R=p.x,P=p.y;c.setWidth(this.width),_?E>0&&R+D+h>this.right&&(P=p.y+=x,p.line++,R=p.x=Ce(s,this.left+h,this.right-i[p.line])):E>0&&P+x>this.bottom&&(R=p.x=R+n[p.line].width+h,p.line++,P=p.y=Ce(s,this.top+k+h,this.bottom-n[p.line].height));const N=c.x(R);if(w(N,P,I),R=_I(M,R+g+d,_?R+D:this.right,t.rtl),C(c.x(R),P,I),_)p.x+=D+h;else if(typeof I.text!="string"){const U=l.lineHeight;p.y+=Ub(I,U)+h}else p.y+=x}),bb(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=he(n.font),r=De(n.padding);if(!n.display)return;const s=fs(t.rtl,this.left,this.width),a=this.ctx,o=n.position,c=i.size/2,l=r.top+c;let h,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),h=this.top+l,u=Ce(t.align,u,this.right-d);else{const g=this.columnSizes.reduce((m,b)=>Math.max(m,b.height),0);h=l+Ce(t.align,this.top,this.bottom-g-t.labels.padding-this._computeTitleHeight())}const p=Ce(o,u,u+d);a.textAlign=s.textAlign(Cd(o)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=i.string,Pr(a,n.text,p,h,i)}_computeTitleHeight(){const t=this.options.title,n=he(t.font),i=De(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,r,s;if(Kn(t,this.left,this.right)&&Kn(n,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],Kn(t,r.left,r.left+r.width)&&Kn(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!dO(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,s=cO(r,i);r&&!s&&Ht(n.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!s&&Ht(n.onHover,[t,i,this],this)}else i&&Ht(n.onClick,[t,i,this],this)}}function lO(e,t,n,i,r){const s=uO(i,e,t,n),a=hO(r,i,t.lineHeight);return{itemWidth:s,itemHeight:a}}function uO(e,t,n,i){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((s,a)=>s.length>a.length?s:a)),t+n.size/2+i.measureText(r).width}function hO(e,t,n){let i=e;return typeof t.text!="string"&&(i=Ub(t,n)),i}function Ub(e,t){const n=e.text?e.text.length:0;return t*n}function dO(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var fO={id:"legend",_element:wg,start(e,t,n){const i=e.legend=new wg({ctx:e.ctx,options:n,chart:e});Me.configure(e,i,n),Me.addBox(e,i)},stop(e){Me.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;Me.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:a,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const l=c.controller.getStyle(n?0:void 0),h=De(l.borderWidth);return{text:t[c.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!c.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class $d extends gi{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=Xt(i.text)?i.text.length:1;this._padding=De(i.padding);const s=r*he(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:r,right:s,options:a}=this,o=a.align;let c=0,l,h,u;return this.isHorizontal()?(h=Ce(o,i,s),u=n+t,l=s-i):(a.position==="left"?(h=i+t,u=Ce(o,r,n),c=It*-.5):(h=s-t,u=Ce(o,n,r),c=It*.5),l=r-n),{titleX:h,titleY:u,maxWidth:l,rotation:c}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=he(n.font),s=i.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:c,rotation:l}=this._drawArgs(s);Pr(t,n.text,0,0,i,{color:n.color,maxWidth:c,rotation:l,textAlign:Cd(n.align),textBaseline:"middle",translation:[a,o]})}}function pO(e,t){const n=new $d({ctx:e.ctx,options:t,chart:e});Me.configure(e,n,t),Me.addBox(e,n),e.titleBlock=n}var gO={id:"title",_element:$d,start(e,t,n){pO(e,n)},stop(e){const t=e.titleBlock;Me.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;Me.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const jo=new WeakMap;var mO={id:"subtitle",start(e,t,n){const i=new $d({ctx:e.ctx,options:n,chart:e});Me.configure(e,i,n),Me.addBox(e,i),jo.set(e,i)},stop(e){Me.removeBox(e,jo.get(e)),jo.delete(e)},beforeUpdate(e,t,n){const i=jo.get(e);Me.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const aa={average(e){if(!e.length)return!1;let t,n,i=new Set,r=0,s=0;for(t=0,n=e.length;t<n;++t){const o=e[t].element;if(o&&o.hasValue()){const c=o.tooltipPosition();i.add(c.x),r+=c.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((o,c)=>o+c)/i.size,y:r/s}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,r=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=e.length;s<a;++s){const c=e[s].element;if(c&&c.hasValue()){const l=c.getCenterPoint(),h=hh(t,l);h<r&&(r=h,o=c)}}if(o){const c=o.tooltipPosition();n=c.x,i=c.y}return{x:n,y:i}}};function kn(e,t){return t&&(Xt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Hn(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function vO(e,t){const{element:n,datasetIndex:i,index:r}=t,s=e.getDatasetMeta(i).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:e,label:a,parsed:s.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function xg(e,t){const n=e.chart.ctx,{body:i,footer:r,title:s}=e,{boxWidth:a,boxHeight:o}=t,c=he(t.bodyFont),l=he(t.titleFont),h=he(t.footerFont),u=s.length,d=r.length,p=i.length,g=De(t.padding);let m=g.height,b=0,w=i.reduce((k,x)=>k+x.before.length+x.lines.length+x.after.length,0);if(w+=e.beforeBody.length+e.afterBody.length,u&&(m+=u*l.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),w){const k=t.displayColors?Math.max(o,c.lineHeight):c.lineHeight;m+=p*k+(w-p)*c.lineHeight+(w-1)*t.bodySpacing}d&&(m+=t.footerMarginTop+d*h.lineHeight+(d-1)*t.footerSpacing);let C=0;const _=function(k){b=Math.max(b,n.measureText(k).width+C)};return n.save(),n.font=l.string,Nt(e.title,_),n.font=c.string,Nt(e.beforeBody.concat(e.afterBody),_),C=t.displayColors?a+2+t.boxPadding:0,Nt(i,k=>{Nt(k.before,_),Nt(k.lines,_),Nt(k.after,_)}),C=0,n.font=h.string,Nt(e.footer,_),n.restore(),b+=g.width,{width:b,height:m}}function bO(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function _O(e,t,n,i){const{x:r,width:s}=i,a=n.caretSize+n.caretPadding;if(e==="left"&&r+s+a>t.width||e==="right"&&r-s-a<0)return!0}function yO(e,t,n,i){const{x:r,width:s}=n,{width:a,chartArea:{left:o,right:c}}=e;let l="center";return i==="center"?l=r<=(o+c)/2?"left":"right":r<=s/2?l="left":r>=a-s/2&&(l="right"),_O(l,e,t,n)&&(l="center"),l}function Sg(e,t,n){const i=n.yAlign||t.yAlign||bO(e,n);return{xAlign:n.xAlign||t.xAlign||yO(e,t,n,i),yAlign:i}}function wO(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function xO(e,t,n){let{y:i,height:r}=e;return t==="top"?i+=n:t==="bottom"?i-=r+n:i-=r/2,i}function Cg(e,t,n,i){const{caretSize:r,caretPadding:s,cornerRadius:a}=e,{xAlign:o,yAlign:c}=n,l=r+s,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:p}=yr(a);let g=wO(t,o);const m=xO(t,c,l);return c==="center"?o==="left"?g+=l:o==="right"&&(g-=l):o==="left"?g-=Math.max(h,d)+r:o==="right"&&(g+=Math.max(u,p)+r),{x:ge(g,0,i.width-t.width),y:ge(m,0,i.height-t.height)}}function zo(e,t,n){const i=De(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function kg(e){return kn([],Hn(e))}function SO(e,t,n){return Ki(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Eg(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Vb={beforeTitle:zn,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:zn,beforeBody:zn,beforeLabel:zn,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return xt(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:zn,afterBody:zn,beforeFooter:zn,footer:zn,afterFooter:zn};function Ne(e,t,n,i){const r=e[t].call(n,i);return typeof r>"u"?Vb[t].call(n,i):r}class Mg extends gi{static positioners=aa;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&n.options.animation&&i.animations,s=new Sb(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=SO(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,r=Ne(i,"beforeTitle",this,t),s=Ne(i,"title",this,t),a=Ne(i,"afterTitle",this,t);let o=[];return o=kn(o,Hn(r)),o=kn(o,Hn(s)),o=kn(o,Hn(a)),o}getBeforeBody(t,n){return kg(Ne(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:i}=n,r=[];return Nt(t,s=>{const a={before:[],lines:[],after:[]},o=Eg(i,s);kn(a.before,Hn(Ne(o,"beforeLabel",this,s))),kn(a.lines,Ne(o,"label",this,s)),kn(a.after,Hn(Ne(o,"afterLabel",this,s))),r.push(a)}),r}getAfterBody(t,n){return kg(Ne(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:i}=n,r=Ne(i,"beforeFooter",this,t),s=Ne(i,"footer",this,t),a=Ne(i,"afterFooter",this,t);let o=[];return o=kn(o,Hn(r)),o=kn(o,Hn(s)),o=kn(o,Hn(a)),o}_createItems(t){const n=this._active,i=this.chart.data,r=[],s=[],a=[];let o=[],c,l;for(c=0,l=n.length;c<l;++c)o.push(vO(this.chart,n[c]));return t.filter&&(o=o.filter((h,u,d)=>t.filter(h,u,d,i))),t.itemSort&&(o=o.sort((h,u)=>t.itemSort(h,u,i))),Nt(o,h=>{const u=Eg(t.callbacks,h);r.push(Ne(u,"labelColor",this,h)),s.push(Ne(u,"labelPointStyle",this,h)),a.push(Ne(u,"labelTextColor",this,h))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(t,n){const i=this.options.setContext(this.getContext()),r=this._active;let s,a=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const o=aa[i.position].call(this,r,this._eventPosition);a=this._createItems(i),this.title=this.getTitle(a,i),this.beforeBody=this.getBeforeBody(a,i),this.body=this.getBody(a,i),this.afterBody=this.getAfterBody(a,i),this.footer=this.getFooter(a,i);const c=this._size=xg(this,i),l=Object.assign({},o,c),h=Sg(this.chart,i,l),u=Cg(i,l,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:u.x,y:u.y,width:c.width,height:c.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,r){const s=this.getCaretPosition(t,i,r);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(t,n,i){const{xAlign:r,yAlign:s}=this,{caretSize:a,cornerRadius:o}=i,{topLeft:c,topRight:l,bottomLeft:h,bottomRight:u}=yr(o),{x:d,y:p}=t,{width:g,height:m}=n;let b,w,C,_,k,x;return s==="center"?(k=p+m/2,r==="left"?(b=d,w=b-a,_=k+a,x=k-a):(b=d+g,w=b+a,_=k-a,x=k+a),C=b):(r==="left"?w=d+Math.max(c,h)+a:r==="right"?w=d+g-Math.max(l,u)-a:w=this.caretX,s==="top"?(_=p,k=_-a,b=w-a,C=w+a):(_=p+m,k=_+a,b=w+a,C=w-a),x=_),{x1:b,x2:w,x3:C,y1:_,y2:k,y3:x}}drawTitle(t,n,i){const r=this.title,s=r.length;let a,o,c;if(s){const l=fs(i.rtl,this.x,this.width);for(t.x=zo(this,i.titleAlign,i),n.textAlign=l.textAlign(i.titleAlign),n.textBaseline="middle",a=he(i.titleFont),o=i.titleSpacing,n.fillStyle=i.titleColor,n.font=a.string,c=0;c<s;++c)n.fillText(r[c],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,c+1===s&&(t.y+=i.titleMarginBottom-o)}}_drawColorBox(t,n,i,r,s){const a=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:c,boxWidth:l}=s,h=he(s.bodyFont),u=zo(this,"left",s),d=r.x(u),p=c<h.lineHeight?(h.lineHeight-c)/2:0,g=n.y+p;if(s.usePointStyle){const m={radius:Math.min(l,c)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},b=r.leftForLtr(d,l)+l/2,w=g+c/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,fh(t,m,b,w),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,fh(t,m,b,w)}else{t.lineWidth=kt(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const m=r.leftForLtr(d,l),b=r.leftForLtr(r.xPlus(d,1),l-2),w=yr(a.borderRadius);Object.values(w).some(C=>C!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,qa(t,{x:m,y:g,w:l,h:c,radius:w}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),qa(t,{x:b,y:g+1,w:l-2,h:c-2,radius:w}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(m,g,l,c),t.strokeRect(m,g,l,c),t.fillStyle=a.backgroundColor,t.fillRect(b,g+1,l-2,c-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:r}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:c,boxWidth:l,boxPadding:h}=i,u=he(i.bodyFont);let d=u.lineHeight,p=0;const g=fs(i.rtl,this.x,this.width),m=function(y){n.fillText(y,g.x(t.x+p),t.y+d/2),t.y+=d+s},b=g.textAlign(a);let w,C,_,k,x,I,E;for(n.textAlign=a,n.textBaseline="middle",n.font=u.string,t.x=zo(this,b,i),n.fillStyle=i.bodyColor,Nt(this.beforeBody,m),p=o&&b!=="right"?a==="center"?l/2+h:l+2+h:0,k=0,I=r.length;k<I;++k){for(w=r[k],C=this.labelTextColors[k],n.fillStyle=C,Nt(w.before,m),_=w.lines,o&&_.length&&(this._drawColorBox(n,t,k,g,i),d=Math.max(u.lineHeight,c)),x=0,E=_.length;x<E;++x)m(_[x]),d=u.lineHeight;Nt(w.after,m)}p=0,d=u.lineHeight,Nt(this.afterBody,m),t.y-=s}drawFooter(t,n,i){const r=this.footer,s=r.length;let a,o;if(s){const c=fs(i.rtl,this.x,this.width);for(t.x=zo(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=c.textAlign(i.footerAlign),n.textBaseline="middle",a=he(i.footerFont),n.fillStyle=i.footerColor,n.font=a.string,o=0;o<s;++o)n.fillText(r[o],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+i.footerSpacing}}drawBackground(t,n,i,r){const{xAlign:s,yAlign:a}=this,{x:o,y:c}=t,{width:l,height:h}=i,{topLeft:u,topRight:d,bottomLeft:p,bottomRight:g}=yr(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(o+u,c),a==="top"&&this.drawCaret(t,n,i,r),n.lineTo(o+l-d,c),n.quadraticCurveTo(o+l,c,o+l,c+d),a==="center"&&s==="right"&&this.drawCaret(t,n,i,r),n.lineTo(o+l,c+h-g),n.quadraticCurveTo(o+l,c+h,o+l-g,c+h),a==="bottom"&&this.drawCaret(t,n,i,r),n.lineTo(o+p,c+h),n.quadraticCurveTo(o,c+h,o,c+h-p),a==="center"&&s==="left"&&this.drawCaret(t,n,i,r),n.lineTo(o,c+u),n.quadraticCurveTo(o,c,o+u,c),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const a=aa[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=xg(this,t),c=Object.assign({},a,this._size),l=Sg(n,t,c),h=Cg(t,c,l,n);(r._to!==h.x||s._to!==h.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const a=De(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(t.save(),t.globalAlpha=i,this.drawBackground(s,t,r,n),vb(t,n.textDirection),s.y+=a.top,this.drawTitle(s,t,n),this.drawBody(s,t,n),this.drawFooter(s,t,n),bb(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,r=t.map(({datasetIndex:o,index:c})=>{const l=this.chart.getDatasetMeta(o);if(!l)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:l.data[c],index:c}}),s=!zc(i,r),a=this._positionChanged(r,n);(s||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],a=this._getActiveElements(t,s,n,i),o=this._positionChanged(a,t),c=n||!zc(a,s)||o;return c&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),c}_getActiveElements(t,n,i,r){const s=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(t,s.mode,s,i);return s.reverse&&a.reverse(),a}_positionChanged(t,n){const{caretX:i,caretY:r,options:s}=this,a=aa[s.position].call(this,t,n);return a!==!1&&(i!==a.x||r!==a.y)}}var CO={id:"tooltip",_element:Mg,positioners:aa,afterInit(e,t,n){n&&(e.tooltip=new Mg({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Vb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},kO=Object.freeze({__proto__:null,Colors:NP,Decimation:zP,Filler:oO,Legend:fO,SubTitle:mO,Title:gO,Tooltip:CO});const EO=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function MO(e,t,n,i){const r=e.indexOf(t);if(r===-1)return EO(e,t,n,i);const s=e.lastIndexOf(t);return r!==s?n:r}const DO=(e,t)=>e===null?null:ge(Math.round(e),0,t);function Dg(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class IO extends Wr{static id="category";static defaults={ticks:{callback:Dg}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:s}of n)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(xt(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:MO(i,t,ft(n,t),this._addedLabels),DO(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=t===0&&n===s.length-1?s:s.slice(t,n+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let a=t;a<=n;a++)r.push({value:a});return r}getLabelForValue(t){return Dg.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function RO(e,t){const n=[],{bounds:r,step:s,min:a,max:o,precision:c,count:l,maxTicks:h,maxDigits:u,includeBounds:d}=e,p=s||1,g=h-1,{min:m,max:b}=t,w=!xt(a),C=!xt(o),_=!xt(l),k=(b-m)/(u+1);let x=xp((b-m)/g/p)*p,I,E,y,M;if(x<1e-14&&!w&&!C)return[{value:m},{value:b}];M=Math.ceil(b/x)-Math.floor(m/x),M>g&&(x=xp(M*x/g/p)*p),xt(c)||(I=Math.pow(10,c),x=Math.ceil(x*I)/I),r==="ticks"?(E=Math.floor(m/x)*x,y=Math.ceil(b/x)*x):(E=m,y=b),w&&C&&s&&dI((o-a)/s,x/1e3)?(M=Math.round(Math.min((o-a)/x,h)),x=(o-a)/M,E=a,y=o):_?(E=w?a:E,y=C?o:y,M=l-1,x=(y-E)/M):(M=(y-E)/x,Sa(M,Math.round(M),x/1e3)?M=Math.round(M):M=Math.ceil(M));const D=Math.max(Sp(x),Sp(E));I=Math.pow(10,xt(c)?D:c),E=Math.round(E*I)/I,y=Math.round(y*I)/I;let R=0;for(w&&(d&&E!==a?(n.push({value:a}),E<a&&R++,Sa(Math.round((E+R*x)*I)/I,a,Ig(a,k,e))&&R++):E<a&&R++);R<M;++R){const P=Math.round((E+R*x)*I)/I;if(C&&P>o)break;n.push({value:P})}return C&&d&&y!==o?n.length&&Sa(n[n.length-1].value,o,Ig(o,k,e))?n[n.length-1].value=o:n.push({value:o}):(!C||y===o)&&n.push({value:y}),n}function Ig(e,t,{horizontal:n,minRotation:i}){const r=bn(i),s=(n?Math.sin(r):Math.cos(r))||.001,a=.75*t*(""+e).length;return Math.min(t/s,a)}class Yc extends Wr{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return xt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const a=c=>r=n?r:c,o=c=>s=i?s:c;if(t){const c=Tn(r),l=Tn(s);c<0&&l<0?o(0):c>0&&l>0&&a(0)}if(r===s){let c=s===0?1:Math.abs(s*.05);o(s+c),t||a(r-c)}this.min=r,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,a=RO(r,s);return t.bounds==="ticks"&&tb(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const r=(i-n)/Math.max(t.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return po(t,this.chart.options.locale,this.options.ticks.format)}}class TO extends Yc{static id="linear";static defaults={ticks:{callback:bl.formatters.numeric}};determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=te(t)?t:0,this.max=te(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=bn(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const Ya=e=>Math.floor(Ri(e)),sr=(e,t)=>Math.pow(10,Ya(e)+t);function Rg(e){return e/Math.pow(10,Ya(e))===1}function Tg(e,t,n){const i=Math.pow(10,n),r=Math.floor(e/i);return Math.ceil(t/i)-r}function PO(e,t){const n=t-e;let i=Ya(n);for(;Tg(e,t,i)>10;)i++;for(;Tg(e,t,i)<10;)i--;return Math.min(i,Ya(e))}function OO(e,{min:t,max:n}){t=qe(e.min,t);const i=[],r=Ya(t);let s=PO(t,n),a=s<0?Math.pow(10,Math.abs(s)):1;const o=Math.pow(10,s),c=r>s?Math.pow(10,r):0,l=Math.round((t-c)*a)/a,h=Math.floor((t-c)/o/10)*o*10;let u=Math.floor((l-h)/Math.pow(10,s)),d=qe(e.min,Math.round((c+h+u*Math.pow(10,s))*a)/a);for(;d<n;)i.push({value:d,major:Rg(d),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(s++,u=2,a=s>=0?1:a),d=Math.round((c+h+u*Math.pow(10,s))*a)/a;const p=qe(e.max,d);return i.push({value:p,major:Rg(p),significand:u}),i}class AO extends Wr{static id="logarithmic";static defaults={ticks:{callback:bl.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=Yc.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return te(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=te(t)?Math.max(0,t):null,this.max=te(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!te(this._userMin)&&(this.min=t===sr(this.min,0)?sr(this.min,-1):sr(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,r=this.max;const s=o=>i=t?i:o,a=o=>r=n?r:o;i===r&&(i<=0?(s(1),a(10)):(s(sr(i,-1)),a(sr(r,1)))),i<=0&&s(sr(r,-1)),r<=0&&a(sr(i,1)),this.min=i,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=OO(n,this);return t.bounds==="ticks"&&tb(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":po(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Ri(t),this._valueRange=Ri(this.max)-Ri(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Ri(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}function _h(e){const t=e.ticks;if(t.display&&e.display){const n=De(t.backdropPadding);return ft(t.font&&t.font.size,Gt.font.size)+n.height}return 0}function $O(e,t,n){return n=Xt(n)?n:[n],{w:II(e,t.string,n),h:n.length*t.lineHeight}}function Pg(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function LO(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],s=e._pointLabels.length,a=e.options.pointLabels,o=a.centerPointLabels?It/s:0;for(let c=0;c<s;c++){const l=a.setContext(e.getPointLabelContext(c));r[c]=l.padding;const h=e.getPointPosition(c,e.drawingArea+r[c],o),u=he(l.font),d=$O(e.ctx,u,e._pointLabels[c]);i[c]=d;const p=Ee(e.getIndexAngle(c)+o),g=Math.round(xd(p)),m=Pg(g,h.x,d.w,0,180),b=Pg(g,h.y,d.h,90,270);NO(n,t,p,m,b)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=jO(e,i,r)}function NO(e,t,n,i,r){const s=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let o=0,c=0;i.start<t.l?(o=(t.l-i.start)/s,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/s,e.r=Math.max(e.r,t.r+o)),r.start<t.t?(c=(t.t-r.start)/a,e.t=Math.min(e.t,t.t-c)):r.end>t.b&&(c=(r.end-t.b)/a,e.b=Math.max(e.b,t.b+c))}function FO(e,t,n){const i=e.drawingArea,{extra:r,additionalAngle:s,padding:a,size:o}=n,c=e.getPointPosition(t,i+r+a,s),l=Math.round(xd(Ee(c.angle+re))),h=HO(c.y,o.h,l),u=zO(l),d=WO(c.x,o.w,u);return{visible:!0,x:c.x,y:h,textAlign:u,left:d,top:h,right:d+o.w,bottom:h+o.h}}function BO(e,t){if(!t)return!0;const{left:n,top:i,right:r,bottom:s}=e;return!(Xn({x:n,y:i},t)||Xn({x:n,y:s},t)||Xn({x:r,y:i},t)||Xn({x:r,y:s},t))}function jO(e,t,n){const i=[],r=e._pointLabels.length,s=e.options,{centerPointLabels:a,display:o}=s.pointLabels,c={extra:_h(s)/2,additionalAngle:a?It/r:0};let l;for(let h=0;h<r;h++){c.padding=n[h],c.size=t[h];const u=FO(e,h,c);i.push(u),o==="auto"&&(u.visible=BO(u,l),u.visible&&(l=u))}return i}function zO(e){return e===0||e===180?"center":e<180?"left":"right"}function WO(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function HO(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function UO(e,t,n){const{left:i,top:r,right:s,bottom:a}=n,{backdropColor:o}=t;if(!xt(o)){const c=yr(t.borderRadius),l=De(t.backdropPadding);e.fillStyle=o;const h=i-l.left,u=r-l.top,d=s-i+l.width,p=a-r+l.height;Object.values(c).some(g=>g!==0)?(e.beginPath(),qa(e,{x:h,y:u,w:d,h:p,radius:c}),e.fill()):e.fillRect(h,u,d,p)}}function VO(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const s=e._pointLabelItems[r];if(!s.visible)continue;const a=i.setContext(e.getPointLabelContext(r));UO(n,a,s);const o=he(a.font),{x:c,y:l,textAlign:h}=s;Pr(n,e._pointLabels[r],c,l+o.lineHeight/2,o,{color:a.color,textAlign:h,textBaseline:"middle"})}}function qb(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,Vt);else{let s=e.getPointPosition(0,t);r.moveTo(s.x,s.y);for(let a=1;a<i;a++)s=e.getPointPosition(a,t),r.lineTo(s.x,s.y)}}function qO(e,t,n,i,r){const s=e.ctx,a=t.circular,{color:o,lineWidth:c}=t;!a&&!i||!o||!c||n<0||(s.save(),s.strokeStyle=o,s.lineWidth=c,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),qb(e,n,a,i),s.closePath(),s.stroke(),s.restore())}function KO(e,t,n){return Ki(e,{label:n,index:t,type:"pointLabel"})}class YO extends Yc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:bl.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=De(_h(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=te(t)&&!isNaN(t)?t:0,this.max=te(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/_h(this.options))}generateTickLabels(t){Yc.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const r=Ht(this.options.pointLabels.callback,[n,i],this);return r||r===0?r:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?LO(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,r))}getIndexAngle(t){const n=Vt/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ee(t*n+bn(i))}getDistanceFromCenterForValue(t){if(xt(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(xt(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return KO(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const r=this.getIndexAngle(t)-re+i;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:r,bottom:s}=this._pointLabelItems[t];return{left:n,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),qb(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:r,border:s}=n,a=this._pointLabels.length;let o,c,l;if(n.pointLabels.display&&VO(this,a),r.display&&this.ticks.forEach((h,u)=>{if(u!==0||u===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);const d=this.getContext(u),p=r.setContext(d),g=s.setContext(d);qO(this,p,c,a,g)}}),i.display){for(t.save(),o=a-1;o>=0;o--){const h=i.setContext(this.getPointLabelContext(o)),{color:u,lineWidth:d}=h;!d||!u||(t.lineWidth=d,t.strokeStyle=u,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),l=this.getPointPosition(o,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,c)=>{if(c===0&&this.min>=0&&!n.reverse)return;const l=i.setContext(this.getContext(c)),h=he(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[c].value),l.showLabelBackdrop){t.font=h.string,a=t.measureText(o.label).width,t.fillStyle=l.backdropColor;const u=De(l.backdropPadding);t.fillRect(-a/2-u.left,-s-h.size/2-u.top,a+u.width,h.size+u.height)}Pr(t,o.label,0,-s,h,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}),t.restore()}drawTitle(){}}const kl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Be=Object.keys(kl);function Og(e,t){return e-t}function Ag(e,t){if(xt(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:s}=e._parseOpts;let a=t;return typeof i=="function"&&(a=i(a)),te(a)||(a=typeof i=="string"?n.parse(a,i):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(Es(s)||s===!0)?n.startOf(a,"isoWeek",s):n.startOf(a,r)),+a)}function $g(e,t,n,i){const r=Be.length;for(let s=Be.indexOf(e);s<r-1;++s){const a=kl[Be[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(o*a.size))<=i)return Be[s]}return Be[r-1]}function XO(e,t,n,i,r){for(let s=Be.length-1;s>=Be.indexOf(n);s--){const a=Be[s];if(kl[a].common&&e._adapter.diff(r,i,a)>=t-1)return a}return Be[n?Be.indexOf(n):0]}function GO(e){for(let t=Be.indexOf(e)+1,n=Be.length;t<n;++t)if(kl[Be[t]].common)return Be[t]}function Lg(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:r}=Sd(n,t),s=n[i]>=t?n[i]:n[r];e[s]=!0}}function QO(e,t,n,i){const r=e._adapter,s=+r.startOf(t[0].value,i),a=t[t.length-1].value;let o,c;for(o=s;o<=a;o=+r.add(o,1,i))c=n[o],c>=0&&(t[c].major=!0);return t}function Ng(e,t,n){const i=[],r={},s=t.length;let a,o;for(a=0;a<s;++a)o=t[a],r[o]=a,i.push({value:o,major:!1});return s===0||!n?i:QO(e,i,r,n)}class yh extends Wr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const i=t.time||(t.time={}),r=this._adapter=new JR._date(t.adapters.date);r.init(n),xa(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:Ag(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:r,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function c(l){!a&&!isNaN(l.min)&&(r=Math.min(r,l.min)),!o&&!isNaN(l.max)&&(s=Math.max(s,l.max))}(!a||!o)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=te(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),s=te(s)&&!isNaN(s)?s:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,a=this.max,o=mI(r,s,a);return this._unit=n.unit||(i.autoSkip?$g(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):XO(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:GO(this._unit),this.initOffsets(r),t.reverse&&o.reverse(),Ng(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,i=0,r,s;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?i=s:i=(s-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;n=ge(n,0,a),i=ge(i,0,a),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,r=this.options,s=r.time,a=s.unit||$g(s.minUnit,n,i,this._getLabelCapacity(n)),o=ft(r.ticks.stepSize,1),c=a==="week"?s.isoWeekday:!1,l=Es(c)||c===!0,h={};let u=n,d,p;if(l&&(u=+t.startOf(u,"isoWeek",c)),u=+t.startOf(u,l?"day":a),t.diff(i,n,a)>1e5*o)throw new Error(n+" and "+i+" are too far apart with stepSize of "+o+" "+a);const g=r.ticks.source==="data"&&this.getDataTimestamps();for(d=u,p=0;d<i;d=+t.add(d,o,a),p++)Lg(h,d,g);return(d===i||r.bounds==="ticks"||p===1)&&Lg(h,d,g),Object.keys(h).sort(Og).map(m=>+m)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,s=this._unit,a=n||r[s];return this._adapter.format(t,a)}_tickFormatFunction(t,n,i,r){const s=this.options,a=s.ticks.callback;if(a)return Ht(a,[t,n,i],this);const o=s.time.displayFormats,c=this._unit,l=this._majorUnit,h=c&&o[c],u=l&&o[l],d=i[n],p=l&&u&&d&&d.major;return this._adapter.format(t,r||(p?u:h))}generateTickLabels(t){let n,i,r;for(n=0,i=t.length;n<i;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,r=bn(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(r),a=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:i*s+o*a,h:i*a+o*s}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,s=this._tickFormatFunction(t,0,Ng(this,[t],this._majorUnit),r),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)t.push(Ag(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return ib(t.sort(Og))}}function Wo(e,t,n){let i=0,r=e.length-1,s,a,o,c;n?(t>=e[i].pos&&t<=e[r].pos&&({lo:i,hi:r}=Yn(e,"pos",t)),{pos:s,time:o}=e[i],{pos:a,time:c}=e[r]):(t>=e[i].time&&t<=e[r].time&&({lo:i,hi:r}=Yn(e,"time",t)),{time:s,pos:o}=e[i],{time:a,pos:c}=e[r]);const l=a-s;return l?o+(c-o)*(t-s)/l:o}class JO extends yh{static id="timeseries";static defaults=yh.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Wo(n,this.min),this._tableRange=Wo(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,r=[],s=[];let a,o,c,l,h;for(a=0,o=t.length;a<o;++a)l=t[a],l>=n&&l<=i&&r.push(l);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(a=0,o=r.length;a<o;++a)h=r[a+1],c=r[a-1],l=r[a],Math.round((h+c)/2)!==l&&s.push({time:l,pos:a/(o-1)});return s}_generate(){const t=this.min,n=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(n)||i.length===1)&&i.push(n),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Wo(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return Wo(this._table,i*this._tableRange+this._minPos,!0)}}var ZO=Object.freeze({__proto__:null,CategoryScale:IO,LinearScale:TO,LogarithmicScale:AO,RadialLinearScale:YO,TimeScale:yh,TimeSeriesScale:JO});const tA=[QR,RP,kO,ZO];var eA=Object.defineProperty,nA=Object.getOwnPropertyDescriptor,Kb=e=>{throw TypeError(e)},El=(e,t,n,i)=>{for(var r=i>1?void 0:i?nA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&eA(t,n,r),r},iA=(e,t,n)=>t.has(e)||Kb("Cannot "+n),rA=(e,t,n)=>t.has(e)?Kb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Fg=(e,t,n)=>(iA(e,t,"access private method"),n),ic,wh;Ad.register(...tA);let Is=class extends $t{constructor(){super(...arguments),rA(this,ic),this.chartType="bar",this.data={labels:[],datasets:[]},this.options={}}render(){return F`
      <canvas></canvas>
    `}updated(e){if(!this._chart){Fg(this,ic,wh).call(this);return}e.has("chartType")?(this._chart.destroy(),Fg(this,ic,wh).call(this)):(e.has("data")||e.has("options"))&&(this._chart.data=this.data,e.has("options")&&(this._chart.options=this.options),this._chart.update())}disconnectedCallback(){super.disconnectedCallback(),this._chart?.destroy(),this._chart=void 0}};ic=new WeakSet;wh=function(){const t=this.shadowRoot.querySelector("canvas").getContext("2d");t&&(this._chart=new Ad(t,{type:this.chartType,data:this.data,options:{responsive:!0,maintainAspectRatio:!1,...this.options}}))};Is.styles=Bt`
    :host {
      display: block;
      position: relative;
    }
  `;El([pt({type:String})],Is.prototype,"chartType",2);El([pt({type:Object})],Is.prototype,"data",2);El([pt({type:Object})],Is.prototype,"options",2);Is=El([Ut("chart-wrapper")],Is);const sA=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-x"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M18 6 6 18" />
  <path d="m6 6 12 12" />
</svg>
`;var aA=Object.defineProperty,oA=Object.getOwnPropertyDescriptor,Yb=e=>{throw TypeError(e)},Xb=(e,t,n,i)=>{for(var r=i>1?void 0:i?oA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&aA(t,n,r),r},cA=(e,t,n)=>t.has(e)||Yb("Cannot "+n),lA=(e,t,n)=>t.has(e)?Yb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),uA=(e,t,n)=>(cA(e,t,"access private method"),n),xh,Gb;let Xc=class extends $t{constructor(){super(...arguments),lA(this,xh),this.heading=""}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>{const e=this.shadowRoot?.getElementById("popover");e?.showPopover?.(),e?.addEventListener("toggle",t=>{t.newState==="closed"&&this.dispatchEvent(new CustomEvent("modal-close"))})})}render(){return F`
      <div id="popover" popover="auto">
        <div class="header">
          <h3>${this.heading}</h3>
          <button class="close" aria-label="Close" @click=${uA(this,xh,Gb)}>${ye(sA)}</button>
        </div>
        <slot></slot>
      </div>
    `}};xh=new WeakSet;Gb=function(){this.shadowRoot?.getElementById("popover")?.hidePopover?.()};Xc.styles=Bt`
    [popover] {
      background: var(--budgee-surface);
      border-radius: 8px;
      padding: 1.5rem;
      max-width: 800px;
      width: min(90vw, 800px);
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 24px lch(0% 0 none / 0.2);
      border: none;
      margin: auto;
      position: fixed;
      inset: 0;
      height: fit-content;
    }
    [popover]::backdrop {
      background: var(--budgee-overlay);
      backdrop-filter: blur(1px);
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    h3 {
      margin: 0;
    }
    .close {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--budgee-text-muted);
      padding: 4px;
      line-height: 1;
    }
    .close:hover {
      color: var(--budgee-text);
    }
    .close svg {
      width: 20px;
      height: 20px;
    }
  `;Xb([pt({type:String})],Xc.prototype,"heading",2);Xc=Xb([Ut("budgee-modal")],Xc);const Ml=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-wrench"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z" />
</svg>
`;function hA(e,t,n){const i=n?new Set(n):void 0,r=new Map;for(const a of e)a.merchantId!==void 0&&r.set(a.merchantId,(r.get(a.merchantId)??0)+a.amount);const s=new Map;for(const a of t){if(i?.has(a.id))continue;const o=r.get(a.id);o!==void 0&&s.set(a.name,o)}return s}function dA(e,t){switch(t){case"day":return e.slice(0,10);case"month":return e.slice(0,7);case"year":return e.slice(0,4)}}function fA(e,t){const n=new Map;for(const i of e){const r=dA(i.date,t);n.set(r,(n.get(r)??0)+i.amount)}return n}function pA(e,t,n){const i=n?new Set(n):void 0,r=new Map;for(const a of e)for(const o of a.tagIds)r.set(o,(r.get(o)??0)+a.amount);const s=new Map;for(const a of t){if(i?.has(a.id))continue;const o=r.get(a.id);o!==void 0&&s.set(a.name,o)}return s}function gA(e,t){return e.filter(n=>{if(t.tagId!==void 0&&!n.tagIds.includes(t.tagId)||t.excludedTagId!==void 0&&n.tagIds.includes(t.excludedTagId)||t.merchantId!==void 0&&n.merchantId!==t.merchantId||t.excludedMerchantId!==void 0&&n.merchantId===t.excludedMerchantId||t.startDate&&n.date<t.startDate||t.endDate&&n.date>t.endDate)return!1;if(t.amountFilter){const{operator:i,value:r}=t.amountFilter;if(i==="lt"&&!(n.amount<r)||i==="gt"&&!(n.amount>r)||i==="lte"&&!(n.amount<=r)||i==="gte"&&!(n.amount>=r))return!1}if(t.descriptionFilter){const i=n.originalDescription.toLowerCase().includes(t.descriptionFilter.toLowerCase());if(t.descriptionFilterMode==="exclude"&&i||t.descriptionFilterMode==="include"&&!i)return!1}return!0})}function mA(e,t){return t<2?e.map(n=>n):e.map((n,i)=>i<t-1?null:e.slice(i-t+1,i+1).reduce((s,a)=>s+a,0)/t)}function vA(e){return Math.max(2,Math.min(12,Math.round(e*.1)))}const bA=/^(\d+)\s+(day|week|month|year)s?\s+ago$/i;function _A(e){const t=e.trim();if(!t)return;if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const n=t.match(bA);if(!n)return;const i=parseInt(n[1],10),r=n[2].toLowerCase(),s=new Date;switch(r){case"day":s.setDate(s.getDate()-i);break;case"week":s.setDate(s.getDate()-i*7);break;case"month":s.setMonth(s.getMonth()-i);break;case"year":s.setFullYear(s.getFullYear()-i);break}return s.toISOString().slice(0,10)}function bi(e,t){const n=getComputedStyle(document.documentElement).getPropertyValue(e).trim();if(t==null)return n;const i=n.match(/^lch\(([^)]+)\)$/);return i?`lch(${i[1]} / ${t})`:`color-mix(in srgb, ${n} ${Math.round(t*100)}%, transparent)`}var yA=Object.defineProperty,wA=Object.getOwnPropertyDescriptor,Qb=e=>{throw TypeError(e)},go=(e,t,n,i)=>{for(var r=i>1?void 0:i?wA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&yA(t,n,r),r},Jb=(e,t,n)=>t.has(e)||Qb("Cannot "+n),Bg=(e,t,n)=>(Jb(e,t,"read from private field"),n?n.call(e):t.get(e)),xA=(e,t,n)=>t.has(e)?Qb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Xe=(e,t,n)=>(Jb(e,t,"access private method"),n),_e,Zb,t_,e_,n_,Sh,i_,r_,s_,a_,o_,c_,Dl;function SA(e){const t={};for(const n of e)switch(n.field){case"tag":n.operator==="is"&&(t.tagId=n.value),n.operator==="isNot"&&(t.excludedTagId=n.value);break;case"merchant":n.operator==="is"&&(t.merchantId=n.value),n.operator==="isNot"&&(t.excludedMerchantId=n.value);break;case"amount":t.amountFilter={operator:n.operator,value:Number(n.value)};break;case"description":t.descriptionFilter=n.value,t.descriptionFilterMode=n.operator==="contains"?"include":"exclude";break}return t}let Or=class extends $t{constructor(){super(...arguments),xA(this,_e),this.transactions=[],this.tags=[],this.merchants=[]}render(){return F`
      <div class="resize-handle" @pointerdown=${Xe(this,_e,a_)}></div>
      <div class="resize-handle-bottom" @pointerdown=${Xe(this,_e,o_)}></div>
      <div class="resize-handle-corner" @pointerdown=${Xe(this,_e,c_)}></div>
      <div class="header">
        <h4>${this.config.title}</h4>
        <div class="actions">
          <button class="icon-btn" aria-label="Edit" @click=${Xe(this,_e,i_)}>${ye(Ml)}</button>
          <button class="icon-btn icon-btn--danger" aria-label="Delete" @click=${Xe(this,_e,r_)}>${ye(As)}</button>
        </div>
      </div>
      <chart-wrapper
        .chartType=${this.config.chartType}
        .data=${Bg(this,_e,Zb)}
        .options=${Bg(this,_e,t_)}
      ></chart-wrapper>
    `}};_e=new WeakSet;Zb=function(){const e=this.config.startDate?_A(this.config.startDate):void 0,t=this.config.filters?SA(this.config.filters):{tagId:this.config.tagId,merchantId:this.config.merchantId,amountFilter:this.config.direction==="debit"?{operator:"lt",value:0}:this.config.direction==="credit"?{operator:"gt",value:0}:void 0,descriptionFilter:this.config.descriptionFilter,descriptionFilterMode:this.config.descriptionFilterMode},n=gA(this.transactions,{...t,startDate:e}),{granularity:i}=this.config,r=i==="byTag"?pA(n,this.tags,this.config.excludedTagIds):i==="byMerchant"?hA(n,this.merchants,this.config.excludedMerchantIds):fA(n,i),s=i==="byTag"||i==="byMerchant",a=this.config.chartType==="pie"||this.config.chartType==="doughnut";let o=[...r.entries()].sort(([g],[m])=>g.localeCompare(m));a&&(o=Xe(this,_e,e_).call(this,o),o.sort(([,g],[,m])=>Math.abs(m)-Math.abs(g)));const c=o.map(([,g])=>g),l=this.config.chartType==="bar",h=l||a?c.map(Math.abs):c,u=a?Xe(this,_e,n_).call(this,o):l?c.map(g=>g<0?bi("--budgee-negative",.5):bi("--budgee-positive",.5)):bi("--budgee-primary",.5),d=a?bi("--budgee-surface"):l?c.map(g=>g<0?bi("--budgee-negative"):bi("--budgee-positive")):bi("--budgee-primary"),p=[{label:this.config.title,data:h,backgroundColor:u,borderColor:d,borderWidth:a?2:1}];if(!s&&this.config.chartType==="bar"&&h.length>=2){const g=vA(h.length);p.push({type:"line",label:`${this.config.title} (${g}-pt avg)`,data:mA(h,g),borderColor:bi("--budgee-text-muted",.5),borderWidth:1.5,pointRadius:0,fill:!1,tension:.3})}return{labels:o.map(([g])=>g),datasets:p}};t_=function(){const e=this.config.legendPosition??"top";return e==="hidden"?{plugins:{legend:{display:!1}}}:{plugins:{legend:{position:e}}}};e_=function(e){const t=e.reduce((s,[,a])=>s+Math.abs(a),0);if(t===0)return e;const n=t*.01,i=[];let r=0;for(const[s,a]of e)Math.abs(a)<n?r+=a:i.push([s,a]);return r!==0&&i.push(["Other",r]),i};n_=function(e){if(this.config.granularity==="byTag"){const t=new Map(this.tags.map(n=>[n.name,n]));return e.map(([n])=>t.get(n)?.color??Xe(this,_e,Sh).call(this,n))}return e.map(([t])=>Xe(this,_e,Sh).call(this,t))};Sh=function(e){let t=0;for(let i=0;i<e.length;i++)t=t*31+e.charCodeAt(i)|0;return`lch(55% 50 ${(t%360+360)%360})`};i_=function(){this.dispatchEvent(new CustomEvent("chart-edit",{detail:{chart:this.config}}))};r_=function(){this.dispatchEvent(new CustomEvent("chart-deleted",{detail:{id:this.config.id}}))};s_=function(e){this.dispatchEvent(new CustomEvent("chart-resized",{detail:{id:this.config.id,...e}}))};a_=function(e){Xe(this,_e,Dl).call(this,e,{horizontal:!0})};o_=function(e){Xe(this,_e,Dl).call(this,e,{vertical:!0})};c_=function(e){Xe(this,_e,Dl).call(this,e,{horizontal:!0,vertical:!0})};Dl=function(e,{horizontal:t,vertical:n}){e.preventDefault(),e.stopPropagation();const i=e.currentTarget;i.setPointerCapture(e.pointerId);const r=this.closest(".chart-grid")??this.parentElement;if(!r)return;const s=r.getBoundingClientRect(),a=getComputedStyle(r),o=t?a.gridTemplateColumns.split(" ").length:0,c=n?parseFloat(a.gridTemplateRows.split(" ")[0])||200:0,l=n&&parseFloat(a.rowGap)||0;let h=this.config.colSpan??1,u=this.config.rowSpan??1;const d=t&&n?"data-resizing-corner":t?"data-resizing":"data-resizing-vertical";this.setAttribute(d,"");const p=m=>{if(t){const w=(m.clientX-s.left)/s.width,C=Math.round(w*o),_=this.getBoundingClientRect().left-s.left,k=Math.round(_/s.width*o);h=Math.max(1,Math.min(o-k,C-k)),this.style.gridColumn=`span ${h}`}if(n){const b=this.getBoundingClientRect().top-s.top,C=m.clientY-s.top-b;u=Math.max(1,Math.round((C+l)/(c+l))),this.style.gridRow=`span ${u}`}},g=()=>{this.removeAttribute(d),i.removeEventListener("pointermove",p),i.removeEventListener("pointerup",g),Xe(this,_e,s_).call(this,{...t&&{colSpan:Math.max(1,Math.min(6,h))},...n&&{rowSpan:Math.max(1,Math.min(4,u))}})};i.addEventListener("pointermove",p),i.addEventListener("pointerup",g)};Or.styles=[$s,Bt`
      :host {
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        background: var(--budgee-surface);
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      h4 {
        margin: 0;
      }
      .actions {
        display: flex;
        gap: 0.25rem;
      }
      chart-wrapper {
        flex: 1;
        min-height: 0;
      }
      .resize-handle {
        position: absolute;
        right: 0;
        top: 0;
        width: 6px;
        height: 100%;
        cursor: col-resize;
        background: transparent;
        transition: background 0.15s;
      }
      .resize-handle:hover,
      :host([data-resizing]) .resize-handle {
        background: var(--budgee-primary);
      }
      .resize-handle-bottom {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 6px;
        cursor: row-resize;
        background: transparent;
        transition: background 0.15s;
      }
      .resize-handle-bottom:hover,
      :host([data-resizing-vertical]) .resize-handle-bottom {
        background: var(--budgee-primary);
      }
      .resize-handle-corner {
        position: absolute;
        right: 0;
        bottom: 0;
        width: 12px;
        height: 12px;
        cursor: nwse-resize;
        background: transparent;
        z-index: 1;
      }
      .resize-handle-corner:hover,
      :host([data-resizing-corner]) .resize-handle-corner {
        background: var(--budgee-primary);
      }
    `];go([pt({type:Object})],Or.prototype,"config",2);go([pt({type:Array})],Or.prototype,"transactions",2);go([pt({type:Array})],Or.prototype,"tags",2);go([pt({type:Array})],Or.prototype,"merchants",2);Or=go([Ut("dashboard-chart-card")],Or);var CA=Object.defineProperty,kA=Object.getOwnPropertyDescriptor,l_=e=>{throw TypeError(e)},Xi=(e,t,n,i)=>{for(var r=i>1?void 0:i?kA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&CA(t,n,r),r},EA=(e,t,n)=>t.has(e)||l_("Cannot "+n),MA=(e,t,n)=>t.has(e)?l_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),At=(e,t,n)=>(EA(e,t,"access private method"),n),Dt,u_,h_,d_,f_,p_,g_,Il,Rl,m_,v_,b_,Tl,Pl,__,y_,w_,x_,S_,C_,k_,E_,M_;let Ln=class extends $t{constructor(){super(...arguments),MA(this,Dt),this.transactions=[],this.tags=[],this.merchants=[],this.accounts=[],this._page=1,this._pageSize=10}render(){return F`
      <div class="resize-handle" @pointerdown=${At(this,Dt,f_)}></div>
      <div class="resize-handle-bottom" @pointerdown=${At(this,Dt,p_)}></div>
      <div class="resize-handle-corner" @pointerdown=${At(this,Dt,g_)}></div>
      <div class="header">
        <h4>${this.config.title}</h4>
        <div class="actions">
          <button class="icon-btn" aria-label="Edit" @click=${At(this,Dt,u_)}>${ye(Ml)}</button>
          <button class="icon-btn icon-btn--danger" aria-label="Delete" @click=${At(this,Dt,h_)}>${ye(As)}</button>
        </div>
      </div>
      ${At(this,Dt,M_).call(this)}
    `}};Dt=new WeakSet;u_=function(){this.dispatchEvent(new CustomEvent("table-edit",{detail:{table:this.config}}))};h_=function(){this.dispatchEvent(new CustomEvent("table-deleted",{detail:{id:this.config.id}}))};d_=function(e){this.dispatchEvent(new CustomEvent("table-resized",{detail:{id:this.config.id,...e}}))};f_=function(e){At(this,Dt,Il).call(this,e,{horizontal:!0})};p_=function(e){At(this,Dt,Il).call(this,e,{vertical:!0})};g_=function(e){At(this,Dt,Il).call(this,e,{horizontal:!0,vertical:!0})};Il=function(e,{horizontal:t,vertical:n}){e.preventDefault(),e.stopPropagation();const i=e.currentTarget;i.setPointerCapture(e.pointerId);const r=this.closest(".table-grid")??this.parentElement;if(!r)return;const s=r.getBoundingClientRect(),a=getComputedStyle(r),o=t?a.gridTemplateColumns.split(" ").length:0,c=n?parseFloat(a.gridTemplateRows.split(" ")[0])||200:0,l=n&&parseFloat(a.rowGap)||0;let h=this.config.colSpan??1,u=this.config.rowSpan??1;const d=t&&n?"data-resizing-corner":t?"data-resizing":"data-resizing-vertical";this.setAttribute(d,"");const p=m=>{if(t){const w=(m.clientX-s.left)/s.width,C=Math.round(w*o),_=this.getBoundingClientRect().left-s.left,k=Math.round(_/s.width*o);h=Math.max(1,Math.min(o-k,C-k)),this.style.gridColumn=`span ${h}`}if(n){const b=this.getBoundingClientRect().top-s.top,C=m.clientY-s.top-b;u=Math.max(1,Math.round((C+l)/(c+l))),this.style.gridRow=`span ${u}`}},g=()=>{this.removeAttribute(d),i.removeEventListener("pointermove",p),i.removeEventListener("pointerup",g),At(this,Dt,d_).call(this,{...t&&{colSpan:Math.max(1,Math.min(6,h))},...n&&{rowSpan:Math.max(1,Math.min(4,u))}})};i.addEventListener("pointermove",p),i.addEventListener("pointerup",g)};Rl=function(e){this._page=e.detail.page,this._pageSize=e.detail.pageSize};m_=function(e){return e?this.merchants.find(t=>t.id===e)?.name??"":""};v_=function(e){return e?this.accounts.find(t=>t.id===e)?.name??"":""};b_=function(e){return e.map(t=>this.tags.find(n=>n.id===t)?.name??`#${t}`).join(", ")};Tl=function(e){return{date:"Date",amount:"Amount",description:"Description",merchant:"Merchant",tags:"Tags",account:"Account",name:"Name",transactionCount:"Transactions",totalAmount:"Total Amount"}[e]};Pl=function(e){return e==="amount"||e==="totalAmount"};__=function(){const e=[...this.transactions].sort((r,s)=>s.date.localeCompare(r.date)),t=(this._page-1)*this._pageSize,n=e.slice(t,t+this._pageSize),i=this.config.columns;return F`
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${10}
        storageKey="dashboard-table-${this.config.id}"
        @page-change=${At(this,Dt,Rl)}
      >
        <table>
          <thead>
            <tr>
              ${i.map(r=>F`
                <th class=${At(this,Dt,Pl).call(this,r)?"col-amount":""}>${At(this,Dt,Tl).call(this,r)}</th>
              `)}
            </tr>
          </thead>
          <tbody>
            ${n.map(r=>F`
              <tr>
                ${i.map(s=>At(this,Dt,y_).call(this,r,s))}
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `};y_=function(e,t){switch(t){case"date":return F`<td>${e.date}</td>`;case"amount":return F`<td class="col-amount ${e.amount<0?"amount-negative":"amount-positive"}">${e.amount.toFixed(2)}</td>`;case"description":return F`<td>${e.originalDescription}</td>`;case"merchant":return F`<td>${At(this,Dt,m_).call(this,e.merchantId)}</td>`;case"tags":return F`<td>${At(this,Dt,b_).call(this,e.tagIds)}</td>`;case"account":return F`<td>${At(this,Dt,v_).call(this,e.accountId)}</td>`;default:return F`
          <td></td>
        `}};w_=function(){const e=new Map,t=new Map;for(const n of this.transactions)n.merchantId!=null&&(e.set(n.merchantId,(e.get(n.merchantId)??0)+1),t.set(n.merchantId,(t.get(n.merchantId)??0)+n.amount));return this.merchants.map(n=>({merchant:n,transactionCount:e.get(n.id)??0,totalAmount:t.get(n.id)??0}))};x_=function(){const e=At(this,Dt,w_).call(this),t=(this._page-1)*this._pageSize,n=e.slice(t,t+this._pageSize),i=this.config.columns;return F`
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${10}
        storageKey="dashboard-table-${this.config.id}"
        @page-change=${At(this,Dt,Rl)}
      >
        <table>
          <thead>
            <tr>
              ${i.map(r=>F`
                <th class=${At(this,Dt,Pl).call(this,r)?"col-amount":""}>${At(this,Dt,Tl).call(this,r)}</th>
              `)}
            </tr>
          </thead>
          <tbody>
            ${n.map(r=>F`
              <tr>
                ${i.map(s=>At(this,Dt,S_).call(this,r,s))}
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `};S_=function(e,t){switch(t){case"name":return F`<td>${e.merchant.name}</td>`;case"transactionCount":return F`<td>${e.transactionCount}</td>`;case"totalAmount":return F`<td class="col-amount ${e.totalAmount<0?"amount-negative":"amount-positive"}">${e.totalAmount.toFixed(2)}</td>`;default:return F`
          <td></td>
        `}};C_=function(){const e=new Map,t=new Map;for(const n of this.transactions)for(const i of n.tagIds)e.set(i,(e.get(i)??0)+1),t.set(i,(t.get(i)??0)+n.amount);return this.tags.map(n=>({tag:n,transactionCount:e.get(n.id)??0,totalAmount:t.get(n.id)??0}))};k_=function(){const e=At(this,Dt,C_).call(this),t=(this._page-1)*this._pageSize,n=e.slice(t,t+this._pageSize),i=this.config.columns;return F`
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${10}
        storageKey="dashboard-table-${this.config.id}"
        @page-change=${At(this,Dt,Rl)}
      >
        <table>
          <thead>
            <tr>
              ${i.map(r=>F`
                <th class=${At(this,Dt,Pl).call(this,r)?"col-amount":""}>${At(this,Dt,Tl).call(this,r)}</th>
              `)}
            </tr>
          </thead>
          <tbody>
            ${n.map(r=>F`
              <tr>
                ${i.map(s=>At(this,Dt,E_).call(this,r,s))}
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `};E_=function(e,t){switch(t){case"name":return F`<td>${e.tag.name}</td>`;case"transactionCount":return F`<td>${e.transactionCount}</td>`;case"totalAmount":return F`<td class="col-amount ${e.totalAmount<0?"amount-negative":"amount-positive"}">${e.totalAmount.toFixed(2)}</td>`;default:return F`
          <td></td>
        `}};M_=function(){switch(this.config.model){case"transactions":return At(this,Dt,__).call(this);case"merchants":return At(this,Dt,x_).call(this);case"tags":return At(this,Dt,k_).call(this);default:return gt}};Ln.styles=[fi,$s,Bt`
      :host {
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        background: var(--budgee-surface);
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      h4 {
        margin: 0;
      }
      .actions {
        display: flex;
        gap: 0.25rem;
      }
      .resize-handle {
        position: absolute;
        right: 0;
        top: 0;
        width: 6px;
        height: 100%;
        cursor: col-resize;
        background: transparent;
        transition: background 0.15s;
      }
      .resize-handle:hover,
      :host([data-resizing]) .resize-handle {
        background: var(--budgee-primary);
      }
      .resize-handle-bottom {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 6px;
        cursor: row-resize;
        background: transparent;
        transition: background 0.15s;
      }
      .resize-handle-bottom:hover,
      :host([data-resizing-vertical]) .resize-handle-bottom {
        background: var(--budgee-primary);
      }
      .resize-handle-corner {
        position: absolute;
        right: 0;
        bottom: 0;
        width: 12px;
        height: 12px;
        cursor: nwse-resize;
        background: transparent;
        z-index: 1;
      }
      .resize-handle-corner:hover,
      :host([data-resizing-corner]) .resize-handle-corner {
        background: var(--budgee-primary);
      }
    `];Xi([pt({type:Object})],Ln.prototype,"config",2);Xi([pt({type:Array})],Ln.prototype,"transactions",2);Xi([pt({type:Array})],Ln.prototype,"tags",2);Xi([pt({type:Array})],Ln.prototype,"merchants",2);Xi([pt({type:Array})],Ln.prototype,"accounts",2);Xi([W()],Ln.prototype,"_page",2);Xi([W()],Ln.prototype,"_pageSize",2);Ln=Xi([Ut("dashboard-table-card")],Ln);var DA=Object.defineProperty,IA=Object.getOwnPropertyDescriptor,D_=e=>{throw TypeError(e)},Gi=(e,t,n,i)=>{for(var r=i>1?void 0:i?IA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&DA(t,n,r),r},RA=(e,t,n)=>t.has(e)||D_("Cannot "+n),TA=(e,t,n)=>t.has(e)?D_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Du=(e,t,n)=>(RA(e,t,"access private method"),n),oa,I_,R_,T_;const Ld={transactions:[{id:"date",label:"Date"},{id:"amount",label:"Amount"},{id:"description",label:"Description"},{id:"merchant",label:"Merchant"},{id:"tags",label:"Tags"},{id:"account",label:"Account"}],merchants:[{id:"name",label:"Name"},{id:"transactionCount",label:"Transaction Count"},{id:"totalAmount",label:"Total Amount"}],tags:[{id:"name",label:"Name"},{id:"transactionCount",label:"Transaction Count"},{id:"totalAmount",label:"Total Amount"}]};function P_(e){return Ld[e].map(t=>t.id)}let Nn=class extends $t{constructor(){super(...arguments),TA(this,oa),this._title="",this._model="transactions",this._columns=P_("transactions"),this._colSpan=1,this._rowSpan=1,this._initialized=!1}updated(e){e.has("editingTable")&&this.editingTable&&!this._initialized&&(this._title=this.editingTable.title,this._model=this.editingTable.model,this._columns=[...this.editingTable.columns],this._colSpan=this.editingTable.colSpan??1,this._rowSpan=this.editingTable.rowSpan??1,this._initialized=!0)}render(){const e=Ld[this._model];return F`
      <h4>${this.editingTable?"Edit Table":"Add Table"}</h4>
      <div class="form-grid">
        <label>Title:</label>
        <input
          type="text"
          .value=${this._title}
          @input=${t=>{this._title=t.target.value}}
        />
        <label>Model:</label>
        <select @change=${t=>{Du(this,oa,I_).call(this,t.target.value)}}>
          <option value="transactions" ?selected=${this._model==="transactions"}>Transactions</option>
          <option value="merchants" ?selected=${this._model==="merchants"}>Merchants</option>
          <option value="tags" ?selected=${this._model==="tags"}>Tags</option>
        </select>
        <label>Width:</label>
        <select @change=${t=>{this._colSpan=Number(t.target.value)}}>
          <option value="1" ?selected=${this._colSpan===1}>1 col</option>
          <option value="2" ?selected=${this._colSpan===2}>2 col</option>
          <option value="3" ?selected=${this._colSpan===3}>3 col</option>
          <option value="4" ?selected=${this._colSpan===4}>4 col</option>
          <option value="5" ?selected=${this._colSpan===5}>5 col</option>
          <option value="6" ?selected=${this._colSpan===6}>6 col</option>
        </select>
        <label>Height:</label>
        <select @change=${t=>{this._rowSpan=Number(t.target.value)}}>
          <option value="1" ?selected=${this._rowSpan===1}>1 row</option>
          <option value="2" ?selected=${this._rowSpan===2}>2 rows</option>
          <option value="3" ?selected=${this._rowSpan===3}>3 rows</option>
          <option value="4" ?selected=${this._rowSpan===4}>4 rows</option>
        </select>
      </div>
      <label>Columns:</label>
      <div class="checkbox-list">
        ${e.map(t=>F`
          <label>
            <input
              type="checkbox"
              ?checked=${this._columns.includes(t.id)}
              @change=${n=>Du(this,oa,R_).call(this,t.id,n.target.checked)}
            />
            ${t.label}
          </label>
        `)}
      </div>
      <button @click=${Du(this,oa,T_)}>${this.editingTable?"Update Table":"Save to Dashboard"}</button>
    `}};oa=new WeakSet;I_=function(e){this._model=e,this._columns=P_(e)};R_=function(e,t){if(t){const n=Ld[this._model].map(i=>i.id);this._columns=n.filter(i=>this._columns.includes(i)||i===e)}else this._columns=this._columns.filter(n=>n!==e)};T_=function(){const e=this._title.trim();!e||this._columns.length===0||(this.dispatchEvent(new CustomEvent("table-saved",{detail:{id:this.editingTable?.id,title:e,model:this._model,columns:this._columns,colSpan:this._colSpan,rowSpan:this._rowSpan}})),this._title="",this._initialized=!1)};Nn.styles=Bt`
    :host {
      display: block;
      border: 1px solid var(--budgee-border);
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
      background: var(--budgee-surface);
    }
    h4 {
      margin-top: 0;
    }
    .form-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.5rem;
      align-items: center;
      max-width: 400px;
      margin-bottom: 1rem;
    }
    input,
    select {
      padding: 4px 8px;
    }
    button {
      padding: 4px 12px;
      cursor: pointer;
      background-color: var(--budgee-primary);
      color: white;
      border: none;
      border-radius: 4px;
      margin-right: 0.5rem;
    }
    button:hover {
      background-color: var(--budgee-primary-hover);
    }
    .checkbox-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem 1rem;
      margin-bottom: 1rem;
    }
    .checkbox-list label {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.9rem;
    }
  `;Gi([pt({type:Object})],Nn.prototype,"editingTable",2);Gi([W()],Nn.prototype,"_title",2);Gi([W()],Nn.prototype,"_model",2);Gi([W()],Nn.prototype,"_columns",2);Gi([W()],Nn.prototype,"_colSpan",2);Gi([W()],Nn.prototype,"_rowSpan",2);Gi([W()],Nn.prototype,"_initialized",2);Nn=Gi([Ut("table-configurator")],Nn);var PA=Object.defineProperty,OA=Object.getOwnPropertyDescriptor,O_=e=>{throw TypeError(e)},Sn=(e,t,n,i)=>{for(var r=i>1?void 0:i?OA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&PA(t,n,r),r},AA=(e,t,n)=>t.has(e)||O_("Cannot "+n),$A=(e,t,n)=>t.has(e)?O_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ue=(e,t,n)=>(AA(e,t,"access private method"),n),ne,mi,Ch,A_,$_,L_,N_,F_,B_,j_,z_,W_;let Ze=class extends $t{constructor(){super(...arguments),$A(this,ne),this._transactions=null,this._tags=[],this._merchants=[],this._accounts=[],this._charts=[],this._tables=[],this._showChartConfigurator=!1,this._showTableConfigurator=!1}connectedCallback(){super.connectedCallback(),ue(this,ne,mi).call(this)}disconnectedCallback(){super.disconnectedCallback(),this._chartSortable?.destroy(),this._tableSortable?.destroy()}updated(){ue(this,ne,Ch).call(this,".chart-grid","chart",e=>{this._chartSortable=e}),ue(this,ne,Ch).call(this,".table-grid","table",e=>{this._tableSortable=e})}render(){return this._transactions===null?F`
        <h3>Dashboard</h3>
        <p>Loading</p>
      `:this._transactions.length===0?F`
        <h3>Dashboard</h3>
        <p>No transactions to display.</p>
      `:F`
      <h3>Dashboard</h3>

      ${this._charts.length>0?F`
            <div class="chart-grid">
              ${this._charts.map(e=>F`
                <dashboard-chart-card
                  data-chart-id=${e.id}
                  style="grid-column: span ${e.colSpan??1}; grid-row: span ${e.rowSpan??1}"
                  .config=${e}
                  .transactions=${this._transactions}
                  .tags=${this._tags}
                  .merchants=${this._merchants}
                  @chart-edit=${ue(this,ne,L_)}
                  @chart-resized=${ue(this,ne,N_)}
                  @chart-deleted=${ue(this,ne,F_)}
                ></dashboard-chart-card>
              `)}
            </div>
          `:gt}

      ${this._tables.length>0?F`
            <div class="table-grid">
              ${this._tables.map(e=>F`
                <dashboard-table-card
                  data-table-id=${e.id}
                  style="grid-column: span ${e.colSpan??1}; grid-row: span ${e.rowSpan??1}"
                  .config=${e}
                  .transactions=${this._transactions}
                  .tags=${this._tags}
                  .merchants=${this._merchants}
                  .accounts=${this._accounts}
                  @table-edit=${ue(this,ne,j_)}
                  @table-resized=${ue(this,ne,z_)}
                  @table-deleted=${ue(this,ne,W_)}
                ></dashboard-table-card>
              `)}
            </div>
          `:gt}

      <div class="button-bar">
        <button @click=${()=>{this._showChartConfigurator=!0,this._editingChart=void 0}}>
          Add Chart
        </button>
        <button @click=${()=>{this._showTableConfigurator=!0,this._editingTable=void 0}}>
          Add Table
        </button>
      </div>

      ${this._showChartConfigurator?F`
            <budgee-modal
              heading=${this._editingChart?"Edit Chart":"Add Chart"}
              @modal-close=${()=>{this._showChartConfigurator=!1,this._editingChart=void 0}}
            >
              <chart-configurator
                .transactions=${this._transactions}
                .tags=${this._tags}
                .merchants=${this._merchants}
                .editingChart=${this._editingChart}
                @chart-saved=${ue(this,ne,$_)}
              ></chart-configurator>
            </budgee-modal>
          `:gt}

      ${this._showTableConfigurator?F`
            <budgee-modal
              heading=${this._editingTable?"Edit Table":"Add Table"}
              @modal-close=${()=>{this._showTableConfigurator=!1,this._editingTable=void 0}}
            >
              <table-configurator
                .editingTable=${this._editingTable}
                @table-saved=${ue(this,ne,B_)}
              ></table-configurator>
            </budgee-modal>
          `:gt}
    `}};ne=new WeakSet;mi=async function(){this._transactions=await An.all(),this._tags=await hn.all(),this._merchants=await oi.all(),this._accounts=await xs.all(),this._charts=await Ni.all(),this._tables=await ks.all(),this._charts.length===0&&(await Ni.create({title:"Monthly Overview",chartType:"bar",granularity:"month",colSpan:6,position:0}),this._charts=await Ni.all())};Ch=function(e,t,n){const i=t==="chart"?this._chartSortable:this._tableSortable,r=this.shadowRoot?.querySelector(e);if(!r){i?.destroy(),n(void 0);return}i?.el!==r&&(i?.destroy(),n(ot.create(r,{animation:150,onEnd:()=>ue(this,ne,A_).call(this,t)})))};A_=async function(e){const t=e==="chart"?".chart-grid":".table-grid",n=e==="chart"?"data-chart-id":"data-table-id",i=this.shadowRoot?.querySelector(t);if(!i)return;const r=i.querySelectorAll(`[${n}]`),s=[];r.forEach(a=>{const o=a.getAttribute(n);o&&s.push(o)}),e==="chart"?await Ni.reorder(s):await ks.reorder(s),await ue(this,ne,mi).call(this)};$_=async function(e){const t=e.detail;t.id?await Ni.update(t.id,{title:t.title,chartType:t.chartType,granularity:t.granularity,startDate:t.startDate,excludedTagIds:t.excludedTagIds,excludedMerchantIds:t.excludedMerchantIds,legendPosition:t.legendPosition,filters:t.filters}):await Ni.create({...t,colSpan:6,position:this._charts.length}),this._showChartConfigurator=!1,this._editingChart=void 0,await ue(this,ne,mi).call(this)};L_=function(e){this._editingChart=e.detail.chart,this._showChartConfigurator=!0};N_=async function(e){const{id:t,colSpan:n,rowSpan:i}=e.detail;await Ni.update(t,{...n!==void 0&&{colSpan:n},...i!==void 0&&{rowSpan:i}}),await ue(this,ne,mi).call(this)};F_=async function(e){await Ni.remove(e.detail.id),await ue(this,ne,mi).call(this)};B_=async function(e){const t=e.detail;t.id?await ks.update(t.id,{title:t.title,model:t.model,columns:t.columns,colSpan:t.colSpan,rowSpan:t.rowSpan}):await ks.create({...t,position:this._tables.length}),this._showTableConfigurator=!1,this._editingTable=void 0,await ue(this,ne,mi).call(this)};j_=function(e){this._editingTable=e.detail.table,this._showTableConfigurator=!0};z_=async function(e){const{id:t,colSpan:n,rowSpan:i}=e.detail;await ks.update(t,{...n!==void 0&&{colSpan:n},...i!==void 0&&{rowSpan:i}}),await ue(this,ne,mi).call(this)};W_=async function(e){await ks.remove(e.detail.id),await ue(this,ne,mi).call(this)};Ze.styles=[fi,Bt`
      :host {
        display: block;
      }
      .card {
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
        background: var(--budgee-surface);
      }
      .card h3 {
        margin-top: 0;
      }
      .chart-grid {
        display: grid;
        grid-template-columns: 1fr;
        grid-auto-rows: 200px;
        gap: 1rem;
        margin-bottom: 1rem;
      }
      @media (min-width: 700px) {
        .chart-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      @media (min-width: 1200px) {
        .chart-grid {
          grid-template-columns: repeat(6, 1fr);
        }
      }
      .table-grid {
        display: grid;
        grid-template-columns: 1fr;
        grid-auto-rows: 200px;
        gap: 1rem;
        margin-bottom: 1rem;
      }
      @media (min-width: 700px) {
        .table-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      @media (min-width: 1200px) {
        .table-grid {
          grid-template-columns: repeat(6, 1fr);
        }
      }
      button {
        padding: 0.5rem 1rem;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
        margin-bottom: 1rem;
      }
      button:hover {
        background-color: var(--budgee-primary-hover);
      }
      .button-bar {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }
    `];Sn([W()],Ze.prototype,"_transactions",2);Sn([W()],Ze.prototype,"_tags",2);Sn([W()],Ze.prototype,"_merchants",2);Sn([W()],Ze.prototype,"_accounts",2);Sn([W()],Ze.prototype,"_charts",2);Sn([W()],Ze.prototype,"_tables",2);Sn([W()],Ze.prototype,"_showChartConfigurator",2);Sn([W()],Ze.prototype,"_editingChart",2);Sn([W()],Ze.prototype,"_showTableConfigurator",2);Sn([W()],Ze.prototype,"_editingTable",2);Ze=Sn([Ut("budgee-dashboard")],Ze);async function LA(){const e=await ht(),t={version:_r,transactions:await e.transactions.all(),tags:await e.tags.all(),merchants:await e.merchants.all(),accounts:await e.accounts.all(),merchantRules:await e.merchantRules.all(),dashboardCharts:await e.dashboardCharts.all(),dashboardTables:await e.dashboardTables.all()},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=`budgee-export-${new Date().toISOString().slice(0,10)}.json`,r.click(),URL.revokeObjectURL(i)}const Ls=Bt`
  :host([busy]) {
    pointer-events: none;
    cursor: wait;
    opacity: 0.6;
  }
`;function Ns(e){class t extends e{constructor(){super(...arguments),this._busy=!1}async withBusy(i){this._busy=!0,this.toggleAttribute("busy",!0),this.requestUpdate();try{return await i()}finally{this._busy=!1,this.toggleAttribute("busy",!1),this.requestUpdate()}}get busy(){return this._busy}}return t}var NA=Object.getOwnPropertyDescriptor,H_=e=>{throw TypeError(e)},FA=(e,t,n,i)=>{for(var r=i>1?void 0:i?NA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=a(r)||r);return r},BA=(e,t,n)=>t.has(e)||H_("Cannot "+n),jA=(e,t,n)=>t.has(e)?H_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),zA=(e,t,n)=>(BA(e,t,"access private method"),n),kh,U_;let Eh=class extends Ns($t){constructor(){super(...arguments),jA(this,kh)}render(){return F`
      <h2>Import Database</h2>
      <p>Restore from a full JSON backup. This will replace all existing data.</p>
      <input type="file" accept=".json" @change=${zA(this,kh,U_)} />

      <h2>Export Database</h2>
      <p>Download a full backup of your data as JSON.</p>
      <button @click=${LA}>Export</button>
    `}};kh=new WeakSet;U_=async function(e){const t=e.target;if(t.files?.length){if(!confirm("This will replace all existing data. Are you sure?")){t.value="";return}await this.withBusy(async()=>{dd("Importing database...");try{await Kv(t.files[0]),t.value="",window.location.reload()}finally{fd()}})}};Eh.styles=[Ls,Bt`
      :host {
        display: block;
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
        background: var(--budgee-surface);
      }
      button {
        padding: 0.5rem 1rem;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: var(--budgee-primary-hover);
      }
    `];Eh=FA([Ut("database-manager")],Eh);var WA=Object.defineProperty,HA=Object.getOwnPropertyDescriptor,V_=e=>{throw TypeError(e)},Hr=(e,t,n,i)=>{for(var r=i>1?void 0:i?HA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&WA(t,n,r),r},UA=(e,t,n)=>t.has(e)||V_("Cannot "+n),VA=(e,t,n)=>t.has(e)?V_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ue=(e,t,n)=>(UA(e,t,"access private method"),n),Te,q_,K_,Y_,X_,G_,rc,sc,Q_,J_;let ci=class extends $t{constructor(){super(...arguments),VA(this,Te),this._rows=null,this._currentPage=1,this._pageSize=25,this._filter="",this._sortCol="name",this._sortDir="asc"}connectedCallback(){super.connectedCallback(),Ue(this,Te,q_).call(this)}render(){if(this._rows===null)return F`
        <p>Loading</p>
      `;if(this._rows.length===0)return F`
        <p>No merchants found.</p>
      `;const e=this._rows.filter(r=>Ue(this,Te,G_).call(this,r)),t=Ue(this,Te,Q_).call(this,e),n=(this._currentPage-1)*this._pageSize,i=t.slice(n,n+this._pageSize);return F`
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${25}
        storageKey="merchants"
        ?filterable=${!0}
        @page-change=${Ue(this,Te,Y_)}
        @filter-change=${Ue(this,Te,X_)}
      >
        <table>
          <thead>
            <tr>
              <th class="sortable" @click=${()=>Ue(this,Te,rc).call(this,"name")}>
                Name${Ue(this,Te,sc).call(this,"name")}
              </th>
              <th class="sortable" @click=${()=>Ue(this,Te,rc).call(this,"count")}>
                Transactions${Ue(this,Te,sc).call(this,"count")}
              </th>
              <th class="sortable col-amount" @click=${()=>Ue(this,Te,rc).call(this,"spend")}>
                Total Spend${Ue(this,Te,sc).call(this,"spend")}
              </th>
            </tr>
          </thead>
          <tbody>
            ${i.map(r=>F`
              <tr @click=${()=>Ue(this,Te,J_).call(this,r.merchant.id)}>
                <td>${r.merchant.name}</td>
                <td>${r.transactionCount??""}</td>
                <td class="col-amount ${r.totalSpend!=null&&r.totalSpend<0?"amount-negative":"amount-positive"}">
                  ${r.totalSpend!=null?r.totalSpend.toFixed(2):""}
                </td>
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `}};Te=new WeakSet;q_=async function(){const e=await oi.all();this._rows=e.map(t=>({merchant:t,transactionCount:null,totalSpend:null})),Ue(this,Te,K_).call(this)};K_=async function(){const e=await An.all(),t=new Map,n=new Map;for(const i of e)i.merchantId!=null&&(t.set(i.merchantId,(t.get(i.merchantId)??0)+1),n.set(i.merchantId,(n.get(i.merchantId)??0)+i.amount));this._rows=this._rows.map(i=>({...i,transactionCount:t.get(i.merchant.id)??0,totalSpend:n.get(i.merchant.id)??0}))};Y_=function(e){this._currentPage=e.detail.page,this._pageSize=e.detail.pageSize};X_=function(e){this._filter=e.detail.filter,this._currentPage=1};G_=function(e){if(!this._filter)return!0;const t=this._filter.toLowerCase();return!!(e.merchant.name.toLowerCase().includes(t)||e.transactionCount!=null&&String(e.transactionCount).includes(t)||e.totalSpend!=null&&e.totalSpend.toFixed(2).includes(t))};rc=function(e){this._sortCol===e?this._sortDir=this._sortDir==="asc"?"desc":"asc":(this._sortCol=e,this._sortDir="asc"),this._currentPage=1};sc=function(e){return this._sortCol!==e?"":this._sortDir==="asc"?" ":" "};Q_=function(e){const t=this._sortCol,n=this._sortDir==="asc"?1:-1;return[...e].sort((i,r)=>{let s=0;return t==="name"?s=i.merchant.name.localeCompare(r.merchant.name):t==="count"?s=(i.transactionCount??0)-(r.transactionCount??0):t==="spend"&&(s=(i.totalSpend??0)-(r.totalSpend??0)),s*n})};J_=function(e){window.history.pushState({},"",`/merchants/${e}`),window.dispatchEvent(new PopStateEvent("popstate"))};ci.styles=[fi,Bt`
      tbody tr {
        cursor: pointer;
      }
    `];Hr([W()],ci.prototype,"_rows",2);Hr([W()],ci.prototype,"_currentPage",2);Hr([W()],ci.prototype,"_pageSize",2);Hr([W()],ci.prototype,"_filter",2);Hr([W()],ci.prototype,"_sortCol",2);Hr([W()],ci.prototype,"_sortDir",2);ci=Hr([Ut("merchant-list")],ci);function qA(e,t){const n=t.value.toLowerCase();switch(t.operator){case"contains":return e.includes(n);case"startsWith":return e.startsWith(n);case"equals":return e===n;case"regex":return new RegExp(t.value,"i").test(e)}}function Nd(e,t){const n=t.logic==="and"?"every":"some";return t.conditions[n](i=>qA(e,i))}class Gn{constructor(){}static async all(){return(await ht()).merchantRules.all()}static async create(t){const n=await ht(),i=Pe();return await n.merchantRules.put({...t,id:i}),i}static async put(t){const n=await ht();t.id?await n.merchantRules.put(t):await n.merchantRules.put({...t,id:Pe()})}static async update(t,n){const i=await ht(),r=await i.merchantRules.get(t);await i.merchantRules.put({...r,...n})}static async remove(t){await(await ht()).merchantRules.remove(t)}static async applyToTransactions(t){const n=await ht(),i=await n.transactions.all(),r=[];for(const s of i){const a=s.originalDescription.toLowerCase();Nd(a,t)&&r.push({...s,merchantId:t.merchantId??s.merchantId,tagIds:[...new Set([...s.tagIds,...t.tagIds])]})}return r.length>0&&await n.transactions.bulkDocs(r),r.length}}const KA=/^(SQ \*|TST\* |SP \*?|PAYPAL \*)/i,YA=/,\s*\w{2}$/,XA=e=>e.replace(KA,"").trim().replace(YA,"").trim().toLocaleLowerCase().split(" ").map(n=>n.charAt(0).toLocaleUpperCase()+n.slice(1)).join(" ");var GA=Object.defineProperty,QA=Object.getOwnPropertyDescriptor,Z_=e=>{throw TypeError(e)},mo=(e,t,n,i)=>{for(var r=i>1?void 0:i?QA(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&GA(t,n,r),r},ty=(e,t,n)=>t.has(e)||Z_("Cannot "+n),Mh=(e,t,n)=>(ty(e,t,"read from private field"),n?n.call(e):t.get(e)),JA=(e,t,n)=>t.has(e)?Z_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),dr=(e,t,n)=>(ty(e,t,"access private method"),n),cn,Fd,ey,ny,iy,ry,sy,Bd,ay;let Ar=class extends $t{constructor(){super(...arguments),JA(this,cn),this.merchants=[],this.value="",this._highlightIndex=-1,this._open=!1}render(){const e=Mh(this,cn,Fd),t=Mh(this,cn,ay),n=this._open&&e.length>0&&!t,i=this.value.trim();return F`
      <div class="input-wrapper">
        <input
          type="text"
          placeholder="Merchant name (optional)"
          .value=${this.value}
          @input=${dr(this,cn,ey)}
          @paste=${dr(this,cn,ny)}
          @keydown=${dr(this,cn,iy)}
          @focus=${dr(this,cn,ry)}
          @blur=${dr(this,cn,sy)}
        />
        ${i?t?F`
                  <span class="status existing">existing</span>
                `:F`
                  <span class="status new">new</span>
                `:gt}
      </div>
      ${n?F`
          <div class="suggestions">
            ${e.map((r,s)=>F`
              <div
                class="suggestion ${s===this._highlightIndex?"highlighted":""}"
                @click=${()=>dr(this,cn,Bd).call(this,r)}
              >
                ${r.name}
              </div>
            `)}
          </div>
        `:gt}
    `}};cn=new WeakSet;Fd=function(){const e=this.value.toLowerCase().trim();return e?this.merchants.filter(t=>t.name.toLowerCase().includes(e)):[]};ey=function(e){const t=e.target.value;this.dispatchEvent(new CustomEvent("merchant-changed",{detail:{name:t}})),this._highlightIndex=-1,this._open=t.trim().length>0};ny=function(e){e.preventDefault();const n=(e.clipboardData?.getData("text")??"").toLowerCase().replace(/(?:^|\s)\S/g,r=>r.toUpperCase()),i=e.target;i.value=n,this.dispatchEvent(new CustomEvent("merchant-changed",{detail:{name:n}})),this._highlightIndex=-1,this._open=n.trim().length>0};iy=function(e){const t=Mh(this,cn,Fd);e.key==="ArrowDown"?(e.preventDefault(),this._highlightIndex=Math.min(this._highlightIndex+1,t.length-1)):e.key==="ArrowUp"?(e.preventDefault(),this._highlightIndex=Math.max(this._highlightIndex-1,-1)):e.key==="Enter"&&this._highlightIndex>=0&&this._highlightIndex<t.length?(e.preventDefault(),dr(this,cn,Bd).call(this,t[this._highlightIndex])):e.key==="Escape"&&(this._open=!1)};ry=function(){this.value.trim().length>0&&(this._open=!0)};sy=function(){setTimeout(()=>{this._open=!1},150)};Bd=function(e){this.dispatchEvent(new CustomEvent("merchant-changed",{detail:{name:e.name}})),this._open=!1,this._highlightIndex=-1};ay=function(){const e=this.value.trim().toLowerCase();return e.length>0&&this.merchants.some(t=>t.name.toLowerCase()===e)};Ar.styles=Bt`
    :host {
      display: inline-block;
      position: relative;
    }
    .input-wrapper {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    input {
      padding: 4px 8px;
    }
    .status {
      font-size: 0.75rem;
      white-space: nowrap;
    }
    .status.existing {
      color: var(--budgee-success);
    }
    .status.new {
      color: var(--budgee-text-muted);
      font-style: italic;
    }
    .suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--budgee-surface);
      border: 1px solid var(--budgee-border);
      border-radius: 0 0 4px 4px;
      max-height: 150px;
      overflow-y: auto;
      z-index: 10;
      min-width: 180px;
    }
    .suggestion {
      padding: 4px 6px;
      cursor: pointer;
      font-size: 0.85rem;
    }
    .suggestion:hover,
    .suggestion.highlighted {
      background: var(--budgee-bg);
    }
  `;mo([pt({type:Array})],Ar.prototype,"merchants",2);mo([pt({type:String})],Ar.prototype,"value",2);mo([W()],Ar.prototype,"_highlightIndex",2);mo([W()],Ar.prototype,"_open",2);Ar=mo([Ut("merchant-autocomplete")],Ar);function oy(e){if(e.startsWith("#"))return ZA(e);const t=t$(e);if(t)return t;const n=e.match(/hsl\(\s*(\d+),\s*(\d+)%,\s*(\d+)%\s*\)/);return n?e$(Number(n[1]),Number(n[2]),Number(n[3])):{r:0,g:0,b:0}}function ZA(e){const t=e.replace("#",""),n=t.length===3?t.split("").map(i=>i+i).join(""):t;return{r:parseInt(n.slice(0,2),16),g:parseInt(n.slice(2,4),16),b:parseInt(n.slice(4,6),16)}}function t$(e){const t=e.match(/lch\(\s*([\d.]+)\s+([\d.]+)\s+([\d.]+)\s*\)/);if(!t)return null;const n=Number(t[1]),i=Number(t[2]),s=Number(t[3])*Math.PI/180,a=i*Math.cos(s),o=i*Math.sin(s),c=(n+16)/116,l=a/500+c,h=c-o/200,u=.008856,d=903.3,p=l**3>u?l**3:(116*l-16)/d,g=n>d*u?((n+16)/116)**3:n/d,m=h**3>u?h**3:(116*h-16)/d,b=p*.95047,w=g*1,C=m*1.08883,_=3.2404542*b-1.5371385*w-.4985314*C,k=-.969266*b+1.8760108*w+.041556*C,x=.0556434*b-.2040259*w+1.0572252*C,I=E=>{const y=Math.max(0,Math.min(1,E));return y<=.0031308?12.92*y:1.055*y**(1/2.4)-.055};return{r:Math.round(I(_)*255),g:Math.round(I(k)*255),b:Math.round(I(x)*255)}}function e$(e,t,n){const i=t/100,r=n/100,s=(1-Math.abs(2*r-1))*i,a=s*(1-Math.abs(e/60%2-1)),o=r-s/2;let c=0,l=0,h=0;return e<60?(c=s,l=a):e<120?(c=a,l=s):e<180?(l=s,h=a):e<240?(l=a,h=s):e<300?(c=a,h=s):(c=s,h=a),{r:Math.round((c+o)*255),g:Math.round((l+o)*255),b:Math.round((h+o)*255)}}function cy(e){return n$(e)>70?"black":"white"}function n$(e){const t=e.match(/lch\(\s*([\d.]+)\s/);if(t)return Number(t[1]);const{r:n,g:i,b:r}=oy(e),[s,a,o]=[n,i,r].map(l=>{const h=l/255;return h<=.03928?h/12.92:((h+.055)/1.055)**2.4}),c=.2126*s+.7152*a+.0722*o;return c>.008856?116*Math.cbrt(c)-16:903.3*c}const i$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-apple"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 6.528V3a1 1 0 0 1 1-1h0" />
  <path d="M18.237 21A15 15 0 0 0 22 11a6 6 0 0 0-10-4.472A6 6 0 0 0 2 11a15.1 15.1 0 0 0 3.763 10 3 3 0 0 0 3.648.648 5.5 5.5 0 0 1 5.178 0A3 3 0 0 0 18.237 21" />
</svg>
`,r$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-beaker"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M4.5 3h15" />
  <path d="M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3" />
  <path d="M6 14h12" />
</svg>
`,s$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-beer"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M17 11h1a3 3 0 0 1 0 6h-1" />
  <path d="M9 12v6" />
  <path d="M13 12v6" />
  <path d="M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z" />
  <path d="M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8" />
</svg>
`,a$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-bell"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10.268 21a2 2 0 0 0 3.464 0" />
  <path d="M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326" />
</svg>
`,o$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-bike"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="18.5" cy="17.5" r="3.5" />
  <circle cx="5.5" cy="17.5" r="3.5" />
  <circle cx="15" cy="5" r="1" />
  <path d="M12 17.5V14l-3-3 4-3 2 3h2" />
</svg>
`,c$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-book-open"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 7v14" />
  <path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z" />
</svg>
`,l$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-box"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z" />
  <path d="m3.3 7 8.7 5 8.7-5" />
  <path d="M12 22V12" />
</svg>
`,u$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-briefcase"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
  <rect width="20" height="14" x="2" y="6" rx="2" />
</svg>
`,h$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-bug"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 20v-9" />
  <path d="M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z" />
  <path d="M14.12 3.88 16 2" />
  <path d="M21 21a4 4 0 0 0-3.81-4" />
  <path d="M21 5a4 4 0 0 1-3.55 3.97" />
  <path d="M22 13h-4" />
  <path d="M3 21a4 4 0 0 1 3.81-4" />
  <path d="M3 5a4 4 0 0 0 3.55 3.97" />
  <path d="M6 13H2" />
  <path d="m8 2 1.88 1.88" />
  <path d="M9 7.13V6a3 3 0 1 1 6 0v1.13" />
</svg>
`,d$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-cake"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8" />
  <path d="M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1" />
  <path d="M2 21h20" />
  <path d="M7 8v3" />
  <path d="M12 8v3" />
  <path d="M17 8v3" />
  <path d="M7 4h.01" />
  <path d="M12 4h.01" />
  <path d="M17 4h.01" />
</svg>
`,f$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-calculator"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="16" height="20" x="4" y="2" rx="2" />
  <line x1="8" x2="16" y1="6" y2="6" />
  <line x1="16" x2="16" y1="14" y2="18" />
  <path d="M16 10h.01" />
  <path d="M12 10h.01" />
  <path d="M8 10h.01" />
  <path d="M12 14h.01" />
  <path d="M8 14h.01" />
  <path d="M12 18h.01" />
  <path d="M8 18h.01" />
</svg>
`,p$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-calendar"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M8 2v4" />
  <path d="M16 2v4" />
  <rect width="18" height="18" x="3" y="4" rx="2" />
  <path d="M3 10h18" />
</svg>
`,g$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-camera"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z" />
  <circle cx="12" cy="13" r="3" />
</svg>
`,m$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-car"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2" />
  <circle cx="7" cy="17" r="2" />
  <path d="M9 17h6" />
  <circle cx="17" cy="17" r="2" />
</svg>
`,v$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-carrot"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2.27 21.7s9.87-3.5 12.73-6.36a4.5 4.5 0 0 0-6.36-6.37C5.77 11.84 2.27 21.7 2.27 21.7zM8.64 14l-2.05-2.04M15.34 15l-2.46-2.46" />
  <path d="M22 9s-1.33-2-3.5-2C16.86 7 15 9 15 9s1.33 2 3.5 2S22 9 22 9z" />
  <path d="M15 2s-2 1.33-2 3.5S15 9 15 9s2-1.84 2-3.5C17 3.33 15 2 15 2z" />
</svg>
`,b$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-chef-hat"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z" />
  <path d="M6 17h12" />
</svg>
`,_$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-circle-dollar-sign"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="10" />
  <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8" />
  <path d="M12 18V6" />
</svg>
`,y$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-circle-plus"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="10" />
  <path d="M8 12h8" />
  <path d="M12 8v8" />
</svg>
`,w$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-circle-question-mark"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="10" />
  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
  <path d="M12 17h.01" />
</svg>
`,x$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-clock"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 6v6l4 2" />
  <circle cx="12" cy="12" r="10" />
</svg>
`,S$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-cloud"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z" />
</svg>
`,C$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-coffee"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10 2v2" />
  <path d="M14 2v2" />
  <path d="M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1" />
  <path d="M6 2v2" />
</svg>
`,k$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-credit-card"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="20" height="14" x="2" y="5" rx="2" />
  <line x1="2" x2="22" y1="10" y2="10" />
</svg>
`,E$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-cup-soda"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m6 8 1.75 12.28a2 2 0 0 0 2 1.72h4.54a2 2 0 0 0 2-1.72L18 8" />
  <path d="M5 8h14" />
  <path d="M7 15a6.47 6.47 0 0 1 5 0 6.47 6.47 0 0 0 5 0" />
  <path d="m12 8 1-6h2" />
</svg>
`,M$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-dumbbell"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z" />
  <path d="m2.5 21.5 1.4-1.4" />
  <path d="m20.1 3.9 1.4-1.4" />
  <path d="M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z" />
  <path d="m9.6 14.4 4.8-4.8" />
</svg>
`,D$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-flask-conical"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2" />
  <path d="M6.453 15h11.094" />
  <path d="M8.5 2h7" />
</svg>
`,I$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-gamepad-2"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <line x1="6" x2="10" y1="11" y2="11" />
  <line x1="8" x2="8" y1="9" y2="13" />
  <line x1="15" x2="15.01" y1="12" y2="12" />
  <line x1="18" x2="18.01" y1="10" y2="10" />
  <path d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z" />
</svg>
`,R$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-gift"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect x="3" y="8" width="18" height="4" rx="1" />
  <path d="M12 8v13" />
  <path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7" />
  <path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5" />
</svg>
`,T$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-globe"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="10" />
  <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20" />
  <path d="M2 12h20" />
</svg>
`,P$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-graduation-cap"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z" />
  <path d="M22 10v6" />
  <path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5" />
</svg>
`,O$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-hamburger"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 16H4a2 2 0 1 1 0-4h16a2 2 0 1 1 0 4h-4.25" />
  <path d="M5 12a2 2 0 0 1-2-2 9 7 0 0 1 18 0 2 2 0 0 1-2 2" />
  <path d="M5 16a2 2 0 0 0-2 2 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 2 2 0 0 0-2-2q0 0 0 0" />
  <path d="m6.67 12 6.13 4.6a2 2 0 0 0 2.8-.4l3.15-4.2" />
</svg>
`,A$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-heart"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5" />
</svg>
`,$$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-home"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
  <path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
</svg>
`,L$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-joystick"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M21 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2Z" />
  <path d="M6 15v-2" />
  <path d="M12 15V9" />
  <circle cx="12" cy="6" r="3" />
</svg>
`,N$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-key"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4" />
  <path d="m21 2-9.6 9.6" />
  <circle cx="7.5" cy="15.5" r="5.5" />
</svg>
`,F$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-lightbulb"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5" />
  <path d="M9 18h6" />
  <path d="M10 22h4" />
</svg>
`,B$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-mail"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7" />
  <rect x="2" y="4" width="20" height="16" rx="2" />
</svg>
`,j$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-map-pin"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0" />
  <circle cx="12" cy="10" r="3" />
</svg>
`,z$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-milk"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M8 2h8" />
  <path d="M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2" />
  <path d="M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0" />
</svg>
`,W$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-monitor"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <rect width="20" height="14" x="2" y="3" rx="2" />
  <line x1="8" x2="16" y1="21" y2="21" />
  <line x1="12" x2="12" y1="17" y2="21" />
</svg>
`,H$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-music"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M9 18V5l12-2v13" />
  <circle cx="6" cy="18" r="3" />
  <circle cx="18" cy="16" r="3" />
</svg>
`,U$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-newspaper"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M15 18h-5" />
  <path d="M18 14h-8" />
  <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2" />
  <rect width="8" height="4" x="10" y="6" rx="1" />
</svg>
`,V$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-paintbrush"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m14.622 17.897-10.68-2.913" />
  <path d="M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z" />
  <path d="M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15" />
</svg>
`,q$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-paw-print"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="11" cy="4" r="2" />
  <circle cx="18" cy="8" r="2" />
  <circle cx="20" cy="16" r="2" />
  <path d="M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z" />
</svg>
`,K$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-phone"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384" />
</svg>
`,Y$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-pizza"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m12 14-1 1" />
  <path d="m13.75 18.25-1.25 1.42" />
  <path d="M17.775 5.654a15.68 15.68 0 0 0-12.121 12.12" />
  <path d="M18.8 9.3a1 1 0 0 0 2.1 7.7" />
  <path d="M21.964 20.732a1 1 0 0 1-1.232 1.232l-18-5a1 1 0 0 1-.695-1.232A19.68 19.68 0 0 1 15.732 2.037a1 1 0 0 1 1.232.695z" />
</svg>
`,X$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-plane"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z" />
</svg>
`,G$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-puzzle"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z" />
</svg>
`,Q$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-receipt"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z" />
  <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8" />
  <path d="M12 17.5v-11" />
</svg>
`,J$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-scale"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 3v18" />
  <path d="m19 8 3 8a5 5 0 0 1-6 0zV7" />
  <path d="M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1" />
  <path d="m5 8 3 8a5 5 0 0 1-6 0zV7" />
  <path d="M7 21h10" />
</svg>
`,Z$=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-scissors"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="6" cy="6" r="3" />
  <path d="M8.12 8.12 12 12" />
  <path d="M20 4 8.12 15.88" />
  <circle cx="6" cy="18" r="3" />
  <path d="M14.8 14.8 20 20" />
</svg>
`,t4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-shield-check"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z" />
  <path d="m9 12 2 2 4-4" />
</svg>
`,e4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-shirt"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z" />
</svg>
`,n4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-shopping-bag"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M16 10a4 4 0 0 1-8 0" />
  <path d="M3.103 6.034h17.794" />
  <path d="M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z" />
</svg>
`,i4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-shopping-cart"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="8" cy="21" r="1" />
  <circle cx="19" cy="21" r="1" />
  <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12" />
</svg>
`,r4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-sparkles"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z" />
  <path d="M20 2v4" />
  <path d="M22 4h-4" />
  <circle cx="4" cy="20" r="2" />
</svg>
`,s4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-star"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z" />
</svg>
`,a4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-sun"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <circle cx="12" cy="12" r="4" />
  <path d="M12 2v2" />
  <path d="M12 20v2" />
  <path d="m4.93 4.93 1.41 1.41" />
  <path d="m17.66 17.66 1.41 1.41" />
  <path d="M2 12h2" />
  <path d="M20 12h2" />
  <path d="m6.34 17.66-1.41 1.41" />
  <path d="m19.07 4.93-1.41 1.41" />
</svg>
`,o4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-ticket"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z" />
  <path d="M13 5v2" />
  <path d="M13 17v2" />
  <path d="M13 11v2" />
</svg>
`,c4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-trophy"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978" />
  <path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978" />
  <path d="M18 9h1.5a1 1 0 0 0 0-5H18" />
  <path d="M4 22h16" />
  <path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z" />
  <path d="M6 9H4.5a1 1 0 0 1 0-5H6" />
</svg>
`,l4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-truck"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2" />
  <path d="M15 18H9" />
  <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14" />
  <circle cx="17" cy="18" r="2" />
  <circle cx="7" cy="18" r="2" />
</svg>`,u4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-tv"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="m17 2-5 5-5-5" />
  <rect width="20" height="15" x="2" y="7" rx="2" />
</svg>
`,h4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-user"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
  <circle cx="12" cy="7" r="4" />
</svg>
`,d4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-users"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
  <path d="M16 3.128a4 4 0 0 1 0 7.744" />
  <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
  <circle cx="9" cy="7" r="4" />
</svg>
`,f4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-utensils"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" />
  <path d="M7 2v20" />
  <path d="M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />
</svg>
`,p4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-wallet"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1" />
  <path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4" />
</svg>
`,g4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-wifi"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M12 20h.01" />
  <path d="M2 8.82a15 15 0 0 1 20 0" />
  <path d="M5 12.859a10 10 0 0 1 14 0" />
  <path d="M8.5 16.429a5 5 0 0 1 7 0" />
</svg>
`,m4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-wine"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M8 22h8" />
  <path d="M7 10h10" />
  <path d="M12 15v7" />
  <path d="M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z" />
</svg>
`,v4=`<!-- @license lucide-static v0.564.0 - ISC -->
<svg
  class="lucide lucide-zap"
  xmlns="http://www.w3.org/2000/svg"
  width="24"
  height="24"
  viewBox="0 0 24 24"
  fill="none"
  stroke="currentColor"
  stroke-width="2"
  stroke-linecap="round"
  stroke-linejoin="round"
>
  <path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z" />
</svg>
`;var b4=Object.defineProperty,_4=Object.getOwnPropertyDescriptor,ly=e=>{throw TypeError(e)},Ol=(e,t,n,i)=>{for(var r=i>1?void 0:i?_4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&b4(t,n,r),r},uy=(e,t,n)=>t.has(e)||ly("Cannot "+n),Xs=(e,t,n)=>(uy(e,t,"read from private field"),n?n.call(e):t.get(e)),Iu=(e,t,n)=>t.has(e)?ly("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ca=(e,t,n)=>(uy(e,t,"access private method"),n),ac,oc,xi,hy,jd,dy,fy,py;const Al={apple:i$,banknote:a0,beaker:r$,beer:s$,bell:a$,bike:o$,"book-open":c$,briefcase:u$,bug:h$,cake:d$,calculator:f$,calendar:p$,camera:g$,car:m$,carrot:v$,"chef-hat":b$,"circle-dollar-sign":_$,"circle-plus":y$,clock:x$,cloud:S$,coffee:C$,"credit-card":k$,box:l$,"cup-soda":E$,dumbbell:M$,flask:D$,gamepad:I$,gift:R$,globe:T$,"graduation-cap":P$,hamburger:O$,heart:A$,home:$$,joystick:L$,key:N$,lightbulb:F$,mail:B$,"map-pin":j$,milk:z$,monitor:W$,music:H$,newspaper:U$,paintbrush:V$,"paw-print":q$,phone:K$,pizza:Y$,plane:X$,puzzle:G$,question:w$,receipt:Q$,scale:J$,scissors:Z$,"shield-check":t4,shirt:e4,"shopping-bag":n4,"shopping-cart":i4,sparkles:r4,star:s4,store:o0,sun:a4,ticket:o4,trophy:c4,truck:l4,tv:u4,user:h4,users:d4,utensils:f4,wallet:p4,wifi:g4,wine:m4,wrench:Ml,zap:v4},jg=Object.entries(Al);let Rs=class extends $t{constructor(){super(...arguments),Iu(this,xi),this.value="",this._open=!1,this._search="",Iu(this,ac,e=>{if(!this._open)return;e.composedPath().includes(this)||(this._open=!1,this._search="")}),Iu(this,oc,()=>{this._open&&ca(this,xi,jd).call(this)})}connectedCallback(){super.connectedCallback(),document.addEventListener("click",Xs(this,ac),!0),window.addEventListener("scroll",Xs(this,oc),!0)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("click",Xs(this,ac),!0),window.removeEventListener("scroll",Xs(this,oc),!0)}render(){const e=this.value?Al[this.value]:null;return F`
      <button
        class="trigger ${e?"":"placeholder"}"
        @click=${ca(this,xi,hy)}
        title="Pick icon"
      >
        ${e?ye(e):"?"}
      </button>
      ${this._open?F`
            <div class="popup">
              <input
                class="search"
                type="text"
                placeholder="Search icons..."
                .value=${this._search}
                @input=${t=>{this._search=t.target.value}}
              />
              <div class="grid">
                ${Xs(this,xi,py).map(([t,n])=>F`
                    <button
                      class="icon-option ${this.value===t?"selected":""}"
                      title=${t}
                      @click=${()=>ca(this,xi,dy).call(this,t)}
                    >
                      ${ye(n)}
                    </button>
                  `)}
              </div>
              ${this.value?F`<button class="clear-btn" @click=${ca(this,xi,fy)}>Clear icon</button>`:gt}
            </div>
          `:gt}
    `}};ac=new WeakMap;oc=new WeakMap;xi=new WeakSet;hy=function(){this._open=!this._open,this._search="",this._open&&this.updateComplete.then(()=>ca(this,xi,jd).call(this))};jd=function(){const e=this.shadowRoot?.querySelector(".trigger"),t=this.shadowRoot?.querySelector(".popup");if(!e||!t)return;const n=e.getBoundingClientRect(),i=t.offsetHeight,r=window.innerHeight-n.bottom;r<i+4&&n.top>r?t.style.top=`${n.top-i-4}px`:t.style.top=`${n.bottom+4}px`,t.style.left=`${n.left}px`};dy=function(e){this.dispatchEvent(new CustomEvent("icon-selected",{detail:{icon:e}})),this._open=!1,this._search=""};fy=function(){this.dispatchEvent(new CustomEvent("icon-selected",{detail:{icon:""}})),this._open=!1,this._search=""};py=function(){if(!this._search)return jg;const e=this._search.toLowerCase();return jg.filter(([t])=>t.includes(e))};Rs.styles=Bt`
    :host {
      display: inline-block;
      position: relative;
    }
    .trigger {
      background: none;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      padding: 4px;
      cursor: pointer;
      color: inherit;
      width: 2.2rem;
      height: 2.2rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .trigger:hover {
      background-color: var(--budgee-bg);
    }
    .trigger svg {
      width: 1.2rem;
      height: 1.2rem;
    }
    .trigger.placeholder {
      color: var(--budgee-text-muted);
    }
    .popup {
      position: fixed;
      z-index: 1200;
      background: var(--budgee-surface);
      border: 1px solid var(--budgee-border);
      border-radius: 8px;
      box-shadow: 0 4px 16px lch(0% 0 none / 0.15);
      padding: 0.5rem;
      width: 280px;
    }
    .search {
      width: 100%;
      box-sizing: border-box;
      padding: 4px 8px;
      margin-bottom: 0.5rem;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      font-size: 0.85rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 2px;
      max-height: 200px;
      overflow-y: auto;
    }
    .icon-option {
      background: none;
      border: 1px solid transparent;
      border-radius: 4px;
      padding: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: inherit;
    }
    .icon-option:hover {
      background-color: var(--budgee-bg);
      border-color: var(--budgee-border);
    }
    .icon-option.selected {
      background-color: var(--budgee-primary);
      color: white;
    }
    .icon-option svg {
      width: 1.2rem;
      height: 1.2rem;
    }
    .clear-btn {
      width: 100%;
      margin-top: 0.5rem;
      padding: 4px;
      background: none;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      color: var(--budgee-text-muted);
    }
    .clear-btn:hover {
      background-color: var(--budgee-bg);
    }
  `;Ol([pt({type:String})],Rs.prototype,"value",2);Ol([W()],Rs.prototype,"_open",2);Ol([W()],Rs.prototype,"_search",2);Rs=Ol([Ut("icon-picker")],Rs);var y4=Object.defineProperty,w4=Object.getOwnPropertyDescriptor,gy=e=>{throw TypeError(e)},Ur=(e,t,n,i)=>{for(var r=i>1?void 0:i?w4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&y4(t,n,r),r},my=(e,t,n)=>t.has(e)||gy("Cannot "+n),Ei=(e,t,n)=>(my(e,t,"read from private field"),n?n.call(e):t.get(e)),x4=(e,t,n)=>t.has(e)?gy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ke=(e,t,n)=>(my(e,t,"access private method"),n),Wt,zd,gr,vy,by,_y,yy,wy,xy,Sy,Gc,Qc,$l;let li=class extends $t{constructor(){super(...arguments),x4(this,Wt),this.tags=[],this.selectedTagIds=[],this.excludeIds=[],this._query="",this._highlightIndex=-1,this._open=!1}updated(e){e.has("_open")&&this._open&&this.updateComplete.then(()=>ke(this,Wt,_y).call(this))}render(){const e=Ei(this,Wt,zd);return F`
      <div class="input-wrapper" @click=${()=>this.shadowRoot?.querySelector("input")?.focus()}>
        ${this.selectedTagIds.map(t=>{const n=this.tags.find(s=>s.id===t),i=n?.color??"var(--budgee-primary)",r=n?.color?cy(n.color):"white";return F`
          <span class="tag-pill" style="background:${i};color:${r}" @click=${s=>{s.stopPropagation(),ke(this,Wt,by).call(this,t)}}>
            ${ke(this,Wt,vy).call(this,t)} &times;
          </span>
        `})}
        <input
          type="text"
          placeholder=${this.selectedTagIds.length>0?"":"Add tag..."}
          .value=${this._query}
          @input=${ke(this,Wt,yy)}
          @keydown=${ke(this,Wt,wy)}
          @focus=${ke(this,Wt,xy)}
          @blur=${ke(this,Wt,Sy)}
        />
      </div>
      ${this._open&&(e.length>0||Ei(this,Wt,gr))?F`
            <div class="suggestions">
              ${e.map((t,n)=>F`
                <div
                  class="suggestion ${n===this._highlightIndex?"highlighted":""}"
                  @click=${()=>ke(this,Wt,Gc).call(this,t)}
                >
                  ${t.name}
                </div>
              `)}
              ${Ei(this,Wt,gr)?F`
                    <div
                      class="suggestion create ${e.length===this._highlightIndex?"highlighted":""}"
                      @click=${ke(this,Wt,Qc)}
                    >
                      Create "${this._query.trim()}"
                    </div>
                  `:gt}
            </div>
          `:gt}
    `}};Wt=new WeakSet;zd=function(){const e=this._query.toLowerCase();return this.tags.filter(t=>!this.selectedTagIds.includes(t.id)&&!this.excludeIds.includes(t.id)&&t.name.toLowerCase().includes(e)).sort((t,n)=>{const i=t.name.toLowerCase().startsWith(e)?0:1,r=n.name.toLowerCase().startsWith(e)?0:1;return i-r||t.name.localeCompare(n.name)})};gr=function(){const e=this._query.trim();return e?!this.tags.some(t=>t.name.toLowerCase()===e.toLowerCase()):!1};vy=function(e){const t=this.tags.find(i=>i.id===e);if(!t)return`#${e}`;const n=t.icon?Al[t.icon]:null;return n?F`<span class="pill-icon">${ye(n)}</span> ${t.name}`:t.name};by=function(e){this.dispatchEvent(new CustomEvent("tag-removed",{detail:{tagId:e}}))};_y=function(){const e=this.shadowRoot?.querySelector("input"),t=this.shadowRoot?.querySelector(".suggestions");if(!e||!t)return;const n=e.getBoundingClientRect();t.style.top=`${n.bottom}px`,t.style.left=`${n.left}px`,t.style.width=`${n.width}px`};yy=function(e){this._query=e.target.value,this._highlightIndex=-1,this._open=this._query.length>0};wy=function(e){const t=Ei(this,Wt,zd),n=t.length+(Ei(this,Wt,gr)?1:0);e.key==="ArrowDown"?(e.preventDefault(),this._highlightIndex=Math.min(this._highlightIndex+1,n-1)):e.key==="ArrowUp"?(e.preventDefault(),this._highlightIndex=Math.max(this._highlightIndex-1,-1)):e.key==="Enter"?(e.preventDefault(),this._highlightIndex>=0&&this._highlightIndex<t.length?ke(this,Wt,Gc).call(this,t[this._highlightIndex]):Ei(this,Wt,gr)&&(this._highlightIndex===t.length||this._highlightIndex===-1)?ke(this,Wt,Qc).call(this):t.length===1&&!Ei(this,Wt,gr)?ke(this,Wt,Gc).call(this,t[0]):Ei(this,Wt,gr)&&ke(this,Wt,Qc).call(this)):e.key==="Escape"&&ke(this,Wt,$l).call(this)};xy=function(){this._query.length>0&&(this._open=!0)};Sy=function(){setTimeout(()=>{this._open=!1},150)};Gc=function(e){this.dispatchEvent(new CustomEvent("tag-selected",{detail:{tag:e}})),ke(this,Wt,$l).call(this)};Qc=function(){const e=this._query.trim();e&&(this.dispatchEvent(new CustomEvent("tag-created",{detail:{name:e}})),ke(this,Wt,$l).call(this))};$l=function(){this._query="",this._highlightIndex=-1,this._open=!1,this.updateComplete.then(()=>{this.shadowRoot?.querySelector("input")?.focus()})};li.styles=Bt`
    :host {
      display: inline-block;
      position: relative;
    }
    .input-wrapper {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 2px;
      padding: 2px 4px;
      border: 1px solid var(--budgee-border);
      border-radius: 12px;
      min-width: 120px;
      cursor: text;
      background: var(--budgee-surface);
    }
    .input-wrapper:focus-within {
      outline: 2px solid var(--budgee-primary);
      outline-offset: -1px;
    }
    .tag-pill {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      background: var(--budgee-primary);
      color: white;
      padding: 1px 6px;
      border-radius: 8px;
      font-size: 0.75rem;
      cursor: pointer;
      white-space: nowrap;
    }
    .pill-icon {
      display: inline-flex;
      align-items: center;
    }
    .pill-icon svg {
      width: 0.75rem;
      height: 0.75rem;
    }
    input {
      border: none;
      outline: none;
      padding: 2px 4px;
      font-size: 0.85rem;
      flex: 1;
      min-width: 60px;
      background: transparent;
    }
    .suggestions {
      position: fixed;
      background: var(--budgee-surface);
      border: 1px solid var(--budgee-border);
      border-radius: 0 0 4px 4px;
      max-height: 150px;
      overflow-y: auto;
      z-index: 1100;
      min-width: 120px;
    }
    .suggestion {
      padding: 4px 6px;
      cursor: pointer;
      font-size: 0.85rem;
    }
    .suggestion:hover,
    .suggestion.highlighted {
      background: var(--budgee-bg);
    }
    .suggestion.create {
      font-style: italic;
      color: var(--budgee-text-muted);
    }
  `;Ur([pt({type:Array})],li.prototype,"tags",2);Ur([pt({type:Array})],li.prototype,"selectedTagIds",2);Ur([pt({type:Array})],li.prototype,"excludeIds",2);Ur([W()],li.prototype,"_query",2);Ur([W()],li.prototype,"_highlightIndex",2);Ur([W()],li.prototype,"_open",2);li=Ur([Ut("tag-autocomplete")],li);var S4=Object.defineProperty,C4=Object.getOwnPropertyDescriptor,Cy=e=>{throw TypeError(e)},Wd=(e,t,n,i)=>{for(var r=i>1?void 0:i?C4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&S4(t,n,r),r},k4=(e,t,n)=>t.has(e)||Cy("Cannot "+n),E4=(e,t,n)=>t.has(e)?Cy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ru=(e,t,n)=>(k4(e,t,"access private method"),n),la,ky,Ey,My;const M4=[{value:"contains",label:"contains"},{value:"startsWith",label:"starts with"},{value:"equals",label:"equals"},{value:"regex",label:"regex"}];let Xa=class extends $t{constructor(){super(...arguments),E4(this,la),this.condition={field:"description",operator:"equals",value:""},this.index=0}render(){return F`
      <span>description</span>
      <select @change=${Ru(this,la,ky)}>
        ${M4.map(e=>F`
          <option value=${e.value} ?selected=${this.condition.operator===e.value}>
            ${e.label}
          </option>
        `)}
      </select>
      <input
        type="text"
        placeholder="value"
        .value=${this.condition.value}
        @input=${Ru(this,la,Ey)}
      />
      <button class="icon-btn icon-btn--danger" aria-label="Remove condition" @click=${Ru(this,la,My)}>${ye(As)}</button>
    `}};la=new WeakSet;ky=function(e){const t=e.target.value;this.dispatchEvent(new CustomEvent("condition-changed",{detail:{index:this.index,condition:{...this.condition,operator:t}}}))};Ey=function(e){const t=e.target.value;this.dispatchEvent(new CustomEvent("condition-changed",{detail:{index:this.index,condition:{...this.condition,value:t}}}))};My=function(){this.dispatchEvent(new CustomEvent("condition-removed",{detail:{index:this.index}}))};Xa.styles=[$s,Bt`
      :host {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        margin-bottom: 0.25rem;
      }
      select,
      input {
        padding: 4px 8px;
      }
      input {
        flex: 1;
      }
    `];Wd([pt({type:Object})],Xa.prototype,"condition",2);Wd([pt({type:Number})],Xa.prototype,"index",2);Xa=Wd([Ut("condition-row")],Xa);var D4=Object.defineProperty,I4=Object.getOwnPropertyDescriptor,Dy=e=>{throw TypeError(e)},dn=(e,t,n,i)=>{for(var r=i>1?void 0:i?I4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&D4(t,n,r),r},R4=(e,t,n)=>t.has(e)||Dy("Cannot "+n),T4=(e,t,n)=>t.has(e)?Dy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),_i=(e,t,n)=>(R4(e,t,"access private method"),n),En,Iy,Ry,Ty,Py,Oy,Ay,$y,Ly;let We=class extends $t{constructor(){super(...arguments),T4(this,En),this.tags=[],this.merchants=[],this.prefillDescription="",this.editingRule=null,this.editingMerchantName="",this._prefillPristine=!1,this._logic="or",this._conditions=[{field:"description",operator:"equals",value:""}],this._selectedTagIds=[],this._merchantName="",this._pendingTagNames=[]}updated(e){e.has("editingRule")&&this.editingRule?(this._conditions=[...this.editingRule.conditions],this._logic=this.editingRule.logic,this._selectedTagIds=[...this.editingRule.tagIds],this._merchantName=this.editingMerchantName,this._pendingTagNames=[]):e.has("prefillDescription")&&this.prefillDescription&&(this._conditions=[{field:"description",operator:"equals",value:this.prefillDescription}],this._merchantName=XA(this.prefillDescription),this._prefillPristine=!0,this._pendingTagNames=[])}render(){return F`
      <h4>${this.editingRule?"Edit Rule":"Create Rule"}</h4>
      <div class="conditions">
        ${this._conditions.map((e,t)=>F`
          <condition-row
            .condition=${e}
            .index=${t}
            @condition-changed=${_i(this,En,Iy)}
            @condition-removed=${_i(this,En,Ry)}
          ></condition-row>
        `)}
      </div>
      ${this._conditions.length>1?F`
            <div class="form-row">
              <label>Logic:</label>
              <select @change=${e=>{this._logic=e.target.value}}>
                <option value="and" ?selected=${this._logic==="and"}>All match (AND)</option>
                <option value="or" ?selected=${this._logic==="or"}>Any match (OR)</option>
              </select>
            </div>
          `:""}
      <button class="add-condition" @click=${_i(this,En,Ty)}>+ Add Condition</button>
      <div class="form-row">
        <label>Merchant:</label>
        <merchant-autocomplete
          .merchants=${this.merchants}
          .value=${this._merchantName}
          @merchant-changed=${e=>{this._merchantName=e.detail.name}}
        ></merchant-autocomplete>
      </div>
      <div class="form-row tags-row">
        <label>Tags:</label>
        ${this._pendingTagNames.map(e=>F`
          <span class="tag-badge" @click=${()=>_i(this,En,Ay).call(this,e)}>
            ${e} &times;
          </span>
        `)}
        <tag-autocomplete
          .tags=${this.tags}
          .selectedTagIds=${this._selectedTagIds}
          @tag-selected=${_i(this,En,Py)}
          @tag-created=${_i(this,En,Oy)}
          @tag-removed=${e=>_i(this,En,$y).call(this,e.detail.tagId)}
        ></tag-autocomplete>
      </div>
      <button @click=${_i(this,En,Ly)}>Save Rule</button>
    `}};En=new WeakSet;Iy=function(e){const{index:t,condition:n}=e.detail;let i=n;this._prefillPristine&&t===0&&n.operator==="equals"&&n.value!==this._conditions[0]?.value&&(i={...n,operator:"contains"},this._prefillPristine=!1),this._conditions=this._conditions.map((r,s)=>s===t?i:r)};Ry=function(e){const{index:t}=e.detail;this._conditions=this._conditions.filter((n,i)=>i!==t)};Ty=function(){this._conditions=[...this._conditions,{field:"description",operator:"equals",value:""}]};Py=function(e){const t=e.detail.tag;this._selectedTagIds.includes(t.id)||(this._selectedTagIds=[...this._selectedTagIds,t.id])};Oy=function(e){const t=e.detail.name;this._pendingTagNames.includes(t)||(this._pendingTagNames=[...this._pendingTagNames,t])};Ay=function(e){this._pendingTagNames=this._pendingTagNames.filter(t=>t!==e)};$y=function(e){this._selectedTagIds=this._selectedTagIds.filter(t=>t!==e)};Ly=function(){const e=this._conditions.filter(t=>t.value.trim());e.length!==0&&(this.dispatchEvent(new CustomEvent("rule-saved",{detail:{id:this.editingRule?.id,logic:this._logic,conditions:e,tagIds:this._selectedTagIds,newTagNames:this._pendingTagNames,merchantName:this._merchantName.trim()||void 0}})),this._conditions=[{field:"description",operator:"equals",value:""}],this._selectedTagIds=[],this._merchantName="",this._pendingTagNames=[],this._logic="or")};We.styles=Bt`
    :host {
      display: block;
      border: 1px solid var(--budgee-border);
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
      background: var(--budgee-surface);
    }
    .form-row {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .conditions {
      margin-bottom: 0.5rem;
    }
    select,
    input {
      padding: 4px 8px;
    }
    button {
      padding: 4px 12px;
      cursor: pointer;
      background-color: var(--budgee-primary);
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background-color: var(--budgee-primary-hover);
    }
    .add-condition {
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
    }
    .tags-row {
      flex-wrap: wrap;
    }
    .tag-badge {
      display: inline-block;
      background: var(--budgee-primary);
      color: white;
      padding: 2px 8px;
      border-radius: 8px;
      font-size: 0.8rem;
      cursor: pointer;
    }
    h4 {
      margin: 0 0 0.5rem;
    }
  `;dn([pt({type:Array})],We.prototype,"tags",2);dn([pt({type:Array})],We.prototype,"merchants",2);dn([pt({type:String})],We.prototype,"prefillDescription",2);dn([pt({attribute:!1})],We.prototype,"editingRule",2);dn([pt({type:String})],We.prototype,"editingMerchantName",2);dn([W()],We.prototype,"_prefillPristine",2);dn([W()],We.prototype,"_logic",2);dn([W()],We.prototype,"_conditions",2);dn([W()],We.prototype,"_selectedTagIds",2);dn([W()],We.prototype,"_merchantName",2);dn([W()],We.prototype,"_pendingTagNames",2);We=dn([Ut("rule-editor")],We);var P4=Object.defineProperty,O4=Object.getOwnPropertyDescriptor,Ny=e=>{throw TypeError(e)},vo=(e,t,n,i)=>{for(var r=i>1?void 0:i?O4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&P4(t,n,r),r},A4=(e,t,n)=>t.has(e)||Ny("Cannot "+n),$4=(e,t,n)=>t.has(e)?Ny("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ho=(e,t,n)=>(A4(e,t,"access private method"),n),ns,Dh,Ih;let $r=class extends Ns($t){constructor(){super(...arguments),$4(this,ns),this.refreshTrigger=0,this._overlaps=[],this._merchants=new Map,this._loading=!0}connectedCallback(){super.connectedCallback(),Ho(this,ns,Dh).call(this)}willUpdate(e){e.has("refreshTrigger")&&e.get("refreshTrigger")!==void 0&&Ho(this,ns,Dh).call(this)}render(){return this._loading?F`
        <p>Analyzing rules...</p>
      `:this._overlaps.length===0?F`
        <h2>Rule Overlap</h2>
        <p>No overlapping rules found.</p>
      `:F`
      <h2>Rule Overlap</h2>
      <p>${this._overlaps.length} overlapping rule pair${this._overlaps.length===1?"":"s"} found.</p>
      <table>
        <thead>
          <tr>
            <th>Rule A</th>
            <th>Rule B</th>
            <th>Overlapping Transactions</th>
            <th>Examples</th>
          </tr>
        </thead>
        <tbody>
          ${this._overlaps.map(e=>F`
            <tr>
              <td class="condition-summary">${Ho(this,ns,Ih).call(this,e.ruleA)}</td>
              <td class="condition-summary">${Ho(this,ns,Ih).call(this,e.ruleB)}</td>
              <td>${e.count}</td>
              <td class="samples">${e.samples.values().take(3).toArray().join(`

`)}</td>
            </tr>
          `)}
        </tbody>
      </table>
    `}};ns=new WeakSet;Dh=async function(){await this.withBusy(async()=>{const[e,t,n]=await Promise.all([Gn.all(),An.all(),oi.all()]);this._merchants=new Map(n.map(r=>[r.id,r.name]));const i=new Map;for(const r of t){const s=r.originalDescription.toLowerCase(),a=e.filter(o=>Nd(s,o));if(!(a.length<2))for(let o=0;o<a.length;o++)for(let c=o+1;c<a.length;c++){const l=[a[o].id,a[c].id].sort().join("-"),h=i.get(l);h?(h.count++,h.samples.add(r.originalDescription)):i.set(l,{ruleA:a[o],ruleB:a[c],count:1,samples:new Set([r.originalDescription])})}}this._overlaps=[...i.values()].sort((r,s)=>s.count-r.count),this._loading=!1})};Ih=function(e){const t=e.merchantId?this._merchants.get(e.merchantId)??"":"",n=e.conditions.map(i=>`${i.operator} "${i.value}"`).join(e.logic==="and"?" AND ":" OR ");return t?`${t}: ${n}`:n};$r.styles=[Ls,fi,Bt`
      :host {
        display: block;
      }
      .condition-summary {
        font-size: 0.85rem;
        color: var(--budgee-text-muted);
      }
      .samples {
        font-size: 0.8rem;
        color: var(--budgee-text-muted);
        font-style: italic;
        white-space: pre-wrap;
      }
    `];vo([pt({type:Number})],$r.prototype,"refreshTrigger",2);vo([W()],$r.prototype,"_overlaps",2);vo([W()],$r.prototype,"_merchants",2);vo([W()],$r.prototype,"_loading",2);$r=vo([Ut("rule-overlap")],$r);var L4=Object.defineProperty,N4=Object.getOwnPropertyDescriptor,Fy=e=>{throw TypeError(e)},de=(e,t,n,i)=>{for(var r=i>1?void 0:i?N4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&L4(t,n,r),r},F4=(e,t,n)=>t.has(e)||Fy("Cannot "+n),B4=(e,t,n)=>t.has(e)?Fy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Lt=(e,t,n)=>(F4(e,t,"access private method"),n),Pt,Ts,By,jy,zy,Wy,Jc,Zc,Hy,Uy,Vy,qy,cc,lc,Ky,Yy,Xy,Gy;let se=class extends Ns($t){constructor(){super(...arguments),B4(this,Pt),this._rules=[],this._tags=[],this._merchants=[],this._unmerchanted=[],this._prefillDescription="",this._showEditor=!1,this._editingRule=null,this._editingMerchantName="",this._pendingRerunRule=null,this._rulesPage=1,this._rulesPageSize=10,this._rulesFilter="",this._rulesSortCol="conditions",this._rulesSortDir="asc",this._unmerchantedPage=1,this._unmerchantedPageSize=20,this._unmerchantedFilter="",this._overlapRefresh=0}connectedCallback(){super.connectedCallback(),Lt(this,Pt,Ts).call(this)}render(){return F`
      <h2>Merchant Rules</h2>

      <div class="sections-grid">
      ${this._rules.length>0?F`
            <div class="section">
              <h3>Existing Rules</h3>
              ${(()=>{const e=this._rules.filter(n=>Lt(this,Pt,qy).call(this,n)),t=Lt(this,Pt,Ky).call(this,e);return F`
                  <paginated-table
                    .totalItems=${e.length}
                    .defaultPageSize=${10}
                    storageKey="rules"
                    ?filterable=${!0}
                    @page-change=${Lt(this,Pt,Uy)}
                    @filter-change=${Lt(this,Pt,Vy)}
                  >
                    <table>
                      <thead>
                        <tr>
                          <th class="sortable" @click=${()=>Lt(this,Pt,cc).call(this,"conditions")}>
                            Conditions${Lt(this,Pt,lc).call(this,"conditions")}
                          </th>
                          <th class="sortable" @click=${()=>Lt(this,Pt,cc).call(this,"merchant")}>
                            Merchant${Lt(this,Pt,lc).call(this,"merchant")}
                          </th>
                          <th class="sortable" @click=${()=>Lt(this,Pt,cc).call(this,"tags")}>
                            Tags${Lt(this,Pt,lc).call(this,"tags")}
                          </th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        ${t.slice((this._rulesPage-1)*this._rulesPageSize,this._rulesPage*this._rulesPageSize).map(n=>F`
                              <tr>
                                <td class="condition-summary">${Lt(this,Pt,Hy).call(this,n)}</td>
                                <td>${Lt(this,Pt,Zc).call(this,n.merchantId)}</td>
                                <td>
                                  ${n.tagIds.map(i=>Lt(this,Pt,Wy).call(this,i)).join(", ")||"None"}
                                </td>
                                <td class="actions">
                                  <button class="icon-btn" aria-label="Edit rule" @click=${()=>Lt(this,Pt,zy).call(this,n)}>${ye(Ml)}</button>
                                  <button class="icon-btn icon-btn--danger" aria-label="Delete rule" @click=${()=>Lt(this,Pt,jy).call(this,n.id)}>${ye(As)}</button>
                                </td>
                              </tr>
                            `)}
                      </tbody>
                    </table>
                  </paginated-table>
                `})()}
            </div>
          `:F`
              <p>No rules defined.</p>
            `}

      ${this._showEditor?F`
            <budgee-modal
              heading=${this._editingRule?"Edit Rule":"Create Rule"}
              @modal-close=${()=>{this._showEditor=!1,this._editingRule=null,this._editingMerchantName="",this._prefillDescription=""}}
            >
              <rule-editor
                .tags=${this._tags}
                .merchants=${this._merchants}
                .prefillDescription=${this._prefillDescription}
                .editingRule=${this._editingRule}
                .editingMerchantName=${this._editingMerchantName}
                @rule-saved=${Lt(this,Pt,By)}
              ></rule-editor>
            </budgee-modal>
          `:gt}

      ${this._pendingRerunRule?F`
            <budgee-modal
              heading="Apply Rule"
              @modal-close=${()=>{this._pendingRerunRule=null}}
            >
              <p>Apply this rule to existing unmerchanted transactions?</p>
              <div class="confirm-actions">
                <button @click=${async()=>{await Gn.applyToTransactions(this._pendingRerunRule),this._pendingRerunRule=null,await Lt(this,Pt,Ts).call(this)}}>Apply</button>
                <button class="secondary-btn" @click=${()=>{this._pendingRerunRule=null}}>Skip</button>
              </div>
            </budgee-modal>
          `:gt}

      ${this._unmerchanted.length>0?F`
            <div class="section">
              <h3>Unmerchanted Transactions</h3>
              ${(()=>{const e=this._unmerchantedFilter.toLowerCase(),t=e?this._unmerchanted.filter(n=>n.originalDescription.toLowerCase().includes(e)):this._unmerchanted;return F`
                  <paginated-table
                    .totalItems=${t.length}
                    .defaultPageSize=${20}
                    storageKey="unmerchanted"
                    ?filterable=${!0}
                    @page-change=${Lt(this,Pt,Yy)}
                    @filter-change=${Lt(this,Pt,Xy)}
                  >
                    <table>
                      <thead>
                        <tr>
                          <th>Date</th>
                          <th>Description</th>
                          <th>Amount</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${t.slice((this._unmerchantedPage-1)*this._unmerchantedPageSize,this._unmerchantedPage*this._unmerchantedPageSize).map(n=>F`
                          <tr class="clickable-row" @click=${()=>Lt(this,Pt,Gy).call(this,n)}>
                            <td>${n.date}</td>
                            <td>${n.originalDescription}</td>
                            <td class=${n.amount<0?"amount-negative":"amount-positive"}>${n.amount.toFixed(2)}</td>
                          </tr>
                        `)}
                      </tbody>
                    </table>
                  </paginated-table>
                `})()}
            </div>
          `:gt}

      <rule-overlap .refreshTrigger=${this._overlapRefresh}></rule-overlap>
      </div>
    `}};Pt=new WeakSet;Ts=async function(){this._rules=await Gn.all(),this._tags=await hn.all(),this._merchants=await oi.all();const e=await An.all();this._unmerchanted=e.filter(t=>t.merchantId===void 0),this._overlapRefresh++};By=async function(e){await this.withBusy(async()=>{const{id:t,logic:n,conditions:i,tagIds:r,newTagNames:s,merchantName:a}=e.detail,o=[...r];if(s?.length)for(const h of s){const d=(await hn.byName(h))?.id??await hn.create(h);o.push(d)}let c;if(a&&(c=(await oi.byName(a))?.id??await oi.create(a)),!t&&c){const h=this._rules.find(u=>u.merchantId===c);if(h){const u=[...h.conditions,...i],d=[...new Set([...h.tagIds,...o])],p=h.conditions.length<=1?"or":h.logic,g={...h,logic:p,conditions:u,tagIds:d};await Gn.put(g),this._showEditor=!1,this._editingRule=null,this._editingMerchantName="",this._prefillDescription="",this._pendingRerunRule=g,await Lt(this,Pt,Ts).call(this);return}}const l=t?{id:t,logic:n,conditions:i,merchantId:c,tagIds:o}:{logic:n,conditions:i,merchantId:c,tagIds:o};t?(await Gn.put(l),this._showEditor=!1,this._editingRule=null,this._editingMerchantName="",this._prefillDescription="",this._pendingRerunRule=l):(l.id=await Gn.create(l),await Gn.applyToTransactions(l),this._showEditor=!1,this._editingRule=null,this._editingMerchantName="",this._prefillDescription=""),await Lt(this,Pt,Ts).call(this)})};jy=async function(e){await this.withBusy(async()=>{await Gn.remove(e),await Lt(this,Pt,Ts).call(this)})};zy=async function(e){let t="";e.merchantId&&(t=(await oi.get(e.merchantId))?.name??""),this._editingRule=e,this._editingMerchantName=t,this._showEditor=!0};Wy=function(e){const t=this._tags.find(n=>n.id===e);return t?t.icon?`${t.icon} ${t.name}`:t.name:`#${e}`};Jc=function(e){return this._tags.find(t=>t.id===e)?.name??`#${e}`};Zc=function(e){return e?this._merchants.find(t=>t.id===e)?.name??"":""};Hy=function(e){return e.conditions.map(t=>`${t.operator} "${t.value}"`).join(e.logic==="and"?" AND ":" OR ")};Uy=function(e){this._rulesPage=e.detail.page,this._rulesPageSize=e.detail.pageSize};Vy=function(e){this._rulesFilter=e.detail.filter,this._rulesPage=1};qy=function(e){if(!this._rulesFilter)return!0;const t=this._rulesFilter.toLowerCase();return!!(e.conditions.some(n=>n.value.toLowerCase().includes(t))||e.merchantId&&this._merchants.find(i=>i.id===e.merchantId)?.name.toLowerCase().includes(t)||e.tagIds.some(n=>Lt(this,Pt,Jc).call(this,n).toLowerCase().includes(t)))};cc=function(e){this._rulesSortCol===e?this._rulesSortDir=this._rulesSortDir==="asc"?"desc":"asc":(this._rulesSortCol=e,this._rulesSortDir="asc"),this._rulesPage=1};lc=function(e){return this._rulesSortCol!==e?"":this._rulesSortDir==="asc"?" ":" "};Ky=function(e){const t=this._rulesSortCol,n=this._rulesSortDir==="asc"?1:-1;return[...e].sort((i,r)=>{let s=0;if(t==="conditions"){const a=i.conditions[0]?.value??"",o=r.conditions[0]?.value??"";s=a.localeCompare(o)}else if(t==="merchant")s=Lt(this,Pt,Zc).call(this,i.merchantId).localeCompare(Lt(this,Pt,Zc).call(this,r.merchantId));else if(t==="tags"){const a=i.tagIds.map(c=>Lt(this,Pt,Jc).call(this,c)).join(","),o=r.tagIds.map(c=>Lt(this,Pt,Jc).call(this,c)).join(",");s=a.localeCompare(o)}return s*n})};Yy=function(e){this._unmerchantedPage=e.detail.page,this._unmerchantedPageSize=e.detail.pageSize};Xy=function(e){this._unmerchantedFilter=e.detail.filter,this._unmerchantedPage=1};Gy=function(e){this._prefillDescription=e.originalDescription,this._showEditor=!0};se.styles=[Ls,fi,$s,Bt`
      :host {
        display: block;
      }
      .section {
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
        background: var(--budgee-surface);
      }
      .section h3 {
        margin-top: 0;
      }
      button {
        padding: 4px 12px;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: var(--budgee-primary-hover);
      }
      .secondary-btn {
        background-color: var(--budgee-danger);
      }
      .secondary-btn:hover {
        background-color: var(--budgee-danger-hover);
      }
      .confirm-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
      }
      .condition-summary {
        font-size: 0.85rem;
        color: var(--budgee-text-muted);
      }
      .actions {
        white-space: nowrap;
      }
      .sections-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      @media (min-width: 1600px) {
        .sections-grid {
          grid-template-columns: 1fr 1fr;
        }
      }
    `];de([W()],se.prototype,"_rules",2);de([W()],se.prototype,"_tags",2);de([W()],se.prototype,"_merchants",2);de([W()],se.prototype,"_unmerchanted",2);de([W()],se.prototype,"_prefillDescription",2);de([W()],se.prototype,"_showEditor",2);de([W()],se.prototype,"_editingRule",2);de([W()],se.prototype,"_editingMerchantName",2);de([W()],se.prototype,"_pendingRerunRule",2);de([W()],se.prototype,"_rulesPage",2);de([W()],se.prototype,"_rulesPageSize",2);de([W()],se.prototype,"_rulesFilter",2);de([W()],se.prototype,"_rulesSortCol",2);de([W()],se.prototype,"_rulesSortDir",2);de([W()],se.prototype,"_unmerchantedPage",2);de([W()],se.prototype,"_unmerchantedPageSize",2);de([W()],se.prototype,"_unmerchantedFilter",2);de([W()],se.prototype,"_overlapRefresh",2);se=de([Ut("rule-manager")],se);var j4=Object.defineProperty,z4=Object.getOwnPropertyDescriptor,Qy=e=>{throw TypeError(e)},bo=(e,t,n,i)=>{for(var r=i>1?void 0:i?z4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&j4(t,n,r),r},Jy=(e,t,n)=>t.has(e)||Qy("Cannot "+n),W4=(e,t,n)=>(Jy(e,t,"read from private field"),n?n.call(e):t.get(e)),H4=(e,t,n)=>t.has(e)?Qy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Tu=(e,t,n)=>(Jy(e,t,"access private method"),n),is,Zy,tw,ew,nw;let Lr=class extends $t{constructor(){super(...arguments),H4(this,is),this._url="",this._testResult=null,this._testError="",this._testedUrl=""}connectedCallback(){super.connectedCallback(),this._url=localStorage.getItem("budgee-sync-url")??""}render(){return F`
      <h2>Sync Settings</h2>
      <p class="hint">Sync your data across devices using a sync server. Save a valid URL to enable sync; clear it to disable.</p>
      <div class="field">
        <label for="sync-url">Server URL</label>
        <input type="url" id="sync-url" .value=${this._url} @change=${Tu(this,is,Zy)}
          placeholder="http://your-server:3001" />
        <p class="hint">The URL of your sync server.</p>
      </div>
      ${this._url?F`
            <div class="field">
              <button ?disabled=${this._testResult==="testing"} @click=${Tu(this,is,tw)}>
                ${this._testResult==="testing"?"Testing...":"Test Connection"}
              </button>
              ${this._testResult==="success"?F`
                      <p class="test-result success">Connection successful.</p>
                    `:this._testResult==="error"?F`<p class="test-result error">Connection failed: ${this._testError}</p>`:gt}
            </div>
          `:gt}
      <div class="field">
        <button ?disabled=${!W4(this,is,ew)} @click=${Tu(this,is,nw)}>Save</button>
      </div>
    `}};is=new WeakSet;Zy=function(e){this._url=e.target.value,this._testResult=null,this._testError="",this._testedUrl=""};tw=async function(){this._testResult="testing",this._testError="";try{await TM(this._url),this._testResult="success",this._testedUrl=this._url}catch(e){this._testResult="error",this._testError=e instanceof Error?e.message:String(e),this._testedUrl=""}};ew=function(){const e=localStorage.getItem("budgee-sync-url")??"";return this._url===e?!1:this._url?this._testResult==="success"&&this._testedUrl===this._url:!0};nw=function(){localStorage.setItem("budgee-sync-url",this._url),this.dispatchEvent(new CustomEvent("budgee-sync-settings-changed",{bubbles:!0,composed:!0})),this.requestUpdate()};Lr.styles=Bt`
    :host {
      display: block;
    }

    h2 {
      margin-top: 0;
    }

    .field {
      margin-bottom: 1rem;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    input[type="url"] {
      width: 100%;
      max-width: 400px;
      padding: 0.4rem 0.6rem;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      background: var(--budgee-surface);
      color: var(--budgee-text);
      font-size: 0.9rem;
    }

    .hint {
      font-size: 0.8rem;
      color: var(--budgee-text-muted);
      margin-top: 0.25rem;
    }

    button {
      padding: 0.4rem 0.8rem;
      border: 1px solid var(--budgee-border);
      border-radius: 4px;
      background: var(--budgee-surface);
      color: var(--budgee-text);
      cursor: pointer;
      font-size: 0.9rem;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .test-result {
      font-size: 0.85rem;
      margin-top: 0.25rem;
    }

    .test-result.success {
      color: var(--budgee-positive, green);
    }

    .test-result.error {
      color: var(--budgee-negative, red);
    }
  `;bo([W()],Lr.prototype,"_url",2);bo([W()],Lr.prototype,"_testResult",2);bo([W()],Lr.prototype,"_testError",2);bo([W()],Lr.prototype,"_testedUrl",2);Lr=bo([Ut("budgee-settings")],Lr);function U4(e){if(e.startsWith("#"))return e;const{r:t,g:n,b:i}=oy(e),r=s=>s.toString(16).padStart(2,"0");return`#${r(t)}${r(n)}${r(i)}`}var V4=Object.defineProperty,q4=Object.getOwnPropertyDescriptor,iw=e=>{throw TypeError(e)},Qi=(e,t,n,i)=>{for(var r=i>1?void 0:i?q4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&V4(t,n,r),r},K4=(e,t,n)=>t.has(e)||iw("Cannot "+n),Y4=(e,t,n)=>t.has(e)?iw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),be=(e,t,n)=>(K4(e,t,"access private method"),n),le,Fs,Hd,rw,sw,aw,ow,cw,lw,uw,hw,dw,fw;let Fn=class extends Ns($t){constructor(){super(...arguments),Y4(this,le),this._tags=[],this._newTagName="",this._error="",this._filter="",this._currentPage=1,this._pageSize=25,this._sortDir="asc"}connectedCallback(){super.connectedCallback(),be(this,le,Fs).call(this)}render(){return F`
      <h3>Tags</h3>
      <div class="tag-form">
        <input
          type="text"
          placeholder="New tag name"
          .value=${this._newTagName}
          @input=${be(this,le,cw)}
          @keydown=${be(this,le,lw)}
        />
        <button @click=${be(this,le,Hd)}>Add</button>
      </div>
      ${this._error?F`<p class="error">${this._error}</p>`:""}
      ${(()=>{const e=this._filter.toLowerCase(),t=e?this._tags.filter(a=>a.name.toLowerCase().includes(e)):this._tags,n=be(this,le,fw).call(this,t),i=(this._currentPage-1)*this._pageSize,r=n.slice(i,i+this._pageSize),s=this._sortDir==="asc"?" ":" ";return F`
          <paginated-table
            .totalItems=${t.length}
            .defaultPageSize=${25}
            storageKey="tags"
            ?filterable=${!0}
            @page-change=${be(this,le,uw)}
            @filter-change=${be(this,le,hw)}
          >
            <table>
              <thead>
                <tr>
                  <th class="col-icon">Icon</th>
                  <th class="col-color">Color</th>
                  <th class="sortable" @click=${be(this,le,dw)}>Name${s}</th>
                  <th class="col-remove"></th>
                </tr>
              </thead>
              <tbody>
                ${r.map(a=>F`
                  <tr>
                    <td class="col-icon">
                      <icon-picker
                        .value=${a.icon??""}
                        @icon-selected=${o=>be(this,le,sw).call(this,a,o.detail.icon)}
                      ></icon-picker>
                    </td>
                    <td class="col-color">
                      <input
                        type="color"
                        class="color-swatch"
                        .value=${be(this,le,aw).call(this,a.color)}
                        @change=${o=>be(this,le,ow).call(this,a,o.target.value)}
                      />
                    </td>
                    <td>
                      ${a.name}
                    </td>
                    <td class="col-remove">
                      <button class="icon-btn icon-btn--danger" aria-label="Remove tag" @click=${()=>be(this,le,rw).call(this,a.id)}>
                        ${ye(As)}
                      </button>
                    </td>
                  </tr>
                `)}
              </tbody>
            </table>
          </paginated-table>
        `})()}
    `}};le=new WeakSet;Fs=async function(){this._tags=await hn.all()};Hd=async function(){const e=this._newTagName.trim();if(!e)return;if(this._error="",await hn.byName(e)){this._error=`Tag "${e}" already exists.`;return}await this.withBusy(async()=>{await hn.create(e),this._newTagName="",await be(this,le,Fs).call(this)})};rw=async function(e){await this.withBusy(async()=>{await hn.remove(e),await be(this,le,Fs).call(this)})};sw=async function(e,t){await this.withBusy(async()=>{await hn.update(e.id,{icon:t||void 0}),await be(this,le,Fs).call(this)})};aw=function(e){return e?U4(e):"#7eb8da"};ow=async function(e,t){await this.withBusy(async()=>{await hn.update(e.id,{color:t}),await be(this,le,Fs).call(this)})};cw=function(e){this._newTagName=e.target.value};lw=function(e){e.key==="Enter"&&be(this,le,Hd).call(this)};uw=function(e){this._currentPage=e.detail.page,this._pageSize=e.detail.pageSize};hw=function(e){this._filter=e.detail.filter,this._currentPage=1};dw=function(){this._sortDir=this._sortDir==="asc"?"desc":"asc",this._currentPage=1};fw=function(e){const t=this._sortDir==="asc"?1:-1;return[...e].sort((n,i)=>n.name.localeCompare(i.name)*t)};Fn.styles=[Ls,fi,$s,Bt`
      :host {
        display: block;
        border: 1px solid var(--budgee-border);
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
        background: var(--budgee-surface);
      }
      .tag-form {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        align-items: center;
      }
      input {
        padding: 4px 8px;
        flex: 1;
      }
      button {
        padding: 4px 12px;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: var(--budgee-primary-hover);
      }
      .error {
        color: var(--budgee-danger-hover);
        font-size: 0.85rem;
      }
      .col-icon,
      .col-color,
      .col-remove {
        width: 1%;
        white-space: nowrap;
      }
      .color-swatch {
        width: 2rem;
        height: 1.5rem;
        border: none;
        padding: 0;
        cursor: pointer;
        border-radius: 4px;
      }
    `];Qi([W()],Fn.prototype,"_tags",2);Qi([W()],Fn.prototype,"_newTagName",2);Qi([W()],Fn.prototype,"_error",2);Qi([W()],Fn.prototype,"_filter",2);Qi([W()],Fn.prototype,"_currentPage",2);Qi([W()],Fn.prototype,"_pageSize",2);Qi([W()],Fn.prototype,"_sortDir",2);Fn=Qi([Ut("tag-manager")],Fn);var X4=Object.defineProperty,G4=Object.getOwnPropertyDescriptor,pw=e=>{throw TypeError(e)},Ud=(e,t,n,i)=>{for(var r=i>1?void 0:i?G4(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&X4(t,n,r),r},Q4=(e,t,n)=>t.has(e)||pw("Cannot "+n),J4=(e,t,n)=>t.has(e)?pw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Z4=(e,t,n)=>(Q4(e,t,"access private method"),n),Rh,gw;let Ga=class extends $t{constructor(){super(...arguments),J4(this,Rh),this.tags=[],this.tagIds=[]}render(){return F`${this.tagIds.map(e=>{const t=this.tags.find(r=>r.id===e),n=t?.color??"var(--budgee-primary)",i=t?.color?cy(t.color):"white";return F`<span class="tag-pill" style="background:${n};color:${i}">${Z4(this,Rh,gw).call(this,e)}</span>`})}`}};Rh=new WeakSet;gw=function(e){const t=this.tags.find(i=>i.id===e);if(!t)return`#${e}`;const n=t.icon?Al[t.icon]:null;return n?F`<span class="pill-icon">${ye(n)}</span> ${t.name}`:t.name};Ga.styles=Bt`
    :host {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }
    .tag-pill {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      background: var(--budgee-primary);
      color: white;
      padding: 1px 6px;
      border-radius: 8px;
      font-size: 0.75rem;
      white-space: nowrap;
    }
    .pill-icon {
      display: inline-flex;
      align-items: center;
    }
    .pill-icon svg {
      width: 0.75rem;
      height: 0.75rem;
    }
  `;Ud([pt({type:Array})],Ga.prototype,"tags",2);Ud([pt({type:Array})],Ga.prototype,"tagIds",2);Ga=Ud([Ut("tag-pills")],Ga);function tL(e,t){const n=e.originalDescription.toLowerCase();for(const i of t){if(!Nd(n,i))continue;const r=[...new Set([...e.tagIds,...i.tagIds])],s=i.merchantId??e.merchantId;return{...e,tagIds:r,merchantId:s}}return e}async function eL(e,t,n){const i=await Gn.all(),r=t.account?await nL(e,t.account):void 0,s=e.map(a=>iL(a,t,r?.get(a[t.account])??n.accountId)).filter(a=>a!==void 0).map(a=>tL(a,i));return n.importMode==="replace"&&await An.deleteAll(),await An.bulkAdd(s),s.length}async function nL(e,t){const n=[...new Set(e.map(a=>a[t]).filter(Boolean))],i=await xs.all(),r=new Map;for(const a of i)r.set(a.name.toLowerCase(),a.id);const s=new Map;for(const a of n){const o=r.get(a.toLowerCase());if(o)s.set(a,o);else{const c=await xs.create({name:a});s.set(a,c),r.set(a.toLowerCase(),c)}}return s}function iL(e,t,n){const i=t.date?e[t.date]:void 0,r=t.amount?e[t.amount]:void 0,s=t.credit?e[t.credit]:void 0,a=t.description?e[t.description]:void 0;if(!i||!a)return;const o=r?Number.parseFloat(r):NaN,c=s?Number.parseFloat(s):NaN;if(Number.isNaN(o)&&Number.isNaN(c))return;const l=(Number.isNaN(o)?0:-o)+(Number.isNaN(c)?0:c);return{date:i,amount:l,originalDescription:a,tagIds:[],accountId:n}}var uc={exports:{}};var rL=uc.exports,zg;function sL(){return zg||(zg=1,(function(e,t){((n,i)=>{e.exports=i()})(rL,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r,s=!i.document&&!!i.postMessage,a=i.IS_PAPA_WORKER||!1,o={},c=0,l={};function h(y){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(M){var D=x(M);D.chunkSize=parseInt(D.chunkSize),M.step||M.chunk||(D.chunkSize=null),this._handle=new m(D),(this._handle.streamer=this)._config=D}).call(this,y),this.parseChunk=function(M,D){var R=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<R){let N=this._config.newline;N||(P=this._config.quoteChar||'"',N=this._handle.guessLineEndings(M,P)),M=[...M.split(N).slice(R)].join(N)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(P=this._config.beforeFirstChunk(M))!==void 0&&(M=P),this.isFirstChunk=!1,this._halted=!1;var R=this._partialLine+M,P=(this._partialLine="",this._handle.parse(R,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(M=P.meta.cursor,R=(this._finished||(this._partialLine=R.substring(M-this._baseIndex),this._baseIndex=M),P&&P.data&&(this._rowCount+=P.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)i.postMessage({results:P,workerId:l.WORKER_ID,finished:R});else if(E(this._config.chunk)&&!D){if(this._config.chunk(P,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=P=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(P.data),this._completeResults.errors=this._completeResults.errors.concat(P.errors),this._completeResults.meta=P.meta),this._completed||!R||!E(this._config.complete)||P&&P.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||P&&P.meta.paused||this._nextChunk(),P}this._halted=!0},this._sendError=function(M){E(this._config.error)?this._config.error(M):a&&this._config.error&&i.postMessage({workerId:l.WORKER_ID,error:M,finished:!1})}}function u(y){var M;(y=y||{}).chunkSize||(y.chunkSize=l.RemoteChunkSize),h.call(this,y),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(D){this._input=D,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(M=new XMLHttpRequest,this._config.withCredentials&&(M.withCredentials=this._config.withCredentials),s||(M.onload=I(this._chunkLoaded,this),M.onerror=I(this._chunkError,this)),M.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var D,R=this._config.downloadRequestHeaders;for(D in R)M.setRequestHeader(D,R[D])}var P;this._config.chunkSize&&(P=this._start+this._config.chunkSize-1,M.setRequestHeader("Range","bytes="+this._start+"-"+P));try{M.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}s&&M.status===0&&this._chunkError()}},this._chunkLoaded=function(){M.readyState===4&&(M.status<200||400<=M.status?this._chunkError():(this._start+=this._config.chunkSize||M.responseText.length,this._finished=!this._config.chunkSize||this._start>=(D=>(D=D.getResponseHeader("Content-Range"))!==null?parseInt(D.substring(D.lastIndexOf("/")+1)):-1)(M),this.parseChunk(M.responseText)))},this._chunkError=function(D){D=M.statusText||D,this._sendError(new Error(D))}}function d(y){(y=y||{}).chunkSize||(y.chunkSize=l.LocalChunkSize),h.call(this,y);var M,D,R=typeof FileReader<"u";this.stream=function(P){this._input=P,D=P.slice||P.webkitSlice||P.mozSlice,R?((M=new FileReader).onload=I(this._chunkLoaded,this),M.onerror=I(this._chunkError,this)):M=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var P=this._input,N=(this._config.chunkSize&&(N=Math.min(this._start+this._config.chunkSize,this._input.size),P=D.call(P,this._start,N)),M.readAsText(P,this._config.encoding));R||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(P){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(P.target.result)},this._chunkError=function(){this._sendError(M.error)}}function p(y){var M;h.call(this,y=y||{}),this.stream=function(D){return M=D,this._nextChunk()},this._nextChunk=function(){var D,R;if(!this._finished)return D=this._config.chunkSize,M=D?(R=M.substring(0,D),M.substring(D)):(R=M,""),this._finished=!M,this.parseChunk(R)}}function g(y){h.call(this,y=y||{});var M=[],D=!0,R=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(P){this._input=P,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){R&&M.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),M.length?this.parseChunk(M.shift()):D=!0},this._streamData=I(function(P){try{M.push(typeof P=="string"?P:P.toString(this._config.encoding)),D&&(D=!1,this._checkIsFinished(),this.parseChunk(M.shift()))}catch(N){this._streamError(N)}},this),this._streamError=I(function(P){this._streamCleanUp(),this._sendError(P)},this),this._streamEnd=I(function(){this._streamCleanUp(),R=!0,this._streamData("")},this),this._streamCleanUp=I(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(y){var M,D,R,P,N=Math.pow(2,53),U=-N,H=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Y=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,Z=0,j=0,nt=!1,G=!1,tt=[],z={data:[],errors:[],meta:{}};function J(mt){return y.skipEmptyLines==="greedy"?mt.join("").trim()==="":mt.length===1&&mt[0].length===0}function lt(){if(z&&R&&(ee("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),R=!1),y.skipEmptyLines&&(z.data=z.data.filter(function(st){return!J(st)})),St()){let st=function(Rt,Tt){E(y.transformHeader)&&(Rt=y.transformHeader(Rt,Tt)),tt.push(Rt)};if(z)if(Array.isArray(z.data[0])){for(var mt=0;St()&&mt<z.data.length;mt++)z.data[mt].forEach(st);z.data.splice(0,1)}else z.data.forEach(st)}function _t(st,Rt){for(var Tt=y.header?{}:[],yt=0;yt<st.length;yt++){var $=yt,L=st[yt],L=((V,q)=>(T=>(y.dynamicTypingFunction&&y.dynamicTyping[T]===void 0&&(y.dynamicTyping[T]=y.dynamicTypingFunction(T)),(y.dynamicTyping[T]||y.dynamicTyping)===!0))(V)?q==="true"||q==="TRUE"||q!=="false"&&q!=="FALSE"&&((T=>{if(H.test(T)&&(T=parseFloat(T),U<T&&T<N))return 1})(q)?parseFloat(q):Y.test(q)?new Date(q):q===""?null:q):q)($=y.header?yt>=tt.length?"__parsed_extra":tt[yt]:$,L=y.transform?y.transform(L,$):L);$==="__parsed_extra"?(Tt[$]=Tt[$]||[],Tt[$].push(L)):Tt[$]=L}return y.header&&(yt>tt.length?ee("FieldMismatch","TooManyFields","Too many fields: expected "+tt.length+" fields but parsed "+yt,j+Rt):yt<tt.length&&ee("FieldMismatch","TooFewFields","Too few fields: expected "+tt.length+" fields but parsed "+yt,j+Rt)),Tt}var Ot;z&&(y.header||y.dynamicTyping||y.transform)&&(Ot=1,!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(_t),Ot=z.data.length):z.data=_t(z.data,0),y.header&&z.meta&&(z.meta.fields=tt),j+=Ot)}function St(){return y.header&&tt.length===0}function ee(mt,_t,Ot,st){mt={type:mt,code:_t,message:Ot},st!==void 0&&(mt.row=st),z.errors.push(mt)}E(y.step)&&(P=y.step,y.step=function(mt){z=mt,St()?lt():(lt(),z.data.length!==0&&(Z+=mt.data.length,y.preview&&Z>y.preview?D.abort():(z.data=z.data[0],P(z,K))))}),this.parse=function(mt,_t,Ot){var st=y.quoteChar||'"',st=(y.newline||(y.newline=this.guessLineEndings(mt,st)),R=!1,y.delimiter?E(y.delimiter)&&(y.delimiter=y.delimiter(mt),z.meta.delimiter=y.delimiter):((st=((Rt,Tt,yt,$,L)=>{var V,q,T,f;L=L||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var v=0;v<L.length;v++){for(var S,O=L[v],A=0,B=0,Q=0,rt=(T=void 0,new w({comments:$,delimiter:O,newline:Tt,preview:10}).parse(Rt)),Mt=0;Mt<rt.data.length;Mt++)yt&&J(rt.data[Mt])?Q++:(S=rt.data[Mt].length,B+=S,T===void 0?T=S:0<S&&(A+=Math.abs(S-T),T=S));0<rt.data.length&&(B/=rt.data.length-Q),(q===void 0||A<=q)&&(f===void 0||f<B)&&1.99<B&&(q=A,V=O,f=B)}return{successful:!!(y.delimiter=V),bestDelimiter:V}})(mt,y.newline,y.skipEmptyLines,y.comments,y.delimitersToGuess)).successful?y.delimiter=st.bestDelimiter:(R=!0,y.delimiter=l.DefaultDelimiter),z.meta.delimiter=y.delimiter),x(y));return y.preview&&y.header&&st.preview++,M=mt,D=new w(st),z=D.parse(M,_t,Ot),lt(),nt?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return nt},this.pause=function(){nt=!0,D.abort(),M=E(y.chunk)?"":M.substring(D.getCharIndex())},this.resume=function(){K.streamer._halted?(nt=!1,K.streamer.parseChunk(M,!0)):setTimeout(K.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,D.abort(),z.meta.aborted=!0,E(y.complete)&&y.complete(z),M=""},this.guessLineEndings=function(Rt,st){Rt=Rt.substring(0,1048576);var st=new RegExp(b(st)+"([^]*?)"+b(st),"gm"),Ot=(Rt=Rt.replace(st,"")).split("\r"),st=Rt.split(`
`),Rt=1<st.length&&st[0].length<Ot[0].length;if(Ot.length===1||Rt)return`
`;for(var Tt=0,yt=0;yt<Ot.length;yt++)Ot[yt][0]===`
`&&Tt++;return Tt>=Ot.length/2?`\r
`:"\r"}}function b(y){return y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(y){var M=(y=y||{}).delimiter,D=y.newline,R=y.comments,P=y.step,N=y.preview,U=y.fastMode,H=null,Y=!1,K=y.quoteChar==null?'"':y.quoteChar,Z=K;if(y.escapeChar!==void 0&&(Z=y.escapeChar),(typeof M!="string"||-1<l.BAD_DELIMITERS.indexOf(M))&&(M=","),R===M)throw new Error("Comment character same as delimiter");R===!0?R="#":(typeof R!="string"||-1<l.BAD_DELIMITERS.indexOf(R))&&(R=!1),D!==`
`&&D!=="\r"&&D!==`\r
`&&(D=`
`);var j=0,nt=!1;this.parse=function(G,tt,z){if(typeof G!="string")throw new Error("Input must be a string");var J=G.length,lt=M.length,St=D.length,ee=R.length,mt=E(P),_t=[],Ot=[],st=[],Rt=j=0;if(!G)return A();if(U||U!==!1&&G.indexOf(K)===-1){for(var Tt=G.split(D),yt=0;yt<Tt.length;yt++){if(st=Tt[yt],j+=st.length,yt!==Tt.length-1)j+=D.length;else if(z)return A();if(!R||st.substring(0,ee)!==R){if(mt){if(_t=[],f(st.split(M)),B(),nt)return A()}else f(st.split(M));if(N&&N<=yt)return _t=_t.slice(0,N),A(!0)}}return A()}for(var $=G.indexOf(M,j),L=G.indexOf(D,j),V=new RegExp(b(Z)+b(K),"g"),q=G.indexOf(K,j);;)if(G[j]===K)for(q=j,j++;;){if((q=G.indexOf(K,q+1))===-1)return z||Ot.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_t.length,index:j}),S();if(q===J-1)return S(G.substring(j,q).replace(V,K));if(K===Z&&G[q+1]===Z)q++;else if(K===Z||q===0||G[q-1]!==Z){$!==-1&&$<q+1&&($=G.indexOf(M,q+1));var T=v((L=L!==-1&&L<q+1?G.indexOf(D,q+1):L)===-1?$:Math.min($,L));if(G.substr(q+1+T,lt)===M){st.push(G.substring(j,q).replace(V,K)),G[j=q+1+T+lt]!==K&&(q=G.indexOf(K,j)),$=G.indexOf(M,j),L=G.indexOf(D,j);break}if(T=v(L),G.substring(q+1+T,q+1+T+St)===D){if(st.push(G.substring(j,q).replace(V,K)),O(q+1+T+St),$=G.indexOf(M,j),q=G.indexOf(K,j),mt&&(B(),nt))return A();if(N&&_t.length>=N)return A(!0);break}Ot.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_t.length,index:j}),q++}}else if(R&&st.length===0&&G.substring(j,j+ee)===R){if(L===-1)return A();j=L+St,L=G.indexOf(D,j),$=G.indexOf(M,j)}else if($!==-1&&($<L||L===-1))st.push(G.substring(j,$)),j=$+lt,$=G.indexOf(M,j);else{if(L===-1)break;if(st.push(G.substring(j,L)),O(L+St),mt&&(B(),nt))return A();if(N&&_t.length>=N)return A(!0)}return S();function f(Q){_t.push(Q),Rt=j}function v(Q){var rt=0;return rt=Q!==-1&&(Q=G.substring(q+1,Q))&&Q.trim()===""?Q.length:rt}function S(Q){return z||(Q===void 0&&(Q=G.substring(j)),st.push(Q),j=J,f(st),mt&&B()),A()}function O(Q){j=Q,f(st),st=[],L=G.indexOf(D,j)}function A(Q){if(y.header&&!tt&&_t.length&&!Y){var rt=_t[0],Mt=Object.create(null),vt=new Set(rt);let bt=!1;for(let Kt=0;Kt<rt.length;Kt++){let fe=rt[Kt];if(Mt[fe=E(y.transformHeader)?y.transformHeader(fe,Kt):fe]){let nn,vi=Mt[fe];for(;nn=fe+"_"+vi,vi++,vt.has(nn););vt.add(nn),rt[Kt]=nn,Mt[fe]++,bt=!0,(H=H===null?{}:H)[nn]=fe}else Mt[fe]=1,rt[Kt]=fe;vt.add(fe)}bt&&console.warn("Duplicate headers found and renamed."),Y=!0}return{data:_t,errors:Ot,meta:{delimiter:M,linebreak:D,aborted:nt,truncated:!!Q,cursor:Rt+(tt||0),renamedHeaders:H}}}function B(){P(A()),_t=[],Ot=[]}},this.abort=function(){nt=!0},this.getCharIndex=function(){return j}}function C(y){var M=y.data,D=o[M.workerId],R=!1;if(M.error)D.userError(M.error,M.file);else if(M.results&&M.results.data){var P={abort:function(){R=!0,_(M.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:k,resume:k};if(E(D.userStep)){for(var N=0;N<M.results.data.length&&(D.userStep({data:M.results.data[N],errors:M.results.errors,meta:M.results.meta},P),!R);N++);delete M.results}else E(D.userChunk)&&(D.userChunk(M.results,P,M.file),delete M.results)}M.finished&&!R&&_(M.workerId,M.results)}function _(y,M){var D=o[y];E(D.userComplete)&&D.userComplete(M),D.terminate(),delete o[y]}function k(){throw new Error("Not implemented.")}function x(y){if(typeof y!="object"||y===null)return y;var M,D=Array.isArray(y)?[]:{};for(M in y)D[M]=x(y[M]);return D}function I(y,M){return function(){y.apply(M,arguments)}}function E(y){return typeof y=="function"}return l.parse=function(y,M){var D=(M=M||{}).dynamicTyping||!1;if(E(D)&&(M.dynamicTypingFunction=D,D={}),M.dynamicTyping=D,M.transform=!!E(M.transform)&&M.transform,!M.worker||!l.WORKERS_SUPPORTED)return D=null,l.NODE_STREAM_INPUT,typeof y=="string"?(y=(R=>R.charCodeAt(0)!==65279?R:R.slice(1))(y),D=new(M.download?u:p)(M)):y.readable===!0&&E(y.read)&&E(y.on)?D=new g(M):(i.File&&y instanceof File||y instanceof Object)&&(D=new d(M)),D.stream(y);(D=(()=>{var R;return!!l.WORKERS_SUPPORTED&&(R=(()=>{var P=i.URL||i.webkitURL||null,N=n.toString();return l.BLOB_URL||(l.BLOB_URL=P.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",N,")();"],{type:"text/javascript"})))})(),(R=new i.Worker(R)).onmessage=C,R.id=c++,o[R.id]=R)})()).userStep=M.step,D.userChunk=M.chunk,D.userComplete=M.complete,D.userError=M.error,M.step=E(M.step),M.chunk=E(M.chunk),M.complete=E(M.complete),M.error=E(M.error),delete M.worker,D.postMessage({input:y,config:M,workerId:D.id})},l.unparse=function(y,M){var D=!1,R=!0,P=",",N=`\r
`,U='"',H=U+U,Y=!1,K=null,Z=!1,j=((()=>{if(typeof M=="object"){if(typeof M.delimiter!="string"||l.BAD_DELIMITERS.filter(function(tt){return M.delimiter.indexOf(tt)!==-1}).length||(P=M.delimiter),typeof M.quotes!="boolean"&&typeof M.quotes!="function"&&!Array.isArray(M.quotes)||(D=M.quotes),typeof M.skipEmptyLines!="boolean"&&typeof M.skipEmptyLines!="string"||(Y=M.skipEmptyLines),typeof M.newline=="string"&&(N=M.newline),typeof M.quoteChar=="string"&&(U=M.quoteChar),typeof M.header=="boolean"&&(R=M.header),Array.isArray(M.columns)){if(M.columns.length===0)throw new Error("Option columns is empty");K=M.columns}M.escapeChar!==void 0&&(H=M.escapeChar+U),M.escapeFormulae instanceof RegExp?Z=M.escapeFormulae:typeof M.escapeFormulae=="boolean"&&M.escapeFormulae&&(Z=/^[=+\-@\t\r].*$/)}})(),new RegExp(b(U),"g"));if(typeof y=="string"&&(y=JSON.parse(y)),Array.isArray(y)){if(!y.length||Array.isArray(y[0]))return nt(null,y,Y);if(typeof y[0]=="object")return nt(K||Object.keys(y[0]),y,Y)}else if(typeof y=="object")return typeof y.data=="string"&&(y.data=JSON.parse(y.data)),Array.isArray(y.data)&&(y.fields||(y.fields=y.meta&&y.meta.fields||K),y.fields||(y.fields=Array.isArray(y.data[0])?y.fields:typeof y.data[0]=="object"?Object.keys(y.data[0]):[]),Array.isArray(y.data[0])||typeof y.data[0]=="object"||(y.data=[y.data])),nt(y.fields||[],y.data||[],Y);throw new Error("Unable to serialize unrecognized input");function nt(tt,z,J){var lt="",St=(typeof tt=="string"&&(tt=JSON.parse(tt)),typeof z=="string"&&(z=JSON.parse(z)),Array.isArray(tt)&&0<tt.length),ee=!Array.isArray(z[0]);if(St&&R){for(var mt=0;mt<tt.length;mt++)0<mt&&(lt+=P),lt+=G(tt[mt],mt);0<z.length&&(lt+=N)}for(var _t=0;_t<z.length;_t++){var Ot=(St?tt:z[_t]).length,st=!1,Rt=St?Object.keys(z[_t]).length===0:z[_t].length===0;if(J&&!St&&(st=J==="greedy"?z[_t].join("").trim()==="":z[_t].length===1&&z[_t][0].length===0),J==="greedy"&&St){for(var Tt=[],yt=0;yt<Ot;yt++){var $=ee?tt[yt]:yt;Tt.push(z[_t][$])}st=Tt.join("").trim()===""}if(!st){for(var L=0;L<Ot;L++){0<L&&!Rt&&(lt+=P);var V=St&&ee?tt[L]:L;lt+=G(z[_t][V],L)}_t<z.length-1&&(!J||0<Ot&&!Rt)&&(lt+=N)}}return lt}function G(tt,z){var J,lt;return tt==null?"":tt.constructor===Date?JSON.stringify(tt).slice(1,25):(lt=!1,Z&&typeof tt=="string"&&Z.test(tt)&&(tt="'"+tt,lt=!0),J=tt.toString().replace(j,H),(lt=lt||D===!0||typeof D=="function"&&D(tt,z)||Array.isArray(D)&&D[z]||((St,ee)=>{for(var mt=0;mt<ee.length;mt++)if(-1<St.indexOf(ee[mt]))return!0;return!1})(J,l.BAD_DELIMITERS)||-1<J.indexOf(P)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?U+J+U:J)}},l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!s&&!!i.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=w,l.ParserHandle=m,l.NetworkStreamer=u,l.FileStreamer=d,l.StringStreamer=p,l.ReadableStreamStreamer=g,i.jQuery&&((r=i.jQuery).fn.parse=function(y){var M=y.config||{},D=[];return this.each(function(N){if(!(r(this).prop("tagName").toUpperCase()==="INPUT"&&r(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var U=0;U<this.files.length;U++)D.push({file:this.files[U],inputElem:this,instanceConfig:r.extend({},M)})}),R(),this;function R(){if(D.length===0)E(y.complete)&&y.complete();else{var N,U,H,Y,K=D[0];if(E(y.before)){var Z=y.before(K.file,K.inputElem);if(typeof Z=="object"){if(Z.action==="abort")return N="AbortError",U=K.file,H=K.inputElem,Y=Z.reason,void(E(y.error)&&y.error({name:N},U,H,Y));if(Z.action==="skip")return void P();typeof Z.config=="object"&&(K.instanceConfig=r.extend(K.instanceConfig,Z.config))}else if(Z==="skip")return void P()}var j=K.instanceConfig.complete;K.instanceConfig.complete=function(nt){E(j)&&j(nt,K.file,K.inputElem),P()},l.parse(K.file,K.instanceConfig)}}function P(){D.splice(0,1),R()}}),a&&(i.onmessage=function(y){y=y.data,l.WORKER_ID===void 0&&y&&(l.WORKER_ID=y.workerId),typeof y.input=="string"?i.postMessage({workerId:l.WORKER_ID,results:l.parse(y.input,y.config),finished:!0}):(i.File&&y.input instanceof File||y.input instanceof Object)&&(y=l.parse(y.input,y.config))&&i.postMessage({workerId:l.WORKER_ID,results:y,finished:!0})}),(u.prototype=Object.create(h.prototype)).constructor=u,(d.prototype=Object.create(h.prototype)).constructor=d,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(h.prototype)).constructor=g,l})})(uc)),uc.exports}var aL=sL();const oL=r0(aL),cL=e=>{const t=e.map(i=>i.toLocaleLowerCase()),n=i=>{const r=t.findIndex(s=>i.some(a=>s.includes(a)));return r!==-1?e[r]:void 0};return{date:n(["date","time"]),amount:n(["amount","value","cost","price","debit"]),credit:n(["credit","payment"]),description:n(["description","merchant","payee","name","memo"]),account:n(["account","source","card"])}},lL=e=>new Promise((t,n)=>{oL.parse(e,{header:!0,skipEmptyLines:!0,complete:({data:i,meta:r,errors:s})=>{const a=cL(r.fields||[]);t({data:i,meta:r,errors:s,suggestedMapping:a})},error:i=>{n(i)}})});var uL=Object.defineProperty,hL=Object.getOwnPropertyDescriptor,mw=e=>{throw TypeError(e)},Vr=(e,t,n,i)=>{for(var r=i>1?void 0:i?hL(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&uL(t,n,r),r},dL=(e,t,n)=>t.has(e)||mw("Cannot "+n),fL=(e,t,n)=>t.has(e)?mw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Oi=(e,t,n)=>(dL(e,t,"access private method"),n),In,vw,bw,_w,yw,ww,xw,Sw,Cw;const pL=[{key:"date",label:"Date"},{key:"amount",label:"Debit"},{key:"credit",label:"Credit"},{key:"description",label:"Description"},{key:"account",label:"Account"}];let ui=class extends Ns($t){constructor(){super(...arguments),fL(this,In),this._step="upload",this._mapping={},this._accounts=[],this._accountName="",this._importMode="append"}async loadFile(e){await this.withBusy(async()=>{this._accounts=await xs.all(),this._result=await lL(e),this._mapping={...this._result.suggestedMapping},this._step="mapping"})}render(){return F`
      ${this._step==="upload"?Oi(this,In,Sw).call(this):Oi(this,In,Cw).call(this)}
    `}};In=new WeakSet;vw=async function(e){const t=e.target;!t.files||t.files.length===0||await this.loadFile(t.files[0])};bw=function(e){this._accountName=e.target.value};_w=function(e){this._importMode=e.target.value};yw=function(e,t){const i=t.target.value||void 0;this._mapping={...this._mapping,[e]:i}};ww=async function(){if(this._mapping.account)return;const e=this._accountName.trim();if(!e)return;const t=this._accounts.find(n=>n.name.toLowerCase()===e.toLowerCase());return t?t.id:xs.create({name:e})};xw=async function(){this._result&&await this.withBusy(async()=>{const e=!this._mapping.account,t=await Oi(this,In,ww).call(this);if(!(e&&t===void 0)){dd("Importing transactions...");try{const n=await eL(this._result.data,this._mapping,{accountId:t,importMode:this._importMode});this.dispatchEvent(new CustomEvent("imported",{detail:{count:n}})),this._step="upload",this._result=void 0,this._mapping={},this._accountName="",this._importMode="append"}finally{fd()}}})};Sw=function(){return F`
      <label for="file-upload">Select a CSV file:</label>
      <input type="file" id="file-upload" accept=".csv" @change=${Oi(this,In,vw)} />
    `};Cw=function(){if(!this._result)return gt;const e=this._result.meta.fields??[],t=this._result.data.slice(0,5);return F`
      <h4>Column Mapping</h4>
      <div class="mapping-form">
        ${pL.map(({key:n,label:i})=>F`
          <label>${i}:</label>
          <select @change=${r=>Oi(this,In,yw).call(this,n,r)}>
            <option value="">-- Unmapped --</option>
            ${e.map(r=>F`
              <option value=${r} ?selected=${this._mapping[n]===r}>${r}</option>
            `)}
          </select>
        `)}
      </div>

      ${this._mapping.account?gt:F`
        <h4>Account</h4>
        <div class="mapping-form">
          <label>Account:</label>
          <input
            type="text"
            list="account-options"
            .value=${this._accountName}
            @input=${Oi(this,In,bw)}
            placeholder="Type or select an account"
          />
          <datalist id="account-options">
            ${this._accounts.map(n=>F`<option value=${n.name}></option>`)}
          </datalist>
        </div>
      `}

      <div class="mapping-form">
        <label>Mode:</label>
        <select @change=${Oi(this,In,_w)}>
          <option value="append" ?selected=${this._importMode==="append"}>Append to existing</option>
          <option value="replace" ?selected=${this._importMode==="replace"}>Replace existing transactions</option>
        </select>
      </div>

      <button @click=${Oi(this,In,xw)}>Import</button>

      <h4>Preview</h4>
      <div class="preview">
        <table>
          <thead>
            <tr>${e.map(n=>F`<th>${n}</th>`)}</tr>
          </thead>
          <tbody>
            ${t.map(n=>F`
              <tr>${e.map(i=>F`<td>${n[i]}</td>`)}</tr>
            `)}
          </tbody>
        </table>
      </div>
    `};ui.styles=[Ls,fi,Bt`
      :host {
        display: block;
      }
      .mapping-form {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.5rem;
        align-items: center;
        max-width: 400px;
      }
      select {
        padding: 4px 8px;
      }
      button {
        padding: 0.5rem 1rem;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: var(--budgee-primary-hover);
      }
    `];Vr([W()],ui.prototype,"_step",2);Vr([W()],ui.prototype,"_result",2);Vr([W()],ui.prototype,"_mapping",2);Vr([W()],ui.prototype,"_accounts",2);Vr([W()],ui.prototype,"_accountName",2);Vr([W()],ui.prototype,"_importMode",2);ui=Vr([Ut("transaction-importer")],ui);var gL=Object.defineProperty,mL=Object.getOwnPropertyDescriptor,kw=e=>{throw TypeError(e)},$e=(e,t,n,i)=>{for(var r=i>1?void 0:i?mL(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&gL(t,n,r),r},Ew=(e,t,n)=>t.has(e)||kw("Cannot "+n),Wg=(e,t,n)=>(Ew(e,t,"read from private field"),n?n.call(e):t.get(e)),Hg=(e,t,n)=>t.has(e)?kw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ut=(e,t,n)=>(Ew(e,t,"access private method"),n),hc,ct,Mw,_o,Dw,Qa,Iw,Rw,Tw,rs,ss,Th,Pw,Ow,Aw,$w,Lw,Nw,Ll,Fw,Bw,Vd,jw,Ph,Oh,zw,Ww;let xe=class extends Ns($t){constructor(){super(...arguments),Hg(this,ct),this._transactions=null,this._tags=[],this._tagMap=new Map,this._merchants=new Map,this._merchantList=[],this._currentPage=1,this._pageSize=50,this._filter="",this._sortCol="date",this._sortDir="desc",this._selectedIds=new Set,this._excludeTagIds=new Set,this._noMerchant=!1,this._bulkMerchantName="",this._showImporter=!1,Hg(this,hc,e=>{const t=e.detail.file;this._showImporter=!0,this.updateComplete.then(()=>{const n=this.shadowRoot?.querySelector("transaction-importer");n&&n.loadFile(t)})})}connectedCallback(){super.connectedCallback(),ut(this,ct,_o).call(this),document.addEventListener("budgee-import-csv",Wg(this,hc))}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("budgee-import-csv",Wg(this,hc))}render(){if(this._transactions===null)return F`
        <p>Loading</p>
      `;if(this._transactions.length===0)return F`
        <p>No transactions found.</p>
      `;const e=this._transactions.filter(a=>ut(this,ct,Tw).call(this,a)),t=ut(this,ct,Ow).call(this,e),n=(this._currentPage-1)*this._pageSize,i=t.slice(n,n+this._pageSize),r=i.map(a=>a.id),s=r.length>0&&r.every(a=>this._selectedIds.has(a));return F`
      <button class="import-toggle" @click=${()=>{this._showImporter=!0}}>
        Import CSV
      </button>
      ${this._showImporter?F`<budgee-modal heading="Import Transactions" @modal-close=${()=>{this._showImporter=!1}}><transaction-importer @imported=${ut(this,ct,Mw)}></transaction-importer></budgee-modal>`:gt}
      ${ut(this,ct,zw).call(this)}
      ${ut(this,ct,Ww).call(this)}
      <paginated-table
        .totalItems=${e.length}
        .defaultPageSize=${50}
        storageKey="transactions"
        ?filterable=${!0}
        @page-change=${ut(this,ct,Iw)}
        @filter-change=${ut(this,ct,Rw)}
      >
        <table>
          <thead>
            <tr>
              <th class="col-checkbox">
                <input
                  type="checkbox"
                  .checked=${s}
                  @change=${()=>ut(this,ct,Nw).call(this,i)}
                />
              </th>
              <th class="sortable col-date" @click=${()=>ut(this,ct,rs).call(this,"date")}>
                Date${ut(this,ct,ss).call(this,"date")}
              </th>
              <th class="sortable" @click=${()=>ut(this,ct,rs).call(this,"merchant")}>
                Merchant${ut(this,ct,ss).call(this,"merchant")}
              </th>
              <th class="sortable" @click=${()=>ut(this,ct,rs).call(this,"description")}>
                Description${ut(this,ct,ss).call(this,"description")}
              </th>
              <th class="sortable col-amount" @click=${()=>ut(this,ct,rs).call(this,"amount")}>
                Amount${ut(this,ct,ss).call(this,"amount")}
              </th>
              <th class="sortable col-tags" @click=${()=>ut(this,ct,rs).call(this,"tags")}>
                Tags${ut(this,ct,ss).call(this,"tags")}
              </th>
            </tr>
          </thead>
          <tbody>
            ${i.map(a=>F`
              <tr @click=${()=>ut(this,ct,$w).call(this,a.id)}>
                <td class="col-checkbox" @click=${o=>o.stopPropagation()}>
                  <input
                    type="checkbox"
                    .checked=${this._selectedIds.has(a.id)}
                    @change=${()=>ut(this,ct,Lw).call(this,a.id)}
                  />
                </td>
                <td class="col-date">${ut(this,ct,Pw).call(this,a.date)}</td>
                <td>${a.merchantId&&this._merchants.has(a.merchantId)?F`<a class="merchant-link" @click=${o=>{o.stopPropagation(),ut(this,ct,Aw).call(this,a.merchantId)}}>${this._merchants.get(a.merchantId)}</a>`:""}</td>
                <td>${a.originalDescription}</td>
                <td class="col-amount ${a.amount<0?"amount-negative":"amount-positive"}">
                  ${a.amount.toFixed(2)}
                </td>
                <td class="col-tags">
                  <tag-pills .tags=${this._tags} .tagIds=${a.tagIds}></tag-pills>
                </td>
              </tr>
            `)}
          </tbody>
        </table>
      </paginated-table>
    `}};hc=new WeakMap;ct=new WeakSet;Mw=async function(){await this.withBusy(async()=>{this._showImporter=!1,await ut(this,ct,_o).call(this)})};_o=async function(){const[e,t,n]=await Promise.all([An.all(),hn.all(),oi.all()]);this._transactions=e,this._tags=t,this._tagMap=new Map(t.map(i=>[i.id,i])),this._merchants=new Map(n.map(i=>[i.id,i.name])),this._merchantList=n};Dw=function(e){return this._tagMap.get(e)};Qa=function(e){return ut(this,ct,Dw).call(this,e)?.name??`#${e}`};Iw=function(e){this._currentPage=e.detail.page,this._pageSize=e.detail.pageSize};Rw=function(e){this._filter=e.detail.filter,this._currentPage=1};Tw=function(e){if(this._noMerchant&&e.merchantId||e.tagIds.some(n=>this._excludeTagIds.has(n)))return!1;if(!this._filter)return!0;const t=this._filter.toLowerCase();return!!(e.originalDescription.toLowerCase().includes(t)||e.tagIds.some(n=>ut(this,ct,Qa).call(this,n).toLowerCase().includes(t))||e.merchantId&&this._merchants.get(e.merchantId)?.toLowerCase().includes(t)||e.date.includes(t)||e.amount.toFixed(2).includes(t))};rs=function(e){this._sortCol===e?this._sortDir=this._sortDir==="asc"?"desc":"asc":(this._sortCol=e,this._sortDir="asc"),this._currentPage=1};ss=function(e){return this._sortCol!==e?"":this._sortDir==="asc"?" ":" "};Th=function(e){return e?this._merchants.get(e)??"":""};Pw=function(e){const[t,n,i]=e.split("-");return new Date(Number(t),Number(n)-1,Number(i)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};Ow=function(e){const t=this._sortCol,n=this._sortDir==="asc"?1:-1;return[...e].sort((i,r)=>{let s=0;if(t==="date")s=i.date.localeCompare(r.date);else if(t==="merchant")s=ut(this,ct,Th).call(this,i.merchantId).localeCompare(ut(this,ct,Th).call(this,r.merchantId));else if(t==="description")s=i.originalDescription.localeCompare(r.originalDescription);else if(t==="amount")s=i.amount-r.amount;else if(t==="tags"){const a=i.tagIds.map(c=>ut(this,ct,Qa).call(this,c)).join(","),o=r.tagIds.map(c=>ut(this,ct,Qa).call(this,c)).join(",");s=a.localeCompare(o)}return s*n})};Aw=function(e){window.history.pushState({},"",`/merchants/${e}`),window.dispatchEvent(new PopStateEvent("popstate"))};$w=function(e){window.history.pushState({},"",`/transactions/${e}`),window.dispatchEvent(new PopStateEvent("popstate"))};Lw=function(e){const t=new Set(this._selectedIds);t.has(e)?t.delete(e):t.add(e),this._selectedIds=t};Nw=function(e){const t=e.map(i=>i.id);if(t.every(i=>this._selectedIds.has(i))){const i=new Set(this._selectedIds);for(const r of t)i.delete(r);this._selectedIds=i}else this._selectedIds=new Set([...this._selectedIds,...t])};Ll=function(){this._selectedIds=new Set,this._bulkMerchantName=""};Fw=async function(e){const n=e.detail.tag.id;await ut(this,ct,Vd).call(this,n)};Bw=async function(e){const t=e.detail.name,n=await hn.create(t);await ut(this,ct,Vd).call(this,n)};Vd=async function(e){this._transactions&&await this.withBusy(async()=>{const t=this._transactions.filter(n=>this._selectedIds.has(n.id)&&!n.tagIds.includes(e)).map(n=>({...n,tagIds:[...n.tagIds,e]}));t.length>0&&await An.bulkPut(t),ut(this,ct,Ll).call(this),await ut(this,ct,_o).call(this)})};jw=async function(){const e=this._bulkMerchantName.trim();!e||!this._transactions||await this.withBusy(async()=>{let t=this._merchantList.find(i=>i.name.toLowerCase()===e.toLowerCase());t||(t={id:await oi.create(e),name:e});const n=this._transactions.filter(i=>this._selectedIds.has(i.id)).map(i=>({...i,merchantId:t.id}));n.length>0&&await An.bulkPut(n),ut(this,ct,Ll).call(this),await ut(this,ct,_o).call(this)})};Ph=function(e){const t=new Set(this._excludeTagIds);t.has(e)?t.delete(e):t.add(e),this._excludeTagIds=t,this._currentPage=1};Oh=function(){this._noMerchant=!this._noMerchant,this._currentPage=1};zw=function(){const e=this._excludeTagIds.size>0||this._noMerchant;return F`
      <div class="filter-bar">
        <div class="filter-group">
          <label>Exclude tag:</label>
          <select @change=${t=>{const n=t.target.value;n&&ut(this,ct,Ph).call(this,n),t.target.value=""}}>
            <option value="">Select</option>
            ${this._tags.filter(t=>!this._excludeTagIds.has(t.id)).map(t=>F`<option value=${t.id}>${t.name}</option>`)}
          </select>
        </div>
        <div class="filter-group">
          <label>
            <input type="checkbox" .checked=${this._noMerchant} @change=${ut(this,ct,Oh)} />
            No merchant
          </label>
        </div>
        ${e?F`
            <div class="active-filters">
              ${[...this._excludeTagIds].map(t=>F`
                  <span class="filter-chip">
                    Not: ${ut(this,ct,Qa).call(this,t)}
                    <button class="chip-remove" @click=${()=>ut(this,ct,Ph).call(this,t)}></button>
                  </span>
                `)}
              ${this._noMerchant?F`<span class="filter-chip">
                    No merchant
                    <button class="chip-remove" @click=${ut(this,ct,Oh)}></button>
                  </span>`:gt}
            </div>
          `:gt}
      </div>
    `};Ww=function(){return this._selectedIds.size===0?gt:F`
      <div class="bulk-bar">
        <span class="selected-count">${this._selectedIds.size} selected</span>
        <div class="bulk-action">
          <label>Tag:</label>
          <tag-autocomplete
            .tags=${this._tags}
            .selectedTagIds=${[]}
            .excludeIds=${[]}
            @tag-selected=${ut(this,ct,Fw)}
            @tag-created=${ut(this,ct,Bw)}
          ></tag-autocomplete>
        </div>
        <div class="bulk-action">
          <label>Merchant:</label>
          <merchant-autocomplete
            .merchants=${this._merchantList}
            .value=${this._bulkMerchantName}
            @merchant-changed=${e=>{this._bulkMerchantName=e.detail.name}}
          ></merchant-autocomplete>
          <button @click=${ut(this,ct,jw)} ?disabled=${!this._bulkMerchantName.trim()}>
            Set
          </button>
        </div>
        <button @click=${ut(this,ct,Ll)}>Clear selection</button>
      </div>
    `};xe.styles=[Ls,fi,Bt`
      tbody tr {
        cursor: pointer;
      }
      .merchant-link {
        color: var(--budgee-primary);
        cursor: pointer;
        text-decoration: underline;
      }
      .col-amount {
        width: 8rem;
      }
      .col-date {
        white-space: nowrap;
      }
      .col-tags tag-pills {
        display: block;
        width: 100%;
      }
      .col-checkbox {
        width: min-content;
      }
      .bulk-bar {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.5rem 0.75rem;
        background: var(--budgee-bg);
        border: 1px solid var(--budgee-border);
        border-radius: 4px;
        margin-bottom: 0.5rem;
        flex-wrap: wrap;
      }
      .bulk-bar .selected-count {
        font-weight: 600;
        white-space: nowrap;
      }
      .bulk-bar label {
        font-size: 0.85rem;
        white-space: nowrap;
      }
      .bulk-bar .bulk-action {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      .bulk-bar button {
        padding: 4px 10px;
        cursor: pointer;
      }
      .filter-bar {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.5rem 0.75rem;
        margin-bottom: 0.5rem;
        flex-wrap: wrap;
        font-size: 0.85rem;
      }
      .filter-group {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      .filter-group select {
        padding: 2px 6px;
        border: 1px solid var(--budgee-border);
        border-radius: 4px;
        background: var(--budgee-surface);
        font-size: 0.85rem;
      }
      .active-filters {
        display: flex;
        gap: 0.4rem;
        flex-wrap: wrap;
      }
      .filter-chip {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        padding: 2px 8px;
        border-radius: 12px;
        background: var(--budgee-bg);
        border: 1px solid var(--budgee-border);
        font-size: 0.8rem;
      }
      .chip-remove {
        all: unset;
        cursor: pointer;
        font-size: 0.9rem;
        line-height: 1;
        padding: 0 2px;
      }
      .import-toggle {
        padding: 0.4rem 0.8rem;
        cursor: pointer;
        background-color: var(--budgee-primary);
        color: white;
        border: none;
        border-radius: 4px;
        margin-bottom: 0.5rem;
        font-size: 0.85rem;
      }
      .import-toggle:hover {
        background-color: var(--budgee-primary-hover);
      }
    `];$e([W()],xe.prototype,"_transactions",2);$e([W()],xe.prototype,"_tags",2);$e([W()],xe.prototype,"_merchants",2);$e([W()],xe.prototype,"_merchantList",2);$e([W()],xe.prototype,"_currentPage",2);$e([W()],xe.prototype,"_pageSize",2);$e([W()],xe.prototype,"_filter",2);$e([W()],xe.prototype,"_sortCol",2);$e([W()],xe.prototype,"_sortDir",2);$e([W()],xe.prototype,"_selectedIds",2);$e([W()],xe.prototype,"_excludeTagIds",2);$e([W()],xe.prototype,"_noMerchant",2);$e([W()],xe.prototype,"_bulkMerchantName",2);$e([W()],xe.prototype,"_showImporter",2);xe=$e([Ut("transaction-list")],xe);var vL=Object.defineProperty,bL=Object.getOwnPropertyDescriptor,Hw=e=>{throw TypeError(e)},Uw=(e,t,n,i)=>{for(var r=i>1?void 0:i?bL(t,n):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(i?a(t,n,r):a(r))||r);return i&&r&&vL(t,n,r),r},qd=(e,t,n)=>t.has(e)||Hw("Cannot "+n),an=(e,t,n)=>(qd(e,t,"read from private field"),n?n.call(e):t.get(e)),ar=(e,t,n)=>t.has(e)?Hw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),tl=(e,t,n,i)=>(qd(e,t,"write to private field"),t.set(e,n),n),Ug=(e,t,n)=>(qd(e,t,"access private method"),n),Vg=(e,t,n,i)=>({set _(r){tl(e,t,r)},get _(){return an(e,t,i)}}),as,ps,dc,Ah,fc,pc,gc,mc;let el=class extends $t{constructor(){super(...arguments),ar(this,dc),this._dragOver=!1,ar(this,as,0),ar(this,ps),this._router=new Xw(this,[{path:"/",render:()=>F`
          <budgee-dashboard></budgee-dashboard>
        `},{path:"/transactions",render:()=>F`
          <transaction-list></transaction-list>
        `},{path:"/transactions/:id",render:({id:e})=>F`<transaction-detail .transactionId=${e}></transaction-detail>`,enter:async()=>(await cs(()=>import("./transactionDetail-8zXH6p3I.js"),[]),!0)},{path:"/accounts",render:()=>F`
          <account-list></account-list>
        `},{path:"/accounts/:id",render:({id:e})=>F`<account-detail .accountId=${e}></account-detail>`,enter:async()=>(await cs(()=>import("./accountDetail-CXfBq4wQ.js"),[]),!0)},{path:"/merchants",render:()=>F`
          <merchant-list></merchant-list>
        `},{path:"/merchants/:id",render:({id:e})=>F`<merchant-detail .merchantId=${e}></merchant-detail>`,enter:async()=>(await cs(()=>import("./merchantDetail-qQSF9HZI.js"),[]),!0)},{path:"/tags",render:()=>F`
          <tag-manager></tag-manager>
        `},{path:"/rules",render:()=>F`
          <rule-manager></rule-manager>
        `},{path:"/import",render:()=>F`
          <database-manager></database-manager>
        `},{path:"/settings",render:()=>F`
          <budgee-settings @budgee-sync-settings-changed=${()=>Ug(this,dc,Ah).call(this)}></budgee-settings>
        `}]),ar(this,fc,e=>{e.preventDefault()}),ar(this,pc,e=>{e.preventDefault(),Vg(this,as)._++,this._dragOver=!0}),ar(this,gc,e=>{Vg(this,as)._--,an(this,as)===0&&(this._dragOver=!1)}),ar(this,mc,async e=>{e.preventDefault(),tl(this,as,0),this._dragOver=!1;const t=e.dataTransfer?.files[0];if(t){if(t.name.endsWith(".csv"))window.history.pushState({},"","/transactions"),window.dispatchEvent(new PopStateEvent("popstate")),await this.updateComplete,document.dispatchEvent(new CustomEvent("budgee-import-csv",{detail:{file:t}}));else if(t.name.endsWith(".json")){if(!confirm("This will replace all existing data. Are you sure?"))return;dd("Importing database...");try{await Kv(t),window.location.reload()}finally{fd()}}}})}connectedCallback(){super.connectedCallback(),this.addEventListener("dragover",an(this,fc)),this.addEventListener("dragenter",an(this,pc)),this.addEventListener("dragleave",an(this,gc)),this.addEventListener("drop",an(this,mc)),ht().then(e=>e0(e)).catch(console.error),Ug(this,dc,Ah).call(this)}disconnectedCallback(){var e;super.disconnectedCallback(),this.removeEventListener("dragover",an(this,fc)),this.removeEventListener("dragenter",an(this,pc)),this.removeEventListener("dragleave",an(this,gc)),this.removeEventListener("drop",an(this,mc)),(e=an(this,ps))==null||e.call(this)}navLink(e,t,n){const i=window.location.pathname,r=e==="/"?i==="/":i.startsWith(e);return F`<a href=${e} class=${y1({active:r})}>${ye(n)} ${t}</a>`}render(){return F`
      <nav>
        <div class="app-name">${ye(Yv)} Budgee</div>
        ${this.navLink("/","Dashboard",AM)}
        ${this.navLink("/transactions","Transactions",a0)}
        ${this.navLink("/accounts","Accounts",LM)}
        ${this.navLink("/merchants","Merchants",o0)}
        ${this.navLink("/tags","Tags",BM)}
        ${this.navLink("/rules","Rules",NM)}
        ${this.navLink("/import","Database",$M)}
        ${this.navLink("/settings","Sync",FM)}
      </nav>
      <div class="container">
        ${this._router.outlet()}
      </div>
      ${this._dragOver?F`
              <div class="drop-overlay"><span>Drop file to import</span></div>
            `:gt}
    `}};as=new WeakMap;ps=new WeakMap;dc=new WeakSet;Ah=function(){var e;(e=an(this,ps))==null||e.call(this),tl(this,ps,void 0);let t;try{t=localStorage.getItem("budgee-sync-url")}catch{return}t&&OM(t).then(n=>{tl(this,ps,n)},n=>{console.error("Failed to start replication:",n)})};fc=new WeakMap;pc=new WeakMap;gc=new WeakMap;mc=new WeakMap;el.styles=Bt`
    :host {
      display: flex;
      min-height: 100vh;
      color: var(--budgee-text);
      font-family: sans-serif;
    }

    svg.lucide {
      display: inline-block;
      width: 1rem;
      height: 1rem;
    }

    .app-name {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem 1rem;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--budgee-text);
      text-decoration: none;
      border-bottom: 1px solid var(--budgee-border);
      margin-bottom: 0.5rem;
    }

    .app-name svg.lucide {
      width: 1.5rem;
      height: 1.5rem;
    }

    nav {
      display: flex;
      flex-direction: column;
      gap: 0;
      background: var(--budgee-surface);
      border-right: 1px solid var(--budgee-border);
      padding: 1rem 0;
      width: 180px;
      flex-shrink: 0;
    }

    nav a,
    nav button {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.5rem 1rem;
      text-decoration: none;
      color: var(--budgee-text-muted);
      font-size: 0.9rem;
      border-left: 3px solid transparent;
      background: none;
      border-top: none;
      border-right: none;
      border-bottom: none;
      cursor: pointer;
      font-family: inherit;
      text-align: left;
      transition:
        color 0.15s,
        border-color 0.15s;
    }

    nav a:hover,
    nav button:hover {
      color: var(--budgee-primary);
    }

    nav a.active {
      color: var(--budgee-primary);
      border-left-color: var(--budgee-primary);
    }

    .container {
      flex: 1;
      min-width: 0;
      padding: 1.5rem 2rem;
    }

    @media (max-width: 768px) {
      :host {
        flex-direction: column;
      }

      nav {
        flex-direction: row;
        flex-wrap: wrap;
        width: auto;
        border-right: none;
        border-bottom: 1px solid var(--budgee-border);
        padding: 0 0.5rem;
      }

      nav a,
      nav button {
        border-left: none;
        border-bottom: 2px solid transparent;
        padding: 0.5rem 0.75rem;
      }

      nav a.active {
        border-bottom-color: var(--budgee-primary);
      }

      .container {
        padding: 1rem;
      }
    }

    .drop-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      pointer-events: none;
    }

    .drop-overlay span {
      color: white;
      font-size: 1.5rem;
      font-weight: 600;
    }
  `;Uw([W()],el.prototype,"_dragOver",2);el=Uw([Ut("budgee-app")],el);export{gt as A,Ns as B,pS as C,ha as D,RL as E,wn as F,K1 as G,et as H,da as I,hl as J,ML as K,it as L,oi as M,DL as N,V1 as R,ie as S,An as T,hn as a,F as b,bi as c,mA as d,Ls as e,Bt as f,Ut as g,TL as h,$t as i,zM as j,xs as k,Cn as l,vA as m,pt as n,r0 as o,ln as p,qt as q,W as r,xn as s,fi as t,$u as u,Oa as v,CL as w,vs as x,kL as y,Gm as z};
